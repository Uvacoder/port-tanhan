<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Tan Li Hau]]></title><description><![CDATA[Tan Li Hau is a frontend engineer who is currently working in Shopee]]></description><link>https://lihautan.com</link><generator>RSS for Node</generator><lastBuildDate>Fri, 30 Aug 2019 00:42:58 GMT</lastBuildDate><item><title><![CDATA[What is module bundler and how does it work?]]></title><link>https://lihautan.com/what-is-module-bundler-and-how-does-it-work/</link><guid isPermaLink="false">https://lihautan.com/what-is-module-bundler-and-how-does-it-work/</guid><pubDate>Fri, 30 Aug 2019 08:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;What is a Module Bundler?&lt;/h2&gt;
&lt;p&gt;
  &lt;a class=&quot;gatsby-resp-image-link&quot; href=&quot;/static/ece4b04e88f84e6d61abc84e759c0916/426f8/module-bundlers.png&quot; style=&quot;display: block&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;
  
  &lt;figure class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;&gt;
    &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom: 31.542056074766357%; position: relative; bottom: 0; left: 0; background-image: url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAYAAADDl76dAAAACXBIWXMAABYlAAAWJQFJUiTwAAABNElEQVQY03WRO0sDQRSF9/dY+APsrOwFK1PZiaII2sTCQrESNWinYqOCjQ+CoCCYxgTfRmVjEAMxCXGTjYHEbHbdnflcd5MYfAxMMeec+e7cOwo/lpSSvzRPb2zpi773I6vIXA65sop5GmmZhmEQjUaJ397gOKIVtpqABlSYFaSeQFTzmNojTr3iAo9cUG8HmUAXZjLlBROqyuLCPLPL66hpzYNdaRaDOynCT++tAubbC8mNUSIzfdyvDWGW0igkYlTGO3kd6EfWLf/yxTnBqWm2L/NktLKnHTzX6A5ds3Smf7/YsjgMDROe7CG+GcQyDRRRjFMYC1AdmYCaX72k6+zu7ZPNFxDCb7lmSx7KgqIpvca/Rvhh29zFjjnZmiOrxrDdrCJFc3JuyHH+/ZRf5zZNtHmfIQi5j0YdnM8AAAAASUVORK5CYII=&amp;#x27;); background-size: cover; display: block;&quot;&gt;
      &lt;img class=&quot;gatsby-resp-image-image&quot; style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot; alt=&quot;module bundlers&quot; title=&quot;Module Bundlers: (left to right) Rollup, FuseBox, webpack, parcel&quot; src=&quot;/static/ece4b04e88f84e6d61abc84e759c0916/623ee/module-bundlers.png&quot; srcset=&quot;/static/ece4b04e88f84e6d61abc84e759c0916/816c5/module-bundlers.png 148w, /static/ece4b04e88f84e6d61abc84e759c0916/c766b/module-bundlers.png 295w, /static/ece4b04e88f84e6d61abc84e759c0916/623ee/module-bundlers.png 590w, /static/ece4b04e88f84e6d61abc84e759c0916/426f8/module-bundlers.png 856w&quot; sizes=&quot;(max-width: 590px) 100vw, 590px&quot;&gt;
    &lt;/span&gt;
  &lt;figcaption&gt;Module Bundlers: (left to right) Rollup, FuseBox, webpack, parcel&lt;/figcaption&gt;&lt;/figure&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Module bundlers are tools frontend developers used to bundle &lt;a href=&quot;https://lihautan.com/javascript-modules/&quot;&gt;JavaScript modules&lt;/a&gt; into a single JavaScript files that can be executed in the browser.&lt;/p&gt;
&lt;p&gt;Examples of modern module bundlers &lt;em&gt;(in no particular order)&lt;/em&gt; are: &lt;a href=&quot;https://webpack.js.org&quot;&gt;webpack&lt;/a&gt;, &lt;a href=&quot;https://rollupjs.org&quot;&gt;rollup&lt;/a&gt;, &lt;a href=&quot;https://fuse-box.org&quot;&gt;fusebox&lt;/a&gt;, &lt;a href=&quot;https://parceljs.org&quot;&gt;parcel&lt;/a&gt;, etc.&lt;/p&gt;
&lt;p&gt;Module bundler is required because:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Browser does not support module system, &lt;a href=&quot;https://philipwalton.com/articles/using-native-javascript-modules-in-production-today/&quot;&gt;although this is not entirely true nowadays&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;It helps you manage the dependency relationship of your code, it will load modules in dependency order for you.&lt;/li&gt;
&lt;li&gt;It helps you to load your assets in dependency order, image asset, css asset, etc.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;To illustrate, imagine you are building a web application, which is made up of multiple JavaScript files. You add JavaScript files into html via script tags:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/src/foo.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/src/bar.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/src/baz.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/src/qux.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/src/quux.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Each file requires a separate http requests, which is 5 round trip requests in order to get your application started. So it would be better if you can combine all 5 files into 1:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/dist/bundle.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;html&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;i&gt;(Although with &lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/http2/&quot;&gt;HTTP/2&lt;/a&gt;, this is much less of a case right now)&lt;/i&gt;&lt;/p&gt;
&lt;p&gt;So how do we generate the &lt;code class=&quot;language-text&quot;&gt;dist/bundle.js&lt;/code&gt;?&lt;/p&gt;
&lt;p&gt;Several challenges arise in the process:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;How do we &lt;strong&gt;maintain the order&lt;/strong&gt; of the “files” to be included?&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;It would be great that it is some sort of dependency order amongst the “files”&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;How do we &lt;strong&gt;prevent naming conflicts&lt;/strong&gt; between “files”?&lt;/li&gt;
&lt;li&gt;How do we determine any unused “file” within the bundle?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;All of these can be solved if we know the relationship amongst each files, such as:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Which file is depended on another?&lt;/li&gt;
&lt;li&gt;What are the interface exposed from a file? and&lt;/li&gt;
&lt;li&gt;Which exposed interfaces are being used by another?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These information, granted, can solve the challenges brought up respectively. So, what we need is a declarative method to describe the relationship between files, which led us to the &lt;a href=&quot;https://lihautan.com/javascript-modules/&quot;&gt;JavaScript Module System&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://requirejs.org/docs/commonjs.html&quot;&gt;CommonJS&lt;/a&gt; or &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import&quot;&gt;ES6 Modules&lt;/a&gt; provides way for us to specify what files we are dependening on, and which of their interface we are using in our file.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// CommonJS&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; foo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./foo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exports &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; bar&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// ES Modules&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; foo &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./foo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; bar&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;How do we bundle?&lt;/h2&gt;
&lt;p&gt;With the information gathered from the module system, how do we link the files together and generate the bundle file that encapsulates everything?&lt;/p&gt;
&lt;p&gt;If you scrutinize the bundle generated by &lt;a href=&quot;https://webpack.js.org&quot;&gt;webpack&lt;/a&gt; and &lt;a href=&quot;https://rollupjs.org&quot;&gt;rollup&lt;/a&gt;, you would notice that the 2 most popular bundler takes a totally different approach in bundling, and here I coined them, the &lt;em&gt;&lt;strong&gt;“webpack way”&lt;/strong&gt;&lt;/em&gt; and the &lt;em&gt;&lt;strong&gt;“rollup way”&lt;/strong&gt;&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Let’s illustrate this with an example:&lt;/p&gt;
&lt;p&gt;Say you have 3 files, &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;square.js&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;app.js&lt;/code&gt;:&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;circle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p class=&quot;filename&quot;&gt;square.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;side&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; side &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p class=&quot;filename&quot;&gt;app.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; squareArea &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./square&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; circleArea &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Area of square: &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;squareArea&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Area of circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;circleArea&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3&gt;The “webpack way”&lt;/h3&gt;
&lt;p&gt;What would be the “webpack way” bundle looks like?&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;webpack-bundle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; modules &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&apos;circle.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; require&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&apos;square.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; require&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;side&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; side &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token string&quot;&gt;&apos;app.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; require&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; squareArea &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;square.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; circleArea &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;circle.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Area of square: &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;squareArea&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Area of circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;circleArea&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;webpackStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  modules&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  entry&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;app.js&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;I have made some slight modifications for easier illustration&lt;/div&gt;
&lt;p&gt;First thing you would notice is the &lt;strong&gt;“module map”&lt;/strong&gt;. It is a dictionary that maps the module name to the module itself, which is wrapped by a function. The “module map” is like a registry, it makes it easy to register modules by adding entries.&lt;/p&gt;
&lt;p&gt;Secondly, &lt;strong&gt;each module is wrapped by a function&lt;/strong&gt;. The function simulates the module scope, where everything declared within the module is scoped within itself. The function itself is called the “module factory function”. As you can see, it takes in a few parameters, to allow the module to exports its interface, as well as to require from other modules.&lt;/p&gt;
&lt;p&gt;Thirdly, the application is start via &lt;code class=&quot;language-text&quot;&gt;webpackStart&lt;/code&gt;, which is &lt;strong&gt;a function that glues everything together&lt;/strong&gt;. The function itself, often called as the &lt;em&gt;“runtime”&lt;/em&gt;, is the most important piece of the bundle. It uses the “module map” and the entry module to start the application.&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;webpack-bundle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;webpackStart&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; modules&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; entry &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; moduleRegistry &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; moduleName &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// if in cache, return the cached version&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;moduleCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;moduleName&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; moduleCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;moduleName&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; exports &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// this will prevent infinite &quot;require&quot; loop&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// from circular dependencies&lt;/span&gt;
    moduleCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;moduleName&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; exports&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// &quot;require&quot;-ing the module,&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// exported stuff will assigned to &quot;exports&quot;&lt;/span&gt;
    modules&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;moduleName&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; require&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; moduleCache&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;moduleName&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// start the program&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;entry&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;I have made some slight modifications for easier illustration&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;webpackStart&lt;/code&gt; defines 2 things, the “require” function and the module cache. The “require” function is not the same as the &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; from CommonJS. “require” takes in the module name, and returns the exported interface from a module, eg: for &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt; it would be &lt;code class=&quot;language-text&quot;&gt;{ default: function area(radius){ ... } }&lt;/code&gt;. The exported interface is cached in the module cache, so that if we call “require” of the same module name repeatedly, the “module factory function” will only be executed once.&lt;/p&gt;
&lt;p&gt;With “require” defined, starting the application would be just “require”ing the entry module.&lt;/p&gt;
&lt;h3&gt;The “rollup way”&lt;/h3&gt;
&lt;p&gt;Now you’ve seen how webpack bundle looked like, let’s take a look at the “rollup way” bundle:&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;rollup-bundle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;circle$area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;square$area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;side&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; side &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; side&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Area of square: &apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;square$area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Area of circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;circle$area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;I have made some slight modifications for easier illustration&lt;/div&gt;
&lt;p&gt;Firstly, the key difference in the rollup bundle, is that it is much smaller compared to the webpack bundle. There is &lt;strong&gt;no module map&lt;/strong&gt;, as compared to the “webpack way”. All the modules are &lt;strong&gt;“flatten” into the bundle&lt;/strong&gt;. There is no function wrapping of modules. All the variables/functions that were declared within the module, is now declared into the global scope.&lt;/p&gt;
&lt;p&gt;If everything declared in individual module scope is now declared into the global scope, &lt;em&gt;what happened if 2 modules declare variable/function of the same name?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Well, rollup will &lt;strong&gt;rename the variable/function name&lt;/strong&gt;, such that name collision do not happen. In our example, both &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;square.js&lt;/code&gt; have declared &lt;code class=&quot;language-text&quot;&gt;function area(){}&lt;/code&gt; within the module, when bundled, you see that both functions and their usage were renamed to avoid collision.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;em&gt;One of the side effects of not wrapping module with a function is the behavior of &lt;code class=&quot;language-text&quot;&gt;eval&lt;/code&gt;, see &lt;a href=&quot;http://rollupjs.org/guide/en/#avoiding-eval&quot;&gt;here&lt;/a&gt; for more in-depth explanation&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Secondly, &lt;strong&gt;the order of the modules within the bundle matters&lt;/strong&gt;. Well you can argue that &lt;code class=&quot;language-text&quot;&gt;circle$area&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;square$area&lt;/code&gt; can come after &lt;code class=&quot;language-text&quot;&gt;console.log&lt;/code&gt; and it will still work, yet &lt;code class=&quot;language-text&quot;&gt;PI&lt;/code&gt; has to be declared before the &lt;code class=&quot;language-text&quot;&gt;console.log&lt;/code&gt;, because of &lt;a href=&quot;https://wesbos.com/temporal-dead-zone/&quot;&gt;temporal dead zone&lt;/a&gt;. So, sorting modules in order of their dependency matters for the “rollup way”.&lt;/p&gt;
&lt;p&gt;All in all, the “rollup way” seemed to be better than the “webpack way”. It has a smaller bundle and less runtime overhead by removing all the functions.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Is there a drawback of the “rollup way”?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Well, sometimes it does not work well with circular dependency. Let’s take a look at this contrived example:&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;shape.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; circle &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;circle&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p class=&quot;filename&quot;&gt;circle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./shape&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; _PI &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; _PI &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;I have made some slight modifications for easier illustration&lt;/div&gt;
&lt;p&gt;In this example &lt;code class=&quot;language-text&quot;&gt;shape.js&lt;/code&gt; is depending on &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt; is depending on &lt;code class=&quot;language-text&quot;&gt;shape.js&lt;/code&gt;. So, for rollup to sort out which module to come first than another in the output bundle, there’s no “correct” answer for it. Either &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt; then &lt;code class=&quot;language-text&quot;&gt;shape.js&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;shape.js&lt;/code&gt; then &lt;code class=&quot;language-text&quot;&gt;circle.js&lt;/code&gt; is reasonable. So, you could possibly get the following output bundle:&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;rollup-bundle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// cirlce.js first&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; _PI &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// throws ReferenceError: PI is not defined&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;circle$Area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; _PI &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// shape.js later&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;circle$Area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You can tell this will be problematic right?&lt;/p&gt;
&lt;p&gt;Is there a solution for this? A short answer is &lt;strong&gt;no&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;A “simple” fix is to not use a circular dependency. Rollup will &lt;strong&gt;throw warnings at you&lt;/strong&gt; if it encountered one.&lt;/p&gt;
&lt;p&gt;Well, what makes the example “works” is that we have statements that are immediately evaluated within the module. If we change the evaluation of &lt;code class=&quot;language-text&quot;&gt;_PI&lt;/code&gt; to be lazy:&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;circle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./shape&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;_PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// to be lazily evaluated&lt;/span&gt;
module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;exports&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_PI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;the order of modules now does not really matter much:&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;rollup-bundle.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// cirlce.js first&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;_PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;circle$Area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;_PI&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// shape.js later&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;PI&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.141&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;circle$Area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// prints 78.525&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This is because at the time &lt;code class=&quot;language-text&quot;&gt;_PI&lt;/code&gt; is evaluated, &lt;code class=&quot;language-text&quot;&gt;PI&lt;/code&gt; has already been defined.&lt;/p&gt;
&lt;h2&gt;Summary&lt;/h2&gt;
&lt;p&gt;So, let’s summarize what we’ve learned so far:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Module bundler&lt;/em&gt; helped us to combine multiple JavaScript modules into 1 JavaScript file.&lt;/li&gt;
&lt;li&gt;Different bundler bundles differently, and we’ve looked into 2 of the modern bundler, &lt;code class=&quot;language-text&quot;&gt;webpack&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;rollup&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;the “webpack way”:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;uses module map&lt;/li&gt;
&lt;li&gt;uses function to wrap each module&lt;/li&gt;
&lt;li&gt;has a runtime code that glues the module together&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;the “rollup way”:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;flatter and smaller bundle&lt;/li&gt;
&lt;li&gt;does not use function to wrap module&lt;/li&gt;
&lt;li&gt;order matters, require sorting based on dependency&lt;/li&gt;
&lt;li&gt;circular dependency may not work&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;References&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://webpack.js.org&quot;&gt;Webpack&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://rollupjs.org/guide/en/&quot;&gt;Rollup&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Learn in Public]]></title><link>https://lihautan.com/learn-in-public/</link><guid isPermaLink="false">https://lihautan.com/learn-in-public/</guid><pubDate>Fri, 21 Jun 2019 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Yesterday, &lt;a href=&quot;https://twitter.com/swyx&quot;&gt;@swyx&lt;/a&gt; made a talk in React Knowledgeable about Learning in Public, (you can watch the talk &lt;a href=&quot;https://www.youtube.com/watch?v=-f-rZepNKW0&quot;&gt;here&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;One thing that amazed me was that &lt;a href=&quot;https://github.com/sw-yx/sw-yx.github.io/tree/20f471fbeca350fb5f397aafb71ada9075b9fac0/_posts&quot;&gt;he keeps a daily note&lt;/a&gt; of his learning everyday.&lt;/p&gt;
&lt;p&gt;It strucked me because, everyday I am kind of learning something new, but, after a while, I can’t remember what it is. Not sure is it because of age catching up, or just, there’s too many things happen going on in the Developer world and too little memory space left for it.&lt;/p&gt;
&lt;p&gt;Often times, when we are digging through some difficult concepts / code / etc, it took a days / weeks to sink in the concept we are looking at, and by the time we realised, tiny details that paved us to the conclustion we had were kind of forgotten. And sometimes in the future, when we encounter the same problem again, it all seems like a total stranger.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://twitter.com/swyx&quot;&gt;@swyx&lt;/a&gt; made a good point, he said, “Note things down for the future you”, and it makes a lot of sense! A lot of times when I felt dejavu when I am solving the same problem again and again, digging through the problem again, and it’s a time waster!&lt;/p&gt;
&lt;p&gt;So, I decided to start &lt;a href=&quot;https://github.com/tanhauhau/tanhauhau.github.io/commit/50c82259749f7608d1c81062eac1f357b9437485&quot;&gt;my notes&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It’s gonna be &lt;a href=&quot;/notes&quot;&gt;notes for the future me&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;To future me, you are going to appreciate what I am about to start here.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[How to get started in contributing to open source]]></title><link>https://lihautan.com/how-to-get-started-in-contributing-to-open-source/</link><guid isPermaLink="false">https://lihautan.com/how-to-get-started-in-contributing-to-open-source/</guid><pubDate>Wed, 05 Jun 2019 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Allow me to start this article with an anecdote, it was a few months ago, where &lt;a href=&quot;https://dev.wgao19.cc/2019-04-17__making-flow-happy-after-0.85/&quot;&gt;we were upgrading Flow version&lt;/a&gt; and &lt;a href=&quot;https://lihautan.com/parsing-error-flow-type-parameter-instantiation/&quot;&gt;it led me to a bug in babel&lt;/a&gt;. After some googling, I &lt;a href=&quot;https://github.com/babel/babel/issues/9240&quot;&gt;landed onto an issue reported to babel&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I think in most cases, when we ended up onto an open Github issue, there’s where all our leads ended. The only one obvious way solution is to wait, wait for the library maintainer to fix it.&lt;/p&gt;
&lt;p&gt;The next best alternative is to read through the issue threads, and find any patches or workarounds that can be applied in the mean time.&lt;/p&gt;
&lt;p&gt;We have been so used to making use of an open source libraries, tools or frameworks in our daily development, but it rarely occurred to us, that we should sometime, contribute back to the open source libraries, tools or frameworks we used.&lt;/p&gt;
&lt;p&gt;To be honest, I felt inadequate when I made my first merge request to &lt;a href=&quot;https://github.com/babel/babel&quot;&gt;babel&lt;/a&gt;. Who am I to make changes to the tool that was used by every JavaScript developer in the world?&lt;/p&gt;
&lt;p&gt;My answer to that is, &lt;a href=&quot;https://github.com/babel/babel/graphs/contributors&quot;&gt;everyone plays an important role&lt;/a&gt; in shaping how babel is today. Babel, or any other library would not be what it is today, without the constant contributions from the community.&lt;/p&gt;
&lt;p&gt;So, if you are interested in playing a part in the open source libraries, tools or frameworks you used, spare me a few more minutes to read my following two cents on how you could get started in contributing to open source libraries.&lt;/p&gt;
&lt;h2&gt;1. Read &lt;code class=&quot;language-text&quot;&gt;CONTRIBUTING.md&lt;/code&gt;&lt;/h2&gt;
&lt;p&gt;Most popular open source libraries have this file called &lt;code class=&quot;language-text&quot;&gt;CONTRIBUTING.md&lt;/code&gt;. &lt;code class=&quot;language-text&quot;&gt;CONTRIBUTING.md&lt;/code&gt; is where library maintainers document down what you should know before starting to contribute to the library.&lt;/p&gt;
&lt;p&gt;Examples:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/babel/babel/blob/master/CONTRIBUTING.md&quot;&gt;babel&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/facebook/react/blob/master/CONTRIBUTING.md&quot;&gt;React&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/microsoft/typescript/blob/master/CONTRIBUTING.md&quot;&gt;TypeScript&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/jquery/jquery/blob/master/CONTRIBUTING.md&quot;&gt;JQuery&lt;/a&gt;…&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So if you want to start contributing, start with reading &lt;code class=&quot;language-text&quot;&gt;CONTRIBUTING.md&lt;/code&gt;!&lt;/p&gt;
&lt;h2&gt;2. Good First Issue&lt;/h2&gt;
&lt;p&gt;Usually mentioned within &lt;code class=&quot;language-text&quot;&gt;CONTRIBUTING.md&lt;/code&gt;, most popular libraries do label their issues to categorize them. In our case, &lt;code class=&quot;language-text&quot;&gt;&amp;quot;Good First Issue&amp;quot;&lt;/code&gt; is what starters should look out for. When library maintainers labelled their issue as &lt;code class=&quot;language-text&quot;&gt;&amp;quot;Good First Issue&amp;quot;&lt;/code&gt;, they usually expect to guide and give advice to anyone who is willing to work on the issue. By working through the issue, contributors should gain some practical understanding on how things works, and be more confident in fixing the next bug.&lt;/p&gt;
&lt;p&gt;Examples of &lt;code class=&quot;language-text&quot;&gt;&amp;quot;Good First Issue&amp;quot;&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;github.com/microsoft/TypeScript/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22&quot;&gt;TypeScript&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/facebook/react/issues?q=is%3Aopen+is%3Aissue+label%3A%22good+first+issue%22&quot;&gt;React&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;3. It doesn’t have to be code&lt;/h2&gt;
&lt;p&gt;When we think about contributing to open source, we might just think of contributing in terms of code. Well, we don’t have to limit ourselves to just contributing code. There are a lot other ways to contribute:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Report an issue&lt;/strong&gt;. Discuss and make suggestions in the issue&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Improving the docs&lt;/strong&gt;. You may have spent a lot of time figuring out, maybe it will save the next person’s time by converting your experience into a better doc?&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tweet, blog or talk&lt;/strong&gt; about it. Good thing must share.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Closing Notes&lt;/h2&gt;
&lt;p&gt;If you are interested in contributing to open source, and have no idea how to get started, these are 3 tips I can give to you.&lt;/p&gt;
&lt;p&gt;Hope to see your contributions out there soon!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Debugging Web Workers]]></title><link>https://lihautan.com/Debugging web workers/</link><guid isPermaLink="false">https://lihautan.com/Debugging web workers/</guid><pubDate>Wed, 22 May 2019 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/Worker&quot;&gt;Web Workers API&lt;/a&gt; allows you to start a separate worker thread and receives and execute tasks off the main thread.&lt;/p&gt;
&lt;p&gt;Since worker runs in a separate worker thread, how would you debug, ie set breakpoint, console log, and inspect your worker script?&lt;/p&gt;
&lt;p&gt;Here’s how you would do it for various major browsers:&lt;/p&gt;
&lt;h2&gt;Chrome&lt;/h2&gt;
&lt;p&gt;If you are debugging service worker or worker, you can head down to the console. There’s a dropdown menu, if you haven’t noticed previously, that says “JavaScript context”.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f447664867ab3d7a0b0a7382035f127a/a8f3e/chrome-console.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 46.03321033210332%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAAAsSAAALEgHS3X78AAAA80lEQVQoz62PbWuDMBSF8/9/3GBQ1i/FomunaWoSo+ZFTc6uug1bytigFx7wXDnn5LIwBtjGo1U92m6E7Rz6foD38QfnJoQQMU0JKQGDc+j2e/DDAVI3tB8xDMMC03WD6kPhVFxxzhXKs4YoFaQwqLmB4Br8osC5hDEWpnVU2kFmGU55gVoqKnRU7BfYMcshdq9o3ojdC8R7Aa0UmQ0arZdvzitUVQlNWsp6/feFphfOuqMSIQSYpVTYHklckOorIkE3YDtpvvNOf7PVMUawEMK63BoemLbG34bNd9+3Ljza/YGbQGxZl/jv3AY+YZjz9qmBnxTzwO+RZ5BKAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;chrome console&quot;
        title=&quot;&quot;
        src=&quot;/static/f447664867ab3d7a0b0a7382035f127a/623ee/chrome-console.png&quot;
        srcset=&quot;/static/f447664867ab3d7a0b0a7382035f127a/816c5/chrome-console.png 148w,
/static/f447664867ab3d7a0b0a7382035f127a/c766b/chrome-console.png 295w,
/static/f447664867ab3d7a0b0a7382035f127a/623ee/chrome-console.png 590w,
/static/f447664867ab3d7a0b0a7382035f127a/e5345/chrome-console.png 885w,
/static/f447664867ab3d7a0b0a7382035f127a/a8f3e/chrome-console.png 1084w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/f204eeef9843eaee0792b0e2d6594d20/481f7/chrome-console-context.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 36.31336405529954%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAA6klEQVQoz5WR3UoDMRCF8/4voaAIWvEd/KPYgrfihYIXLk3ibppkM022SY7Z1l0o1lIPHOZiho85M+zt/QNSLNAqjpUWxRxppYCgoZcKdd2Ac46qqtA0DaSU0FrDGLNjay2EEGBEDncvLc7vJU5ua5w+WJxNCRdPBE0JvWLa1kE5571OZY6F4PH4ajGZfuHm2eNqTricOVzPHZZu/QPYBR0S894jBofkze9uThvYXxvt8wbYOkK1ECAfSrw+YsY6biMMmx2jEajLUT/L0Z1ziDGOzf8AhxnWkkEomynVf7RG13Uj7Fjg0O/rN5CsIAKqtwJFAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;chrome console context&quot;
        title=&quot;&quot;
        src=&quot;/static/f204eeef9843eaee0792b0e2d6594d20/623ee/chrome-console-context.png&quot;
        srcset=&quot;/static/f204eeef9843eaee0792b0e2d6594d20/816c5/chrome-console-context.png 148w,
/static/f204eeef9843eaee0792b0e2d6594d20/c766b/chrome-console-context.png 295w,
/static/f204eeef9843eaee0792b0e2d6594d20/623ee/chrome-console-context.png 590w,
/static/f204eeef9843eaee0792b0e2d6594d20/e5345/chrome-console-context.png 885w,
/static/f204eeef9843eaee0792b0e2d6594d20/481f7/chrome-console-context.png 1085w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;For worker context, you would see a cog logo beside the name.&lt;/p&gt;
&lt;p&gt;After you choose the worker context, you can type &lt;code class=&quot;language-text&quot;&gt;self&lt;/code&gt; into the console, and you should see &lt;code class=&quot;language-text&quot;&gt;self&lt;/code&gt; is an instance of &lt;code class=&quot;language-text&quot;&gt;DedicatedWorkerGlobalScope&lt;/code&gt; instead of &lt;code class=&quot;language-text&quot;&gt;window&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4319a503f1339435f69b5d931dad2ed0/00215/chrome-worker-context.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 33.98148148148149%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAHCAYAAAAIy204AAAACXBIWXMAAAsSAAALEgHS3X78AAAAcUlEQVQoz9WNSwrDMAxEdf/7FZOSI3jhRMaSP3hiLdxNSSDpqgMPRhIzom1dwO4Ffjvs3kM1o5aCMqi1IsaIEAJSSh9U9QvbMzNIcoaOoFhBayg2D6xQRNBsN7yF5pMrER6o934KXR3vMB/RNL/ovwoPM1Yp7/K+EeIAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;chrome worker context&quot;
        title=&quot;&quot;
        src=&quot;/static/4319a503f1339435f69b5d931dad2ed0/623ee/chrome-worker-context.png&quot;
        srcset=&quot;/static/4319a503f1339435f69b5d931dad2ed0/816c5/chrome-worker-context.png 148w,
/static/4319a503f1339435f69b5d931dad2ed0/c766b/chrome-worker-context.png 295w,
/static/4319a503f1339435f69b5d931dad2ed0/623ee/chrome-worker-context.png 590w,
/static/4319a503f1339435f69b5d931dad2ed0/e5345/chrome-worker-context.png 885w,
/static/4319a503f1339435f69b5d931dad2ed0/00215/chrome-worker-context.png 1080w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;For shared worker, you would need to go to &lt;a href=&quot;chrome://inspect/#workers&quot;&gt;chrome://inspect/#workers&lt;/a&gt;. Select “Shared workers” on the left panel.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4a1f187999558929e12c82767ac653d6/fa22a/chrome-shared-worker.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 79.92565055762083%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAAAsElEQVQ4y+2Qyw6CMBRE+9cGNfCPsFBk6StRhKJACpd2LEWJLCQoLJnkZJImncxcFm4tXDcL3PzGa6KdpVnj5Dk4uA6Onq3dxt51jIf+CnGwRBTU3oU9ciDVkALOl8KQFzBS+F2sEBkqEqgqQprlhrIUIP1GL5eSOihZfoUlyR1CCCjV10cNhsUxB+dcN6Hmqw4eA5NStu36Ww68YTtqolD2rvo5d3TgVHPnwDnwTz0BKYHpaEc9MJUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;chrome shared worker&quot;
        title=&quot;&quot;
        src=&quot;/static/4a1f187999558929e12c82767ac653d6/623ee/chrome-shared-worker.png&quot;
        srcset=&quot;/static/4a1f187999558929e12c82767ac653d6/816c5/chrome-shared-worker.png 148w,
/static/4a1f187999558929e12c82767ac653d6/c766b/chrome-shared-worker.png 295w,
/static/4a1f187999558929e12c82767ac653d6/623ee/chrome-shared-worker.png 590w,
/static/4a1f187999558929e12c82767ac653d6/e5345/chrome-shared-worker.png 885w,
/static/4a1f187999558929e12c82767ac653d6/fa22a/chrome-shared-worker.png 1076w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;You would be able to see a list of shared workers if you have any running.&lt;/p&gt;
&lt;p&gt;You can click “inspect”, which will open a new console for you to debug.&lt;/p&gt;
&lt;h2&gt;Firefox&lt;/h2&gt;
&lt;p&gt;For Firefox, you could go to &lt;a href=&quot;about:debugging#workers&quot;&gt;about:debugging#workers&lt;/a&gt;. You will be able to see a list of service workers, and shared workers registered to the browser.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/e293f9be86a51d004ee22836d76b1ca3/0e893/firefox-shared-worker.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 79.45075757575758%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAQCAYAAAAWGF8bAAAACXBIWXMAAAsSAAALEgHS3X78AAACLUlEQVQ4y31U2ZKbQAzk//8k2WRT5RzPqeQ5la2tOPYasLnBGIO5hwG7I43tDeVjH7o0h9RILQ3aMOzBkLJX6DqJvKggRI++PxDojtCfIO9ZuUcnB2hxvEEUrVGWFV0MRCTguybSJEBbZ6iKBE2Voi5TZRXG6ypT+67doe9KaJ7nwbFtdKKjrwxka/jzCaznBzjTRxhP72D/+QiX1ubTezr/oLBSeKC7R7VOra9A+RvathTwkhZlQyUSoewahIvPhAli8wsifQJv9okCvgG7nzhkPwjXdp9+xz7/BU10PRrBpUqlYdu2sJczGC/P0Al5GlJJCdoqQS+oLJHdhRQ5NCklZcZkZ0IBy/YQx1sURa1Ep56hHw4k+v4u+J6bo3Udd/bYXdawaRrM5y/QFwZMw0SeF6iqGnXdKB/ldwE+K4qjnzYel3OGtu3AcVyyLpIkxXabKmKeglfSUQxbnpQ0za4Jm6bFYqHDMJewiZT3nB1/nUeLfW4R8x373ST0PB/xOkbgh4r0nLHrethskteZHRPOZnPle5OQA6MwQhCECMm6rq/WQXA8S5Ltfy1PsTrp7fnBG4SkyZEkVPuAnH3KmM/XlD1rPY7VdYMqC97OkAkYnGGo9oEqWdCr6i+awrqzVLc1JIJxhkzEe7ZrevsViS/UU73M0L/fFC6Ls2IEJ0Imj+MEWba7IjSMpfrgTcLVylJlW5aj1jyPFtkNkUnq7vl3d47hVzad/qUX5uAfNsy/iXO+rAwAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;firefox shared worker&quot;
        title=&quot;&quot;
        src=&quot;/static/e293f9be86a51d004ee22836d76b1ca3/623ee/firefox-shared-worker.png&quot;
        srcset=&quot;/static/e293f9be86a51d004ee22836d76b1ca3/816c5/firefox-shared-worker.png 148w,
/static/e293f9be86a51d004ee22836d76b1ca3/c766b/firefox-shared-worker.png 295w,
/static/e293f9be86a51d004ee22836d76b1ca3/623ee/firefox-shared-worker.png 590w,
/static/e293f9be86a51d004ee22836d76b1ca3/e5345/firefox-shared-worker.png 885w,
/static/e293f9be86a51d004ee22836d76b1ca3/0e893/firefox-shared-worker.png 1056w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h2&gt;Safari&lt;/h2&gt;
&lt;p&gt;For Safari, you could find the JavaScript context dropdown at the bottom right corner of your console.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/63faa5ab6b7af39c403de23312711343/aa568/safari-console-context.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 83.3955223880597%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAARCAYAAADdRIy+AAAACXBIWXMAAAsSAAALEgHS3X78AAABXUlEQVQ4y+2Uy07DMBBF80cI6lfi2E7StM2jJU0qZVEkuuGDWCABX3sZO7QqIKEuuuzi6o7HnjOOlHH0vO8wjAOcc2jXLYZhipfLJbquw3a7Rd/36Mh3ux02mzXquoZJNdqmRlEUWK1WGMeRznaIjCVQ04JzjjzP0TQNGGPhYFVViOM4wP3ax836EYtyDq4yVG0fwBU18E3LskTEOQuwowQXwZVSEGKKvQspySmfFjBGQ5ga2vmbJsiyDFprUoLoR9FZfGrwO2az8AWcPQQxyvt1yFEcHUHX0g14A14beP7DX5K/6IbnY/kf6AQ8js0f8UlCCkglIeUk/j1qwWnuWZh9L9oTkl6bbA5LL44xBsbaybVBmnilcDZD7vIg62zYs9oiiRWMZDCKI1EzxPIeit8hsq6gIhvewCCC29SFogD2TnCvJElobeCoUZq1yJ8+sTp8oH15x+LwBrt/xRel8zehfF3FNgAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;safari console context&quot;
        title=&quot;&quot;
        src=&quot;/static/63faa5ab6b7af39c403de23312711343/623ee/safari-console-context.png&quot;
        srcset=&quot;/static/63faa5ab6b7af39c403de23312711343/816c5/safari-console-context.png 148w,
/static/63faa5ab6b7af39c403de23312711343/c766b/safari-console-context.png 295w,
/static/63faa5ab6b7af39c403de23312711343/623ee/safari-console-context.png 590w,
/static/63faa5ab6b7af39c403de23312711343/e5345/safari-console-context.png 885w,
/static/63faa5ab6b7af39c403de23312711343/aa568/safari-console-context.png 1072w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Parsing error when calling generic function with type arguments]]></title><link>https://lihautan.com/parsing-error-flow-type-parameter-instantiation/</link><guid isPermaLink="false">https://lihautan.com/parsing-error-flow-type-parameter-instantiation/</guid><pubDate>Tue, 23 Apr 2019 08:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Background&lt;/h2&gt;
&lt;p&gt;Mentioned in the &lt;a href=&quot;/errors-encountered-upgrading-flow-0.85/&quot;&gt;previous post&lt;/a&gt;, we have &lt;a href=&quot;https://babeljs.io/docs/en/v7-migration&quot;&gt;upgraded babel 7&lt;/a&gt; to support the new Flow syntax.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;foobar&amp;lt;Type&amp;gt;(x)&lt;/code&gt; is now &lt;em&gt;call foobar with x, and type parameter &lt;code class=&quot;language-text&quot;&gt;Type&lt;/code&gt;&lt;/em&gt; rather than &lt;code class=&quot;language-text&quot;&gt;(foobar &amp;lt; Type) &amp;gt; x)&lt;/code&gt; &lt;em&gt;is the result of foobar smaller than Type, greater than x?&lt;/em&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Everything is great, until a weird runtime error caught us off guard.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;ReferenceError: XType is not defined&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; foobar&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;XType&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;baz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
                       &lt;span class=&quot;token operator&quot;&gt;^&lt;/span&gt; ReferenceError&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; XType is not defined&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The first time I saw this error, my first impression was that I forgot to import &lt;code class=&quot;language-text&quot;&gt;XType&lt;/code&gt;, so I scrolled to the top of the document. But, alas, I &lt;strong&gt;did import&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;XType&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;So what is going on? &lt;span class=&quot;emoji&quot;&gt;🤷&lt;/span&gt;‍&lt;/p&gt;
&lt;p&gt;I clicked into the error,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; foobar &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; XType &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; baz&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;looked at me innocently. I knew something was wrong. &lt;code class=&quot;language-text&quot;&gt;XType&lt;/code&gt; wasn’t stripeed by babel!&lt;/p&gt;
&lt;p&gt;Shameless plug: If you read my &lt;a href=&quot;/eslint-for-flow-explicit-type-argument-syntax/&quot;&gt;eslint for flow syntax&lt;/a&gt;, you should be able to come to the same conclusion! &lt;span class=&quot;emoji&quot;&gt;😅&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So I checked the &lt;a href=&quot;https://babeljs.io/docs/en/babel-plugin-transform-flow-strip-types&quot;&gt;@babel/plugin strip-flow-types&lt;/a&gt;, I realise there’s a &lt;code class=&quot;language-text&quot;&gt;all&lt;/code&gt; option that I had missed out, basically it says,&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;only parse&lt;/strong&gt; Flow-specific features if a &lt;code class=&quot;language-text&quot;&gt;@flow&lt;/code&gt; pragma is &lt;strong&gt;present atop&lt;/strong&gt; the file&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;It seems that in my file,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/** @module foobar */&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// @flow&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// ...&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; foobar&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;XType&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;baz&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I had a innocent looking &lt;code class=&quot;language-text&quot;&gt;/** @module */&lt;/code&gt; comment above &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt; that breaks my babel plugin!&lt;/p&gt;
&lt;p&gt;So the quick fix is to either:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Move &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt; comment above &lt;code class=&quot;language-text&quot;&gt;/** @module foobar */&lt;/code&gt;, or&lt;/li&gt;
&lt;li&gt;Set &lt;code class=&quot;language-text&quot;&gt;all: true&lt;/code&gt; in &lt;code class=&quot;language-text&quot;&gt;@babel/plugin-transform-flow-strip-types&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Either way, it solves the issue.&lt;/p&gt;
&lt;p&gt;However, one thing bothers me:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;My Flow works perfectly fine with an extra comment on top &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt;, it still typechecks and provides auto-suggestions.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So, the logic for &lt;code class=&quot;language-text&quot;&gt;@babel/plugin-transform-flow-strip-types&lt;/code&gt; and Flow to determine whether a file is a Flow file or not &lt;strong&gt;is different&lt;/strong&gt;!&lt;/p&gt;
&lt;p&gt;And as a frequent user of Open Source libraries, this is something I think I &lt;del&gt;can&lt;/del&gt; should fix, for the betterment of the JavaScript Open Source world &lt;span class=&quot;emoji&quot;&gt;😅&lt;/span&gt;. I always imagine there’s another innocent front-end developer across the world like me stumbled upon a perplexing bug, if only me let the bug go with a workaround/patch.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There’s so much to achieve if we, not just consume the effort of others from the Open Source, but to also contribute into it.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Game Plan&lt;/h2&gt;
&lt;p&gt;So, to fix this bug, one simply has to:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Read Flow’s source code and understand the logic&lt;/li&gt;
&lt;li&gt;Read @babel/plugin-transform-strip-flow-type’s source code and understand the logic&lt;/li&gt;
&lt;li&gt;Make changes to babel code&lt;/li&gt;
&lt;li&gt;Send a MR and brag about it &lt;span class=&quot;emoji&quot;&gt;😎&lt;/span&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Whether this is achieveable at my current level, that’s a different story.
But &lt;strong&gt;one has nothing to lose to try and fail&lt;/strong&gt;.&lt;/p&gt;
&lt;h2&gt;Flow&lt;/h2&gt;
&lt;p&gt;I’ve read a bit of Flow source code previously, mainly to &lt;a href=&quot;https://github.com/facebook/flow/pull/7083&quot;&gt;fix a bad developer experience I had with flowconfig previously&lt;/a&gt;. I had to learn &lt;a href=&quot;https://ocaml.org/&quot;&gt;OCaml&lt;/a&gt;, which was a fad a while ago because of &lt;a href=&quot;https://reasonml.github.io/&quot;&gt;ReasonML&lt;/a&gt;, to understand Flow source code.&lt;/p&gt;
&lt;p&gt;So, this time around, I am much more comfortable to dig the code to find out the information I want.&lt;/p&gt;
&lt;p&gt;I searched for the term &lt;code class=&quot;language-text&quot;&gt;&amp;quot;@flow&amp;quot;&lt;/code&gt;, which ended me up with &lt;a href=&quot;https://github.com/facebook/flow/blob/master/src/parsing/parsing_service_js.ml#L143&quot;&gt;this function&lt;/a&gt;, &lt;code class=&quot;language-text&quot;&gt;extract_docblock&lt;/code&gt; which returns me the information of whether &lt;code class=&quot;language-text&quot;&gt;@flow&lt;/code&gt; is present in the file. And I dug further, I ended up with &lt;a href=&quot;https://github.com/facebook/flow/blob/master/src/parsing/parsing_service_js.ml#L275&quot;&gt;the annonymous function that &lt;code class=&quot;language-text&quot;&gt;extract_docblck&lt;/code&gt; returns&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Allow me to loosely translate the logic into some pseudo JavaScript:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;extract_docblock&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; maxTokens&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; filename&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; content &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; file &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;read&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filename&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; maxTokens&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; token &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; file&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;nextToken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;switch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;string&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;semicolon&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;continue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;comment&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;isFlowComment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;flowPragmaType&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;token&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;In human language:&lt;/p&gt;
&lt;p&gt;Flow will read &lt;code class=&quot;language-text&quot;&gt;maxTokens&lt;/code&gt; number of tokens, look for comments that matches &lt;code class=&quot;language-text&quot;&gt;@flow&lt;/code&gt;, if it encounters any order tokens, it will bail out early, with the exception of string and semicolon.&lt;/p&gt;
&lt;p&gt;So,&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&apos;use strict&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// @flow&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/** @module */&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// @flow&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;is considered as a valid Flow file.&lt;/p&gt;
&lt;p&gt;But&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// @flow&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;or&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;is not.&lt;/p&gt;
&lt;h2&gt;Babel&lt;/h2&gt;
&lt;p&gt;At first, I thought that the logic would be in &lt;code class=&quot;language-text&quot;&gt;@babel/transform-strip-flow-types&lt;/code&gt;, but apparently, its not.&lt;/p&gt;
&lt;p&gt;I discovered that by realising that the &lt;a href=&quot;https://github.com/babel/babel/blob/master/packages/babel-plugin-transform-flow-strip-types/src/index.js&quot;&gt;source code of @babel/transform-strip-flow-types&lt;/a&gt; did not include anything about the &lt;code class=&quot;language-text&quot;&gt;all&lt;/code&gt; options, and &lt;a href=&quot;https://github.com/babel/babel/blob/master/packages/babel-plugin-transform-flow-strip-types/src/index.js#L14&quot;&gt;this plugin extends the @babel/plugin-syntax-flow&lt;/a&gt;, which I knew fairly well that syntax plugins in babel does nothing but to enable syntax switch of the &lt;code class=&quot;language-text&quot;&gt;@babel/parser&lt;/code&gt;. The bulk of the logic lies within the &lt;a href=&quot;https://github.com/babel/babel/blob/master/packages/babel-parser/src/plugins/flow.js&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;@babel/parser&lt;/code&gt;’s flow plugin&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;That was all because &lt;a href=&quot;https://github.com/babel/babel/pulls?q=is%3Apr+is%3Aclosed+author%3Atanhauhau&quot;&gt;I contributed to &lt;code class=&quot;language-text&quot;&gt;@babel/parser&lt;/code&gt; before&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;And here we are in babel-parser, and the line that caught my attention is &lt;a href=&quot;https://github.com/babel/babel/blob/master/packages/babel-parser/src/plugins/flow.js#L98&quot;&gt;this&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;addComment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;comment&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;N&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Comment&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;void&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flowPragma &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; undefined&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Try to parse a flow pragma.&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; matches &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;FLOW_PRAGMA_REGEX&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;exec&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;comment&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;matches&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flowPragma &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;matches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;flow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flowPragma &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;flow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;matches&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;noflow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;flowPragma &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;noflow&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Unexpected flow pragma&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;addComment&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;comment&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So, the babel’s logic of getting a Flow pragma is that as soon as the first comment encountered, we parse the comment and we turn on the Flow syntax switch.&lt;/p&gt;
&lt;p&gt;This is the reason why if we have a comment before &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt;, we will not treat the file as a valid Flow file.&lt;/p&gt;
&lt;p&gt;Interesting enough, this means that if we write&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;foobar &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; XType &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// @flow&lt;/span&gt;
foobar&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;XType&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;the first half of the code before &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt; was parsed as a normal JS code, and the second half after &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt; was parsed as a Flow code.&lt;/p&gt;
&lt;p&gt;You can see this clearly with &lt;a href=&quot;https://lihautan.com/babel-ast-explorer/#?%7B%22babel%22%3A%7B%22jsx%22%3Afalse%2C%22flow%22%3Atrue%2C%22typescript%22%3Afalse%2C%22objectRestSpread%22%3Afalse%2C%22pipelineOperator%22%3Afalse%2C%22throwExpressions%22%3Afalse%2C%22optionalChaining%22%3Afalse%2C%22nullishCoalescingOperator%22%3Afalse%2C%22exportDefaultFrom%22%3Afalse%2C%22dynamicImport%22%3Afalse%7D%2C%22code%22%3A%22foobar%3CXType%3E(1)%3B%5Cn%2F%2F%20%40flow%5Cnfoobar%3CXType%3E(1)%3B%22%7D&quot;&gt;my recently build ASTExplorer clone for babel&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;(I built it with React + Hooks over a long weekend, which I will share about how did it in the future.)&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;You can see that the first expression is a &lt;code class=&quot;language-text&quot;&gt;BinaryExpression&lt;/code&gt; but the second expression is a &lt;code class=&quot;language-text&quot;&gt;CallExpression&lt;/code&gt;;&lt;/p&gt;
&lt;h2&gt;Make changes to the babel code&lt;/h2&gt;
&lt;p&gt;Now step 3, make changes to babel code. So I decided to open an issue and started fixing the code. Surprisingly, someone else &lt;a href=&quot;https://github.com/babel/babel/issues/9240&quot;&gt;had reported the issue a few months ago&lt;/a&gt;, and the issue was still opened.&lt;/p&gt;
&lt;p&gt;So &lt;a href=&quot;https://github.com/babel/babel/issues/9240#issuecomment-485370957&quot;&gt;I explained what I had discovered&lt;/a&gt;, and tried to &lt;a href=&quot;https://github.com/babel/babel/pull/9885&quot;&gt;propose a solution&lt;/a&gt;. Well, after some struggle, I realised I am still a bit behind from being able to fix this code.&lt;/p&gt;
&lt;p&gt;So how?&lt;/p&gt;
&lt;p&gt;I submitted a &lt;a href=&quot;https://github.com/babel/babel/pull/9885&quot;&gt;PR&lt;/a&gt; with a big &lt;strong&gt;WIP&lt;/strong&gt;, because I didn’t know how to look ahead &lt;code class=&quot;language-text&quot;&gt;n&lt;/code&gt; tokens and determine the &lt;code class=&quot;language-text&quot;&gt;flowPragma&lt;/code&gt; flag before &lt;code class=&quot;language-text&quot;&gt;babel&lt;/code&gt; starts parsing the code. I explored around the &lt;code class=&quot;language-text&quot;&gt;babel-parser&lt;/code&gt; source code, uncover new concepts that I never knew before. It took me a day to contemplate and fiddle around, until something sparked me.&lt;/p&gt;
&lt;p&gt;I realised I do not have to follow exactly Flow’s logic in order to achieve similar behaviour. That’s when I submitted another &lt;a href=&quot;https://github.com/babel/babel/pull/9891&quot;&gt;PR&lt;/a&gt; and closed the previous one. &lt;em&gt;(You can check it out if you are curious about it)&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;And finally, the fix has merged into &lt;a href=&quot;https://github.com/babel/babel/releases/tag/v7.4.4&quot;&gt;babel v7.4.4&lt;/a&gt;! &lt;span class=&quot;emoji&quot;&gt;🎉&lt;/span&gt;&lt;span class=&quot;emoji&quot;&gt;🎉&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;And I can’t wait to try all the edge cases that I have fixed in babel repl:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/repl#?babili=false&amp;#x26;browsers=&amp;#x26;build=&amp;#x26;builtIns=false&amp;#x26;spec=false&amp;#x26;loose=false&amp;#x26;code_lz=OQVwzgpgBGAuBOBLAxrYBuAUAem1AAgGYA2A9gO6aGmkA8AggHwAUARgJRbV1NudA&amp;#x26;debug=false&amp;#x26;forceAllTransforms=false&amp;#x26;shippedProposals=false&amp;#x26;circleciRepo=&amp;#x26;evaluate=false&amp;#x26;fileSize=false&amp;#x26;timeTravel=false&amp;#x26;sourceType=module&amp;#x26;lineWrap=false&amp;#x26;presets=&amp;#x26;prettier=false&amp;#x26;targets=&amp;#x26;version=7.4.4&amp;#x26;externalPlugins=%40babel%2Fplugin-transform-flow-strip-types%407.4.4&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;&amp;#39;use strict&amp;#39;&lt;/code&gt;; before &lt;code class=&quot;language-text&quot;&gt;// @flow&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/repl#?babili=false&amp;#x26;browsers=&amp;#x26;build=&amp;#x26;builtIns=false&amp;#x26;spec=false&amp;#x26;loose=false&amp;#x26;code_lz=PQKhAIAEFsHsBMCuAbApgZ3AM1rcJgAoYYKLZWAd0J1gB4BBAPgAoAjASgG4bdHXOXIA&amp;#x26;debug=false&amp;#x26;forceAllTransforms=false&amp;#x26;shippedProposals=false&amp;#x26;circleciRepo=&amp;#x26;evaluate=false&amp;#x26;fileSize=false&amp;#x26;timeTravel=false&amp;#x26;sourceType=module&amp;#x26;lineWrap=false&amp;#x26;presets=&amp;#x26;prettier=false&amp;#x26;targets=&amp;#x26;version=7.4.4&amp;#x26;externalPlugins=%40babel%2Fplugin-transform-flow-strip-types%407.4.4&quot;&gt;comments before &lt;code class=&quot;language-text&quot;&gt;//@flow&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/repl#?babili=false&amp;#x26;browsers=&amp;#x26;build=&amp;#x26;builtIns=false&amp;#x26;spec=false&amp;#x26;loose=false&amp;#x26;code_lz=GYexB4EED4AoCMCUBuAUAenQAgALADYgDuqoEMCKQA&amp;#x26;debug=false&amp;#x26;forceAllTransforms=false&amp;#x26;shippedProposals=false&amp;#x26;circleciRepo=&amp;#x26;evaluate=false&amp;#x26;fileSize=false&amp;#x26;timeTravel=false&amp;#x26;sourceType=module&amp;#x26;lineWrap=false&amp;#x26;presets=&amp;#x26;prettier=false&amp;#x26;targets=&amp;#x26;version=7.4.4&amp;#x26;externalPlugins=%40babel%2Fplugin-transform-flow-strip-types%407.4.4&quot;&gt;first comment is &lt;code class=&quot;language-text&quot;&gt;//@flow&lt;/code&gt;, but in the middle of the file&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Closing Remark&lt;/h2&gt;
&lt;p&gt;&lt;del&gt;Well, I am sorry that I am going to stop here, because the issue is still opened, but I hoped you enjoy the detective journey along the way of hunting this bug.&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;If you encountered similar issues, you can patch it first with the solution I mentioned earlier. And do follow the Github issue, I will do my best to fix this.&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;If you encountered similar issues, please &lt;a href=&quot;https://github.com/babel/babel/releases/tag/v7.4.4&quot;&gt;upgrade babel to v7.4.4&lt;/a&gt;.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The best thing about open source is that the source code is open. As part of the JS community, we should not just reap the efforts of the community when we are building our next billion dollar idea, we should also contribute back so that the community as a whole can grow and improve together.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;As usual, here are the list of references for this article:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;/errors-encountered-upgrading-flow-0.85&quot;&gt;Blog: Errors encountered upgrading Flow v0.85&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;/eslint-for-flow-explicit-type-argument-syntax/&quot;&gt;My eslint doesn’t work with for flow 0.85’s explicit type argument syntax&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/docs/en/v7-migration&quot;&gt;Docs: Upgrading Babel v7&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/docs/en/babel-plugin-transform-flow-strip-types&quot;&gt;Docs: @babel/transform-plugin-flow-strip-types&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://reasonml.github.io/&quot;&gt;Docs: ReasonML&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/facebook/flow/blob/master/src/parsing/parsing_service_js.ml&quot;&gt;Code: Flow Parsing Service&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/babel/babel/issues/9240&quot;&gt;Issue: Parsing error when calling generic functions with type arguments when flow pragma is not first comment&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Errors encountered upgrading Flow v0.85]]></title><link>https://lihautan.com/errors-encountered-upgrading-flow-0.85/</link><guid isPermaLink="false">https://lihautan.com/errors-encountered-upgrading-flow-0.85/</guid><pubDate>Mon, 22 Apr 2019 08:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;Background&lt;/h2&gt;
&lt;p&gt;Despite seeing the JS community &lt;a href=&quot;https://medium.com/entria/incremental-migration-to-typescript-on-a-flowtype-codebase-515f6490d92d&quot;&gt;slowly&lt;/a&gt; &lt;a href=&quot;https://davidgomes.com/porting-30k-lines-of-code-from-flow-to-typescript/&quot;&gt;moving away&lt;/a&gt; from Flow to TypeScript, &lt;a href=&quot;https://careers.shopee.sg/jobs/?region_id=1&amp;#x26;dept_id=109&amp;#x26;name=web%20frontend&amp;#x26;limit=20&amp;#x26;offset=0&quot;&gt;Shopee Web Frontend&lt;/a&gt; codebase is still very much stuck with &lt;a href=&quot;https://flow.org/&quot;&gt;Flow&lt;/a&gt;. &lt;span class=&quot;emoji&quot;&gt;😨&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;After some silence, Flow &lt;a href=&quot;https://medium.com/flow-type/what-the-flow-team-has-been-up-to-54239c62004f&quot;&gt;has come back and committed to be a more efficient, reliable and friendly tool.&lt;/a&gt; Thus, we decided to give Flow a final chance. However, in order to enjoy the improvements that Flow has made in recent days, we have to upgrade Flow from 0.83 (since our last update) to v0.97 (latest to date), which meant that we need to upgrade past v0.85, &lt;a href=&quot;https://github.com/facebook/flow/issues/7493&quot;&gt;which meant hell&lt;/a&gt; to &lt;a href=&quot;https://github.com/flow-typed/flow-typed/issues/2946&quot;&gt;codebase that uses react-redux extensively&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;One of our &lt;a href=&quot;https://wgao19.cc/&quot;&gt;brave developer, Gao Wei&lt;/a&gt; took up the challenge and decided to bring us to the bright side of Flow. &lt;span class=&quot;emoji&quot;&gt;😅&lt;/span&gt;. She &lt;a href=&quot;https://twitter.com/wgao19/status/1115969686758248448&quot;&gt;twitted&lt;/a&gt; and wrote &lt;a href=&quot;https://dev.wgao19.cc/2019-04-17__making-flow-happy-after-0.85/&quot;&gt;an article&lt;/a&gt; on how she fixed the errors arose in the process.&lt;/p&gt;
&lt;p&gt;To put the problem in perspective, from Flow 0.85 onwards, Flow is asking for &lt;a href=&quot;https://medium.com/flow-type/asking-for-required-annotations-64d4f9c1edf8&quot;&gt;required annotations for implicit annotations&lt;/a&gt;. Or less technical, if you are trying to &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt; something that was created from a generic class (eg: &lt;code class=&quot;language-text&quot;&gt;class Foo&amp;lt;T&amp;gt;&lt;/code&gt;) or functions (eg: &lt;code class=&quot;language-text&quot;&gt;function foo&amp;lt;T&amp;gt;(){}&lt;/code&gt;), without explicit type arguments (eg: &lt;code class=&quot;language-text&quot;&gt;new Foo&amp;lt;Type&amp;gt;()&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;foo&amp;lt;Type&amp;gt;()&lt;/code&gt;), Flow is going to give you an error.&lt;/p&gt;
&lt;p&gt;Or in layman terms, if your repo is full of HOCs or &lt;code class=&quot;language-text&quot;&gt;connect()&lt;/code&gt;, you are f**ked. So, be sure the check &lt;a href=&quot;https://dev.wgao19.cc/2019-04-17__making-flow-happy-after-0.85/&quot;&gt;Gao Wei’s blog&lt;/a&gt; if you are one of the brave souls upgrading a Flow project.&lt;/p&gt;
&lt;!-- TODO: count how many lines of code with flow annotation --&gt;
&lt;h2&gt;The Tooling&lt;/h2&gt;
&lt;p&gt;In this article, I would like to list out some of the  roadblocks we encountered that was less well discussed, the tooling for the latest Flow syntax, which is the &lt;code class=&quot;language-text&quot;&gt;TypeParameterInstantiation&lt;/code&gt;, eg: calling a function or instantiation a class with a type parameter, &lt;code class=&quot;language-text&quot;&gt;new Foo&amp;lt;Type&amp;gt;()&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;foo&amp;lt;Type&amp;gt;()&lt;/code&gt;.&lt;/p&gt;
&lt;h2&gt;Babel &amp; Eslint&lt;/h2&gt;
&lt;p&gt;We had to upgrade our babel to &lt;a href=&quot;https://babeljs.io/docs/en/v7-migration&quot;&gt;babel v7&lt;/a&gt; and babel-eslint (a babel wrapper for eslint) to &lt;a href=&quot;https://github.com/babel/babel-eslint/releases/tag/v9.0.0&quot;&gt;babel-eslint v9&lt;/a&gt; to support this new syntax.&lt;/p&gt;
&lt;p&gt;You can read about on how we came to realise the need of this upgrade &lt;a href=&quot;https://lihautan.com/eslint-for-flow-explicit-type-argument-syntax/&quot;&gt;in my previous post&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There was another interesting bug that we ran into regarding &lt;a href=&quot;https://babeljs.io/docs/en/babel-plugin-transform-flow-strip-types&quot;&gt;@babel/plugin-transform-flow-strip-types&lt;/a&gt;, you can read more on how we uncover it in &lt;a href=&quot;/parsing-error-flow-type-parameter-instantiation/&quot;&gt;my other blog post&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;Prettier&lt;/h2&gt;
&lt;p&gt;We had to upgrade prettier to &lt;a href=&quot;https://prettier.io/blog/2019/01/20/1.16.0.html&quot;&gt;v1.16.0&lt;/a&gt; and use &lt;code class=&quot;language-text&quot;&gt;babel-flow&lt;/code&gt; parser for &lt;code class=&quot;language-text&quot;&gt;prettier&lt;/code&gt; to resolve the ambiguity in syntax arise in parsing the newer Flow syntax. In simpler terms, to tell Prettier that&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;foobar&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Type&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;is &lt;em&gt;calling foobar with argument, 1 and type, “Type”&lt;/em&gt;, instead of:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;foobar &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; Type &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;em&gt;is the result of foobar &lt; Type, greater than 1?&lt;/em&gt; &lt;span class=&quot;emoji&quot;&gt;😂&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;You can read more about it in &lt;a href=&quot;https://prettier.io/blog/2019/01/20/1.16.0.html#add-babel-flow-parser-5685-by-ikatyang&quot;&gt;Prettier’s blog post&lt;/a&gt;.&lt;/p&gt;
&lt;h2&gt;VSCode&lt;/h2&gt;
&lt;p&gt;Flow &lt;a href=&quot;https://github.com/facebook/flow/commit/3c0a2bbd118206a0a73a1a4d18375122c4ae1955&quot;&gt;Lazy Mode&lt;/a&gt; has been around since v0.68, but we hadn’t enjoy the benefit of lazy mode through VSCode &lt;a href=&quot;https://github.com/flowtype/flow-for-vscode/commit/9c1440068f8faee95e487fc9f69b5f5ffed64bf1&quot;&gt;until recently&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Now we can specify &lt;code class=&quot;language-text&quot;&gt;lazyMode&lt;/code&gt; in our &lt;code class=&quot;language-text&quot;&gt;.vscode/settings.json&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;&lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;flow.useLSP&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;flow.lazyMode&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;ide&quot;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Although &lt;a href=&quot;https://flow.org/en/docs/lang/lazy-modes/&quot;&gt;lazy mode&lt;/a&gt; reduces the scope where Flow does type checking, one of the pain point we had with Flow was to wait for Flow to do recheck, before returning a meaningful Flow status again. Flow team did some optimisation in &lt;a href=&quot;https://github.com/facebook/flow/releases/tag/v0.92.0&quot;&gt;v92.0&lt;/a&gt;, where it says:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;This release culminates months of hard work on quality of life improvements for IDE support.
Expect your requests to be faster, and your requests to take a bit less time.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;According to the release note, Flow is now able to &lt;strong&gt;provide type definitions while rechecking&lt;/strong&gt;, for further details on how they achieve this, you can read the &lt;a href=&quot;https://medium.com/flow-type/a-more-responsive-flow-1a8cb01aec11&quot;&gt;Flow blog&lt;/a&gt;&lt;/p&gt;
&lt;h2&gt;Closing remarks&lt;/h2&gt;
&lt;p&gt;Finally we managed to get Flow running in v0.97 &lt;span class=&quot;emoji&quot;&gt;🎉&lt;/span&gt;. We’ve been struggling with bad developer experience with v0.83 for the longest time, hopefully v0.97 do not let us down.&lt;/p&gt;
&lt;p&gt;Lastly, be sure to check out all the links sprinkled throughout this blog, they link to Github issues, commits, release notes, and who knows it might lead you to some unexpected adventures? &lt;span class=&quot;emoji&quot;&gt;🤷&lt;/span&gt;‍&lt;/p&gt;
&lt;p&gt;But if you are lazy like me, here are the links, they served as my references when writing this blog post:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/entria/incremental-migration-to-typescript-on-a-flowtype-codebase-515f6490d92d&quot;&gt;Blog: Incremental Migration to TypeScript on a Flowtype codebase&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://davidgomes.com/porting-30k-lines-of-code-from-flow-to-typescript&quot;&gt;Blog: Porting 30k lines of code from Flow to TypeScript&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/facebook/flow/issues/7493&quot;&gt;Issue: What is the official way to type connect ( from flow-typed/react-redux) after 0.85?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/flow-typed/flow-typed/issues/2946&quot;&gt;Issue: [react-redux] libdef incompatible with flow v0.85 #2946&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://twitter.com/wgao19/status/1115969686758248448&quot;&gt;Tweet: It’s so hard to make flow happily get past 0.85 with our codebase…&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://dev.wgao19.cc/2019-04-17__making-flow-happy-after-0.85/&quot;&gt;Blog: Making Flow Happy after 0.85&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/flow-type/asking-for-required-annotations-64d4f9c1edf8&quot;&gt;Blog: Asking for Required Annotations&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/docs/en/v7-migration&quot;&gt;Docs: Babel 7 Migration&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/babel/babel-eslint/releases/tag/v9.0.0&quot;&gt;Release Note: babel-eslint v9.0.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://babeljs.io/docs/en/babel-plugin-transform-flow-strip-types&quot;&gt;Docs: @babel/plugin-transform-flow-strip-types&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://prettier.io/blog/2019/01/20/1.16.0.html&quot;&gt;Release Note: Prettier v1.16.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/facebook/flow/commit/3c0a2bbd118206a0a73a1a4d18375122c4ae1955&quot;&gt;Commit: Lazy mode message for flow status&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/flowtype/flow-for-vscode/commit/9c1440068f8faee95e487fc9f69b5f5ffed64bf1&quot;&gt;Commit: feat(lsp): add setting to support flow lazyMode.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://flow.org/en/docs/lang/lazy-modes/&quot;&gt;Docs: Flow Lazy Mode&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/facebook/flow/releases/tag/v0.92.0&quot;&gt;Release Note: Flow v0.92.0&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/flow-type/a-more-responsive-flow-1a8cb01aec11&quot;&gt;Blog: A more responsive Flow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[History of Web Development: JavaScript Modules]]></title><link>https://lihautan.com/javascript-modules/</link><guid isPermaLink="false">https://lihautan.com/javascript-modules/</guid><pubDate>Fri, 12 Apr 2019 00:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;Motivation&lt;/h1&gt;
&lt;p&gt;A while ago, I posted an article about &lt;a href=&quot;https://lihautan.com/understand-the-frontend-tools/&quot;&gt;understanding frontend tools&lt;/a&gt;. I mentioned that the way I make sense of all the tools and frameworks out there in the JavaScript world, is to try writing a web application with plain JavaScript, and start asking questions.&lt;/p&gt;
&lt;p&gt;One of the question is:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;How do we make our JavaScript code modular&lt;/strong&gt;, having each piece of code &lt;strong&gt;independent&lt;/strong&gt; of each other, without having to worry other parts of code affecting it, yet able to &lt;strong&gt;share functionality&lt;/strong&gt; among different modules.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So I will attempt to answer the question by first exploring how things are done in a “Vanilla” way, and my two cents about the inherent problem with it and how each tooling come about solving those problems.&lt;/p&gt;
&lt;h1&gt;The Vanilla way&lt;/h1&gt;
&lt;p&gt;Imagine the following scenario:&lt;/p&gt;
&lt;p&gt;You are writing a web application. You created a script, &lt;code class=&quot;language-text&quot;&gt;app.js&lt;/code&gt;, and you added a &lt;code class=&quot;language-text&quot;&gt;&amp;lt;script&amp;gt;&lt;/code&gt; tag into your &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt;.&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;index.html&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/app.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Then you decided to add jQuery, because you heard that jQuery is amazing.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;So how would you add jQuery into your application?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;There’s a few ways to go about, but the easiest would be:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;heading to &lt;a href=&quot;https://jquery.com/&quot;&gt;jQuery’s website&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;click download&lt;/li&gt;
&lt;li&gt;dragged the downloaded file to your project folder&lt;/li&gt;
&lt;li&gt;and add another script tag before your &lt;code class=&quot;language-text&quot;&gt;app.js&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;
  &lt;a class=&quot;gatsby-resp-image-link&quot; href=&quot;/static/c4929b81633a5a8b085650e8cf509a93/15912/jquery.png&quot; style=&quot;display: block&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;
  
  &lt;figure class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;&gt;
    &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom: 25.160771704180064%; position: relative; bottom: 0; left: 0; background-image: url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAABYlAAAWJQFJUiTwAAABY0lEQVQY0yXMy04TYRiH8YkxlZ0I0TsAeppvZjrfnJhxrK0UmPRMW5qWUjwsCAlRChsS4xJq0taCoAmJF+XCxLjwVh4munjy5pd/8iqLg2ueHnxlaW/GctyTwfyfl/eveDa84nF/zqPdGYn2hAfNMQu7Ux62p//dGKPULlDql3FjEp0JStp+gbA8qu0encFrnLBIUpOUKk2OPpzh5TdYEZL1whbN3pBVY51mlGd2XOb6fJ/bT++4+fiGb+d9ypshimqYqOkUZ6cjPo8vCQOfVHKNXrfL6egEx5KxV+m0dhi9Pyaj6py0XH5+qfPre58/P97y+27I37suhzUXJaNLTMsmv12hWK7hBCG6bvByM6IQVTFtByEEfr5IWIrQc5LAs+lUN2hEBUqhTdGXvAoklqmjZI34YS6H43rYjotl2xiGget5+MFzpGWhaVq8u3i+jyklqtBQNSO+OpmsIJ1V40RswT3bo7ngbq71cQAAAABJRU5ErkJggg==&amp;#x27;); background-size: cover; display: block;&quot;&gt;
      &lt;img class=&quot;gatsby-resp-image-image&quot; style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot; alt=&quot;jquery page&quot; title=&quot;Downloading jQuery from jQuery.com&quot; src=&quot;/static/c4929b81633a5a8b085650e8cf509a93/623ee/jquery.png&quot; srcset=&quot;/static/c4929b81633a5a8b085650e8cf509a93/816c5/jquery.png 148w, /static/c4929b81633a5a8b085650e8cf509a93/c766b/jquery.png 295w, /static/c4929b81633a5a8b085650e8cf509a93/623ee/jquery.png 590w, /static/c4929b81633a5a8b085650e8cf509a93/e5345/jquery.png 885w, /static/c4929b81633a5a8b085650e8cf509a93/7a439/jquery.png 1180w, /static/c4929b81633a5a8b085650e8cf509a93/84fe0/jquery.png 1770w, /static/c4929b81633a5a8b085650e8cf509a93/15912/jquery.png 2488w&quot; sizes=&quot;(max-width: 590px) 100vw, 590px&quot;&gt;
    &lt;/span&gt;
  &lt;figcaption&gt;Downloading jQuery from jQuery.com&lt;/figcaption&gt;&lt;/figure&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;index.html&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/jquery.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/app.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;Adding &lt;code class=&quot;language-text&quot;&gt;jquery&lt;/code&gt; into html&lt;/div&gt;
&lt;p&gt;Although jQuery is awesome, but adding it takes &lt;strong&gt;a lot of steps and effort&lt;/strong&gt;. And to upgrade jQuery, you would have to redo all the step.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Installing a library&lt;/strong&gt; is a hassle back then.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let’s say we add another file, &lt;code class=&quot;language-text&quot;&gt;utils.js&lt;/code&gt; for all our utility functions.&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;index.html&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/jquery.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/utils.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/app.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p class=&quot;filename&quot;&gt;utils.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; pi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.142&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; pi &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Although you meant to just share the function &lt;code class=&quot;language-text&quot;&gt;area&lt;/code&gt; from &lt;code class=&quot;language-text&quot;&gt;utils.js&lt;/code&gt;, in &lt;code class=&quot;language-text&quot;&gt;app.js&lt;/code&gt;, you would notice that both &lt;code class=&quot;language-text&quot;&gt;pi&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;area&lt;/code&gt; are available.&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;app.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 78.55&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// pi is available too!&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pi&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 3.142&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That is because when you declare a variable or a function within a script, it will be available to the &lt;strong&gt;global scope&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;The only way to hide it, is to use Immediately Invoked Function Expression (IIFE).&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;utils.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; utils &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// you hide `pi` within the function scope&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; pi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.142&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;radius&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; pi &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; radius&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; area &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p class=&quot;filename&quot;&gt;app.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;utils&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;area&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 78.55&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pi&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// Reference error, `pi` is not defined&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;!-- TODO: module pattern --&gt;
&lt;p&gt;This is called the &lt;strong&gt;module pattern&lt;/strong&gt;. The only way to control what to exposed to the global scope.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Scoping the variables&lt;/strong&gt; within the module is hard, and you can only do it via the &lt;strong&gt;module pattern&lt;/strong&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;If you have noticed, we access &lt;code class=&quot;language-text&quot;&gt;utils&lt;/code&gt; freely, because it is defined in the global scope. If you have another module / library that named &lt;code class=&quot;language-text&quot;&gt;utils&lt;/code&gt;, they would have conflicted against each other.&lt;/p&gt;
&lt;p&gt;We want to &lt;em&gt;“import”&lt;/em&gt; the modules freely, and renamed it anyway we want, without worrying naming conflicts amongst modules / libraries.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Importing&lt;/strong&gt; without naming conflicts is what we want.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;So I hereby summarize, the “module” problem in JavaScript,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Installability&lt;/strong&gt; - the ability to install easily&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Scopability&lt;/strong&gt; - the ability of having clearly defined scoped within modules&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Importability&lt;/strong&gt; - the ability to import modules freely without worry&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Well, I am not sure some of these word existed, I think I might have made up some of them to make it rhyme.&lt;/p&gt;
&lt;p&gt;The problems above are no longer a concern any more in the 2019 world, yet it is still interesting to see what the JavaScript community has created to solve these problems.&lt;/p&gt;
&lt;h1&gt;Installability&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The “how easy is it to install” problem.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;As mentioned in the earlier example, to “install” jQuery into your web app is to download jQuery from their main website. To “install” a different version would mean to visit their “Past Releases” Page to download the specific version you want.&lt;/p&gt;
&lt;p&gt;
  &lt;a class=&quot;gatsby-resp-image-link&quot; href=&quot;/static/ae1cba58504fe03b9378bb6889ea1f96/c2b2c/jquery-version.png&quot; style=&quot;display: block&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;
  
  &lt;figure class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;&gt;
    &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom: 56.360078277886494%; position: relative; bottom: 0; left: 0; background-image: url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAABYlAAAWJQFJUiTwAAABvUlEQVQoz5WRO2/UQBSF3UAdiJBANPwtCiCAFPFrQGQR0AMFRXqeQQgpNDQoQAHZ7Pi1sZ1d2+N5+DH2Hu7MakEgAuFKx3dm5Pv5nLG3dvUuLt26j3M37uHC5kNc3HyA9esjrF3bwvrGCGc3bN/C+Zsjtz91+Q5OH6MzV27D2373EU9e7OLRs108fv4eT3c+4PWejzefQ1KEHepWb7+E7uzlXoBXv+tT4M7tnNdpgdifII0DROyAeohOS5hGA5oDrQQasTyrFfrmp0wtqWtYBkwLW14/DGjaFkIqDAtiNK2ToY1WGuV8Bl6WaE2Ptuvo3ZXaX9ZtZ2BZnqXmeQ7m+1BVhanPME8TNEoiz1Kw8T5CNoEsCww08LdaLBZLoJISlRBQ8wwl+woe+6iSGKU/hkwiVDFDERygJ4erwT/JRbaPWmtwcqeLOcpgjOowgpylSzCtOd1vNQ0wGPMDeFwtHSpFDqUDFv4+DYeQRwl4OCFg6MBW/UmBmhzayHWZg0cMIp26+BYsskOKHzn9p0MBnc9QsG/gFE9kCcqVQ/qIVW+6kwGbpiaoRl1x9zPs/SmKb93JWQZB8a2G/t8OvwO6ciSaaf1oZwAAAABJRU5ErkJggg==&amp;#x27;); background-size: cover; display: block;&quot;&gt;
      &lt;img class=&quot;gatsby-resp-image-image&quot; style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot; alt=&quot;jQuery past releases page&quot; title=&quot;Visit &quot; past=&quot;&quot; releases&amp;#x22;=&quot;&quot; to=&quot;&quot; download an=&quot;&quot; older=&quot;&quot; version=&quot;&quot; of=&quot;&quot; jquery&amp;#x22;=&quot;&quot; src=&quot;/static/ae1cba58504fe03b9378bb6889ea1f96/623ee/jquery-version.png&quot; srcset=&quot;/static/ae1cba58504fe03b9378bb6889ea1f96/816c5/jquery-version.png 148w, /static/ae1cba58504fe03b9378bb6889ea1f96/c766b/jquery-version.png 295w, /static/ae1cba58504fe03b9378bb6889ea1f96/623ee/jquery-version.png 590w, /static/ae1cba58504fe03b9378bb6889ea1f96/e5345/jquery-version.png 885w, /static/ae1cba58504fe03b9378bb6889ea1f96/c2b2c/jquery-version.png 1022w&quot; sizes=&quot;(max-width: 590px) 100vw, 590px&quot;&gt;
    &lt;/span&gt;
  &lt;figcaption&gt;Visit &quot;Past Releases&quot; to download an older version of jQuery&lt;/figcaption&gt;&lt;/figure&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;A “faster” alternative to this, is to get jQuery served from a CDN provider. &lt;a href=&quot;https://cdnjs.com/&quot;&gt;cdnjs.com&lt;/a&gt; is a site that catalogues the CDN url for different libraries. The CDN will serve the script faster to the user, because of their delivery network, as well as if multiple sites are using the same CDN url, the file will be cached by browser. And it is faster to “install”, as &lt;a href=&quot;https://cdnjs.com/&quot;&gt;cdnjs.com&lt;/a&gt; provides a one-click to “Copy as script tag”, all you only need to do is to paste it in to your &lt;code class=&quot;language-text&quot;&gt;html&lt;/code&gt; file.&lt;/p&gt;
&lt;p&gt;
  &lt;a class=&quot;gatsby-resp-image-link&quot; href=&quot;/static/6f0e571a8df2f80dc6329502937f11cf/dcef4/cdnjs.png&quot; style=&quot;display: block&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;
  
  &lt;figure class=&quot;gatsby-resp-image-wrapper&quot; style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;&gt;
    &lt;span class=&quot;gatsby-resp-image-background-image&quot; style=&quot;padding-bottom: 39.1869918699187%; position: relative; bottom: 0; left: 0; background-image: url(&amp;#x27;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABV0lEQVQoz31Ry07DMBDM//8DR46cQAIkJLghIS5cWrVNm6bpI2keTmwnaWLHg9e0hfbAyqNZWdmZWcerdhGklKAyxmAwwNBI6CqHrjm0rBwGXsA0An2RQh9aoOP2MBxYho6lMFo7DS8Ml9hEKxzaFv+VObJkHF9PbxgvBJI0xWa3g2zacyBPZAnC6RiT8Qi+P8NyGWA+97EMAgSLBWbTCWI7dBY2CvHnA5JRcmlofiy9ZL/HKlojiiKEYYgkiSE4R1PXqC3oOVqbfhgGaLuWtmyOmenOQalfwbJkbvja6W+RYGrXy7LMQUoOISSkEJBk3GsoKwq3sr1kjKEsS4dTT0xC9GHXdRfo+x49sdLux7CPF6hjDq8oCsRxfMZ2u7VrJ66nNDTsVr0CGWmbiATr90eozRxq7cPj9r3yPAcJE5MI9SecUrpUV1B6QFsWEK934M+3qO5v8A3x0GYDMtuMpAAAAABJRU5ErkJggg==&amp;#x27;); background-size: cover; display: block;&quot;&gt;
      &lt;img class=&quot;gatsby-resp-image-image&quot; style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot; alt=&quot;cdnjs copy as script tag&quot; title=&quot;One click to &quot; copy=&quot;&quot; as=&quot;&quot; script=&quot;&quot; tag&amp;#x22;&amp;#x22;=&quot;&quot; src=&quot;/static/6f0e571a8df2f80dc6329502937f11cf/623ee/cdnjs.png&quot; srcset=&quot;/static/6f0e571a8df2f80dc6329502937f11cf/816c5/cdnjs.png 148w, /static/6f0e571a8df2f80dc6329502937f11cf/c766b/cdnjs.png 295w, /static/6f0e571a8df2f80dc6329502937f11cf/623ee/cdnjs.png 590w, /static/6f0e571a8df2f80dc6329502937f11cf/e5345/cdnjs.png 885w, /static/6f0e571a8df2f80dc6329502937f11cf/7a439/cdnjs.png 1180w, /static/6f0e571a8df2f80dc6329502937f11cf/84fe0/cdnjs.png 1770w, /static/6f0e571a8df2f80dc6329502937f11cf/dcef4/cdnjs.png 2460w&quot; sizes=&quot;(max-width: 590px) 100vw, 590px&quot;&gt;
    &lt;/span&gt;
  &lt;figcaption&gt;One click to &quot;Copy as script tag&quot;&lt;/figcaption&gt;&lt;/figure&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Parallelly in the &lt;a href=&quot;http://nodejs.org/&quot;&gt;Node.js&lt;/a&gt; world, &lt;a href=&quot;http://npmjs.com&quot;&gt;npm&lt;/a&gt;, the Node.js Package Manager was created. With npm, it is much easier to install and maintain packages and their version, &lt;em&gt;(a “package” can be seen as a group of JavaScript modules and their description file)&lt;/em&gt;, for a Node.js project. All a developer need to do list out the dependencies and their version in &lt;code class=&quot;language-text&quot;&gt;package.json&lt;/code&gt; and run &lt;code class=&quot;language-text&quot;&gt;npm install&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;If you think the &lt;em&gt;problem of installability&lt;/em&gt; stops here, well, not quite. See, npm was created for Node.js application, packages that are published to the npm registry was not meant for browser use. The JavaScript “modules” uses “syntax” like the &lt;code class=&quot;language-text&quot;&gt;module.exports&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; which are not readily understandable by the browser. Therefore you can’t add a script tag to include files you just installed from npm. &lt;em&gt;(I will explain what &lt;code class=&quot;language-text&quot;&gt;module.exports&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; syntax are in the later part of this article)&lt;/em&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;&amp;lt;!-- This will not work out of the box! --&gt;&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/node_modules/foo/bar.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;body&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;That’s why &lt;a href=&quot;https://bower.io&quot;&gt;bower&lt;/a&gt; was created. It is called the package manager for the web, because the “package” you installed from bower are readily to be used in the &lt;code class=&quot;language-text&quot;&gt;html&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/a9c17/bower.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 43.33996023856859%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAYAAAAywQxIAAAACXBIWXMAABYlAAAWJQFJUiTwAAAB7UlEQVQoz32Sy2sTURTG55+R0pm5M6aJuBJXooIbkUqXiqCg6KIrNbpQCaVR8VEfmKKgiy5KtVaxLpKSRxO1eRlfC6EoFgTBSJsITRqT/Dx3JvW1cPHjXA6X7/vO4Ri8clgrOVTTinbZhYrwsg8Kim7RpVtw/gtFqUW/Iv+NjzOK5BGH3JBL5kQ/K5k+xm8P8ml2QMRtumUlBkL5H3SvJKZiTFF5AbSoEd/rUh3axPuLWyge20Y4Embz6Sgt7T7vsHo1wI/HLu2UQyft004KCXlndTrVS6u8pMaHXUHq+0MsDQd5sm8rw0f3kBgLibtFd85l9eQAjUiAtcsBmlIbZ4UR4UzAM9Qro9xDCy7tDFLbHeLzjiCLoxat3AZGY/0MHjRZnFAsTzp8f+Twbcrhq1CTd/2Bw8q0kFLUkop62kcnNRaOi/LURphxqUkjOqnYfs7k/CmTL7OKhXs2T69YxK9ZZGIWD6MW8+MWlQmbuTGb1A2b+xGL/B3bHzkWNonfsqiKW/SwyfQli2ZSL132l1MkRKx81yYu9a2IpK/bXq+RlT8VCVPy9/dr5OWEInvT5sIhk5EDJnUt9kaWXvBHaL1QdHR9rjyaz5Tfy6u/T6d3Zoan/M71nHjtesk6ebd3W73+ei2t19/39yf63096g/MljHsPhAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;bower&quot;
        title=&quot;&quot;
        src=&quot;/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/623ee/bower.png&quot;
        srcset=&quot;/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/816c5/bower.png 148w,
/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/c766b/bower.png 295w,
/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/623ee/bower.png 590w,
/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/e5345/bower.png 885w,
/static/b9f29e417a6ee27a6ccd9d1a6625ff3f/a9c17/bower.png 1006w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;!-- prettier-ignore --&gt;
&lt;div class=&quot;gatsby-highlight has-highlighted-lines&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;/project
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  /bower_components&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  /node_modules&lt;/span&gt;  /app
  /bower.json
  /package.json&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;A typical web application project setup with both bower and npm&lt;/div&gt;
&lt;p class=&quot;filename&quot;&gt;index.html&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;html&quot;&gt;&lt;pre class=&quot;language-html&quot;&gt;&lt;code class=&quot;language-html&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;script&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;src&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;bower_components/jquery/dist/jquery.min.js&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;script&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;Adding bower packages into index.html&lt;/div&gt;
&lt;p&gt;Bower components for browser libraries and npm packages for build tools, had been a common web app projects setup until the next tool comes up to change it.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;http://browserify.org/&quot;&gt;Browserify&lt;/a&gt; tries to bring the vast registry of packages from &lt;code class=&quot;language-text&quot;&gt;npm&lt;/code&gt; to the web. Browserify is a module bundler, it reads and understands the &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; syntax, and tries to bundle all the modules into one file.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/567d924485ecb578fc7d16ec7dbf9454/e93fd/browserify.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 76.2208067940552%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAABYlAAAWJQFJUiTwAAACv0lEQVQ4y41TS09TQRTuL3IniRs3ujJxxUI3JhiQuEFiZAVqwKAgRozRBSYmNjHURAOiVcEXiKALSHlI6bu9ffe2987cR188Yj7PzKVYVBIXJ+fMN+f7Zs6cMy7TNPEvMwwDtm1Jn1c1VCv2Pn4YR5jrUDHLQqGoof3mOE50PcTYxDwqZVvuNey/BEUi4xzb9SqmvqzgdM8jHO24j5aOe1gLJVCrlMG5cehtXX+KNTwn0WRWxfOZBXRdvY7jncPofzyN3a0qNJ0dyP1LsLmEhhfEnzvb6B59gYHBKzh24S7OXnPDNBjt1ZpyD/Jcjhg/IKozBs97H/oejONy/w2c6bmNU92jaO8dQtvAE7jffAdjXIo1v6kwp2S7sl9m2TYRTxfQMehGa1cv2nr60HqpHycvDqLl/DCOnBtB55CHytZpCsrEI37TZVwG16FHP4PnQzDLWyRehVWuY6usYWUjAI/3A0bcXtx5toDJuVUs+RXYlRpSxTpygY/gia/EEU9gyUpdplUhwVmwxDcYpTRY2geuxsF1FTVTxY6dR93MY6eiY7eqo8YU8Ow6YmE/1Mg8WGwWvJSRlzI4cwRZYhF66B3UxVsorXugh2egbU6iuOaBuvqU/DhUiovBaajLY9ACXui+MRL5RDZHuS/pED+EFgmWHQH/BG1MgRcVsJSPSK+hRz5IrwW9ZG+lkIgN6rTAWXIJvBCh+JUU22sK1c6KVG7Kab8wveBg9L4G12gvI70gG6zk4AKjmKWW5ROJi0lBpzuWBJzhpDV9O4nR2hKxZTtralgDdzDqbjH1Ozb25jCiZLAZTcIfSSIQS8lYYLFkFhuEheNJ6Dm6XS4ALRdFOJFBKJ6WuYFYmngKlEyBDt8TFEMqhrmk6QhSgm8zhrVgQhLWQ4r0wZiCYDSOjXCc/rSCH2RRJSv/vfiKzqCb+AX1tDHx6+O4hwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;browserify&quot;
        title=&quot;&quot;
        src=&quot;/static/567d924485ecb578fc7d16ec7dbf9454/623ee/browserify.png&quot;
        srcset=&quot;/static/567d924485ecb578fc7d16ec7dbf9454/816c5/browserify.png 148w,
/static/567d924485ecb578fc7d16ec7dbf9454/c766b/browserify.png 295w,
/static/567d924485ecb578fc7d16ec7dbf9454/623ee/browserify.png 590w,
/static/567d924485ecb578fc7d16ec7dbf9454/e5345/browserify.png 885w,
/static/567d924485ecb578fc7d16ec7dbf9454/e93fd/browserify.png 942w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;With &lt;a href=&quot;http://browserify.org/&quot;&gt;Browserify&lt;/a&gt;, and other module bundler, eg &lt;a href=&quot;https://webpack.js.org&quot;&gt;webpack&lt;/a&gt;, &lt;a href=&quot;https://rollupjs.org/&quot;&gt;rollup&lt;/a&gt; etc, we are now able to freely share code among Node.js and browser application, and use &lt;code class=&quot;language-text&quot;&gt;npm&lt;/code&gt; as a package manager for installing and upgrading packages.&lt;/p&gt;
&lt;h1&gt;Importability&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The “how easy is it to import” problem.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Let’s recap the problem of &lt;em&gt;“importability”&lt;/em&gt; with the example earlier. We mentioned that everything we declare within each file, are available to other files via the global scope. There is no control of what you are importing, the sequence of the importing. At this point of time, each JavaScript files is just a script, until module systems were introduced.&lt;/p&gt;
&lt;p&gt;With the advent of Node.js, there’s a need to &lt;em&gt;require&lt;/em&gt; common modules into your JavaScript code. Because in Node.js context, there’s no &lt;code class=&quot;language-text&quot;&gt;index.html&lt;/code&gt; where you can &lt;em&gt;“insert script tags”&lt;/em&gt;. At some point you need to &lt;em&gt;require&lt;/em&gt; some external modules, or else you will end up writing a very long JavaScript file.&lt;/p&gt;
&lt;p&gt;So &lt;a href=&quot;http://commonjs.org&quot;&gt;CommonJS&lt;/a&gt; were introduced into Node.js. It allows your JavaScript code to &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt; other JavaScript modules.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

exports&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;pi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.142&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;the commonjs “require” and “export” syntax&lt;/div&gt;
&lt;p&gt;Note that &lt;code class=&quot;language-text&quot;&gt;require()&lt;/code&gt; is &lt;strong&gt;synchronous&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;When you call &lt;code class=&quot;language-text&quot;&gt;require(&amp;#39;./circle.js&amp;#39;)&lt;/code&gt;, Node runtime will:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;find the file you are &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt;ing&lt;/li&gt;
&lt;li&gt;parse and eval the content&lt;/li&gt;
&lt;li&gt;return what is assigned to &lt;code class=&quot;language-text&quot;&gt;exports&lt;/code&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;But, if we are going to port the &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; syntax into the browser, it will not be able to be synchronous. Because, fetching content involves network call, and it will have to be asynchronous. So, it only make sense to have a asynchronous &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;./circle.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;circle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// callback when circle is ready&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And this is exactly how &lt;a href=&quot;http://www.tysoncadenhead.com/blog/script-loaders/&quot;&gt;&lt;strong&gt;script loaders&lt;/strong&gt;&lt;/a&gt; work!&lt;/p&gt;
&lt;p&gt;If you find the concept of script loading similar, that’s because it is the exact same concept of dynamic import we have today. In fact, if you look at the code, they have the same mechanics of loading the script asynchronously!&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// script loading&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;load&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lib/jquery.min.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; callback&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// dynamic import&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;lib/jquery.min.js&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;then&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;callback&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;CommonJS’s &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; statement did not take into consideration of the asynchronicity of the browser land, therefore the JavaScript community came up with another module system, &lt;a href=&quot;https://requirejs.org/docs/whyamd.html#amd&quot;&gt;AMD (Asynchronous Module Definition)&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;AMD uses an asynchronous &lt;code class=&quot;language-text&quot;&gt;require&lt;/code&gt; syntax, that takes a callback that would be called only after the dependency is available.&lt;/p&gt;
&lt;p class=&quot;filename&quot;&gt;main.js&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;jquery&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;$&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; circle&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// we can use `$` and `circle` now!&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We have both module system in JavaScript, CommonJS and AMD, with both seemed valid and useful, yet troubling, because it meant to library owners to support both module system, by means such as a unified module definition via &lt;a href=&quot;https://github.com/umdjs/umd&quot;&gt;UMDjs&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;So, &lt;a href=&quot;https://www.ecma-international.org/memento/tc39.htm&quot;&gt;TC39&lt;/a&gt;, the standards body charged with defining the syntax and semantics of ECMAScript decided to introduce the &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import&quot;&gt;ES modules&lt;/a&gt; in ES6 (ES2015).&lt;/p&gt;
&lt;p&gt;ES Modules introduced 2 new syntax, the &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt;.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// importing `circle` from &apos;./circle&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; circle &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./circle&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// export the constant `PI`&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; pi &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3.142&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Although at that point of time, most browser still does not support the syntax. So module bundler, like &lt;a href=&quot;https://webpack.js.org&quot;&gt;webpack&lt;/a&gt; came into picture. &lt;a href=&quot;https://webpack.js.org&quot;&gt;webpack&lt;/a&gt; transform the code with &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt; syntax, by concatenating “import”ed modules, and link them together.&lt;/p&gt;
&lt;p&gt;Now, most &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Modules#Applying_the_module_to_your_HTML&quot;&gt;modern browsers have supported &lt;code class=&quot;language-text&quot;&gt;&amp;lt;script type=&amp;quot;module&amp;quot;&amp;gt;&lt;/code&gt;&lt;/a&gt;, which means, the &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt; syntax is supported by default without needing any build tools.&lt;/p&gt;
&lt;p&gt;Over the years, the JavaScript community have been trying to split JavaScript code into multiple files, and link them together with some module system, such as CommonJS and AMD. &lt;a href=&quot;https://www.ecma-international.org/memento/tc39.htm&quot;&gt;TC39&lt;/a&gt; introduced &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import&quot;&gt;ES modules&lt;/a&gt; in ES6 (ES2015) to offer an official module syntax in JavaScript, and before browsers supporting the ES modules syntax, we have to rely on build tools such as &lt;a href=&quot;https://webpack.js.org&quot;&gt;webpack&lt;/a&gt;. Finally, modern browsers are now supporting &lt;code class=&quot;language-text&quot;&gt;&amp;lt;script type=&amp;quot;module&amp;quot;&amp;gt;&lt;/code&gt;, which means we can now use &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt; in our JavaScript application without any configurations.&lt;/p&gt;
&lt;h1&gt;Scopability&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;The “scope pollution” problem.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;There are 2 ways to look at the scope polution problem:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;2 modules are declaring into the same scope, which might have naming conflicts&lt;/li&gt;
&lt;li&gt;variables declared within a module is now “public” and available to other modules, which wasn’t intended&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In this aspect, there are 2 solutions in general for the problem, and I am going to bring out 2 different tools for each solution as an example.&lt;/p&gt;
&lt;p&gt;Firstly, scope naming conflicts can be solved via &lt;a href=&quot;https://en.wikipedia.org/wiki/Namespace&quot;&gt;namespace&lt;/a&gt;. If you read the compiled code from &lt;a href=&quot;https://developers.google.com/closure/&quot;&gt;Google Closure Tools&lt;/a&gt;, you will find that the built-in libraries from Google Closure Tools are namespaced:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;provide&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;tutorial.notepad&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;goog.dom&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

tutorial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notepad&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;makeNotes&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;
  goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parent&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;caption&quot;&gt;Examples from “Building an Application with the Closure Library” tutorial&lt;/div&gt;
&lt;p&gt;Compiled into:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// goog.provide(&apos;tutorial.notepad&apos;);&lt;/span&gt;
tutorial &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tutorial &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
tutorial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notepad &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; tutorial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notepad &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// goog.require(&apos;goog.dom&apos;);&lt;/span&gt;
goog &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; goog &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

tutorial&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notepad&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function-variable function&quot;&gt;makeNotes&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;
  goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parent&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All the code will get concatenated, and declared on the same scope, yet because it is namespace-d, you will have less chance of having a conflict.&lt;/p&gt;
&lt;p&gt;The other solution for the scope problem, is to wrap each module with a function to create a scope for each module. If you look at AMD’s way of writing, you would end up into something like the following:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;goog/dom&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;define&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;tutorial/notepad&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;goog/dom&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;googDom&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    makeNotes&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;
      goog&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;dom&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;parent&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; data&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;You have modules wrapped into their own scope, and hence the only way for 2 modules to interact is through the module systems’ &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;export&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;In terms of “scopeability”, the solutions are namespace it or create a new function scope.&lt;/p&gt;
&lt;p&gt;In fact, these are the 2 different ways module bundlers bundled JavaScript modules into 1 JavaScript file. (which I will explained them further in my future talk).&lt;/p&gt;
&lt;h1&gt;Summary&lt;/h1&gt;
&lt;p&gt;We’ve seen how module system was introduced into JavaScript, and how different tools, standards, or syntax come about in solving the &lt;strong&gt;Installability&lt;/strong&gt;, &lt;strong&gt;Scopability&lt;/strong&gt; and &lt;strong&gt;Importability&lt;/strong&gt; problem.&lt;/p&gt;
&lt;h1&gt;Further Readings&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://arstechnica.com/information-technology/2009/12/commonjs-effort-sets-javascript-on-path-for-world-domination/&quot;&gt;CommonJS effort sets javascript on path for world domination&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://addyosmani.com/writing-modular-js/&quot;&gt;Writing Modular JavaScript With AMD, CommonJS &amp; ES Harmony&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.blueskyonmars.com/2009/01/29/what-server-side-javascript-needs/&quot;&gt;What server side JavaScript needs&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://hacks.mozilla.org/2018/03/es-modules-a-cartoon-deep-dive/&quot;&gt;ES Modules: a cartoon deep dive&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[CSS Code Splitting]]></title><link>https://lihautan.com/css-code-splitting/</link><guid isPermaLink="false">https://lihautan.com/css-code-splitting/</guid><pubDate>Wed, 27 Mar 2019 00:00:00 GMT</pubDate><content:encoded>&lt;p&gt;In the talk, I shared about why and how &lt;a href=&quot;http://careers.shopee.sg&quot;&gt;Shopee&lt;/a&gt; does CSS Code Splitting and how we solve problems arised in the process.&lt;/p&gt;
&lt;p&gt;For those who don’t know about &lt;a href=&quot;http://careers.shopee.sg&quot;&gt;Shopee&lt;/a&gt;, we are an e-commerce platform based in &lt;a href=&quot;https://www.seagroup.com/home&quot;&gt;Greater Southeast Asia&lt;/a&gt;, headquartered in Singapore. As a frontend engineer in Shopee, we constantly striving to deliver performant user experience with high network latency and slow CPU devices.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;Background&lt;/h2&gt;
&lt;p&gt;A little background on how we use CSS in Shopee before getting into how we code split our CSS:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;We use SASS and CSS Modules, and we bundle all our stylesheets with webpack into 1 final CSS file.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;For the benefit of those who might not know about &lt;a href=&quot;https://sass-lang.com/&quot;&gt;SASS&lt;/a&gt;, SASS is a sassy extension of CSS that allow us to write functions and mixins, so we can easily reuse common css tricks and patterns.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/css-modules/css-modules&quot;&gt;CSS Modules&lt;/a&gt; on the other hand, free us from racking our brain, coming up with a unique class name for every element. Even with &lt;a href=&quot;http://getbem.com/naming/&quot;&gt;BEM (Block Element Modifier) naming convention&lt;/a&gt;, as our application grows complex, we can’t keep up with names for our element. Names with BEM convention just get longer and longer. With CSS Modules, we just need to make sure that within a CSS file (we can call it a CSS module, like a js module) the class names are unique. Our build tool will transform the stylesheets and generate class names that is unique throughout the application.&lt;/p&gt;
&lt;p&gt;And lastly with &lt;a href=&quot;https://webpack.js.org/&quot;&gt;webpack&lt;/a&gt;, we use &lt;a href=&quot;https://github.com/webpack-contrib/extract-text-webpack-plugin&quot;&gt;extract-text-webpack-plugin&lt;/a&gt; to extract all the css code within the application into 1 CSS file.&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;So, how big is Shopee?&lt;/h2&gt;
&lt;p&gt;If you ask the business team, they will give you the numbers on &lt;a href=&quot;https://www.techinasia.com/shopee-top-ecommerce-platform-sea&quot;&gt;how well we are doing in the region&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;But if you ask a frontend engineer, I can tell you is that to date (Mar 27 2019), we have more than a thousand of CSS files, and more than 67K lines of CSS code, and the numbers are growing…&lt;/p&gt;
&lt;p&gt;And all this CSS code is bundled into one whoppingly 500KB CSS file! &lt;span class=&quot;emoji&quot;&gt;😱&lt;/span&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;h3&gt;How big is 500KB ?!&lt;/h3&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;a href=&quot;https://www.greennet.org.uk/support/understanding-file-sizes&quot;&gt;500KB is&lt;/a&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;1 minute of MP3 at 80 Kbps bitrate&lt;/li&gt;
&lt;li&gt;2 1280x960 JPEG image&lt;/li&gt;
&lt;li&gt;1/10 second through 4G Network&lt;/li&gt;
&lt;li&gt;2 seconds through 3G Network&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Wait, who uses 3G nowadays? Isn’t 5G is coming?&lt;/p&gt;
&lt;p&gt;Turns out that most of the Southeast Asia is still on 3G if not slow 4G network, except major cities like Singapore, Jakarta, and etc.&lt;/p&gt;
&lt;p&gt;So file size is indeed a big concern, when it comes to network speed.&lt;/p&gt;
&lt;h3&gt;But download time does not tell the full picture.&lt;/h3&gt;
&lt;p&gt;Because you need to look at it holistically in terms of the &lt;a href=&quot;https://developers.google.com/web/fundamentals/performance/critical-rendering-path/&quot;&gt;critical rendering path&lt;/a&gt;:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;When the browser sees a &lt;em&gt;link tag&lt;/em&gt; that links to a CSS file, the browser will go and fetch the CSS file.&lt;/li&gt;
&lt;li&gt;As soon as the CSS is downloaded into the memory, the browser will start to parse and generate a &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/CSS_Object_Model&quot;&gt;CSSOM (CSS Object Model)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;When the DOM is ready for layout, the browser will refer to CSSOM to get the style properties for a particular element and starts to layout.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Which means if your CSS file is large, it will takes up a portion of time to download, and another portion of time to parse, and generate the CSSOM. All these can be traced with the &lt;a href=&quot;https://developers.google.com/web/tools/chrome-devtools/evaluate-performance/timeline-tool&quot;&gt;Chrome’s timeline tool&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;And what makes the matter worse is that, if we open up the &lt;a href=&quot;https://developers.google.com/web/updates/2017/04/devtools-release-notes#coverage&quot;&gt;Chrome’s Coverage tool&lt;/a&gt;, you will see that more than 90% of the CSS code is not being used to style the current page.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;After all the trouble, only 10% of it is being useful&lt;/strong&gt; &lt;span class=&quot;emoji&quot;&gt;😢&lt;/span&gt;.&lt;/p&gt;
&lt;p&gt;So, we have to do what we need to do. &lt;/p&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;Big code file, that take long to download and parse, slows down the browser is not a new problem in frontend development. Indeed we’ve already solved this for JavaScript, we just need to apply the same technique for CSS this time.&lt;/p&gt;
&lt;p&gt;The answer to all of this is &lt;strong&gt;Code Splitting&lt;/strong&gt; &lt;span class=&quot;emoji&quot;&gt;👏&lt;/span&gt;&lt;span class=&quot;emoji&quot;&gt;👏&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;The concept of Code Splitting is to split the code into seperate bundles, and dynamically load then only when you need it.&lt;/p&gt;
&lt;p&gt;There’s a few ways you can look at code splitting, you can:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Split code based on url routes, you don’t have to load the code for Page 2 in Page 1&lt;/li&gt;
&lt;li&gt;Split code based on sections, you dont need code that is off the screen to be loaded now. Only load them when you need it.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;So just as we were &lt;a href=&quot;https://engineering.seagroup.com/shopee-webpack4/&quot;&gt;upgrading Webpack to Webpack 4&lt;/a&gt;, our extract-text-webpack-plugin announced that we should be using &lt;a href=&quot;https://github.com/webpack-contrib/mini-css-extract-plugin&quot;&gt;mini-css-extract-plugin&lt;/a&gt; for CSS now.&lt;/p&gt;
&lt;p&gt;We followed the guide of setting up the new plugin and it worked amazing! &lt;span class=&quot;emoji&quot;&gt;😎&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;What’s different between extract-text-webpack-plugin and mini-css-extract-plugin is that the latter will generate 1 css file per 1 js bundle instead of combining all css files into 1 css file per build.&lt;/p&gt;
&lt;p&gt;All is well until we got our first bug ticket &lt;span class=&quot;emoji&quot;&gt;😫&lt;/span&gt;&lt;/p&gt;
&lt;h2&gt;The Problem&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Styles broken when user goes from Page XXX to Page YYY&lt;/p&gt;
&lt;p&gt;But…&lt;/p&gt;
&lt;p&gt;Stlyes working fine when user goes directly to Page YYY, it’s only broken when user goes from Page XXX to Page YYY&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Well after some investigation, it turns out that it is a special combination of how we write our style declaration and how mini-css-extract-plugin works under the hood.&lt;/p&gt;
&lt;p&gt;For the sake of simplicity, you can imagine this is how &lt;code class=&quot;language-text&quot;&gt;mini-css-extract-plugin&lt;/code&gt; works under the hood:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ensureCss&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;href&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; existingLinkTags &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; existingLinkTags&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;length&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;tag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rel &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;stylesheet&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; tag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getAttribute&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;href&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; href&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; linkTag &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;createElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;link&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  linkTag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;rel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;stylesheet&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  linkTag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;text/css&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  linkTag&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;href &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; href&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; head &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; document&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;getElementsByTagName&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;head&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  head&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;appendChild&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;linkTag&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;When you write:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// somewhere in your application code&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// when you write&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./styles.scss&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;it gets transformed into something like:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// webpack&apos;s mini-css-extract-plugin transform it into&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;ensureCss&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;https://shopee.sg/page-1-style.css&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So when this get executed, it will tries to look for existing link tag, if there’s an existing link tag with the same url, it will be the end of it. But, when it does not exist, the &lt;code class=&quot;language-text&quot;&gt;ensureCss&lt;/code&gt; will create a new link tag and append it at the end of the &lt;code class=&quot;language-text&quot;&gt;&amp;lt;head&amp;gt;&lt;/code&gt; element.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The order of the link tag depends on the order of how you navigate around the application.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;If you are overwriting the same element style in 2 different css files, and in both file if you are specifying the same specificity, the style eventually got applied will solely depend on how your user navigate around your application.&lt;/p&gt;
&lt;p&gt;The solution for this is to make your css declaration more specific when overwriting a particular style.&lt;/p&gt;
&lt;p&gt;eg: &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* only overwrite .foo in page2 */&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;.page2 .foo&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; blue&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Another problem we encountered when we tried to be more specific with CSS declaration, is due to how we write our &lt;a href=&quot;https://reactjs.org&quot;&gt;React&lt;/a&gt; component with CSS Modules.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; styles &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./styles.scss&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;MyComponent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; className &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;div className&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;classA &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos; &apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; className&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Hello World&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;div&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;We wrote a custom component that takes in class name so we can overwrite the default style provided by the component.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;The order of classes in the class attribute does not matter, only the order in declaration matters.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Unfortunately for us this time is that we are using CSS Modules, or else it would be much easier to overwrite it with &lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.classA.classB&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; blue
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;However, because the &lt;code class=&quot;language-text&quot;&gt;.classA&lt;/code&gt; will get transformed to something like &lt;code class=&quot;language-text&quot;&gt;.c8e4436e&lt;/code&gt; and we will never know the generated class name in build time, there’s no way we can have a more specificity with the approach above.&lt;/p&gt;
&lt;p&gt;One hack we came across to solve this conundrum is to &lt;a href=&quot;https://csswizardry.com/2014/07/hacks-for-dealing-with-specificity/&quot;&gt;chain the selector with itself to increase its specifity&lt;/a&gt;, namely:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;&lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.classB.classB&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; blue&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;/* has higher specificity than */&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;.c8e4436e&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; green&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The next problem, is a very specific one.&lt;/p&gt;
&lt;p&gt;In Shopee we does &lt;a href=&quot;https://developers.google.com/web/updates/2019/02/rendering-on-the-web&quot;&gt;Server Side Rendering&lt;/a&gt;, and the nature of &lt;code class=&quot;language-text&quot;&gt;mini-css-extrac-plugin&lt;/code&gt; that uses browser API, like &lt;code class=&quot;language-text&quot;&gt;document.createElement&lt;/code&gt; just not working in a server context.&lt;/p&gt;
&lt;p&gt;We have our on in-house solution for it, which I am not allow to disclose any of it.&lt;/p&gt;
&lt;p&gt;But if you encounter similar issues, and are stucked somewhere, you can &lt;a href=&quot;https://twitter.com/lihautan&quot;&gt;find me on twitter&lt;/a&gt;, I am more than willing to give out some personal pointers and advices on this matter. &lt;/p&gt;</content:encoded></item><item><title><![CDATA[Who accessed my property?]]></title><link>https://lihautan.com/who-accessed-my-property/</link><guid isPermaLink="false">https://lihautan.com/who-accessed-my-property/</guid><pubDate>Sun, 24 Mar 2019 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Say you defined an object &lt;code class=&quot;language-text&quot;&gt;const obj = { awesome: true }&lt;/code&gt; so that anywhere within your code, you can access the value of &lt;code class=&quot;language-text&quot;&gt;obj.awesome&lt;/code&gt; as well as modify its value via &lt;code class=&quot;language-text&quot;&gt;obj.awesome = false&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Question&lt;/strong&gt;: How do you know where and when &lt;code class=&quot;language-text&quot;&gt;obj.awesome&lt;/code&gt; is being accessed or modified?&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;So why is this important?&lt;/strong&gt; If you are using frontend framework that does &lt;a href=&quot;https://stackoverflow.com/a/13504965&quot;&gt;2-way binding&lt;/a&gt;, eg: &lt;a href=&quot;https://angular.io/guide/ajs-quick-reference#ng-model&quot;&gt;Angular&lt;/a&gt;, &lt;a href=&quot;https://vuejs.org/v2/guide/forms.html&quot;&gt;Vue&lt;/a&gt;, do you know how does the framework “watch” your &lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; object? How does the framework knows when to update your DOM when you set some property of the &lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt; object?&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// setting a property in the `$scope` object triggers&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// the framework to update the model and the DOM&lt;/span&gt;
$scope&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Hello&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Answer:&lt;/strong&gt; You use &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Object.defineProperty()&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Object.defineProperty(obj, prop, descriptor)&lt;/code&gt; allows us to define a property to an object with a descriptor for the property being defined.&lt;/p&gt;
&lt;p&gt;Well, nothing special about defining a property of an object, you can do it easily with &lt;code class=&quot;language-text&quot;&gt;obj[prop] = value&lt;/code&gt;. What so special about this &lt;code class=&quot;language-text&quot;&gt;Object.defineProperty()&lt;/code&gt; is the &lt;code class=&quot;language-text&quot;&gt;descriptor&lt;/code&gt; object that you pass in. Lets’ take a look at what can be configured through the &lt;code class=&quot;language-text&quot;&gt;descriptor&lt;/code&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;enumerable&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt; if and only if this property shows up during enumeration of the properties on the corresponding object.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Defaults to &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;If you have a property’s &lt;code class=&quot;language-text&quot;&gt;enumerable&lt;/code&gt; set to &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;, meaning you will not see the property when you do &lt;code class=&quot;language-text&quot;&gt;Object.keys(obj)&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;for (const key in obj) { ... }&lt;/code&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;writable&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt; if and only if the value associated with the property may be changed with an assignment operator.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Defaults to &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;This allows us to create &lt;code class=&quot;language-text&quot;&gt;read-only&lt;/code&gt; property of an object.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;get&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A function which serves as a getter for the property, or &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; if there is no getter. The return value will be used as the value of the property.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Defaults to &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;set&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;A function which serves as a setter for the property, or &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt; if there is no setter. When the property is assigned to, this function is called with one argument (the value being assigned to the property).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Defaults to &lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;So, there you have it. What you need is to define the getter and setter function of the property, and they will be called when the property is accessed or being assigned to a value.&lt;/p&gt;
&lt;p&gt;You can add a breakpoint via &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;debugger;&lt;/code&gt;&lt;/a&gt; in your getter and setter function, to invoke the debugging feature of your development tools to look at the call stack.&lt;/p&gt;
&lt;p&gt;Another way of looking at the call stack without using a debugger is to &lt;strong&gt;throw an Error&lt;/strong&gt; in the getter and setter function.&lt;/p&gt;
&lt;p&gt;Yes. You hear me right. Throwing an error will allow you to get the call stack when the error is thrown:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; _value&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;defineProperty&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;awesome&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    &lt;span class=&quot;token keyword&quot;&gt;try&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token comment&quot;&gt;// intentionally throw an Error to get the call stack&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;catch&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;error&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token comment&quot;&gt;// stack is the stack trace, &lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token comment&quot;&gt;// containing error message and the stack&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; stack &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; error&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;stack&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token comment&quot;&gt;// print the callee stack&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;        stack&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;split&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;slice&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;          &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;\n&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;      &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; _value&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Understand the frontend tools]]></title><link>https://lihautan.com/understand-the-frontend-tools/</link><guid isPermaLink="false">https://lihautan.com/understand-the-frontend-tools/</guid><pubDate>Sat, 16 Mar 2019 08:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;Motivation&lt;/h1&gt;
&lt;p&gt;Some people said, &lt;em&gt;“A year in the JavaScript world is equal to 10 years in the outside world.”&lt;/em&gt; It maybe a bit of exaggerated, but it shed some light on the learning hell of a frontend developer.&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://medium.com/@kamranahmedse&quot;&gt;Kamran Ahmed&lt;/a&gt; has written a nice article on &lt;a href=&quot;https://medium.com/tech-tajawal/modern-frontend-developer-in-2018-4c2072fa2b9c&quot;&gt;frontend developer’s roadmap in 2018&lt;/a&gt;, according to him, if you want to be a frontend developer, you would require to learn preprocessors, package managers, frameworks, build tools, and etc. The list keeps going on and honestly it is tough to keep up with all the new things that’s coming out.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;So, how should we make sense of all these tools, libraries and frameworks to make ourselves a better frontend developer?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;In this post and the posts to come, I would like to share some of my insights on how I navigate around all these ever evolving tools, libraries and frameworks.&lt;/p&gt;
&lt;h1&gt;Disclaimer&lt;/h1&gt;
&lt;p&gt;Before you move on, I have to make some disclaimers.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I am just another frontend developer. I am writing this to share, and hopefully get your feedback, on how to make sense with all the frontend development tools.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;And there’s a lot of articles out there for beginners to pick up JavaScript and CSS, and so I am not covering that.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;I will be assuming you have a basic understanding on how JavaScript and CSS works in building a web application.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Lastly, the opinions and insights I gathered are from articles, tweets, Github issues, and source code of the libraries.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;So some opinions I have might not be the true intention of the library maintainers, but I am giving my perspective in the way I think is the best for me and for you to understand the tools.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1&gt;Asking Questions&lt;/h1&gt;
&lt;p&gt;I realised that in 2019, someone new to frontend development, there is a lot of knowledge and concepts required to acquire, plethora of tools to learn, and I persoanlly think that’s a lot to ask. But yet, this is our state of our industry currently.&lt;/p&gt;
&lt;p&gt;Therefore, I am writing down the thought process and concepts that I’ve gained so far, and hoped that these articles would help new comers to the frontend development world a better foothold on understanding the frontend ecosystem.&lt;/p&gt;
&lt;p&gt;When picking up a new tool, I strongly believe that the best way to learn about it is to ask youself, what kind of problems were you facing without this new tool, and how did you solve these problems? Does the new tool solved your problems?&lt;/p&gt;
&lt;p&gt;So, in my humble opinion, the best way of learning all the tools out there in the JavaScript world, is to go back to the basics, ie: writing &lt;a href=&quot;https://stackoverflow.com/a/20435744/1513547&quot;&gt;Vanilla JavaScript&lt;/a&gt; and plain CSS, and start asking questions:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Modularity&lt;/strong&gt;. How do I break down my code (JavaScript and CSS alike) into separate modules? How do I &lt;em&gt;“import”&lt;/em&gt; then when I need the module? If this module is to be used in multiple projects, how do I share them across projects? or better, how to share the modules to other people around the world?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Following up on question &lt;strong&gt;1.&lt;/strong&gt;, How do I piece all my &lt;em&gt;“modules”&lt;/em&gt; together? How do I download the code for the modules I only when I need it?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;CSS Modularity&lt;/strong&gt;. How do I ensure that in a big application that there’s no naming conflict for my CSS &lt;em&gt;classname&lt;/em&gt; or &lt;em&gt;id&lt;/em&gt;?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Abstraction&lt;/strong&gt;. if I can abstract common logic out in JavaScript, how do I have abstraction for CSS?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;In all fairness, &lt;a href=&quot;https://github.com/getify/You-Dont-Know-JS&quot;&gt;JavaScript is not the best designed language&lt;/a&gt;. JavaScript has its own quirks. So how can JavaScript evolve as a language itself, and how do I make use of the latest language syntax without risking browser compatibility?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;When I write code, I noticed a common pattern in the code that may cause bugs, for example, using variable without defined it in scope, missing &lt;code class=&quot;language-text&quot;&gt;default&lt;/code&gt; case in &lt;code class=&quot;language-text&quot;&gt;switch&lt;/code&gt; statement, adding &lt;code class=&quot;language-text&quot;&gt;string&lt;/code&gt; with &lt;code class=&quot;language-text&quot;&gt;number&lt;/code&gt;, etc. How do I prevent myself from writing such code? Adding &lt;code class=&quot;language-text&quot;&gt;string&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;number&lt;/code&gt; is still a valid JavaScript code, but it will be a source of problem if we assume the result to be a &lt;code class=&quot;language-text&quot;&gt;number&lt;/code&gt;. How do I make myself to be aware of the &lt;code class=&quot;language-text&quot;&gt;type&lt;/code&gt; of the variable, given that JavaScript is a &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Glossary/Dynamic_typing&quot;&gt;dynamically-typed &lt;/a&gt; language?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Testing&lt;/strong&gt;. How should I test my code? If test code explains the behavior of my code, how do I write test code such that when other people reads the test code, they can understand all the quirks and behaviours of my actual code?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Test coverage&lt;/strong&gt;. How do I ensure that I test all the possible scenarios? How do I know that my code has some impossible path/logic that will never execute, knowing all the possible test cases?&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;Optimisation&lt;/strong&gt;. How does the browser downloads and exectues my code? What can I do to optimise the performance of my code? and how do I do it?&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h1&gt;Answering Them&lt;/h1&gt;
&lt;p&gt;The above are questions that I asked, and I am going to answer them one by one in the future articles.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Codemod with babel]]></title><link>https://lihautan.com/codemod-with-babel/</link><guid isPermaLink="false">https://lihautan.com/codemod-with-babel/</guid><pubDate>Wed, 13 Mar 2019 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;A general template that I used:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; babel &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;@babel/core&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; promisify &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;util&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; writeFile &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;promisify&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;fs&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;writeFile&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;async&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; code &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; babel&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;transformFileAsync&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filename&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    plugins&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
        &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token function&quot;&gt;manipulateOptions&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;opts&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; parserOpts&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;/*
             add to parserOpts.plugins to enable the syntax
             eg: 
              jsx, flow, typescript, objectRestSpread, pipelineOperator, 
              throwExpressions, optionalChaining, nullishCoalescingOperator, 
              exportDefaultFrom, dynamicImport, ...
            */&lt;/span&gt;
            parserOpts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;plugins&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
              &lt;span class=&quot;token string&quot;&gt;&apos;classProperties&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
              &lt;span class=&quot;token string&quot;&gt;&apos;classPrivateProperties&apos;&lt;/span&gt;
            &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
          visitor&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
            &lt;span class=&quot;token comment&quot;&gt;// fill in a transformer here&lt;/span&gt;
          &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;await&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;writeFile&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;filename&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; code&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;utf-8&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;[WIP] I am going to explain how it works and how to use it.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[My eslint doesn’t work with for flow 0.85’s explicit type argument syntax]]></title><link>https://lihautan.com/eslint-for-flow-explicit-type-argument-syntax/</link><guid isPermaLink="false">https://lihautan.com/eslint-for-flow-explicit-type-argument-syntax/</guid><pubDate>Thu, 17 Jan 2019 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Today &lt;a href=&quot;https://dev.wgao19.cc/&quot;&gt;Wei Gao&lt;/a&gt; posed an interesting question:&lt;/p&gt;
&lt;p&gt;She was upgrading Flow to v0.85, &lt;a href=&quot;https://medium.com/flow-type/asking-for-required-annotations-64d4f9c1edf8&quot;&gt;which requires her to explicitly type the argument of the function call&lt;/a&gt;. However, when she saved the file, our &lt;a href=&quot;https://github.com/prettier/prettier&quot;&gt;eslint-prettier&lt;/a&gt; automatically format the code into a weird syntax:&lt;/p&gt;
&lt;p&gt;So, when she wrote:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;fooFunction&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Bar&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;With &lt;a href=&quot;https://github.com/prettier/eslint-plugin-prettier&quot;&gt;eslint-plugin-prettier&lt;/a&gt;, eslint &lt;em&gt;“fixed”&lt;/em&gt; the code into:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;fooFunction &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; Bar &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It felt like eslint sees &lt;code class=&quot;language-text&quot;&gt;&amp;lt;&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;&amp;gt;&lt;/code&gt; as the comparison operator, rather than &lt;code class=&quot;language-text&quot;&gt;&amp;lt;Type&amp;gt;&lt;/code&gt; as a whole!&lt;/p&gt;
&lt;p&gt;To confirm with my hypothesis, I opened up my favourite tool for inspecting &lt;a href=&quot;https://en.wikipedia.org/wiki/Abstract_syntax_tree&quot;&gt;AST&lt;/a&gt;: &lt;a href=&quot;https://astexplorer.net/&quot;&gt;astexplorer.net&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;You can paste your code into &lt;a href=&quot;https://astexplorer.net/&quot;&gt;astexplorer.net&lt;/a&gt; and see how different parser “sees” your code in terms of a AST (Abstract Syntax Tree).&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/17844d464c6fad0985e078b84dca8afd/940da/ast-explorer.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 57.182576459684896%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABDklEQVQoz42R62rDMAyF+/6v15alGc1NtmTZsnuFsEDSKQl0+ZGyHAthjD8fSd51P93j9hyG4fXWtGXnqrLSfLteo4gBIMSmrpsa8gyyr6qpadd1Xdu2I6xrUt/3CgPA8XAozmcJQeEkEueIckljpCi71wepZ11VUaVACN77EEJaviJr8NwCNM0py2ZYzRu0hlB59l5DpYcfYSL6znPPnBQPAR0Rs2Ka3bQJq/Bf2WWZRufo2ZEpvCMgkqny9E/ZAGVRXJLORdSsNECO46LhdXiWdqV/o7BGkkCEfhpY3DIwtJhnJ+WtMWQte0be4PyGj/s9KuYcWbBQIuHWsh/3u36ujJdiYIdVxs5GiUv4F+Itbmu8PVBFAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;You can choose different a parser!&quot;
        title=&quot;&quot;
        src=&quot;/static/17844d464c6fad0985e078b84dca8afd/623ee/ast-explorer.png&quot;
        srcset=&quot;/static/17844d464c6fad0985e078b84dca8afd/816c5/ast-explorer.png 148w,
/static/17844d464c6fad0985e078b84dca8afd/c766b/ast-explorer.png 295w,
/static/17844d464c6fad0985e078b84dca8afd/623ee/ast-explorer.png 590w,
/static/17844d464c6fad0985e078b84dca8afd/e5345/ast-explorer.png 885w,
/static/17844d464c6fad0985e078b84dca8afd/940da/ast-explorer.png 1079w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;As you can see from the picture above, you can choose from different parsers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;acorn&lt;/strong&gt; — the parser used by webpack after the loaders, webpack uses acorn’s AST to find &lt;code class=&quot;language-text&quot;&gt;import&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;require()&lt;/code&gt; syntax to know generate the dependency tree of your project, as well as provide an entry for plugins like &lt;a href=&quot;https://webpack.js.org/plugins/define-plugin/&quot;&gt;DefinePlugin&lt;/a&gt; to transform the transpiled code.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;babylon&lt;/strong&gt;— the &lt;a href=&quot;https://github.com/babel/babel/&quot;&gt;babel&lt;/a&gt; parser, now it’s called &lt;a href=&quot;https://babeljs.io/docs/en/babel-parser&quot;&gt;@babel/parser&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;flow&lt;/strong&gt;, &lt;strong&gt;typescript&lt;/strong&gt;, &lt;strong&gt;uglify-js&lt;/strong&gt;— the parsers that each of the library uses&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;esprima&lt;/strong&gt; — the default eslint parser&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;babel-eslint&lt;/strong&gt; — a wrapper of babel parser for eslint, which is also the one we used, because we have a ton of babel plugins configured, so by using babel-eslint we don’t have to reconfigure the same plugins for eslint.&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;So I copied our code into astexplorer, and selected the “flow” parser:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ab7413e038ae94283f26d86d612275bc/e5345/flow-ast.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 28.926553672316384%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3ElEQVQY03WQ2U7DMBBF8/+/wi/wggqtKFuQkKBqmjrexsuM27RKwkNb4xqCBALP8X271hkXMZ4yse969J4QKY0FUZXN+u25am5f65eVcM4R+p9gEcfTd91YTpcUZ1JCI42Q4CwGaje0C4mQM1O0pNvWHo/vQz+gd19lJCPmwCeseVjzUqlS65RPCVCPSt6BvnemLLZU7ffscBjOZfdZ9ohBsSuxuAB+uaqvl/WUy7nIgJ4ZuHFmatTsb21vQQumFWgbCLeEZ+fNaEvf2vH0+8NSJn/0Jr2RF/H/8QF/4EmHPEuiHwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;flow ast&quot;
        title=&quot;&quot;
        src=&quot;/static/ab7413e038ae94283f26d86d612275bc/623ee/flow-ast.png&quot;
        srcset=&quot;/static/ab7413e038ae94283f26d86d612275bc/816c5/flow-ast.png 148w,
/static/ab7413e038ae94283f26d86d612275bc/c766b/flow-ast.png 295w,
/static/ab7413e038ae94283f26d86d612275bc/623ee/flow-ast.png 590w,
/static/ab7413e038ae94283f26d86d612275bc/e5345/flow-ast.png 885w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;I can see the type annotation is being parsed as “TypeParameterInstantiation”, however when I changed the parser to “babel-eslint8”,&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d80586ce912511f29235c3518598301c/bfa8e/babel-eslint-8-ast.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 39.44387229660144%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAAA4UlEQVQY03WQ3W6DMAyFef9H2gOslXazq6lsDEISYju2oVJvgdXpj7Ru5ejISqLzRbarn7vWdZ2mSZhVREUhNH3vPppwaMOAJHJ9f3C1BQuB7+o2Dm5IPiX5R27DqmywqwFSRpjsfkmPN+zWRZWREcbxeFqW+fgLzgShaxqH3w4RpZjUKpFytlj5rprneVlX82Pbo7An/xLjK8Ab415ox1Sq0H7knXCwzObMBD0O74hfmRrOn3K3nZVrZbTMc9iEsQs+tEG7IDEpgE1XmqfLCJzZkn/hQjJzznpV2c1Tl4WdAeWrvB3eiGzDAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;babel eslint 8 ast&quot;
        title=&quot;&quot;
        src=&quot;/static/d80586ce912511f29235c3518598301c/623ee/babel-eslint-8-ast.png&quot;
        srcset=&quot;/static/d80586ce912511f29235c3518598301c/816c5/babel-eslint-8-ast.png 148w,
/static/d80586ce912511f29235c3518598301c/c766b/babel-eslint-8-ast.png 295w,
/static/d80586ce912511f29235c3518598301c/623ee/babel-eslint-8-ast.png 590w,
/static/d80586ce912511f29235c3518598301c/e5345/babel-eslint-8-ast.png 885w,
/static/d80586ce912511f29235c3518598301c/bfa8e/babel-eslint-8-ast.png 971w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;I get a Binary Expression and a SequenceExpression!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Binary Expression&lt;/strong&gt; is a way to express logical expression and mathematical expression, eg: &lt;code class=&quot;language-text&quot;&gt;a + b&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;a &amp;amp;&amp;amp; b&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;a &amp;lt;= b&lt;/code&gt;, etc.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Sequence Expression&lt;/strong&gt; on the other hand is something you don’t see people write that often, you can look up how it works in &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator&quot;&gt;Comma operator (MDN)&lt;/a&gt;, basically you can write expressions as a expression by joining them with a comma operator (&lt;code class=&quot;language-text&quot;&gt;,&lt;/code&gt;), and the expression returns the value of the last expression, eg: result = &lt;code class=&quot;language-text&quot;&gt;(a++, b++, c -= 2, d.push(e), --f)&lt;/code&gt;, you increment &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt; , &lt;code class=&quot;language-text&quot;&gt;b&lt;/code&gt; , decrement &lt;code class=&quot;language-text&quot;&gt;c&lt;/code&gt; by 2, and pushed &lt;code class=&quot;language-text&quot;&gt;e&lt;/code&gt; into &lt;code class=&quot;language-text&quot;&gt;d&lt;/code&gt; and decrement &lt;code class=&quot;language-text&quot;&gt;f&lt;/code&gt; and set result to the new value of &lt;code class=&quot;language-text&quot;&gt;f&lt;/code&gt;. Wow, that’s a lot in one statement! It’s confusing to read, but you see this often in a minified code.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Now this explains why prettier will try to add space in between &lt;code class=&quot;language-text&quot;&gt;&amp;lt;&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;&amp;gt;&lt;/code&gt; .&lt;/p&gt;
&lt;p&gt;I saw that there’s a babel-eslint9, and I gave it a try, and…&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ab7413e038ae94283f26d86d612275bc/e5345/babel-eslint-9-ast.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 28.926553672316384%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAGCAIAAABM9SnKAAAACXBIWXMAAAsSAAALEgHS3X78AAAA3ElEQVQY03WQ2U7DMBBF8/+/wi/wggqtKFuQkKBqmjrexsuM27RKwkNb4xqCBALP8X271hkXMZ4yse969J4QKY0FUZXN+u25am5f65eVcM4R+p9gEcfTd91YTpcUZ1JCI42Q4CwGaje0C4mQM1O0pNvWHo/vQz+gd19lJCPmwCeseVjzUqlS65RPCVCPSt6BvnemLLZU7ffscBjOZfdZ9ohBsSuxuAB+uaqvl/WUy7nIgJ4ZuHFmatTsb21vQQumFWgbCLeEZ+fNaEvf2vH0+8NSJn/0Jr2RF/H/8QF/4EmHPEuiHwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;babel eslint 9 ast&quot;
        title=&quot;&quot;
        src=&quot;/static/ab7413e038ae94283f26d86d612275bc/623ee/babel-eslint-9-ast.png&quot;
        srcset=&quot;/static/ab7413e038ae94283f26d86d612275bc/816c5/babel-eslint-9-ast.png 148w,
/static/ab7413e038ae94283f26d86d612275bc/c766b/babel-eslint-9-ast.png 295w,
/static/ab7413e038ae94283f26d86d612275bc/623ee/babel-eslint-9-ast.png 590w,
/static/ab7413e038ae94283f26d86d612275bc/e5345/babel-eslint-9-ast.png 885w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;It seems like the bug was fixed on &lt;code class=&quot;language-text&quot;&gt;babel-eslint9&lt;/code&gt;, so I plowed through the release notes of babel-eslint, and I found this &lt;a href=&quot;https://github.com/babel/babel-eslint/pull/444&quot;&gt;merge commit&lt;/a&gt;. So it seems like upgrading babel-eslint to v9 will solve the issue! &lt;span class=&quot;emoji&quot;&gt;🎉&lt;/span&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[The `ascii_only` option in uglify-js]]></title><link>https://lihautan.com/uglify-ascii-only/</link><guid isPermaLink="false">https://lihautan.com/uglify-ascii-only/</guid><pubDate>Sat, 27 Oct 2018 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;The background story&lt;/p&gt;
&lt;p&gt;I was working on a chrome extension, and trying to add some emojis &lt;span class=&quot;emoji&quot;&gt;😍&lt;/span&gt;&lt;span class=&quot;emoji&quot;&gt;😀&lt;/span&gt;&lt;span class=&quot;emoji&quot;&gt;😎&lt;/span&gt; into the extension, however I realised the &lt;span class=&quot;emoji&quot;&gt;😍&lt;/span&gt;&lt;span class=&quot;emoji&quot;&gt;😀&lt;/span&gt;&lt;span class=&quot;emoji&quot;&gt;😎&lt;/span&gt; are not rendered correctly!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ff2b81e03b2f2d9068a97743adcb69c8/5e68e/problem.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 66.32911392405065%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAAAZElEQVQoz+2NwQqAIAyGff837FBIJJubmrm8ZuvQPfIWfbCf8Y+PGe89eppmN4zWLrA4h4hElFICgBgjM4cQmFh3ANTUq6aWpta65rwV0Smyi4g27RmmdXDJx80buevzL39fPgFFRwLqWPWYuwAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;The 😍😍😀😀isn’t rendered correctly in chrome extension&quot;
        title=&quot;&quot;
        src=&quot;/static/ff2b81e03b2f2d9068a97743adcb69c8/623ee/problem.png&quot;
        srcset=&quot;/static/ff2b81e03b2f2d9068a97743adcb69c8/816c5/problem.png 148w,
/static/ff2b81e03b2f2d9068a97743adcb69c8/c766b/problem.png 295w,
/static/ff2b81e03b2f2d9068a97743adcb69c8/623ee/problem.png 590w,
/static/ff2b81e03b2f2d9068a97743adcb69c8/e5345/problem.png 885w,
/static/ff2b81e03b2f2d9068a97743adcb69c8/7a439/problem.png 1180w,
/static/ff2b81e03b2f2d9068a97743adcb69c8/5e68e/problem.png 1580w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;And so I inspect the source code loaded into the chrome extension, it wasn’t loaded correctly as well!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1d6b5e9c1ff4877c011da49ac7779e01/daa55/problem-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 52.05158264947245%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAAYUlEQVQoz+3MuxJAMBSE4bz/CyqMwi0Rl8E5J8sEwQOg0Sh8xXb/qrZu8rTMCh3FidGm0rq3lrvOiYAZ507XiEh5753DSATAi8zDuBCtzJvDJrwCIYT9htpfUA/Hf/yp+AB7gVDwv+I1sAAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;problem with the source too&quot;
        title=&quot;&quot;
        src=&quot;/static/1d6b5e9c1ff4877c011da49ac7779e01/623ee/problem-2.png&quot;
        srcset=&quot;/static/1d6b5e9c1ff4877c011da49ac7779e01/816c5/problem-2.png 148w,
/static/1d6b5e9c1ff4877c011da49ac7779e01/c766b/problem-2.png 295w,
/static/1d6b5e9c1ff4877c011da49ac7779e01/623ee/problem-2.png 590w,
/static/1d6b5e9c1ff4877c011da49ac7779e01/e5345/problem-2.png 885w,
/static/1d6b5e9c1ff4877c011da49ac7779e01/7a439/problem-2.png 1180w,
/static/1d6b5e9c1ff4877c011da49ac7779e01/daa55/problem-2.png 1706w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;And so I think, probably the encoding issue was caused by the webpack compilation, but, my compiled code looks exactly fine!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/2601fef3b9c18ade62977ec25a16beda/f6193/source.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 48.95688456189152%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/UlEQVQoz+WLwU6EMBRF+QAZpQwOhcwApS1QYSptYQCFAAsTXbhxYVyZ+Amz8PstM8bErVuTk5dzb941nuaP95fP18fj0L8h0WMxxmIkcsJyInImp5vIiUpdjnE5RrcjXh4WjDDmCJecdoLfp1zRRMj9mNEay4bUd1h1advT/U0hc5SyACGWYT9ElhsAGBhX7vbC8XZJUdRDXvWim0U7R7TM64pViimlhiYTgjdVfqjaA39+KLkqnYDBiBnACy8daMHA9mOg8ZDlofUWAw/b/oIFY33B2X2ygtrJ9Y5qlrFpu6u1a9obzUq77Zpgc46n5pd/R7DwM4Z/4D+OvwBmxkQr7YPD0AAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;The compiled code seems okay!&quot;
        title=&quot;&quot;
        src=&quot;/static/2601fef3b9c18ade62977ec25a16beda/623ee/source.png&quot;
        srcset=&quot;/static/2601fef3b9c18ade62977ec25a16beda/816c5/source.png 148w,
/static/2601fef3b9c18ade62977ec25a16beda/c766b/source.png 295w,
/static/2601fef3b9c18ade62977ec25a16beda/623ee/source.png 590w,
/static/2601fef3b9c18ade62977ec25a16beda/e5345/source.png 885w,
/static/2601fef3b9c18ade62977ec25a16beda/7a439/source.png 1180w,
/static/2601fef3b9c18ade62977ec25a16beda/f6193/source.png 1438w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;So, most likely is a decoding issue when the emoji code get loaded into chrome extension. So I manually changed the emoji in the compiled code to &lt;code class=&quot;language-text&quot;&gt;\ud83d\ude0d&lt;/code&gt; (unicode for &lt;span class=&quot;emoji&quot;&gt;😍&lt;/span&gt;). Guess what? The emoji is showing correctly in the chrome extension!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/c3d91cd8d55265438e63eb08b5570a4d/c2902/expectation.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 53.37423312883436%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAAWklEQVQoz+2LOw6AIBBEuf/9tFESFcIi+6OxsAHhBiaWMsVLZibPxBgdnLPdpsWu+0HM3ntR7RTpr3NZNYTQKgAgYkqpjzkbIkJmFm28L62l1Ncx9UOG/A/5AYJKiv/XIO9rAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;😍!&quot;
        title=&quot;&quot;
        src=&quot;/static/c3d91cd8d55265438e63eb08b5570a4d/623ee/expectation.png&quot;
        srcset=&quot;/static/c3d91cd8d55265438e63eb08b5570a4d/816c5/expectation.png 148w,
/static/c3d91cd8d55265438e63eb08b5570a4d/c766b/expectation.png 295w,
/static/c3d91cd8d55265438e63eb08b5570a4d/623ee/expectation.png 590w,
/static/c3d91cd8d55265438e63eb08b5570a4d/e5345/expectation.png 885w,
/static/c3d91cd8d55265438e63eb08b5570a4d/7a439/expectation.png 1180w,
/static/c3d91cd8d55265438e63eb08b5570a4d/c2902/expectation.png 1304w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;So I changed my source code to manually type in the unicode, and compiled it using webpack. To my surprise, the unicode was compiled back into the emoji (&lt;span class=&quot;emoji&quot;&gt;😍&lt;/span&gt;) it represents!&lt;/p&gt;
&lt;p&gt;I googled around and I found &lt;a href=&quot;https://github.com/babel/babel/pull/4478&quot;&gt;this fix for babel-generator&lt;/a&gt;:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/89e01cd1223b85be658c2ea05cfbd0ab/5be9e/babel-issue.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 41.375%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABBklEQVQY031Ry07EMAzM/38IEgf+AQ7ADQkEFM50d1W1TdPEcd4p0+3CcmFHqWNHGo89Fe/P7cfrbtbaGGPZEjFZNkRmjcfEGO+9Y7xbZi6lLD8QT7fdy0NHRM45BpuDtsH5YDjOBApeXa11+YO61BxjzVmwNzhENoR4jAHtoYGSV6rLpWQAiqVuyCWzmpK14ubquu/HUc6DVFJpOc1rVFoT+5hdSLhQzppciH0/4Jz0axXBe/RNKSHWWlKM5+Hqed4ta5rmq223EhSBzPuw2x8mpeEQO7/8D6wjJ4X5t+YrGevtD90wTpb9ZTJk8F+geXIbH3y6u398az7XbaW6QIZ/cPS3/AZH589NEecGCQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;babel issue&quot;
        title=&quot;&quot;
        src=&quot;/static/89e01cd1223b85be658c2ea05cfbd0ab/623ee/babel-issue.png&quot;
        srcset=&quot;/static/89e01cd1223b85be658c2ea05cfbd0ab/816c5/babel-issue.png 148w,
/static/89e01cd1223b85be658c2ea05cfbd0ab/c766b/babel-issue.png 295w,
/static/89e01cd1223b85be658c2ea05cfbd0ab/623ee/babel-issue.png 590w,
/static/89e01cd1223b85be658c2ea05cfbd0ab/e5345/babel-issue.png 885w,
/static/89e01cd1223b85be658c2ea05cfbd0ab/7a439/babel-issue.png 1180w,
/static/89e01cd1223b85be658c2ea05cfbd0ab/5be9e/babel-issue.png 1600w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;I checked my babel version, and it had included this fix. So what went wrong?&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;My colleague reminded me that during webpack compilation, there are 2 phases, the &lt;strong&gt;transpilation&lt;/strong&gt; (via babel) and the &lt;strong&gt;minification&lt;/strong&gt; (via uglify plugin).&lt;/p&gt;
&lt;p&gt;So I disabled the optimisation in webpack config, and noticed that my compiled code contains the original unicode string (&lt;code class=&quot;language-text&quot;&gt;\ud83d\ude0d&lt;/code&gt;), instead of the emoji (&lt;span class=&quot;emoji&quot;&gt;😍&lt;/span&gt;) string. So the unicode string was converted to emoji string during minification!&lt;/p&gt;
&lt;p&gt;So I went to my favourite &lt;a href=&quot;https://skalman.github.io/UglifyJS-online/&quot;&gt;Online JavaScript Minifier&lt;/a&gt; (by &lt;a href=&quot;https://github.com/skalman&quot;&gt;skalman&lt;/a&gt;) to try it out.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/3c362481f7109a36963627eb1ab37cf3/560b9/uglify.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 21.19521912350598%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAAkklEQVQI12OYvGb95NXr5u/aO3PT1nk7d8/YuGXmxq1ztu4EMtacPrvmxIk1R4+uO3Fi3cmTa48d23T27PbLl7ddugRBDG8+f//248evv3//////D4yArL//gPT/+28+3Hr69O+vn79+gwCQ/PPnz18kwPDl5x+INmTwD6z54ZsPj96+hXMxAcPnH79xaX5ASDMA2CDb/Ms6D0sAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;online javasript minifier&quot;
        title=&quot;&quot;
        src=&quot;/static/3c362481f7109a36963627eb1ab37cf3/623ee/uglify.png&quot;
        srcset=&quot;/static/3c362481f7109a36963627eb1ab37cf3/816c5/uglify.png 148w,
/static/3c362481f7109a36963627eb1ab37cf3/c766b/uglify.png 295w,
/static/3c362481f7109a36963627eb1ab37cf3/623ee/uglify.png 590w,
/static/3c362481f7109a36963627eb1ab37cf3/e5345/uglify.png 885w,
/static/3c362481f7109a36963627eb1ab37cf3/7a439/uglify.png 1180w,
/static/3c362481f7109a36963627eb1ab37cf3/84fe0/uglify.png 1770w,
/static/3c362481f7109a36963627eb1ab37cf3/560b9/uglify.png 2510w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;After some googling, I &lt;a href=&quot;https://github.com/mishoo/UglifyJS2/issues/490&quot;&gt;found this issue&lt;/a&gt; which described my scenario perfectly.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/7080b1d2cff0afacdf72b3196c9d5a13/d40b5/babel-issue-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 42.30396902226525%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAIAAAB2/0i6AAAACXBIWXMAAAsSAAALEgHS3X78AAABKElEQVQY031Qu1LDMBD0/38IDRVDT0dBQQNDSWCw4jixLVnW86STzDrJwNBws9KcpF3t3TVS634c21b0/VGI/TCMXXcATqcTjoe+33fdV9sO4AhhrF3X9ejHm929cH0z7D7Fy5uc5GKM1ou1zhhwEM46F2L0wTvnich7z8wQR6YPI3wOjXl8Gm7vQAEPAVJKiSLFEC/Uf6J5eH59HxR85sXMeoOxnjJT4kg5UAqUkfhAPpLzHnXVWq/i46SVNlIqqeaMgB2XUtdSK3bQuFRc8Pk+hLAsBslVjIU3pZdJzTBXs56kQg7IWUulHUxTjgn/FrSdUv4tGytzPgvt1aEUEDfwtuOISgBUgclhNn/EeIcDrFD/pPQ4SrSXmLfOt+bzBSnDGWOlH/E3Ub3LvmAYyTcAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;why uglifyjs always compress unicode characters to utf8&quot;
        title=&quot;&quot;
        src=&quot;/static/7080b1d2cff0afacdf72b3196c9d5a13/623ee/babel-issue-2.png&quot;
        srcset=&quot;/static/7080b1d2cff0afacdf72b3196c9d5a13/816c5/babel-issue-2.png 148w,
/static/7080b1d2cff0afacdf72b3196c9d5a13/c766b/babel-issue-2.png 295w,
/static/7080b1d2cff0afacdf72b3196c9d5a13/623ee/babel-issue-2.png 590w,
/static/7080b1d2cff0afacdf72b3196c9d5a13/e5345/babel-issue-2.png 885w,
/static/7080b1d2cff0afacdf72b3196c9d5a13/7a439/babel-issue-2.png 1180w,
/static/7080b1d2cff0afacdf72b3196c9d5a13/84fe0/babel-issue-2.png 1770w,
/static/7080b1d2cff0afacdf72b3196c9d5a13/d40b5/babel-issue-2.png 2066w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Turned out there is a &lt;code class=&quot;language-text&quot;&gt;ascii_only&lt;/code&gt; for &lt;a href=&quot;https://github.com/mishoo/UglifyJS2#output-options&quot;&gt;output options&lt;/a&gt;, and it is default to &lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;. So I set &lt;code class=&quot;language-text&quot;&gt;ascii_only&lt;/code&gt; to &lt;code class=&quot;language-text&quot;&gt;true&lt;/code&gt;, ran webpack, and checked my compiled code, it contained the unicode string (&lt;code class=&quot;language-text&quot;&gt;\ud83d\ude0d&lt;/code&gt;)! And even when I wrote emoji string (&lt;span class=&quot;emoji&quot;&gt;😍&lt;/span&gt;) in my source code, it got compiled to unicode as well.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; UglifyJsPlugin &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;uglifyjs-webpack-plugin&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

module&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;exports &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;
  optimization&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    minimizer&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UglifyJsPlugin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      uglifyOptions&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;        output&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;          &lt;span class=&quot;token comment&quot;&gt;// true for `ascii_only`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;          ascii_only&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/span&gt;      &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h2&gt;TIL: UglifyJs ascii_only option, use it when you want to escape Unicode characters.&lt;/h2&gt;
&lt;hr&gt;
&lt;p&gt;Why is there a &lt;code class=&quot;language-text&quot;&gt;ascii_only&lt;/code&gt; option?&lt;/p&gt;
&lt;p&gt;My guess is that it takes less space for a unicode character (16–17bit) than the escaped ascii characters (6 * 8 bit — 12 * bit), that’s why using unicode character is the default option (&lt;code class=&quot;language-text&quot;&gt;ascii_only=false&lt;/code&gt;).&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Dead-code elimination]]></title><link>https://lihautan.com/dead-code-elimination/</link><guid isPermaLink="false">https://lihautan.com/dead-code-elimination/</guid><pubDate>Wed, 24 Oct 2018 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;Imagine you have the code below:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
   &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;after passing this code through &lt;a href=&quot;https://www.npmjs.com/package/uglify-js&quot;&gt;uglify-js&lt;/a&gt;, you will get the code below:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;uglify-js&lt;/strong&gt; will do dead code removal, ie: it will remove code that will not affect the program results. Since we defined &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;b&lt;/code&gt; in the function &lt;code class=&quot;language-text&quot;&gt;foo&lt;/code&gt; and we are not using &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;b&lt;/code&gt; within the &lt;code class=&quot;language-text&quot;&gt;foo&lt;/code&gt;, &lt;strong&gt;uglify-js&lt;/strong&gt; safely removes it from the uglified code.&lt;/p&gt;
&lt;p&gt;However, if you can see from the uglified code, &lt;code class=&quot;language-text&quot;&gt;foobar()&lt;/code&gt; is preserved. This is because calling &lt;code class=&quot;language-text&quot;&gt;foobar&lt;/code&gt; may have side effects on the program, so &lt;strong&gt;uglify-js&lt;/strong&gt; preserves foobar(). But since we do not need the return value of &lt;code class=&quot;language-text&quot;&gt;foobar()&lt;/code&gt;, which is assigned to &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;a&lt;/code&gt; got removed by uglify-js.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;What if we know that &lt;code class=&quot;language-text&quot;&gt;foobar()&lt;/code&gt; will not caused any side effects?&lt;/p&gt;
&lt;p&gt;How do we tell &lt;strong&gt;uglify-js&lt;/strong&gt; that if we are not using the return value from &lt;code class=&quot;language-text&quot;&gt;foobar()&lt;/code&gt;, please remove it as well?&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Turns out that &lt;strong&gt;uglify-js&lt;/strong&gt; will treat a function call as “pure” if there is a comment annotation &lt;code class=&quot;language-text&quot;&gt;/*@__PURE__*/&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;/*#__PURE__*/&lt;/code&gt; immediately precedes the call.&lt;/p&gt;
&lt;p&gt;For example: &lt;code class=&quot;language-text&quot;&gt;/* @__PURE__ */ foobar()&lt;/code&gt; !&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// before uglify&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;gatsby-highlight-code-line&quot;&gt;  &lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;/*@__PURE__*/&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;foobar&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;8&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// after uglify&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Note that now &lt;code class=&quot;language-text&quot;&gt;foobar()&lt;/code&gt; is being removed!&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;So, how is this useful?&lt;/p&gt;
&lt;p&gt;As a library author, you can write a babel plugin to mark your function to be pure, so that &lt;strong&gt;uglify-js&lt;/strong&gt; can drop the function call if the return value is not being used in the code. (There is a &lt;a href=&quot;https://babeljs.io/docs/en/next/babel-helper-annotate-as-pure.html&quot;&gt;util from babel&lt;/a&gt; to do just the job of marking function as pure &lt;span class=&quot;emoji&quot;&gt;😎&lt;/span&gt;)&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Took me hours to realise why docker build ignores my .dockerignore]]></title><link>https://lihautan.com/why-docker-ignores-my-file/</link><guid isPermaLink="false">https://lihautan.com/why-docker-ignores-my-file/</guid><pubDate>Sun, 26 Nov 2017 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;From the &lt;a href=&quot;https://docs.docker.com/engine/reference/builder/#dockerignore-file&quot;&gt;official docs&lt;/a&gt; of docker for .dockerignore:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Before the docker CLI sends the context to the docker daemon, it looks for a file named &lt;code class=&quot;language-text&quot;&gt;.dockerignore&lt;/code&gt; in the root directory of the context. If this file exists, the CLI modifies the context to exclude files and directories that match patterns in it. This helps to avoid unnecessarily sending large or sensitive files and directories to the daemon and potentially adding them to images using &lt;code class=&quot;language-text&quot;&gt;ADD&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;COPY&lt;/code&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Docker CLI will only look for &lt;code class=&quot;language-text&quot;&gt;.dockerignore&lt;/code&gt; file in the &lt;strong&gt;root directory of the context&lt;/strong&gt;, if you have a monorepo of multiple packages, make sure &lt;code class=&quot;language-text&quot;&gt;.dockerignore&lt;/code&gt; file is on the root directory of your context, it will ignore it if it is somewhere in the subfolder.&lt;/p&gt;
&lt;p&gt;About pattern matching of the ignored file, &lt;code class=&quot;language-text&quot;&gt;*/temp&lt;/code&gt; will match &lt;code class=&quot;language-text&quot;&gt;a/temp&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;b/temp&lt;/code&gt; but not &lt;code class=&quot;language-text&quot;&gt;temp&lt;/code&gt; or &lt;code class=&quot;language-text&quot;&gt;a/b/temp&lt;/code&gt; from the root directory. To match 2 levels deep only, you need to write &lt;code class=&quot;language-text&quot;&gt;*/*/temp&lt;/code&gt; and for arbitrary levels, use &lt;code class=&quot;language-text&quot;&gt;**&lt;/code&gt; it will match any number of directory including zero, eg: &lt;code class=&quot;language-text&quot;&gt;**/temp&lt;/code&gt; matches &lt;code class=&quot;language-text&quot;&gt;temp&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;a/temp&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;a/b/temp&lt;/code&gt; !&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Further reading:&lt;/p&gt;
&lt;p&gt;To understand more why you &lt;strong&gt;should not ignore&lt;/strong&gt; &lt;code class=&quot;language-text&quot;&gt;.dockerignore&lt;/code&gt;, read &lt;a href=&quot;https://codefresh.io/docker-tutorial/not-ignore-dockerignore/&quot;&gt;this article&lt;/a&gt;. It gives a lot of insight why &lt;code class=&quot;language-text&quot;&gt;.dockerignore&lt;/code&gt; file is important.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Dynamically load reducers for code splitting in a React Redux application]]></title><link>https://lihautan.com/dynamically-load-async-reducer-for-code-splitting-in-react/</link><guid isPermaLink="false">https://lihautan.com/dynamically-load-async-reducer-for-code-splitting-in-react/</guid><pubDate>Thu, 16 Nov 2017 08:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;p&gt;This article assumes you have basic knowledge on React and Redux. If you like to learn more about React or Redux, you can go here to learn more.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;h2&gt;Context&lt;/h2&gt;
&lt;p&gt;A common pattern to write a React Redux application is to have:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a &lt;code class=&quot;language-text&quot;&gt;rootReducer&lt;/code&gt; that imports &lt;strong&gt;all the reducers&lt;/strong&gt; that will be used in the application&lt;/li&gt;
&lt;li&gt;a &lt;code class=&quot;language-text&quot;&gt;reduxStore&lt;/code&gt; that is created using &lt;code class=&quot;language-text&quot;&gt;rootReducer&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;the React application&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/reduxjs/react-redux&quot;&gt;react-redux&lt;/a&gt; that bridge React components and Redux together&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is what its going to be look like in code:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// root.js&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; React &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Provider &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react-redux&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; store &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt;  &lt;span class=&quot;token string&quot;&gt;&apos;./store&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; CustomComponent &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./CustomComponent&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;App&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// react-redux provider to provide the store in React context&lt;/span&gt;
    &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;Provider&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;store&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;store&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;CustomComponent&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;Provider&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// store.js&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; createStore&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; combineReducers &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;redux&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// import all your reducers here&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; reducerA &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./reducerA&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; reducerB &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./reducerB&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; reducerC &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./reducerC&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// combine all your reducers here&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; rootReducer &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;combineReducers&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  reducerA&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; reducerA&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  reducerB&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; reducerB&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  reducerC&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; reducerC&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// create the redux store!&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; store &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;createStore&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rootReducer&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// CustomComponent.js&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; React &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; connect &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react-redux&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;CustomComponent&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;div&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;mapStateToProps&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; state &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;mapDispatchToProps&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; dispatch &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;connect&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mapStateToProps&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; mapDispatchToProps&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CustomComponent&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2&gt;Problem&lt;/h2&gt;
&lt;p&gt;Everything seemed perfect, until your app size increases too fast…&lt;/p&gt;
&lt;p&gt;It takes much longer time to load your web app, and things got worse with a crappy internet speed…&lt;/p&gt;
&lt;h2&gt;Solution&lt;/h2&gt;
&lt;p&gt;I know you &lt;a href=&quot;http://lmgtfy.com/?q=code-splitting&quot;&gt;must have googled for the solution online.&lt;/a&gt; &lt;span class=&quot;emoji&quot;&gt;😉&lt;/span&gt;&lt;/p&gt;
&lt;p&gt;So, lets talk about one of the solutions that you can do to make your app bundle smaller  — &lt;a href=&quot;https://webpack.js.org/guides/code-splitting/&quot;&gt; code splitting using webpack&lt;/a&gt;!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code splitting is one of the most compelling features of webpack. This feature allows you to split your code into various bundles which can then be loaded on demand or in parallel. It can be used to achieve smaller bundles and control resource load prioritization which, if used correctly, can have a major impact on load time. —&lt;a href=&quot;https://webpack.js.org/guides/code-splitting/&quot;&gt; webpack&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Great! Webpack provides &lt;a href=&quot;https://webpack.js.org/guides/code-splitting/#dynamic-imports&quot;&gt;import()&lt;/a&gt; syntax, that conforms to the &lt;a href=&quot;https://github.com/tc39/proposal-dynamic-import&quot;&gt;ECMAScript proposal&lt;/a&gt; for dynamic imports. Let’s try to split our code &lt;a href=&quot;https://github.com/ReactTraining/react-router/blob/master/packages/react-router-dom/docs/guides/code-splitting.md&quot;&gt;based on different entry points of your routes&lt;/a&gt;. This makes perfect sense, user that goes to &lt;code class=&quot;language-text&quot;&gt;mywebsite/foo&lt;/code&gt; do not need code that is written only for &lt;code class=&quot;language-text&quot;&gt;mywebsite/bar&lt;/code&gt;!&lt;/p&gt;
&lt;p&gt;By now, you should realise, reducer that is written only for &lt;code class=&quot;language-text&quot;&gt;mywebsite/bar&lt;/code&gt;, shouldn’t be imported or included when you are visiting &lt;code class=&quot;language-text&quot;&gt;mywebsite/foo&lt;/code&gt;!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Then how do I dynamically load reducers for code splitting in a Redux application?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;That’s a &lt;a href=&quot;https://stackoverflow.com/questions/32968016/how-to-dynamically-load-reducers-for-code-splitting-in-a-redux-application&quot;&gt;StackOverflow thread&lt;/a&gt; that you should read about.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;There may be neater way of expressing this — I’m just showing the idea.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Yes, one of a neater way is to write a higher order component that takes care of dynamically loading of reducers.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; React &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; gameReducer &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;./gameReducer&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; injectReducer &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;inducer&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CustomComponent&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Component&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// component logic here&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;injectReducer&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  game&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; gameReducer
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CustomComponent&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://www.npmjs.com/package/inducer&quot;&gt;inducer&lt;/a&gt; (read: &lt;strong&gt;In&lt;/strong&gt;ject Re&lt;strong&gt;ducer&lt;/strong&gt;) gives you a HOC that will add you reducer to the Redux store that is currently using during &lt;code class=&quot;language-text&quot;&gt;componentWillMount&lt;/code&gt; and remove it during &lt;code class=&quot;language-text&quot;&gt;componentWillUnmount&lt;/code&gt;. It’s that simple!&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;So, how does inducer actually works?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Firstly, inducer HOC gets the store from context, provided from the StoreProvider of &lt;code class=&quot;language-text&quot;&gt;react-redux&lt;/code&gt; .&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;InjectReducer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;contextTypes &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  store&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; PropTypes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;shape&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
     replaceReducer&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; PropTypes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;func&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;isRequired&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Next, inducer HOC comes up with the new async root reducer that includes the reducer you want to include, and use &lt;a href=&quot;https://redux.js.org/api/store#replaceReducer&quot;&gt;replaceReducer&lt;/a&gt; from Redux to updates the reducer.&lt;/p&gt;
&lt;p&gt;When &lt;code class=&quot;language-text&quot;&gt;componentWillUnmount&lt;/code&gt; inducer will remove your reducer and call &lt;code class=&quot;language-text&quot;&gt;replaceReducer&lt;/code&gt; again!&lt;/p&gt;
&lt;p&gt;You can read the &lt;a href=&quot;https://github.com/tanhauhau/inducer/blob/master/src/index.js&quot;&gt;complete code&lt;/a&gt; here!&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Random stuff that I’ve learned from a browser’s developer console]]></title><link>https://lihautan.com/random-stuff-i-learned-from-browser-console/</link><guid isPermaLink="false">https://lihautan.com/random-stuff-i-learned-from-browser-console/</guid><pubDate>Wed, 20 Apr 2016 08:00:00 GMT</pubDate><content:encoded>&lt;p&gt;On one normal day, I opened up my browser’s developer console for no reason. The page I was on, at that moment, was Facebook. And I saw a big red “Stop” in the console, and followed by a big bolded text of “This is a browser feature intended for developers….”.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/07810825ea3107a242fd0b5d9141f6d9/61f10/fb.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 55.58333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABoklEQVQoz4WSS2/TQBDH/Un5GHDkiASX3ipuFRIihwLHtiqUqqINxC5pabFdv5P4GWf92KcdJzZjcykSLb/DaDS7/53dnb90cqFfq75yM3uz/3Vn7+zF7uGzl++fPH33+ezStoy7AU3TjAFIfummqqqaqkJdUpzYCdAKYcbrrmvb7Wa9XuclFVxUVS0gDAghKKWEkEXKipJAhjGWdC/0/BhjCiWImFDKGGxtmqb7H1KG8mARRlGyTFEBDeumbdvNBvr/W9zeFzNKOSNlkaEkxGlQC1ZX4hHxX50Tz3DlT9bkxJh+0073nen50vqZBW4vbnseE9vjg8u9599HO8rxR/lwJH94/WP06vbo7Z/O7cP04tgzLeX0ajK+UibXijydXCxuxmXiEMctjr9Uc394aPvAh+UkTFbLNEtSlKTZCuWYim3XpXFsyoqjarP5fDbguq7v+5B4rhsGAUxPylFRMdoMbIHNtq5qzlgcx4ZjW7Z9p+u9UfQe0zTBKrZtR1EEe6WynyxHqMyKcpUhxjm4g1BGCIMj7iM4B5PAOlwYxgHO+Q0Pk2Acj5Ez5gAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;fb&quot;
        title=&quot;&quot;
        src=&quot;/static/07810825ea3107a242fd0b5d9141f6d9/623ee/fb.png&quot;
        srcset=&quot;/static/07810825ea3107a242fd0b5d9141f6d9/816c5/fb.png 148w,
/static/07810825ea3107a242fd0b5d9141f6d9/c766b/fb.png 295w,
/static/07810825ea3107a242fd0b5d9141f6d9/623ee/fb.png 590w,
/static/07810825ea3107a242fd0b5d9141f6d9/e5345/fb.png 885w,
/static/07810825ea3107a242fd0b5d9141f6d9/7a439/fb.png 1180w,
/static/07810825ea3107a242fd0b5d9141f6d9/84fe0/fb.png 1770w,
/static/07810825ea3107a242fd0b5d9141f6d9/61f10/fb.png 2400w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;I paused for a while, amazed by what I’ve discovered randomly. This is quite interesting and I have two questions come up to my mind.&lt;/p&gt;
&lt;h2&gt;1. Is Facebook the only site that leaves message in the console?&lt;/h2&gt;
&lt;p&gt;It turns out to be &lt;strong&gt;NO. It’s not just Facebook.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;This is what I found out after some random searches: Oculus and Coursera are hiring people through the console!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/d9e733e21a2ce79b2415772c6199891c/61f10/oc.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 56.08333333333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABuElEQVQoz42Rz0sbQRTH9+/qob336qUglRgPHqMWxR+UoK30JHgRKUgJqFdF8CJCqsSb26bJ/shusj9mq9kfs9nZWXfNrBvS9Ll6KPQQPwxvHm/e4w3fL3dxcWkYBvawk+O6LsbYNJEsy6IoQpQk6SlRVFVq/Go0m01BFARBkmQOWgkhjPXjnCAIwjD0fT+Kon7OfU6SJFChUYS8mIT0MaeUs23b0PWD/cNa7Yrnf+zs7h4dH0M3Y2w0Du7s/PtB5bA0/2FpcaVQnJ18PzVdnKlWq39y/h/4t8SdnJ7tff22sba6sLBYnJktzZUKhUKlUoG34XA4ZnO320UI/eT5FqCoEEAekDDLsvHfJjmgAA1D0CDMgUqapuOHe70eLJfAilZLVVW4TdP0/R5j6Ys2wypwCDwDkz0PQ/5oHtEfXGFAOqPUGaX288nc0cAbPDgxNROKOE1ri6Jwfc0LjXpbVcA2Xdc6uubpcmyKd6gVG2Ki1e86dWZJQ4KywAhchTgK9drc9tbH5eW5V6/fvJt4u742v/m5vPnlU3mjzF/WmIOpdRtZNxGyKPpNDSu5te+xnzhuYjt9D/8FUddEjC/OipoAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;oc&quot;
        title=&quot;&quot;
        src=&quot;/static/d9e733e21a2ce79b2415772c6199891c/623ee/oc.png&quot;
        srcset=&quot;/static/d9e733e21a2ce79b2415772c6199891c/816c5/oc.png 148w,
/static/d9e733e21a2ce79b2415772c6199891c/c766b/oc.png 295w,
/static/d9e733e21a2ce79b2415772c6199891c/623ee/oc.png 590w,
/static/d9e733e21a2ce79b2415772c6199891c/e5345/oc.png 885w,
/static/d9e733e21a2ce79b2415772c6199891c/7a439/oc.png 1180w,
/static/d9e733e21a2ce79b2415772c6199891c/84fe0/oc.png 1770w,
/static/d9e733e21a2ce79b2415772c6199891c/61f10/oc.png 2400w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    
Oculus hiring people through the console&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/b1a93a23ac37bd5e97430af57db415c4/61f10/coursera.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 55.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAACA0lEQVQoz4WSy2sTURTG518QXLlzIRaKWtOMIkpduBHiQtyJLoqopQtBEdSAdCGxKt1VrMShKWIEF7FQbTZWghBdiNZpJvNIwuiYJjGZmbxn7tw7cycz3owoRXz8OBzO5XD4zuF+VL1WEwRR13XsIIQgxtjzPGgBRVFEUSwWi4VCQZKkUgApBUkSRPFHi5qfuzO2a+elydPv361lXq/kch/qjSq7nm23ddt24E8syzIMo9frb+qg2+sb/SFUZOLg2UOjj25HM2/Wlp8n06vL7Aa7uvJMU+u+75Mt/L9D7di+7fqZk5cvnpu7N7vI3F9KxNPplwlmvlL5+sfhrW9qdPfIqciJw+FQ9Ma1u7GZ2K2ZhYcPZmM3Zbn0f+Xpqano1SvTF84/eZxILjGLTDyVSjHxBUnkSXswcAOxrfFrA496mkwKee7T+keOy3M8z7IbHJd7m82yLBsMD/6lPB7aT4/tCe/be2Ti6LHjEZo+QI+H6HAo8+qF70PUVzFoDuwutlrQ0DDqDFwTwg4EbWR1qHarJZaUuqaXy9UvymalprVVuVKWVFXXGtVGvaqr34DRRdA0jI4FDBsNfw2APoKAIosh28Gui7HrOJiU2IEutjWtyfMCL4hcPi/Ln1VNc93fT6CaQ4jB9GYQJjBNExAXkExsQFxBUrfbIxAZL4CMOc7Qj98BPDwrKE3aC3kAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;coursera&quot;
        title=&quot;&quot;
        src=&quot;/static/b1a93a23ac37bd5e97430af57db415c4/623ee/coursera.png&quot;
        srcset=&quot;/static/b1a93a23ac37bd5e97430af57db415c4/816c5/coursera.png 148w,
/static/b1a93a23ac37bd5e97430af57db415c4/c766b/coursera.png 295w,
/static/b1a93a23ac37bd5e97430af57db415c4/623ee/coursera.png 590w,
/static/b1a93a23ac37bd5e97430af57db415c4/e5345/coursera.png 885w,
/static/b1a93a23ac37bd5e97430af57db415c4/7a439/coursera.png 1180w,
/static/b1a93a23ac37bd5e97430af57db415c4/84fe0/coursera.png 1770w,
/static/b1a93a23ac37bd5e97430af57db415c4/61f10/coursera.png 2400w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    
Coursera did the same thing too!&lt;/p&gt;
&lt;p&gt;It seems like this is a good place to hire web stack developer. Since the only person who is going to look into the console of your page is a web developer, or a full stack developer, hiring them through your console isn’t a bad idea after all.&lt;/p&gt;
&lt;h2&gt;2. How did the Facebook printed out a styled text in the console?&lt;/h2&gt;
&lt;p&gt;Actually it turns out it is very simple indeed. You can follow &lt;a href=&quot;http://stackoverflow.com/a/22156044/1513547&quot;&gt;the StackOverflow thread&lt;/a&gt; to see how it is done.&lt;/p&gt;
&lt;h2&gt;3. So can the console print out images?&lt;/h2&gt;
&lt;p&gt;It’s a &lt;strong&gt;YES&lt;/strong&gt; again. But how?&lt;/p&gt;
&lt;p&gt;You can refer to this awesome &lt;a href=&quot;https://github.com/adriancooney/console.image&quot;&gt;console.image&lt;/a&gt; library developed by adriancooney. He will explain how he did it to you.&lt;/p&gt;
&lt;h2&gt;So, why not create an express middleware for this?&lt;/h2&gt;
&lt;p&gt;This was the random idea that came out from my mind after seeing websites leaving messages in the console. Why not have an express middleware that injects a script that prints to the console for each html pages served from the &lt;a href=&quot;http://expressjs.com/&quot;&gt;express server&lt;/a&gt;. It should have an simple intuitive API, and should not pollute to the global namespace at all.&lt;/p&gt;
&lt;p&gt;So, &lt;a href=&quot;https://www.npmjs.com/package/express-console-warning&quot;&gt;this is what I’ve come up&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I know, the name is mouthful and awkward. This is because initially I intended the middleware to just print out a warning message. After a bit of consideration, turns out that hiring in the console should be a good use case too. But the name of the package just stuck there.&lt;/p&gt;
&lt;p&gt;So, how do you use it?&lt;/p&gt;
&lt;p&gt;It’s simple. See the code snippet below:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; express &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;express&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
        app &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;express&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
	hr &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;require&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;express-console-warning&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
	
app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;hr&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;LOG&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Hello world&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;This is a blue text&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;color&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;blue&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fontSize&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;x-large&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;and this is red&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;color&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;red&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; fontSize&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;x-large&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;http://memesvault.com/wp-content/uploads/Best-Meme-Faces-14.png&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
	  &lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
app&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;use&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;express&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;static&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;client&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;And there you go.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0d034d4c9a6d743fa5d4024b79e53a86/61f10/express-console-warning.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 55.75%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAAAq0lEQVQoz7XRSw6DIBCAYe5/p8ZLNAo+NtpGW2KsDIwCCiWuTNTGLvy2k5/JBFIURVlWTfPyK9ZaSilb0EUaMBZTdk/SeBFGxO+Z53lYQUSllATBO3hwqaToewEA+7Fzzp9wTXymv2azEPARYKdpOzXW4IBaa3LwqON1X+b8XY92kw96aLtWgjyKPfJWVM+xg53Negyfp40hRwcnlN6iSCH+fXMAIPMsw5/xF1sNhL64xQjRAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;express-console-warning&quot;
        title=&quot;&quot;
        src=&quot;/static/0d034d4c9a6d743fa5d4024b79e53a86/623ee/express-console-warning.png&quot;
        srcset=&quot;/static/0d034d4c9a6d743fa5d4024b79e53a86/816c5/express-console-warning.png 148w,
/static/0d034d4c9a6d743fa5d4024b79e53a86/c766b/express-console-warning.png 295w,
/static/0d034d4c9a6d743fa5d4024b79e53a86/623ee/express-console-warning.png 590w,
/static/0d034d4c9a6d743fa5d4024b79e53a86/e5345/express-console-warning.png 885w,
/static/0d034d4c9a6d743fa5d4024b79e53a86/7a439/express-console-warning.png 1180w,
/static/0d034d4c9a6d743fa5d4024b79e53a86/84fe0/express-console-warning.png 1770w,
/static/0d034d4c9a6d743fa5d4024b79e53a86/61f10/express-console-warning.png 2400w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;&lt;em&gt;Disclaimer: I did not own the meme. I got the link from Google search just to try out the API.&lt;/em&gt;&lt;/p&gt;
&lt;h2&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;So, these are what I’ve learned from a random action (open the developer console) and what I’ve created from it (express-console-warning).&lt;/p&gt;
&lt;p&gt;express-console-warning &lt;a href=&quot;https://github.com/tanhauhau/express-console-warning&quot;&gt;github&lt;/a&gt; &lt;a href=&quot;http://npmjs.com/package/express-console-warning&quot;&gt;npm&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[5 Steps to build NodeJS using Travis CI]]></title><link>https://lihautan.com/5-steps-to-build-nodejs-using-travis-ci/</link><guid isPermaLink="false">https://lihautan.com/5-steps-to-build-nodejs-using-travis-ci/</guid><pubDate>Wed, 13 Apr 2016 08:00:00 GMT</pubDate><content:encoded>&lt;h2&gt;1. What is Travis CI&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis CI&lt;/a&gt;&lt;/strong&gt; is a &lt;strong&gt;Continuous Integration&lt;/strong&gt; service used to build and test software projects hosted at &lt;a href=&quot;https://github.com&quot;&gt;GitHub&lt;/a&gt;.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Or in simple terms, when you push a commit to the master branch of your project hosted at GitHub, Travis CI will run tests and build the latest commit of your master branch.&lt;/p&gt;
&lt;p&gt;It’s that simple. You push a commit → Travis CI run tests and build. Automatically.&lt;/p&gt;
&lt;h2&gt;2. How do I use Travis CI&lt;/h2&gt;
&lt;p&gt;Go to &lt;a href=&quot;https://travis-ci.org&quot;&gt;Travis CI&lt;/a&gt;. Sign in using your GitHub account. You will be prompted to authorise Travis CI to your GitHub account. Approved that.&lt;/p&gt;
&lt;p&gt;When you see something like this:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/6e3cf01ef134813445a2764dbe24357c/61f10/travis.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 55.666666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABj0lEQVQoz42P3WrCMBTH+x4iIvix1i61tSI6BrvyHVRcBZ9NmF4ovsDEx9jFNhgbY4P1KzZJ07Tdseo+upv9COGf9vxycqQPwLY9z3MzfN8nGUHGITDKGAl3J6DGcRyMsZQmSSxEHMdpCjGhhMA/27bBgQCXUkIfXx7u3bv0DxLmPOD8cAAZM0Ypg4aMsX1PxkQsAroLOP5yoFMYhkII6cl9xZQEIUmTlAr2jN/COAoiQiIaJ3u+nSSGskhECaQM6dV7349FApBBeHSf4Z0e9kPOwYQKcYJz7rgODAJtj/LPGZgI3+jH/v1pkv4DKXe+3Wxms9l8Pr/JmP9msVisVqv1er1cLrfbbV4eDUeFQkGW5VqtVqlUYK9Wq5UTpVKpXC7Dl2KxaFlWXp5Op42G3Ov1Li66pmkipDWOqLBkWVFVtd/vI4TG43FenkwmIF9edjsds9XS223DMJoQYBmG1mwiTUPttlmv10ajYV62rGtNU66uet2uaRio1UK6fq7rsCNVlRWlrihnYMJog8HgE1ed6sXP8zTtAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;travis&quot;
        title=&quot;&quot;
        src=&quot;/static/6e3cf01ef134813445a2764dbe24357c/623ee/travis.png&quot;
        srcset=&quot;/static/6e3cf01ef134813445a2764dbe24357c/816c5/travis.png 148w,
/static/6e3cf01ef134813445a2764dbe24357c/c766b/travis.png 295w,
/static/6e3cf01ef134813445a2764dbe24357c/623ee/travis.png 590w,
/static/6e3cf01ef134813445a2764dbe24357c/e5345/travis.png 885w,
/static/6e3cf01ef134813445a2764dbe24357c/7a439/travis.png 1180w,
/static/6e3cf01ef134813445a2764dbe24357c/84fe0/travis.png 1770w,
/static/6e3cf01ef134813445a2764dbe24357c/61f10/travis.png 2400w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Voila. You have created a Travis CI account.&lt;/p&gt;
&lt;p&gt;Next thing you are going to do is to click the &lt;code class=&quot;language-text&quot;&gt;(+)&lt;/code&gt; button beside the &lt;em&gt;“My Repositories”&lt;/em&gt; on the left.&lt;/p&gt;
&lt;p&gt;You will then see a list of projects on your GitHub.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/4bf79c589919e8f4fcacb7c8f4fda005/61f10/travis-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 55.541666666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAAsSAAALEgHS3X78AAABIElEQVQoz5WSu07DQBBF/ecUCIREiZQW+AYKSrqIwkBj2RayoIUEbO/b++bGG4wTEIJbrGbGe+bujJzFUcMwKKXip5AyiLIQQpwJyYtUT++tH+vZdBuaLjlrCe8JJ84aZ/Xl+UWe56g/3N+dLRZciXRtA6M9E1xrneLk9fj2/EpWwRqm6MHp4e1yieLVzfXRybG3+gv2MRDJpRDzRzLJKCXGaGM1lXRQ0hrNFBMSNsOOsxCCC4Gxkz+C9WrtnDOgtcYU274heu8nj+3MqQQBQNp1XVmWINFUSol1IMa5t78s7ip9BlxVFQA+CuaI557/gOEJMn7Tz3Df93VdW2sxPJ6dFvFXuG3boijAJOfN/0JpWsdvcBIhpGma5Dxpb2DoA1uffdH1gXVKAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;travis&quot;
        title=&quot;&quot;
        src=&quot;/static/4bf79c589919e8f4fcacb7c8f4fda005/623ee/travis-2.png&quot;
        srcset=&quot;/static/4bf79c589919e8f4fcacb7c8f4fda005/816c5/travis-2.png 148w,
/static/4bf79c589919e8f4fcacb7c8f4fda005/c766b/travis-2.png 295w,
/static/4bf79c589919e8f4fcacb7c8f4fda005/623ee/travis-2.png 590w,
/static/4bf79c589919e8f4fcacb7c8f4fda005/e5345/travis-2.png 885w,
/static/4bf79c589919e8f4fcacb7c8f4fda005/7a439/travis-2.png 1180w,
/static/4bf79c589919e8f4fcacb7c8f4fda005/84fe0/travis-2.png 1770w,
/static/4bf79c589919e8f4fcacb7c8f4fda005/61f10/travis-2.png 2400w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;If the list of repositories is empty, click “Sync account” to fetch all your repositories.&lt;/p&gt;
&lt;p&gt;Turn on one of your project for Continuous Integration!&lt;/p&gt;
&lt;p&gt;That’s all.&lt;/p&gt;
&lt;h2&gt;3. How to build a Node.js project using Travis CI&lt;/h2&gt;
&lt;p&gt;Create a file name &lt;code class=&quot;language-text&quot;&gt;.travis.yml&lt;/code&gt; at the root folder of your project.&lt;/p&gt;
&lt;p&gt;Copy this into the file.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;travis.yml:&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yml&quot;&gt;&lt;pre class=&quot;language-yml&quot;&gt;&lt;code class=&quot;language-yml&quot;&gt;language: node_js
node_js:
  - 4.2&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Commit and Push. That’s simple.&lt;/p&gt;
&lt;p&gt;Or if you are lazy, run this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;curl https://gist.githubusercontent.com/tanhauhau/405e39884e80288615a7b51181fd5228/raw/9045c2e219547f0a228da630abff345d8add0c47/.travis.yml &amp;gt; .travis.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The version of Node.js I am using is 4.2 at the time of writing this article. To be safe, you can run “node — version” on your command line to determine which version of Node.js you are running.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Make sure that you have all your dependencies persists to the package.json as Travis CI will install all the dependencies from it by calling npm install.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Another thing to take note is that if you wanna run your test script, make sure to include it in the &lt;code class=&quot;language-text&quot;&gt;package.json&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ea1fc213261bc9adc9f16d577d1cf7a3/cffd4/package-json.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 44.66145833333333%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAJCAIAAAC9o5sfAAAACXBIWXMAAAsSAAALEgHS3X78AAABLklEQVQoz3WQ62rCQBCF8x657XVm9hpjjDGJim1BSqH91fd/lm5iQQSFj2XZ2TNz5mTKKrtDrhUEZbZAG6AWyloUFb9R1i/JXI/jd+wu3vVm+Az7a4AAAhSTgqmELNlrsR+ov/r24roPH0e7fbObk40TJQu2xzASV2qZ/6xFFg40/zRJ1r+n01CrFemi4HnO8pLlBSvKm3/2RFwLGY8URsOVtgP4GcNMYcZ4ojChnygekTqdXGCrU6MHMQULEaRVwkhFIFBykEwLruW6s+Ag6nX/SojyMb8s1ebfsP/ym4tpJl/VsigXh8uQauFp7BVbyCombQ8pYbfHeKY4k9lB8uwGcAf0I5oOwpGaMyXzfkI3pBQxlZKXzDQWG1BWK69qIe7IlfWe/v3f5f09zf8DUz9QL41BfhYAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;packagejson&quot;
        title=&quot;&quot;
        src=&quot;/static/ea1fc213261bc9adc9f16d577d1cf7a3/623ee/package-json.png&quot;
        srcset=&quot;/static/ea1fc213261bc9adc9f16d577d1cf7a3/816c5/package-json.png 148w,
/static/ea1fc213261bc9adc9f16d577d1cf7a3/c766b/package-json.png 295w,
/static/ea1fc213261bc9adc9f16d577d1cf7a3/623ee/package-json.png 590w,
/static/ea1fc213261bc9adc9f16d577d1cf7a3/cffd4/package-json.png 768w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;h2&gt;4. How do I use bower and install bower dependencies&lt;/h2&gt;
&lt;p&gt;If you are using bower, add a before_script for .travis.yml&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;yml&quot;&gt;&lt;pre class=&quot;language-yml&quot;&gt;&lt;code class=&quot;language-yml&quot;&gt;language: node_js
node_js:
  - 4.2
before_script:
  - npm install -g bower
  - bower install&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Or likewise if you are lazy, copy and paste this to your command line.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sh&quot;&gt;&lt;pre class=&quot;language-sh&quot;&gt;&lt;code class=&quot;language-sh&quot;&gt;curl https://gist.githubusercontent.com/tanhauhau/71998bf221810186f046db94cda10c4e/raw/d1e8aee0981a96c20f94de6db386da048face423/.travis.yml &amp;gt; .travis.yml&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;One thing to take note for bower is that when there is dependency conflict, bower will ask you to choose which version of the dependency to be installed interactively. In the case for Travis CI, Travis CI will not know which version to install it for you where you will see an error like this:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/a6db19b080c368076dded9856cdfc138/d6f10/bower.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 22.386483632523756%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAECAIAAAABPYjBAAAACXBIWXMAAAsSAAALEgHS3X78AAAApUlEQVQI122PXQ6DIBCEPYmAgFLYxRQpuvh3AX3w/pcpaWLSJv0y2czDTna2Os/TAzz3XYbQez/PMxFt27YsS/GZKOccY3TOSSmbGyGEMaY6jgMAx5wfiN77kkwpres6TtNEVEYIYRiG/+FymTNmlDKy0VK2St36eK2kEHVdM8bEF5zzruuq67qcfdCY0ium0i8EsLYH8M6Vd9BZBFf22l+01oj4Bil2KiE8c67XAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;bower&quot;
        title=&quot;&quot;
        src=&quot;/static/a6db19b080c368076dded9856cdfc138/623ee/bower.png&quot;
        srcset=&quot;/static/a6db19b080c368076dded9856cdfc138/816c5/bower.png 148w,
/static/a6db19b080c368076dded9856cdfc138/c766b/bower.png 295w,
/static/a6db19b080c368076dded9856cdfc138/623ee/bower.png 590w,
/static/a6db19b080c368076dded9856cdfc138/e5345/bower.png 885w,
/static/a6db19b080c368076dded9856cdfc138/7a439/bower.png 1180w,
/static/a6db19b080c368076dded9856cdfc138/84fe0/bower.png 1770w,
/static/a6db19b080c368076dded9856cdfc138/d6f10/bower.png 1894w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Therefore, you will have to &lt;a href=&quot;https://jaketrent.com/post/bower-resolutions/&quot;&gt;persists the resolution to bower.json&lt;/a&gt; to avoid the build error.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;5. Include a Travis CI badge&lt;/h2&gt;
&lt;p&gt;To summarise, you have set up your Travis CI, copied and pasted the &lt;code class=&quot;language-text&quot;&gt;.travis.yml&lt;/code&gt; to your project, commited and pushed your project to GitHub, and Travis CI had built and tested your project.&lt;/p&gt;
&lt;p&gt;Now, it’s time to add a badge to your GitHub repository!&lt;/p&gt;
&lt;p&gt;Simply clicked the badge in Travis CI and choose for Markdown.&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/7b58bf8025eb10e655b552d925bbdd74/7f37b/badge.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 48.854166666666664%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAIAAAA7N+mxAAAACXBIWXMAAAsSAAALEgHS3X78AAABTUlEQVQoz3VRS27CMBD1JbJhSRcgUFY5AIdAQpyABefgMKw4AMeoVKmq+pGqLiog8dhO4l+S9iUuASrxNHqKxzOeNy8sz/OyLIUQugOORVEgY7T5+Hp/oSffuJ87YESEzsPhoDocj0fOuVASzW+fr8/Z47/muq6rqgI3TcO8cwicjTHee7DznozFfV+NOnwEds5BFxh5ZtFQVejGXairz+gmVKhzWtd53ljbPxEKWGmMtO3QNn0HRmtJlCuFmVAXnmhlC46tCT5Jqf5CXUJIBQchwVob9uqXb5tTUt8nTkqTKgNzeYlMFG2SCI6ergBfoYLhz/Asg+FSSjDq4Dn+WXkGhmw2m9lsNp/PF4tF4OVyud/vGST5W9RnnwHcgtfrdRRFDx2m0+lwOIzjeLfbsTRN+S2yK0AhVl2tVoPBYDQajcfjJEkmkwle2W63v9wbEueK/QBpAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;badge&quot;
        title=&quot;&quot;
        src=&quot;/static/7b58bf8025eb10e655b552d925bbdd74/623ee/badge.png&quot;
        srcset=&quot;/static/7b58bf8025eb10e655b552d925bbdd74/816c5/badge.png 148w,
/static/7b58bf8025eb10e655b552d925bbdd74/c766b/badge.png 295w,
/static/7b58bf8025eb10e655b552d925bbdd74/623ee/badge.png 590w,
/static/7b58bf8025eb10e655b552d925bbdd74/e5345/badge.png 885w,
/static/7b58bf8025eb10e655b552d925bbdd74/7a439/badge.png 1180w,
/static/7b58bf8025eb10e655b552d925bbdd74/84fe0/badge.png 1770w,
/static/7b58bf8025eb10e655b552d925bbdd74/7f37b/badge.png 1920w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;Copy and paste the line into your README.md.&lt;/p&gt;
&lt;p&gt;Commit and Push.&lt;/p&gt;
&lt;p&gt;And now you have a Travis CI badge on your repo!&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/5b0b15e75e2202e4528806c42c473b35/513bc/badge-2.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 65.41200406917599%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAIAAAAmMtkJAAAACXBIWXMAAAsSAAALEgHS3X78AAAA+klEQVQoz5WSyW6DMBCGef93aV+hpyj3HmgIQiEBgZFj43gHL+kkXOghMf0lS5Y93+xZjNEYo7U2K1lr5cR9dPe3yrz3P3leVdXxWJRl+bgUxeFQ7E5fdMZgAd5fwiGEruvatkUIvbF7CQ/D0DTNGo6L7glfGRyokFyvjDEpFedcCPGPyJTScRwJIfNTzrmtMDSsri/Vqa7PjXMenkKI4alkCyBynKY5Bh+8wxj3CEtthTQ3rrwPyZpjftafe/mxV7tvioceioDMYdhpGHJjwiJqe2Ipt8u+wAfUnoYhbSWlUUIKJvgN1muZ1UY4LH1aT3g7/LCLf7UR/gW3YfnzSWhGkQAAAABJRU5ErkJggg==&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;badge&quot;
        title=&quot;&quot;
        src=&quot;/static/5b0b15e75e2202e4528806c42c473b35/623ee/badge-2.png&quot;
        srcset=&quot;/static/5b0b15e75e2202e4528806c42c473b35/816c5/badge-2.png 148w,
/static/5b0b15e75e2202e4528806c42c473b35/c766b/badge-2.png 295w,
/static/5b0b15e75e2202e4528806c42c473b35/623ee/badge-2.png 590w,
/static/5b0b15e75e2202e4528806c42c473b35/e5345/badge-2.png 885w,
/static/5b0b15e75e2202e4528806c42c473b35/7a439/badge-2.png 1180w,
/static/5b0b15e75e2202e4528806c42c473b35/84fe0/badge-2.png 1770w,
/static/5b0b15e75e2202e4528806c42c473b35/513bc/badge-2.png 1966w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;</content:encoded></item></channel></rss>