{"componentChunkName":"component---src-templates-note-post-js","path":"/notes/2019-09-30-node-experimental-modules/","webpackCompilationHash":"08dd4942e43d8158d175","result":{"data":{"site":{"siteMetadata":{"title":"Tan Li Hau","author":"Tan Li Hau"}},"markdownRemark":{"html":"<p>To enable es module system in nodejs, it’s not as simple as enabling the <code class=\"language-text\">--experimental-modules</code> flag.</p>\n<p>You need:</p>\n<ul>\n<li><strong>use <code class=\"language-text\">.mjs</code> file format to hint as a es module</strong> or <strong>at the nearest <code class=\"language-text\">package.json</code>, specify <code class=\"language-text\">&quot;type&quot;: &quot;module&quot;</code></strong></li>\n<li>use <code class=\"language-text\">import</code> statement to “require” the module file -> meaning your main file also need to be a <code class=\"language-text\">.mjs</code> file.</li>\n<li>\n<p>to replace all “require” and “module.exports” in <code class=\"language-text\">.mjs</code> file to <code class=\"language-text\">import</code>.</p>\n<ul>\n<li>as an escape hatch, you can use <a href=\"https://nodejs.org/api/modules.html#modules_module_createrequire_filename\"><code class=\"language-text\">module.createRequire</code></a></li>\n<li>see <a href=\"https://nodejs.org/api/esm.html#esm_no_code_require_code_code_exports_code_code_module_exports_code_code_filename_code_code_dirname_code\">https://nodejs.org/api/esm.html#esm<em>no</em>code<em>require</em>code<em>code</em>exports<em>code</em>code<em>module</em>exports<em>code</em>code<em>filename</em>code<em>code</em>dirname_code</a></li>\n</ul>\n</li>\n<li>es modules import file must specify extension, <code class=\"language-text\">.mjs</code> (es modules), <code class=\"language-text\">.cjs</code> (commonjs) or <code class=\"language-text\">.js</code> (depends on nearest <code class=\"language-text\">package.json#type</code>). </li>\n<li>for commonjs to import es modules, the only way is to use dynamic import <code class=\"language-text\">import()</code>.</li>\n</ul>","excerpt":"","fields":{"noteDate":"2019-09-30","noteTitle":"node experimental modules"},"frontmatter":{"title":"","date":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/notes/2019-09-30-node-experimental-modules/","type":"notes","noteDate":"2019-09-30","noteTitle":"node experimental modules","wip":false,"heroImageUrl":null,"heroTwitterImageUrl":null,"previous":{"id":"6f126bdb-d5fb-5574-b04c-2f0186cbb4c1","fields":{"slug":"/notes/2019-10-01-puppeteer/","type":"notes","noteDate":"2019-10-01","noteTitle":"puppeteer","wip":false},"frontmatter":{"title":""}},"next":{"id":"30fa889c-288e-5d2c-ad28-0196cc6beb56","fields":{"slug":"/notes/2019-09-27-regex-lazy/","type":"notes","noteDate":"2019-09-27","noteTitle":"regex lazy","wip":false},"frontmatter":{"title":""}}}}}