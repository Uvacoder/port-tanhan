{"componentChunkName":"component---src-templates-blog-post-js","path":"/who-accessed-my-property/","webpackCompilationHash":"d6d46818d98a78928580","result":{"data":{"site":{"siteMetadata":{"title":"Tan Li Hau","author":"Tan Li Hau"}},"markdownRemark":{"id":"78c4db3c-e242-5e82-b3e7-cb2c7b64df34","excerpt":"","html":"<p>Say you defined an object <code class=\"language-text\">const obj = { awesome: true }</code> so that anywhere within your code, you can access the value of <code class=\"language-text\">obj.awesome</code> as well as modify its value via <code class=\"language-text\">obj.awesome = false</code>.</p>\n<p><strong>Question</strong>: How do you know where and when <code class=\"language-text\">obj.awesome</code> is being accessed or modified?</p>\n<hr>\n<p><strong>So why is this important?</strong> If you are using frontend framework that does <a href=\"https://stackoverflow.com/a/13504965\">2-way binding</a>, eg: <a href=\"https://angular.io/guide/ajs-quick-reference#ng-model\">Angular</a>, <a href=\"https://vuejs.org/v2/guide/forms.html\">Vue</a>, do you know how does the framework “watch” your <code class=\"language-text\">state</code> object? How does the framework knows when to update your DOM when you set some property of the <code class=\"language-text\">state</code> object?</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// setting a property in the `$scope` object triggers</span>\n<span class=\"token comment\">// the framework to update the model and the DOM</span>\n$scope<span class=\"token punctuation\">.</span>name <span class=\"token operator\">=</span> <span class=\"token string\">'Hello'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<hr>\n<p><strong>Answer:</strong> You use <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty\"><code class=\"language-text\">Object.defineProperty()</code></a>.</p>\n<p><code class=\"language-text\">Object.defineProperty(obj, prop, descriptor)</code> allows us to define a property to an object with a descriptor for the property being defined.</p>\n<p>Well, nothing special about defining a property of an object, you can do it easily with <code class=\"language-text\">obj[prop] = value</code>. What so special about this <code class=\"language-text\">Object.defineProperty()</code> is the <code class=\"language-text\">descriptor</code> object that you pass in. Lets’ take a look at what can be configured through the <code class=\"language-text\">descriptor</code>:</p>\n<ul>\n<li>\n<p><code class=\"language-text\">enumerable</code></p>\n<p><code class=\"language-text\">true</code> if and only if this property shows up during enumeration of the properties on the corresponding object.</p>\n<p><strong>Defaults to <code class=\"language-text\">false</code></strong>.</p>\n<p>If you have a property’s <code class=\"language-text\">enumerable</code> set to <code class=\"language-text\">false</code>, meaning you will not see the property when you do <code class=\"language-text\">Object.keys(obj)</code> or <code class=\"language-text\">for (const key in obj) { ... }</code></p>\n</li>\n<li>\n<p><code class=\"language-text\">writable</code></p>\n<p><code class=\"language-text\">true</code> if and only if the value associated with the property may be changed with an assignment operator.</p>\n<p><strong>Defaults to <code class=\"language-text\">false</code></strong></p>\n<p>This allows us to create <code class=\"language-text\">read-only</code> property of an object.</p>\n</li>\n<li>\n<p><code class=\"language-text\">get</code></p>\n<p>A function which serves as a getter for the property, or <code class=\"language-text\">undefined</code> if there is no getter. The return value will be used as the value of the property.</p>\n<p><strong>Defaults to <code class=\"language-text\">undefined</code></strong></p>\n</li>\n<li>\n<p><code class=\"language-text\">set</code></p>\n<p>A function which serves as a setter for the property, or <code class=\"language-text\">undefined</code> if there is no setter. When the property is assigned to, this function is called with one argument (the value being assigned to the property).</p>\n<p><strong>Defaults to <code class=\"language-text\">undefined</code></strong></p>\n</li>\n</ul>\n<p>So, there you have it. What you need is to define the getter and setter function of the property, and they will be called when the property is accessed or being assigned to a value.</p>\n<p>You can add a breakpoint via <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/debugger\"><code class=\"language-text\">debugger;</code></a> in your getter and setter function, to invoke the debugging feature of your development tools to look at the call stack.</p>\n<p>Another way of looking at the call stack without using a debugger is to <strong>throw an Error</strong> in the getter and setter function.</p>\n<p>Yes. You hear me right. Throwing an error will allow you to get the call stack when the error is thrown:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">let</span> _value<span class=\"token punctuation\">;</span>\nObject<span class=\"token punctuation\">.</span><span class=\"token function\">defineProperty</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> <span class=\"token string\">'awesome'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">get</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n<span class=\"gatsby-highlight-code-line\">    <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// intentionally throw an Error to get the call stack</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">throw</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">error</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// stack is the stack trace, </span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// containing error message and the stack</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token keyword\">const</span> stack <span class=\"token operator\">=</span> error<span class=\"token punctuation\">.</span>stack<span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token comment\">// print the callee stack</span></span><span class=\"gatsby-highlight-code-line\">      console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span></span><span class=\"gatsby-highlight-code-line\">        stack</span><span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">.</span><span class=\"token function\">slice</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">          <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span></span><span class=\"gatsby-highlight-code-line\">      <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></span><span class=\"gatsby-highlight-code-line\">    <span class=\"token punctuation\">}</span></span>    <span class=\"token keyword\">return</span> _value<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","fields":{"slug":"/who-accessed-my-property/","wip":false},"frontmatter":{"title":"Who accessed my property?","date":"March 24, 2019","lastUpdated":null,"description":"How to know when object property get accessed or modified","tags":null}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/who-accessed-my-property/","type":"blog","noteDate":null,"noteTitle":null,"wip":false,"heroImageUrl":null,"heroTwitterImageUrl":null,"previous":{"id":"3c04f8ef-c430-57fc-800d-250d6fb3d88a","fields":{"slug":"/understand-the-frontend-tools/","type":"blog","noteDate":null,"noteTitle":null,"wip":false},"frontmatter":{"title":"Understand the frontend tools"}},"next":{"id":"c680f74b-d9a5-5ef2-bb4c-253d485c5cbc","fields":{"slug":"/errors-encountered-upgrading-flow-0.85/","type":"blog","noteDate":null,"noteTitle":null,"wip":false},"frontmatter":{"title":"Errors encountered upgrading Flow v0.85"}}}}}