function n(){}function a(n,a){for(const s in a)n[s]=a[s];return n}function s(n){return n()}function t(){return Object.create(null)}function e(n){n.forEach(s)}function o(n){return"function"==typeof n}function p(n,a){return n!=n?a==a:n!==a||n&&"object"==typeof n||"function"==typeof n}function c(n,s,t,e){return n[1]&&e?a(t.ctx.slice(),n[1](e(s))):t.ctx}function l(n,a,s,t,e,o,p){const l=function(n,a,s,t){if(n[2]&&t){const e=n[2](t(s));if(void 0===a.dirty)return e;if("object"==typeof e){const n=[],s=Math.max(a.dirty.length,e.length);for(let t=0;t<s;t+=1)n[t]=a.dirty[t]|e[t];return n}return a.dirty|e}return a.dirty}(a,t,e,o);if(l){const e=c(a,s,t,p);n.p(e,l)}}function i(n,a){n.appendChild(a)}function r(n,a,s){n.insertBefore(a,s||null)}function u(n){n.parentNode.removeChild(n)}function h(n,a){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(a)}function k(n){return document.createElement(n)}function d(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function f(n){return document.createTextNode(n)}function m(){return f(" ")}function g(){return f("")}function w(n,a,s){null==s?n.removeAttribute(a):n.getAttribute(a)!==s&&n.setAttribute(a,s)}function y(n){return Array.from(n.childNodes)}function v(n,a,s,t){for(let t=0;t<n.length;t+=1){const e=n[t];if(e.nodeName===a){let a=0;const o=[];for(;a<e.attributes.length;){const n=e.attributes[a++];s[n.name]||o.push(n.name)}for(let n=0;n<o.length;n++)e.removeAttribute(o[n]);return n.splice(t,1)[0]}}return t?d(a):k(a)}function E(n,a){for(let s=0;s<n.length;s+=1){const t=n[s];if(3===t.nodeType)return t.data=""+a,n.splice(s,1)[0]}return f(a)}function b(n){return E(n," ")}function I(n,a){a=""+a,n.wholeText!==a&&(n.data=a)}function P(n,a){n.value=null==a?"":a}class x{constructor(n=null){this.a=n,this.e=this.n=null}m(n,a,s=null){this.e||(this.e=k(a.nodeName),this.t=a,this.h(n)),this.i(s)}h(n){this.e.innerHTML=n,this.n=Array.from(this.e.childNodes)}i(n){for(let a=0;a<this.n.length;a+=1)r(this.t,this.n[a],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(u)}}let j;function A(n){j=n}function T(n){(function(){if(!j)throw new Error("Function called outside component initialization");return j})().$$.on_mount.push(n)}const S=[],L=[],O=[],M=[],C=Promise.resolve();let q=!1;function N(n){O.push(n)}let R=!1;const $=new Set;function H(){if(!R){R=!0;do{for(let n=0;n<S.length;n+=1){const a=S[n];A(a),D(a.$$)}for(S.length=0;L.length;)L.pop()();for(let n=0;n<O.length;n+=1){const a=O[n];$.has(a)||($.add(a),a())}O.length=0}while(S.length);for(;M.length;)M.pop()();q=!1,R=!1,$.clear()}}function D(n){if(null!==n.fragment){n.update(),e(n.before_update);const a=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,a),n.after_update.forEach(N)}}const G=new Set;function B(n,a){n&&n.i&&(G.delete(n),n.i(a))}function F(n,a,s,t){if(n&&n.o){if(G.has(n))return;G.add(n),(void 0).c.push(()=>{G.delete(n),t&&(s&&n.d(1),t())}),n.o(a)}}function J(n){n&&n.c()}function U(n,a){n&&n.l(a)}function W(n,a,t){const{fragment:p,on_mount:c,on_destroy:l,after_update:i}=n.$$;p&&p.m(a,t),N(()=>{const a=c.map(s).filter(o);l?l.push(...a):e(a),n.$$.on_mount=[]}),i.forEach(N)}function _(n,a){const s=n.$$;null!==s.fragment&&(e(s.on_destroy),s.fragment&&s.fragment.d(a),s.on_destroy=s.fragment=null,s.ctx=[])}function z(n,a){-1===n.$$.dirty[0]&&(S.push(n),q||(q=!0,C.then(H)),n.$$.dirty.fill(0)),n.$$.dirty[a/31|0]|=1<<a%31}function V(a,s,o,p,c,l,i=[-1]){const r=j;A(a);const h=s.props||{},k=a.$$={fragment:null,ctx:null,props:l,update:n,not_equal:c,bound:t(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(r?r.$$.context:[]),callbacks:t(),dirty:i};let d=!1;if(k.ctx=o?o(a,h,(n,s,...t)=>{const e=t.length?t[0]:s;return k.ctx&&c(k.ctx[n],k.ctx[n]=e)&&(k.bound[n]&&k.bound[n](e),d&&z(a,n)),s}):[],k.update(),d=!0,e(k.before_update),k.fragment=!!p&&p(k.ctx),s.target){if(s.hydrate){const n=y(s.target);k.fragment&&k.fragment.l(n),n.forEach(u)}else k.fragment&&k.fragment.c();s.intro&&B(a.$$.fragment),W(a,s.target,s.anchor),H()}A(r)}class Y{$destroy(){_(this,1),this.$destroy=n}$on(n,a){const s=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return s.push(a),()=>{const n=s.indexOf(a);-1!==n&&s.splice(n,1)}}$set(){}}function K(a){let s,t,e,o,p,c,l,h,g,I,P,x,j,A,T,S,L,O,M,C,q,N,R,$,H,D,G,B,F,J,U,W,_,z,V;return{c(){s=k("header"),t=k("nav"),e=k("ul"),o=k("li"),p=k("a"),c=f("Tan Li Hau"),l=m(),h=k("li"),g=k("a"),I=f("About"),P=m(),x=k("li"),j=k("a"),A=f("Writings"),T=m(),S=k("li"),L=k("a"),O=f("Talks"),M=m(),C=k("li"),q=k("a"),N=f("Notes"),R=m(),$=k("li"),H=k("a"),D=f("Newsletter"),G=m(),B=k("li"),F=k("a"),J=d("svg"),U=d("path"),W=m(),_=k("a"),z=d("svg"),V=d("path"),this.h()},l(n){s=v(n,"HEADER",{class:!0});var a=y(s);t=v(a,"NAV",{});var i=y(t);e=v(i,"UL",{class:!0});var r=y(e);o=v(r,"LI",{class:!0});var k=y(o);p=v(k,"A",{href:!0,class:!0});var d=y(p);c=E(d,"Tan Li Hau"),d.forEach(u),k.forEach(u),l=b(r),h=v(r,"LI",{class:!0});var f=y(h);g=v(f,"A",{href:!0,class:!0});var m=y(g);I=E(m,"About"),m.forEach(u),f.forEach(u),P=b(r),x=v(r,"LI",{class:!0});var w=y(x);j=v(w,"A",{href:!0,class:!0});var Y=y(j);A=E(Y,"Writings"),Y.forEach(u),w.forEach(u),T=b(r),S=v(r,"LI",{class:!0});var K=y(S);L=v(K,"A",{href:!0,class:!0});var Z=y(L);O=E(Z,"Talks"),Z.forEach(u),K.forEach(u),M=b(r),C=v(r,"LI",{class:!0});var Q=y(C);q=v(Q,"A",{href:!0,class:!0});var X=y(q);N=E(X,"Notes"),X.forEach(u),Q.forEach(u),R=b(r),$=v(r,"LI",{class:!0});var nn=y($);H=v(nn,"A",{href:!0,class:!0});var an=y(H);D=E(an,"Newsletter"),an.forEach(u),nn.forEach(u),G=b(r),B=v(r,"LI",{class:!0});var sn=y(B);F=v(sn,"A",{"aria-label":!0,href:!0,class:!0});var tn=y(F);J=v(tn,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var en=y(J);U=v(en,"path",{d:!0},1),y(U).forEach(u),en.forEach(u),tn.forEach(u),W=b(sn),_=v(sn,"A",{"aria-label":!0,href:!0,class:!0});var on=y(_);z=v(on,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var pn=y(z);V=v(pn,"path",{d:!0},1),y(V).forEach(u),pn.forEach(u),on.forEach(u),sn.forEach(u),r.forEach(u),i.forEach(u),a.forEach(u),this.h()},h(){w(p,"href","/"),w(p,"class","svelte-f3e4uo"),w(o,"class","svelte-f3e4uo"),w(g,"href","/about"),w(g,"class","svelte-f3e4uo"),w(h,"class","svelte-f3e4uo"),w(j,"href","/blogs"),w(j,"class","svelte-f3e4uo"),w(x,"class","svelte-f3e4uo"),w(L,"href","/talks"),w(L,"class","svelte-f3e4uo"),w(S,"class","svelte-f3e4uo"),w(q,"href","/notes"),w(q,"class","svelte-f3e4uo"),w(C,"class","svelte-f3e4uo"),w(H,"href","/newsletter"),w(H,"class","svelte-f3e4uo"),w($,"class","svelte-f3e4uo"),w(U,"d","M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66\n    10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5\n    4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"),w(J,"viewBox","0 0 24 24"),w(J,"width","1em"),w(J,"height","1em"),w(J,"class","svelte-f3e4uo"),w(F,"aria-label","Twitter account"),w(F,"href","https://twitter.com/lihautan"),w(F,"class","svelte-f3e4uo"),w(V,"d","M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0\n    0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07\n    5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65\n    5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42\n    3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"),w(z,"viewBox","0 0 24 24"),w(z,"width","1em"),w(z,"height","1em"),w(z,"class","svelte-f3e4uo"),w(_,"aria-label","Github account"),w(_,"href","https://github.com/tanhauhau"),w(_,"class","svelte-f3e4uo"),w(B,"class","social svelte-f3e4uo"),w(e,"class","svelte-f3e4uo"),w(s,"class","svelte-f3e4uo")},m(n,a){r(n,s,a),i(s,t),i(t,e),i(e,o),i(o,p),i(p,c),i(e,l),i(e,h),i(h,g),i(g,I),i(e,P),i(e,x),i(x,j),i(j,A),i(e,T),i(e,S),i(S,L),i(L,O),i(e,M),i(e,C),i(C,q),i(q,N),i(e,R),i(e,$),i($,H),i(H,D),i(e,G),i(e,B),i(B,F),i(F,J),i(J,U),i(B,W),i(B,_),i(_,z),i(z,V)},p:n,i:n,o:n,d(n){n&&u(s)}}}class Z extends Y{constructor(n){super(),V(this,n,null,K,p,{})}}function Q(a){let s,t,e,o,p,c,l,h,d,g,I,x,j,A,T,S,L,O,M,C;return{c(){s=k("div"),t=k("h1"),e=f("Subscribe to my newsletter"),o=m(),p=k("h2"),c=f("Get the latest blog posts and project updates delivered right to your inbox"),l=m(),h=k("form"),d=k("div"),g=k("input"),I=m(),x=k("input"),A=m(),T=k("input"),S=m(),L=k("p"),O=f("Powered by Buttondown."),this.h()},l(n){s=v(n,"DIV",{class:!0});var a=y(s);t=v(a,"H1",{});var i=y(t);e=E(i,"Subscribe to my newsletter"),i.forEach(u),o=b(a),p=v(a,"H2",{class:!0});var r=y(p);c=E(r,"Get the latest blog posts and project updates delivered right to your inbox"),r.forEach(u),l=b(a),h=v(a,"FORM",{action:!0,method:!0,target:!0,onsubmit:!0,class:!0});var k=y(h);d=v(k,"DIV",{class:!0});var f=y(d);g=v(f,"INPUT",{type:!0,name:!0,id:!0,"aria-label":!0,placeholder:!0,class:!0}),I=b(f),x=v(f,"INPUT",{type:!0,value:!0,disabled:!0,class:!0}),f.forEach(u),A=b(k),T=v(k,"INPUT",{type:!0,value:!0,name:!0,class:!0}),S=b(k),L=v(k,"P",{class:!0});var m=y(L);O=E(m,"Powered by Buttondown."),m.forEach(u),k.forEach(u),a.forEach(u),this.h()},h(){w(p,"class","svelte-1k1s1co"),w(g,"type","email"),w(g,"name","email"),w(g,"id","bd-email"),w(g,"aria-label","email address"),w(g,"placeholder","youremail@example.com"),w(g,"class","svelte-1k1s1co"),w(x,"type","submit"),x.value="Subscribe",x.disabled=j=!a[0],w(x,"class","svelte-1k1s1co"),w(d,"class","form-item svelte-1k1s1co"),w(T,"type","hidden"),T.value="1",w(T,"name","embed"),w(T,"class","svelte-1k1s1co"),w(L,"class","svelte-1k1s1co"),w(h,"action","https://buttondown.email/api/emails/embed-subscribe/lihautan"),w(h,"method","post"),w(h,"target","popupwindow"),w(h,"onsubmit","window.open('https://buttondown.email/lihautan', 'popupwindow')"),w(h,"class","embeddable-buttondown-form"),w(s,"class","form svelte-1k1s1co")},m(n,u){var k,f,m,w;r(n,s,u),i(s,t),i(t,e),i(s,o),i(s,p),i(p,c),i(s,l),i(s,h),i(h,d),i(d,g),P(g,a[0]),i(d,I),i(d,x),i(h,A),i(h,T),i(h,S),i(h,L),i(L,O),M||(k=g,f="input",m=a[1],k.addEventListener(f,m,w),C=()=>k.removeEventListener(f,m,w),M=!0)},p(n,[a]){1&a&&g.value!==n[0]&&P(g,n[0]),1&a&&j!==(j=!n[0])&&(x.disabled=j)},i:n,o:n,d(n){n&&u(s),M=!1,C()}}}function X(n,a,s){let t;return[t,function(){t=this.value,s(0,t)}]}class nn extends Y{constructor(n){super(),V(this,n,X,Q,p,{})}}function an(n){return T(()=>(setTimeout(()=>{if(window.innerWidth>1080){const n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3E&placement=lihautancom",n.id="_carbonads_js",document.body.appendChild(n)}},5e3),()=>{try{const n=document.getElementById("carbonads");n.parentNode.removeChild(n)}catch(n){}})),[]}class sn extends Y{constructor(n){super(),V(this,n,an,null,p,{})}}var tn="https://lihautan.com/i-wrote-my-module-bundler/assets/hero-twitter-01456022.jpg";function en(n,a,s){const t=n.slice();return t[6]=a[s],t}function on(n,a,s){const t=n.slice();return t[6]=a[s],t}function pn(n){let a,s;return{c(){a=k("meta"),this.h()},l(n){a=v(n,"META",{name:!0,content:!0}),this.h()},h(){w(a,"name","keywords"),w(a,"content",s=n[6])},m(n,s){r(n,a,s)},p(n,t){4&t&&s!==(s=n[6])&&w(a,"content",s)},d(n){n&&u(a)}}}function cn(n){let a,s,t=n[6]+"";return{c(){a=k("span"),s=f(t),this.h()},l(n){a=v(n,"SPAN",{class:!0});var e=y(a);s=E(e,t),e.forEach(u),this.h()},h(){w(a,"class","svelte-9tqnza")},m(n,t){r(n,a,t),i(a,s)},p(n,a){4&a&&t!==(t=n[6]+"")&&I(s,t)},d(n){n&&u(a)}}}function ln(n){let a,s,t,e,o,p,d,P,j,A,T,S,L,O,M,C,q,N,R,$,H,D,G,z,V,Y,K,Q,X,an,ln,rn,un,hn,kn,dn,fn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`,mn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},name:"Homepage",position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler",name:n[0]},name:n[0],position:2}]})}<\/script>`;document.title=a=n[0]+" | Tan Li Hau";let gn=n[2],wn=[];for(let a=0;a<gn.length;a+=1)wn[a]=pn(on(n,gn,a));G=new Z({});let yn=n[2],vn=[];for(let a=0;a<yn.length;a+=1)vn[a]=cn(en(n,yn,a));const En=n[5].default,bn=function(n,a,s,t){if(n){const e=c(n,a,s,t);return n[0](e)}}(En,n,n[4],null);return un=new nn({}),kn=new sn({}),{c(){s=k("meta"),t=k("meta"),e=k("meta"),o=k("meta"),p=k("meta"),d=k("meta"),P=k("meta"),j=k("meta"),A=k("meta"),T=k("meta"),S=k("meta");for(let n=0;n<wn.length;n+=1)wn[n].c();L=k("meta"),O=k("meta"),C=g(),N=g(),R=m(),$=k("a"),H=f("Skip to content"),D=m(),J(G.$$.fragment),z=m(),V=k("main"),Y=k("h1"),K=f(n[0]),Q=m();for(let n=0;n<vn.length;n+=1)vn[n].c();X=m(),an=k("article"),bn&&bn.c(),ln=m(),rn=k("footer"),J(un.$$.fragment),hn=m(),J(kn.$$.fragment),this.h()},l(a){const c=function(n,a=document.body){return Array.from(a.querySelectorAll(n))}('[data-svelte="svelte-15e3uyc"]',document.head);s=v(c,"META",{name:!0,content:!0}),t=v(c,"META",{name:!0,content:!0}),e=v(c,"META",{name:!0,content:!0}),o=v(c,"META",{name:!0,content:!0}),p=v(c,"META",{name:!0,content:!0}),d=v(c,"META",{name:!0,content:!0}),P=v(c,"META",{name:!0,content:!0}),j=v(c,"META",{name:!0,content:!0}),A=v(c,"META",{name:!0,content:!0}),T=v(c,"META",{name:!0,content:!0}),S=v(c,"META",{name:!0,content:!0});for(let n=0;n<wn.length;n+=1)wn[n].l(c);L=v(c,"META",{itemprop:!0,content:!0}),O=v(c,"META",{itemprop:!0,content:!0}),C=g(),N=g(),c.forEach(u),R=b(a),$=v(a,"A",{href:!0,class:!0});var l=y($);H=E(l,"Skip to content"),l.forEach(u),D=b(a),U(G.$$.fragment,a),z=b(a),V=v(a,"MAIN",{id:!0,class:!0});var i=y(V);Y=v(i,"H1",{});var r=y(Y);K=E(r,n[0]),r.forEach(u),Q=b(i);for(let n=0;n<vn.length;n+=1)vn[n].l(i);X=b(i),an=v(i,"ARTICLE",{});var h=y(an);bn&&bn.l(h),h.forEach(u),i.forEach(u),ln=b(a),rn=v(a,"FOOTER",{class:!0});var k=y(rn);U(un.$$.fragment,k),hn=b(k),U(kn.$$.fragment,k),k.forEach(u),this.h()},h(){w(s,"name","description"),w(s,"content",n[1]),w(t,"name","image"),w(t,"content",tn),w(e,"name","og:image"),w(e,"content",tn),w(o,"name","og:title"),w(o,"content",n[0]),w(p,"name","og:description"),w(p,"content",n[1]),w(d,"name","og:type"),w(d,"content","website"),w(P,"name","twitter:card"),w(P,"content","summary_large_image"),w(j,"name","twitter:creator"),w(j,"content","@lihautan"),w(A,"name","twitter:title"),w(A,"content",n[0]),w(T,"name","twitter:description"),w(T,"content",n[1]),w(S,"name","twitter:image"),w(S,"content",tn),w(L,"itemprop","url"),w(L,"content","https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler"),w(O,"itemprop","image"),w(O,"content",tn),M=new x(C),q=new x(N),w($,"href","#content"),w($,"class","skip svelte-9tqnza"),w(V,"id","content"),w(V,"class","blog svelte-9tqnza"),w(rn,"class","svelte-9tqnza")},m(n,a){i(document.head,s),i(document.head,t),i(document.head,e),i(document.head,o),i(document.head,p),i(document.head,d),i(document.head,P),i(document.head,j),i(document.head,A),i(document.head,T),i(document.head,S);for(let n=0;n<wn.length;n+=1)wn[n].m(document.head,null);i(document.head,L),i(document.head,O),M.m(fn,document.head),i(document.head,C),q.m(mn,document.head),i(document.head,N),r(n,R,a),r(n,$,a),i($,H),r(n,D,a),W(G,n,a),r(n,z,a),r(n,V,a),i(V,Y),i(Y,K),i(V,Q);for(let n=0;n<vn.length;n+=1)vn[n].m(V,null);i(V,X),i(V,an),bn&&bn.m(an,null),r(n,ln,a),r(n,rn,a),W(un,rn,null),i(rn,hn),W(kn,rn,null),dn=!0},p(n,[t]){if((!dn||1&t)&&a!==(a=n[0]+" | Tan Li Hau")&&(document.title=a),(!dn||2&t)&&w(s,"content",n[1]),(!dn||1&t)&&w(o,"content",n[0]),(!dn||2&t)&&w(p,"content",n[1]),(!dn||1&t)&&w(A,"content",n[0]),(!dn||2&t)&&w(T,"content",n[1]),4&t){let a;for(gn=n[2],a=0;a<gn.length;a+=1){const s=on(n,gn,a);wn[a]?wn[a].p(s,t):(wn[a]=pn(s),wn[a].c(),wn[a].m(L.parentNode,L))}for(;a<wn.length;a+=1)wn[a].d(1);wn.length=gn.length}if((!dn||3&t)&&fn!==(fn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`)&&M.p(fn),(!dn||1&t)&&mn!==(mn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},name:"Homepage",position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fi-wrote-my-module-bundler",name:n[0]},name:n[0],position:2}]})}<\/script>`)&&q.p(mn),(!dn||1&t)&&I(K,n[0]),4&t){let a;for(yn=n[2],a=0;a<yn.length;a+=1){const s=en(n,yn,a);vn[a]?vn[a].p(s,t):(vn[a]=cn(s),vn[a].c(),vn[a].m(V,X))}for(;a<vn.length;a+=1)vn[a].d(1);vn.length=yn.length}bn&&bn.p&&16&t&&l(bn,En,n,n[4],t,null,null)},i(n){dn||(B(G.$$.fragment,n),B(bn,n),B(un.$$.fragment,n),B(kn.$$.fragment,n),dn=!0)},o(n){F(G.$$.fragment,n),F(bn,n),F(un.$$.fragment,n),F(kn.$$.fragment,n),dn=!1},d(n){u(s),u(t),u(e),u(o),u(p),u(d),u(P),u(j),u(A),u(T),u(S),h(wn,n),u(L),u(O),u(C),n&&M.d(),u(N),n&&q.d(),n&&u(R),n&&u($),n&&u(D),_(G,n),n&&u(z),n&&u(V),h(vn,n),bn&&bn.d(n),n&&u(ln),n&&u(rn),_(un),_(kn)}}}function rn(n,a,s){let{title:t=""}=a,{description:e=""}=a,{tags:o=[]}=a;const p={"@type":"Person",name:"Tan Li Hau"};let{$$slots:c={},$$scope:l}=a;return n.$set=n=>{"title"in n&&s(0,t=n.title),"description"in n&&s(1,e=n.description),"tags"in n&&s(2,o=n.tags),"$$scope"in n&&s(4,l=n.$$scope)},[t,e,o,p,l,c]}class un extends Y{constructor(n){super(),V(this,n,rn,ln,p,{title:0,description:1,tags:2})}}function hn(a){let s,t,e,o,p,c,l,h,d,g,I,P,x,j,A,T,S,L,O,M,C,q,N,R,$,H,D,G,B,F,J,U,W,_,z,V,Y,K,Z,Q,X,nn,an,sn,tn,en,on,pn,cn,ln,rn,un,hn,kn,dn,fn,mn,gn,wn,yn,vn,En,bn,In,Pn,xn,jn,An,Tn,Sn,Ln,On,Mn,Cn,qn,Nn,Rn,$n,Hn,Dn,Gn,Bn,Fn,Jn,Un,Wn,_n,zn,Vn,Yn,Kn,Zn,Qn,Xn,na,aa,sa,ta,ea,oa,pa,ca,la,ia,ra,ua,ha,ka,da,fa,ma,ga,wa,ya,va,Ea,ba,Ia,Pa,xa,ja,Aa,Ta,Sa,La,Oa,Ma,Ca,qa,Na,Ra,$a,Ha,Da,Ga,Ba,Fa,Ja,Ua,Wa,_a,za,Va,Ya,Ka,Za,Qa,Xa,ns,as,ss,ts,es,os,ps,cs,ls,is,rs,us,hs,ks,ds,fs,ms,gs,ws,ys,vs,Es,bs,Is,Ps,xs,js,As,Ts,Ss,Ls,Os,Ms,Cs,qs,Ns,Rs,$s,Hs,Ds,Gs,Bs,Fs,Js,Us,Ws,_s,zs,Vs,Ys,Ks,Zs,Qs,Xs,nt,at,st,tt,et,ot,pt,ct,lt,it,rt,ut,ht,kt,dt,ft,mt,gt,wt,yt,vt,Et,bt,It,Pt,xt,jt,At,Tt,St,Lt,Ot,Mt,Ct,qt,Nt,Rt,$t,Ht,Dt,Gt,Bt,Ft,Jt,Ut,Wt,_t,zt,Vt,Yt,Kt,Zt,Qt,Xt,ne,ae,se,te,ee,oe,pe,ce,le,ie,re,ue,he,ke,de,fe,me,ge,we,ye,ve,Ee,be,Ie,Pe,xe,je,Ae,Te,Se,Le,Oe,Me,Ce,qe,Ne,Re,$e,He,De,Ge,Be,Fe,Je,Ue,We,_e,ze,Ve,Ye,Ke,Ze,Qe,Xe,no,ao,so,to,eo,oo,po,co,lo,io,ro,uo,ho,ko,fo,mo,go,wo,yo,vo,Eo,bo,Io,Po,xo,jo,Ao,To,So,Lo,Oo,Mo,Co,qo,No,Ro,$o,Ho,Do,Go,Bo,Fo,Jo,Uo,Wo,_o,zo,Vo,Yo,Ko,Zo,Qo,Xo,np,ap,sp,tp,ep,op,pp,cp,lp,ip,rp,up,hp,kp,dp,fp,mp,gp,wp,yp,vp,Ep,bp,Ip,Pp,xp,jp,Ap,Tp,Sp,Lp,Op,Mp,Cp,qp,Np,Rp,$p,Hp,Dp,Gp,Bp,Fp,Jp,Up,Wp,_p,zp,Vp,Yp,Kp,Zp,Qp,Xp,nc,ac,sc,tc,ec,oc,pc,cc,lc,ic,rc,uc,hc,kc,dc,fc,mc,gc,wc,yc,vc,Ec,bc,Ic,Pc,xc,jc,Ac,Tc,Sc,Lc,Oc,Mc,Cc,qc,Nc,Rc,$c,Hc,Dc,Gc,Bc,Fc,Jc,Uc,Wc,_c,zc,Vc,Yc,Kc,Zc,Qc,Xc,nl,al,sl,tl,el,ol,pl,cl,ll,il,rl,ul,hl,kl,dl,fl,ml,gl,wl,yl,vl,El,bl,Il,Pl,xl,jl,Al,Tl,Sl,Ll,Ol,Ml,Cl,ql,Nl,Rl,$l,Hl,Dl,Gl,Bl,Fl,Jl,Ul,Wl,_l,zl,Vl,Yl,Kl,Zl,Ql,Xl,ni,ai,si,ti,ei,oi,pi,ci,li,ii,ri,ui,hi,ki,di,fi,mi,gi,wi,yi,vi,Ei,bi,Ii,Pi,xi,ji,Ai,Ti,Si,Li,Oi,Mi,Ci,qi,Ni,Ri,$i,Hi,Di,Gi,Bi,Fi,Ji,Ui,Wi,_i,zi,Vi,Yi,Ki,Zi,Qi,Xi,nr,ar,sr,tr,er,or,pr,cr,lr,ir,rr,ur,hr,kr,dr,fr,mr,gr,wr,yr,vr,Er,br,Ir,Pr,xr,jr,Ar,Tr,Sr,Lr,Or,Mr,Cr,qr,Nr,Rr,$r,Hr,Dr,Gr,Br,Fr,Jr,Ur,Wr,_r,zr,Vr,Yr,Kr,Zr,Qr,Xr,nu,au,su,tu,eu,ou,pu,cu,lu,iu,ru,uu,hu,ku,du,fu,mu,gu,wu,yu,vu,Eu,bu,Iu,Pu,xu,ju,Au,Tu,Su,Lu,Ou,Mu,Cu,qu,Nu,Ru,$u,Hu,Du,Gu,Bu,Fu,Ju,Uu,Wu,_u,zu,Vu,Yu,Ku,Zu,Qu,Xu,nh,ah,sh,th,eh,oh,ph,ch,lh,ih,rh,uh,hh,kh,dh,fh,mh,gh,wh,yh,vh,Eh,bh,Ih,Ph,xh,jh,Ah,Th,Sh,Lh,Oh,Mh,Ch,qh,Nh,Rh,$h,Hh,Dh,Gh,Bh,Fh,Jh,Uh,Wh,_h,zh,Vh,Yh,Kh,Zh,Qh,Xh,nk,ak,sk,tk,ek,ok,pk,ck,lk,ik,rk,uk,hk,kk,dk,fk,mk,gk,wk,yk,vk;return{c(){s=k("section"),t=k("ul"),e=k("li"),o=k("a"),p=f("Getting Started"),c=k("ul"),l=k("li"),h=k("a"),d=f("The Input"),g=k("li"),I=k("a"),P=f("Writing"),x=k("li"),j=k("a"),A=f("Resolving"),T=k("li"),S=k("a"),L=f("Bundling"),O=k("ul"),M=k("li"),C=k("a"),q=f("Grouping modules into files"),N=k("li"),R=k("a"),$=f("Creating module map"),H=k("li"),D=k("a"),G=k("li"),B=k("a"),F=f("Optimisation"),J=k("ul"),U=k("li"),W=k("a"),_=f("Circular dependency"),z=k("li"),V=k("a"),Y=f("Summary"),K=k("ul"),Z=k("li"),Q=k("a"),X=f("Whats next?"),nn=k("li"),an=k("a"),sn=f("Further Readings"),tn=m(),en=k("p"),on=f("In my "),pn=k("a"),cn=f("previous article"),ln=f(", I explained how module bundler works. I used "),rn=k("a"),un=f("webpack"),hn=f(" and "),kn=k("a"),dn=f("rollup"),fn=f(" as example, how each of them gave us a different perspective on how we can bundle our JavaScript application."),mn=m(),gn=k("p"),wn=f("In this article, I am going to show you how I wrote my module bundler. The module bundler itself is not production-ready, yet I learned a ton through the exercise, and I am ever more appreciative of what modern module bundlers have provided."),yn=m(),vn=k("hr"),En=m(),bn=k("p"),In=f("⚠️ "),Pn=k("strong"),xn=f("Warning: Tons of JavaScript code ahead. 🙈😱😨"),jn=f(" ⚠️"),An=m(),Tn=k("hr"),Sn=m(),Ln=k("section"),On=k("h2"),Mn=k("a"),Cn=f("Getting Started"),qn=m(),Nn=k("p"),Rn=f("I talked about the input (the JavaScript modules) and the output (the bundled JavaScript file) of a module bundler in "),$n=k("a"),Hn=f("my previous article"),Dn=f(". Now it's time to write a module bundler that takes in the input and produces the output."),Gn=m(),Bn=k("p"),Fn=f("A "),Jn=k("em"),Un=f("basic"),Wn=f(" module bundler can be broken down into 2 parts:"),_n=m(),zn=k("ul"),Vn=k("li"),Yn=f("Understands the code and constructs the dependency graph "),Kn=k("strong"),Zn=f("(Dependency Resolution)"),Qn=m(),Xn=k("li"),na=f("Assembles the module into a single (or multiple) JavaScript file "),aa=k("strong"),sa=f("(Bundle)"),ta=m(),ea=k("blockquote"),oa=k("p"),pa=f("A "),ca=k("strong"),la=f("dependency graph"),ia=f(" is a graph representation of the dependency relationship between modules."),ra=m(),ua=k("section"),ha=k("h3"),ka=k("a"),da=f("The Input"),fa=m(),ma=k("p"),ga=f("In this article, I will be using following files as my input to the bundler:"),wa=m(),ya=k("pre"),va=m(),Ea=k("pre"),ba=m(),Ia=k("pre"),Pa=m(),xa=k("p"),ja=f("I've created the project on "),Aa=k("a"),Ta=f("Github"),Sa=f(", so if you are interested to try out yourself, you can clone it and checkout the "),La=k("code"),Oa=f("fixture-1"),Ma=f(" tag. The input files are in the "),Ca=k("code"),qa=f("fixture/"),Na=f(" folder."),Ra=m(),$a=k("section"),Ha=k("h2"),Da=k("a"),Ga=f("Writing"),Ba=m(),Fa=k("p"),Ja=f("I started with the main structure of the module bundler:"),Ua=m(),Wa=k("pre"),_a=m(),za=k("blockquote"),Va=k("p"),Ya=f("The "),Ka=k("strong"),Za=f("dependency graph"),Qa=f(" is a "),Xa=k("a"),ns=f("directed graph"),as=f(", where the vertex is the module, and the directed edge is the dependency relationship between the modules."),ss=m(),ts=k("pre"),es=m(),os=k("p"),ps=f('So, the entry module is "the root" of the graph.'),cs=m(),ls=k("p"),is=f("In "),rs=k("code"),us=f("createModule"),hs=f(", I instantiate a new "),ks=k("code"),ds=f("Module"),fs=f(" instance:"),ms=m(),gs=k("pre"),ws=m(),ys=k("p"),vs=f("The class "),Es=k("code"),bs=f("Module"),Is=f(" will be used to record module properties, such as the content, the dependencies, exported keys, etc."),Ps=m(),xs=k("pre"),js=m(),As=k("p"),Ts=f("While the "),Ss=k("code"),Ls=f("content"),Os=f(" is the string content of the module, to understand what it actually means, I used "),Ms=k("a"),Cs=f("babel"),qs=f(" to "),Ns=k("em"),Rs=f("parse the content"),$s=f(" into AST (Abstract Syntax Tree):"),Hs=m(),Ds=k("pre"),Gs=m(),Bs=k("p"),Fs=f("Next, I need to find out the dependency of this module:"),Js=m(),Us=k("pre"),Ws=m(),_s=k("p"),zs=f("So, how can I know what are the dependencies of this module?"),Vs=m(),Ys=k("p"),Ks=f("I can look for the "),Zs=k("code"),Qs=f("import"),Xs=f(" statement from the AST with the help of the\n"),nt=k("a"),at=f("babel-ast-explorer"),st=f("."),tt=m(),et=k("p"),ot=k("picture"),pt=k("source"),ct=k("source"),lt=k("img"),it=m(),rt=k("p"),ut=f("I found out that the "),ht=k("code"),kt=f("import"),dt=f(" statement in the AST is called the "),ft=k("code"),mt=f("ImportDeclaration"),gt=f(". It has "),wt=k("code"),yt=f("specifiers"),vt=f(" and "),Et=k("code"),bt=f("source"),It=f(", which the "),Pt=k("code"),xt=f("source.value"),jt=f(" tells us what this module is importing from:"),At=m(),Tt=k("pre"),St=m(),Lt=k("p"),Ot=f("So I had the path that the module is requesting, but it could be relative to the current file, eg "),Mt=k("code"),Ct=f('"./foo/bar"'),qt=f(", or from the "),Nt=k("code"),Rt=f("node_modules"),$t=f(", eg: "),Ht=k("code"),Dt=f('"lodash"'),Gt=f(". How do I know what is the "),Bt=k("strong"),Ft=f("actual file path"),Jt=f(" that the module is requesting?"),Ut=m(),Wt=k("p"),_t=f("The step of figuring out the actual path based on the requested path, is called "),zt=k("strong"),Vt=f('"Resolving"'),Yt=f(":"),Kt=m(),Zt=k("pre"),Qt=m(),Xt=k("p"),ne=k("em"),ae=f("Resolving path to the actual file path"),se=m(),te=k("section"),ee=k("h2"),oe=k("a"),pe=f("Resolving"),ce=m(),le=k("p"),ie=f('Let\'s talk about resolving. We know that "import"ing '),re=k("code"),ue=f("./b.js"),he=f(" in the following examples will result in getting a different file, because when we specify "),ke=k("code"),de=f("./"),fe=f(', we are "import"ing relative to the current file.'),me=m(),ge=k("pre"),we=m(),ye=k("pre"),ve=m(),Ee=k("p"),be=f("So, what are the rules of resolving a module?"),Ie=m(),Pe=k("p"),xe=f("The Node.js documentation has listed out the "),je=k("a"),Ae=f("detailed step of the module resolving algorithm"),Te=f(":"),Se=m(),Le=k("p"),Oe=f("When we specify a relative path, "),Me=k("code"),Ce=f("./b"),qe=f(", Node.js will first assume that "),Ne=k("code"),Re=f("./b"),$e=f(" is a file, and tries the following extension if it doesn't exactly match the file name:"),He=m(),De=k("pre"),Ge=m(),Be=k("p"),Fe=f("If the file does not exist, Node.js will then try to treat "),Je=k("code"),Ue=f("./b"),We=f(" as a directory, and try the following:"),_e=m(),ze=k("pre"),Ve=m(),Ye=k("p"),Ke=f("If we specify "),Ze=k("code"),Qe=f("import 'b'"),Xe=f(" instead, Node.js will treat it as a package within "),no=k("code"),ao=f("node_modules/"),so=f(", and have a different resolving strategy."),to=m(),eo=k("p"),oo=f("Through the above illustration, we can see that resolving "),po=k("code"),co=f("import './b'"),lo=f(" is not as simple as it seems. Besides the default Node.js resolving behaviour, "),io=k("a"),ro=f("webpack provides a lot more customisation options"),uo=f(", such as custom extensions, alias, modules folders, etc."),ho=m(),ko=k("p"),fo=f("Here, I am showing you the "),mo=k("em"),go=f('"simplest"'),wo=f(" resolver, which is to resolve relative path only:"),yo=m(),vo=k("pre"),Eo=m(),bo=k("blockquote"),Io=k("small"),Po=f("**Note:** You should try out writing a full node resolvers that resolve relatively as well as absolutely from `node_modules/`"),xo=m(),jo=k("p"),Ao=f("Now I know the actual requested file paths, I then create modules out of them."),To=m(),So=k("pre"),Lo=m(),Oo=k("p"),Mo=f("So, for each module, I find their dependencies, parse them, and find each dependency's dependencies, parse them as well, and find their dependencies, and so forth recursively. At the end of the process, I get a module dependency graph that looks something like this:"),Co=m(),qo=k("pre"),No=m(),Ro=k("p"),$o=f("The root of the graph is our entry module, and you can traverse the graph through the "),Ho=k("code"),Do=f("dependencies"),Go=f(" of the module. As you can see, the "),Bo=k("code"),Fo=f("index.js"),Jo=f(" has 2 dependencies, the "),Uo=k("code"),Wo=f("square.js"),_o=f(" and the "),zo=k("code"),Vo=f("circle.js"),Yo=f("."),Ko=m(),Zo=k("blockquote"),Qo=k("small"),Xo=f("**Note:** If you are following along, you can checkout the tag `feat-1-module-dependency-graph`, to see the code that I had written up till this point."),np=m(),ap=k("section"),sp=k("h2"),tp=k("a"),ep=f("Bundling"),op=m(),pp=k("p"),cp=f("With the module dependency graph, it's time to bundle them into a file!"),lp=m(),ip=k("p"),rp=f("At this point in time, we can choose whether we want to bundle it in the "),up=k("strong"),hp=f('"webpack way"'),kp=f(" or the "),dp=k("strong"),fp=f('"rollup way"'),mp=f(". In this article I am showing you how I did it the "),gp=k("strong"),wp=f('"webpack way"'),yp=f(". I'll write about bundling in the "),vp=k("strong"),Ep=f('"rollup way"'),bp=f(" in the coming article."),Ip=m(),Pp=k("blockquote"),xp=k("p"),jp=f("If you have no idea about what is the "),Ap=k("strong"),Tp=f('"webpack way"'),Sp=f(" or "),Lp=k("strong"),Op=f('"rollup way"'),Mp=f(', I have "coined" the term in my '),Cp=k("a"),qp=f("previous article"),Np=f(" and have detailed explanation about them!"),Rp=m(),$p=k("p"),Hp=f("Let's take a look how the final bundled file would look like:"),Dp=m(),Gp=k("pre"),Bp=m(),Fp=k("p"),Jp=f("Let's break it down to a few steps:"),Up=m(),Wp=k("ul"),_p=k("li"),zp=k("strong"),Vp=f("Group modules into files"),Yp=m(),Kp=k("li"),Zp=k("strong"),Qp=f("Create the module map"),Xp=f(' and wrapping each module in a "special" module factory function'),nc=m(),ac=k("li"),sc=k("strong"),tc=f('Create the "runtime"'),ec=f(", the glue that links each module together."),oc=m(),pc=k("section"),cc=k("h3"),lc=k("a"),ic=f("Grouping modules into files"),rc=m(),uc=k("p"),hc=f("This step is to decide which modules goes to which file. We can split modules into different files because of "),kc=k("a"),dc=f("code splitting"),fc=f(" due to dynamic import as well as optimisation, such as the webpack's "),mc=k("a"),gc=f("Chunk Splitting"),wc=f("."),yc=m(),vc=k("p"),Ec=f("I will support code splitting in the future. For now, I grouped all modules into 1 file."),bc=m(),Ic=k("p"),Pc=f("To collect all the modules from module graph into a list of modules, I did a graph traversal:"),xc=m(),jc=k("pre"),Ac=m(),Tc=k("p"),Sc=f("...and I used the list of modules to create a module map."),Lc=m(),Oc=k("section"),Mc=k("h3"),Cc=k("a"),qc=f("Creating module map"),Nc=m(),Rc=k("p"),$c=f("The module map I created is a string, that would be inlined into the final bundle file."),Hc=m(),Dc=k("p"),Gc=f("I looped through each module, and used "),Bc=k("code"),Fc=f("module.filePath"),Jc=f(" as the key, and "),Uc=k("code"),Wc=f("module.content"),_c=f(" as the value."),zc=m(),Vc=k("p"),Yc=f("The reason I dont use "),Kc=k("code"),Zc=f("JSON.stringify(moduleMap)"),Qc=f(" instead of manually concatenating to build up the module map, is because JSON can only takes in "),Xc=k("a"),nl=f("JSON primitive data type"),al=f(" as value, but what I built here is a JavaScript map, with "),sl=k("code"),tl=f("function"),el=f(" as value, but in string."),ol=m(),pl=k("pre"),cl=m(),ll=k("p"),il=f("The function that wraps around the "),rl=k("code"),ul=f("module.content"),hl=f(" is called the module factory function. It provides 2 parameter to the module:"),kl=m(),dl=k("ul"),fl=k("li"),ml=k("code"),gl=f("exports"),wl=f(", an object that the module can assign its exported value onto"),yl=m(),vl=k("li"),El=k("code"),bl=f("require"),Il=f(", a function that the module can invoke with module path to import exported value from another module"),Pl=m(),xl=k("p"),jl=f("The module map right now is not something that can be executed:"),Al=m(),Tl=k("pre"),Sl=m(),Ll=k("p"),Ol=f("because it still uses "),Ml=k("code"),Cl=f("import"),ql=f(" and "),Nl=k("code"),Rl=f("export"),$l=f(". I had to transform them to use the "),Hl=k("code"),Dl=f("exports"),Gl=f(" and "),Bl=k("code"),Fl=f("require"),Jl=f(" that we pass in."),Ul=m(),Wl=k("p"),_l=f("To transform the code, I used the AST of the module again: trasform the ast and generate the new code from the transformed ast."),zl=m(),Vl=k("p"),Yl=f('What I need is to trasform the "from" to "to" of the following:'),Kl=m(),Zl=k("pre"),Ql=m(),Xl=k("blockquote"),ni=k("p"),ai=f("I wrote a "),si=k("a"),ti=f("step by step guide"),ei=f(" on how to write babel transformation, please do check it out."),oi=m(),pi=k("p"),ci=f("Knowing "),li=k("strong"),ii=f("what to target on AST"),ri=f(" and "),ui=k("strong"),hi=f("how the transformed AST look like"),ki=f(", I wrote my transformation code:"),di=m(),fi=k("pre"),mi=m(),gi=k("p"),wi=f("I omitted the actual babel transformation code, because it is lengthy. If you are interested to read about it, you can check out "),yi=k("a"),vi=f("from my Github repo"),Ei=m(),bi=k("p"),Ii=f("So, now the module map looks ready:"),Pi=m(),xi=k("pre"),ji=m(),Ai=k("p"),Ti=f("One thing to take note is that, for the "),Si=k("code"),Li=f("require"),Oi=f(" statements, I replaced the requested path to the actual resolved path, because I used the actual resolved path as the key to the module map."),Mi=m(),Ci=k("section"),qi=k("h3"),Ni=k("a"),Ri=k("strong"),$i=f('Create the "runtime"'),Hi=m(),Di=k("p"),Gi=f("Now it's time to create the runtime. The runtime is a piece of code that is part of the output bundle, that runs when the application code is running, therefore, the runtime."),Bi=m(),Fi=k("p"),Ji=f("The runtime code can be from a template file, but for simplicity sake, I kept the runtime code as a string:"),Ui=m(),Wi=k("pre"),_i=m(),zi=k("p"),Vi=f("The code above is self explanatory, except if you have no idea what does the "),Yi=k("code"),Ki=f("webpackStart()"),Zi=f(" do, you can read more about it in "),Qi=k("a"),Xi=f("my previous post"),nr=f("."),ar=m(),sr=k("p"),tr=f("Finally, I returned the module code from the "),er=k("code"),or=f("bundle"),pr=f(" function:"),cr=m(),lr=k("pre"),ir=m(),rr=k("p"),ur=f("Now I run my bundler, it generates a "),hr=k("code"),kr=f("output/bundle.js"),dr=f(" file. I run the generated file with node and I see:"),fr=m(),mr=k("pre"),gr=m(),wr=k("p"),yr=f("That's it! A working module bundler!"),vr=m(),Er=k("p"),br=f("Of course, the module bundler I've shown here is "),Ir=k("strong"),Pr=f("nowhere near webpack"),xr=f(". Webpack supports more module system, resolving strategies, loading strategies, plugin system, optimisation, and many many more."),jr=m(),Ar=k("section"),Tr=k("h2"),Sr=k("a"),Lr=f("Optimisation"),Or=m(),Mr=k("p"),Cr=f("I played around my module bundler, and I quickly noticed a bug: "),qr=k("strong"),Nr=f("Circular Dependency"),Rr=f("."),$r=m(),Hr=k("p"),Dr=f("Here's my input files that I've tweaked:"),Gr=m(),Br=k("pre"),Fr=m(),Jr=k("pre"),Ur=m(),Wr=k("p"),_r=f("When I ran it through my module bunlder, immediately it ran into a stack overflow:"),zr=m(),Vr=k("pre"),Yr=m(),Kr=k("section"),Zr=k("h3"),Qr=k("a"),Xr=f("Circular dependency"),nu=m(),au=k("p"),su=f("There were 2 junctures that the code did recursive traversal which have led to the endless loop:"),tu=m(),eu=k("ul"),ou=k("li"),pu=f("Generating dependency graphs"),cu=m(),lu=k("li"),iu=f("Traversing module graph for bundling"),ru=m(),uu=k("pre"),hu=m(),ku=k("p"),du=f("Bundle with the latest code, the stack overflow is gone. However when I executed the output bundle, I saw"),fu=m(),mu=k("pre"),gu=m(),wu=k("p"),yu=f("So I took a look at the output bundle:"),vu=m(),Eu=k("pre"),bu=m(),Iu=k("p"),Pu=f("So, the problem is that I destructed "),xu=k("code"),ju=f("PI"),Au=f(" from the exports of "),Tu=k("code"),Su=f("index.js"),Lu=f(" before it is defined, so naturally "),Ou=k("code"),Mu=f("PI"),Cu=f(" within "),qu=k("code"),Nu=f("circle.js"),Ru=f(" would stay as "),$u=k("code"),Hu=f("undefined"),Du=f(" throughout the application. However before I called "),Gu=k("code"),Bu=f("circleArea"),Fu=f(", we defined "),Ju=k("code"),Uu=f("PI"),Wu=f(" on the "),_u=k("code"),zu=f("index.js"),Vu=f("'s export, I am expecting it to be available."),Yu=m(),Ku=k("p"),Zu=f("So I built my application with webpack and took a look at how webpack solved this problem."),Qu=m(),Xu=k("pre"),nh=m(),ah=k("p"),sh=f("Brilliant! The key is to lazily get the value of "),th=k("code"),eh=f("PI"),oh=f(" when needed!"),ph=m(),ch=k("p"),lh=f("I changed my babel transformation code, which I am not showing it here. If you are curious enough, you can check out "),ih=k("a"),rh=f("the changes I made from Github"),uh=f("."),hh=m(),kh=k("section"),dh=k("h2"),fh=k("a"),mh=f("Summary"),gh=m(),wh=k("p"),yh=f("There's two phases in module bundling: "),vh=k("strong"),Eh=f("Dependency Resolution"),bh=f(" and "),Ih=k("strong"),Ph=f("Bundling"),xh=f("."),jh=m(),Ah=k("p"),Th=f("I showed you how I constructed the dependency graph, by finding import statements and resolving modules. I shared how I created module maps and transformed the imports / exports syntax during "),Sh=k("strong"),Lh=f("bundling"),Oh=f(". Lastly, I fixed the circular dependency bug that was in the first version of my module bundler."),Mh=m(),Ch=k("section"),qh=k("h3"),Nh=k("a"),Rh=f("Whats next?"),$h=m(),Hh=k("p"),Dh=f("I have a few ideas that I will add to my module bundler, such as:"),Gh=m(),Bh=k("ul"),Fh=k("li"),Jh=f("code spliting"),Uh=m(),Wh=k("li"),_h=f("watch mode and reloading"),zh=m(),Vh=k("p"),Yh=f("which I will cover them in my next article when they are ready."),Kh=m(),Zh=k("p"),Qh=f("Till then. Cheers. 😎"),Xh=m(),nk=k("section"),ak=k("h2"),sk=k("a"),tk=f("Further Readings"),ek=m(),ok=k("ul"),pk=k("li"),ck=k("a"),lk=f("Ronen Amiel, Build Your Own Webpack - You Gotta Love Frontend 2018"),ik=m(),rk=k("li"),uk=k("a"),hk=f("Luciano Mammino, Unbundling the JavaScript module bundler - DublinJS July 2018"),kk=m(),dk=k("li"),fk=k("a"),mk=f("Adam Kelly, Let’s learn how module bundlers work and then write one ourselves"),gk=m(),wk=k("li"),yk=k("a"),vk=f("Webpack founder Tobias Koppers demos bundling live by hand"),this.h()},l(n){s=v(n,"SECTION",{});var a=y(s);t=v(a,"UL",{class:!0,id:!0,role:!0,"aria-label":!0});var i=y(t);e=v(i,"LI",{});var r=y(e);o=v(r,"A",{href:!0});var k=y(o);p=E(k,"Getting Started"),k.forEach(u),r.forEach(u),c=v(i,"UL",{});var f=y(c);l=v(f,"LI",{});var m=y(l);h=v(m,"A",{href:!0});var w=y(h);d=E(w,"The Input"),w.forEach(u),m.forEach(u),f.forEach(u),g=v(i,"LI",{});var Ek=y(g);I=v(Ek,"A",{href:!0});var bk=y(I);P=E(bk,"Writing"),bk.forEach(u),Ek.forEach(u),x=v(i,"LI",{});var Ik=y(x);j=v(Ik,"A",{href:!0});var Pk=y(j);A=E(Pk,"Resolving"),Pk.forEach(u),Ik.forEach(u),T=v(i,"LI",{});var xk=y(T);S=v(xk,"A",{href:!0});var jk=y(S);L=E(jk,"Bundling"),jk.forEach(u),xk.forEach(u),O=v(i,"UL",{});var Ak=y(O);M=v(Ak,"LI",{});var Tk=y(M);C=v(Tk,"A",{href:!0});var Sk=y(C);q=E(Sk,"Grouping modules into files"),Sk.forEach(u),Tk.forEach(u),N=v(Ak,"LI",{});var Lk=y(N);R=v(Lk,"A",{href:!0});var Ok=y(R);$=E(Ok,"Creating module map"),Ok.forEach(u),Lk.forEach(u),H=v(Ak,"LI",{});var Mk=y(H);D=v(Mk,"A",{href:!0}),y(D).forEach(u),Mk.forEach(u),Ak.forEach(u),G=v(i,"LI",{});var Ck=y(G);B=v(Ck,"A",{href:!0});var qk=y(B);F=E(qk,"Optimisation"),qk.forEach(u),Ck.forEach(u),J=v(i,"UL",{});var Nk=y(J);U=v(Nk,"LI",{});var Rk=y(U);W=v(Rk,"A",{href:!0});var $k=y(W);_=E($k,"Circular dependency"),$k.forEach(u),Rk.forEach(u),Nk.forEach(u),z=v(i,"LI",{});var Hk=y(z);V=v(Hk,"A",{href:!0});var Dk=y(V);Y=E(Dk,"Summary"),Dk.forEach(u),Hk.forEach(u),K=v(i,"UL",{});var Gk=y(K);Z=v(Gk,"LI",{});var Bk=y(Z);Q=v(Bk,"A",{href:!0});var Fk=y(Q);X=E(Fk,"Whats next?"),Fk.forEach(u),Bk.forEach(u),Gk.forEach(u),nn=v(i,"LI",{});var Jk=y(nn);an=v(Jk,"A",{href:!0});var Uk=y(an);sn=E(Uk,"Further Readings"),Uk.forEach(u),Jk.forEach(u),i.forEach(u),a.forEach(u),tn=b(n),en=v(n,"P",{});var Wk=y(en);on=E(Wk,"In my "),pn=v(Wk,"A",{href:!0});var _k=y(pn);cn=E(_k,"previous article"),_k.forEach(u),ln=E(Wk,", I explained how module bundler works. I used "),rn=v(Wk,"A",{href:!0,rel:!0});var zk=y(rn);un=E(zk,"webpack"),zk.forEach(u),hn=E(Wk," and "),kn=v(Wk,"A",{href:!0,rel:!0});var Vk=y(kn);dn=E(Vk,"rollup"),Vk.forEach(u),fn=E(Wk," as example, how each of them gave us a different perspective on how we can bundle our JavaScript application."),Wk.forEach(u),mn=b(n),gn=v(n,"P",{});var Yk=y(gn);wn=E(Yk,"In this article, I am going to show you how I wrote my module bundler. The module bundler itself is not production-ready, yet I learned a ton through the exercise, and I am ever more appreciative of what modern module bundlers have provided."),Yk.forEach(u),yn=b(n),vn=v(n,"HR",{}),En=b(n),bn=v(n,"P",{});var Kk=y(bn);In=E(Kk,"⚠️ "),Pn=v(Kk,"STRONG",{});var Zk=y(Pn);xn=E(Zk,"Warning: Tons of JavaScript code ahead. 🙈😱😨"),Zk.forEach(u),jn=E(Kk," ⚠️"),Kk.forEach(u),An=b(n),Tn=v(n,"HR",{}),Sn=b(n),Ln=v(n,"SECTION",{});var Qk=y(Ln);On=v(Qk,"H2",{});var Xk=y(On);Mn=v(Xk,"A",{href:!0,id:!0});var nd=y(Mn);Cn=E(nd,"Getting Started"),nd.forEach(u),Xk.forEach(u),qn=b(Qk),Nn=v(Qk,"P",{});var ad=y(Nn);Rn=E(ad,"I talked about the input (the JavaScript modules) and the output (the bundled JavaScript file) of a module bundler in "),$n=v(ad,"A",{href:!0});var sd=y($n);Hn=E(sd,"my previous article"),sd.forEach(u),Dn=E(ad,". Now it's time to write a module bundler that takes in the input and produces the output."),ad.forEach(u),Gn=b(Qk),Bn=v(Qk,"P",{});var td=y(Bn);Fn=E(td,"A "),Jn=v(td,"EM",{});var ed=y(Jn);Un=E(ed,"basic"),ed.forEach(u),Wn=E(td," module bundler can be broken down into 2 parts:"),td.forEach(u),_n=b(Qk),zn=v(Qk,"UL",{});var od=y(zn);Vn=v(od,"LI",{});var pd=y(Vn);Yn=E(pd,"Understands the code and constructs the dependency graph "),Kn=v(pd,"STRONG",{});var cd=y(Kn);Zn=E(cd,"(Dependency Resolution)"),cd.forEach(u),pd.forEach(u),Qn=b(od),Xn=v(od,"LI",{});var ld=y(Xn);na=E(ld,"Assembles the module into a single (or multiple) JavaScript file "),aa=v(ld,"STRONG",{});var id=y(aa);sa=E(id,"(Bundle)"),id.forEach(u),ld.forEach(u),od.forEach(u),ta=b(Qk),ea=v(Qk,"BLOCKQUOTE",{});var rd=y(ea);oa=v(rd,"P",{});var ud=y(oa);pa=E(ud,"A "),ca=v(ud,"STRONG",{});var hd=y(ca);la=E(hd,"dependency graph"),hd.forEach(u),ia=E(ud," is a graph representation of the dependency relationship between modules."),ud.forEach(u),rd.forEach(u),Qk.forEach(u),ra=b(n),ua=v(n,"SECTION",{});var kd=y(ua);ha=v(kd,"H3",{});var dd=y(ha);ka=v(dd,"A",{href:!0,id:!0});var fd=y(ka);da=E(fd,"The Input"),fd.forEach(u),dd.forEach(u),fa=b(kd),ma=v(kd,"P",{});var md=y(ma);ga=E(md,"In this article, I will be using following files as my input to the bundler:"),md.forEach(u),wa=b(kd),ya=v(kd,"PRE",{class:!0}),y(ya).forEach(u),va=b(kd),Ea=v(kd,"PRE",{class:!0}),y(Ea).forEach(u),ba=b(kd),Ia=v(kd,"PRE",{class:!0}),y(Ia).forEach(u),Pa=b(kd),xa=v(kd,"P",{});var gd=y(xa);ja=E(gd,"I've created the project on "),Aa=v(gd,"A",{href:!0,rel:!0});var wd=y(Aa);Ta=E(wd,"Github"),wd.forEach(u),Sa=E(gd,", so if you are interested to try out yourself, you can clone it and checkout the "),La=v(gd,"CODE",{});var yd=y(La);Oa=E(yd,"fixture-1"),yd.forEach(u),Ma=E(gd," tag. The input files are in the "),Ca=v(gd,"CODE",{});var vd=y(Ca);qa=E(vd,"fixture/"),vd.forEach(u),Na=E(gd," folder."),gd.forEach(u),kd.forEach(u),Ra=b(n),$a=v(n,"SECTION",{});var Ed=y($a);Ha=v(Ed,"H2",{});var bd=y(Ha);Da=v(bd,"A",{href:!0,id:!0});var Id=y(Da);Ga=E(Id,"Writing"),Id.forEach(u),bd.forEach(u),Ba=b(Ed),Fa=v(Ed,"P",{});var Pd=y(Fa);Ja=E(Pd,"I started with the main structure of the module bundler:"),Pd.forEach(u),Ua=b(Ed),Wa=v(Ed,"PRE",{class:!0}),y(Wa).forEach(u),_a=b(Ed),za=v(Ed,"BLOCKQUOTE",{});var xd=y(za);Va=v(xd,"P",{});var jd=y(Va);Ya=E(jd,"The "),Ka=v(jd,"STRONG",{});var Ad=y(Ka);Za=E(Ad,"dependency graph"),Ad.forEach(u),Qa=E(jd," is a "),Xa=v(jd,"A",{href:!0,rel:!0});var Td=y(Xa);ns=E(Td,"directed graph"),Td.forEach(u),as=E(jd,", where the vertex is the module, and the directed edge is the dependency relationship between the modules."),jd.forEach(u),xd.forEach(u),ss=b(Ed),ts=v(Ed,"PRE",{class:!0}),y(ts).forEach(u),es=b(Ed),os=v(Ed,"P",{});var Sd=y(os);ps=E(Sd,'So, the entry module is "the root" of the graph.'),Sd.forEach(u),cs=b(Ed),ls=v(Ed,"P",{});var Ld=y(ls);is=E(Ld,"In "),rs=v(Ld,"CODE",{});var Od=y(rs);us=E(Od,"createModule"),Od.forEach(u),hs=E(Ld,", I instantiate a new "),ks=v(Ld,"CODE",{});var Md=y(ks);ds=E(Md,"Module"),Md.forEach(u),fs=E(Ld," instance:"),Ld.forEach(u),ms=b(Ed),gs=v(Ed,"PRE",{class:!0}),y(gs).forEach(u),ws=b(Ed),ys=v(Ed,"P",{});var Cd=y(ys);vs=E(Cd,"The class "),Es=v(Cd,"CODE",{});var qd=y(Es);bs=E(qd,"Module"),qd.forEach(u),Is=E(Cd," will be used to record module properties, such as the content, the dependencies, exported keys, etc."),Cd.forEach(u),Ps=b(Ed),xs=v(Ed,"PRE",{class:!0}),y(xs).forEach(u),js=b(Ed),As=v(Ed,"P",{});var Nd=y(As);Ts=E(Nd,"While the "),Ss=v(Nd,"CODE",{});var Rd=y(Ss);Ls=E(Rd,"content"),Rd.forEach(u),Os=E(Nd," is the string content of the module, to understand what it actually means, I used "),Ms=v(Nd,"A",{href:!0,rel:!0});var $d=y(Ms);Cs=E($d,"babel"),$d.forEach(u),qs=E(Nd," to "),Ns=v(Nd,"EM",{});var Hd=y(Ns);Rs=E(Hd,"parse the content"),Hd.forEach(u),$s=E(Nd," into AST (Abstract Syntax Tree):"),Nd.forEach(u),Hs=b(Ed),Ds=v(Ed,"PRE",{class:!0}),y(Ds).forEach(u),Gs=b(Ed),Bs=v(Ed,"P",{});var Dd=y(Bs);Fs=E(Dd,"Next, I need to find out the dependency of this module:"),Dd.forEach(u),Js=b(Ed),Us=v(Ed,"PRE",{class:!0}),y(Us).forEach(u),Ws=b(Ed),_s=v(Ed,"P",{});var Gd=y(_s);zs=E(Gd,"So, how can I know what are the dependencies of this module?"),Gd.forEach(u),Vs=b(Ed),Ys=v(Ed,"P",{});var Bd=y(Ys);Ks=E(Bd,"I can look for the "),Zs=v(Bd,"CODE",{});var Fd=y(Zs);Qs=E(Fd,"import"),Fd.forEach(u),Xs=E(Bd," statement from the AST with the help of the\n"),nt=v(Bd,"A",{href:!0,rel:!0});var Jd=y(nt);at=E(Jd,"babel-ast-explorer"),Jd.forEach(u),st=E(Bd,"."),Bd.forEach(u),tt=b(Ed),et=v(Ed,"P",{});var Ud=y(et);ot=v(Ud,"PICTURE",{});var Wd=y(ot);pt=v(Wd,"SOURCE",{type:!0,srcset:!0}),ct=v(Wd,"SOURCE",{type:!0,srcset:!0}),lt=v(Wd,"IMG",{title:!0,alt:!0,"data-src":!0,loading:!0}),Wd.forEach(u),Ud.forEach(u),it=b(Ed),rt=v(Ed,"P",{});var _d=y(rt);ut=E(_d,"I found out that the "),ht=v(_d,"CODE",{});var zd=y(ht);kt=E(zd,"import"),zd.forEach(u),dt=E(_d," statement in the AST is called the "),ft=v(_d,"CODE",{});var Vd=y(ft);mt=E(Vd,"ImportDeclaration"),Vd.forEach(u),gt=E(_d,". It has "),wt=v(_d,"CODE",{});var Yd=y(wt);yt=E(Yd,"specifiers"),Yd.forEach(u),vt=E(_d," and "),Et=v(_d,"CODE",{});var Kd=y(Et);bt=E(Kd,"source"),Kd.forEach(u),It=E(_d,", which the "),Pt=v(_d,"CODE",{});var Zd=y(Pt);xt=E(Zd,"source.value"),Zd.forEach(u),jt=E(_d," tells us what this module is importing from:"),_d.forEach(u),At=b(Ed),Tt=v(Ed,"PRE",{class:!0}),y(Tt).forEach(u),St=b(Ed),Lt=v(Ed,"P",{});var Qd=y(Lt);Ot=E(Qd,"So I had the path that the module is requesting, but it could be relative to the current file, eg "),Mt=v(Qd,"CODE",{});var Xd=y(Mt);Ct=E(Xd,'"./foo/bar"'),Xd.forEach(u),qt=E(Qd,", or from the "),Nt=v(Qd,"CODE",{});var nf=y(Nt);Rt=E(nf,"node_modules"),nf.forEach(u),$t=E(Qd,", eg: "),Ht=v(Qd,"CODE",{});var af=y(Ht);Dt=E(af,'"lodash"'),af.forEach(u),Gt=E(Qd,". How do I know what is the "),Bt=v(Qd,"STRONG",{});var sf=y(Bt);Ft=E(sf,"actual file path"),sf.forEach(u),Jt=E(Qd," that the module is requesting?"),Qd.forEach(u),Ut=b(Ed),Wt=v(Ed,"P",{});var tf=y(Wt);_t=E(tf,"The step of figuring out the actual path based on the requested path, is called "),zt=v(tf,"STRONG",{});var ef=y(zt);Vt=E(ef,'"Resolving"'),ef.forEach(u),Yt=E(tf,":"),tf.forEach(u),Kt=b(Ed),Zt=v(Ed,"PRE",{class:!0}),y(Zt).forEach(u),Qt=b(Ed),Xt=v(Ed,"P",{});var of=y(Xt);ne=v(of,"EM",{});var pf=y(ne);ae=E(pf,"Resolving path to the actual file path"),pf.forEach(u),of.forEach(u),Ed.forEach(u),se=b(n),te=v(n,"SECTION",{});var cf=y(te);ee=v(cf,"H2",{});var lf=y(ee);oe=v(lf,"A",{href:!0,id:!0});var rf=y(oe);pe=E(rf,"Resolving"),rf.forEach(u),lf.forEach(u),ce=b(cf),le=v(cf,"P",{});var uf=y(le);ie=E(uf,'Let\'s talk about resolving. We know that "import"ing '),re=v(uf,"CODE",{});var hf=y(re);ue=E(hf,"./b.js"),hf.forEach(u),he=E(uf," in the following examples will result in getting a different file, because when we specify "),ke=v(uf,"CODE",{});var kf=y(ke);de=E(kf,"./"),kf.forEach(u),fe=E(uf,', we are "import"ing relative to the current file.'),uf.forEach(u),me=b(cf),ge=v(cf,"PRE",{class:!0}),y(ge).forEach(u),we=b(cf),ye=v(cf,"PRE",{class:!0}),y(ye).forEach(u),ve=b(cf),Ee=v(cf,"P",{});var df=y(Ee);be=E(df,"So, what are the rules of resolving a module?"),df.forEach(u),Ie=b(cf),Pe=v(cf,"P",{});var ff=y(Pe);xe=E(ff,"The Node.js documentation has listed out the "),je=v(ff,"A",{href:!0,rel:!0});var mf=y(je);Ae=E(mf,"detailed step of the module resolving algorithm"),mf.forEach(u),Te=E(ff,":"),ff.forEach(u),Se=b(cf),Le=v(cf,"P",{});var gf=y(Le);Oe=E(gf,"When we specify a relative path, "),Me=v(gf,"CODE",{});var wf=y(Me);Ce=E(wf,"./b"),wf.forEach(u),qe=E(gf,", Node.js will first assume that "),Ne=v(gf,"CODE",{});var yf=y(Ne);Re=E(yf,"./b"),yf.forEach(u),$e=E(gf," is a file, and tries the following extension if it doesn't exactly match the file name:"),gf.forEach(u),He=b(cf),De=v(cf,"PRE",{class:!0}),y(De).forEach(u),Ge=b(cf),Be=v(cf,"P",{});var vf=y(Be);Fe=E(vf,"If the file does not exist, Node.js will then try to treat "),Je=v(vf,"CODE",{});var Ef=y(Je);Ue=E(Ef,"./b"),Ef.forEach(u),We=E(vf," as a directory, and try the following:"),vf.forEach(u),_e=b(cf),ze=v(cf,"PRE",{class:!0}),y(ze).forEach(u),Ve=b(cf),Ye=v(cf,"P",{});var bf=y(Ye);Ke=E(bf,"If we specify "),Ze=v(bf,"CODE",{});var If=y(Ze);Qe=E(If,"import 'b'"),If.forEach(u),Xe=E(bf," instead, Node.js will treat it as a package within "),no=v(bf,"CODE",{});var Pf=y(no);ao=E(Pf,"node_modules/"),Pf.forEach(u),so=E(bf,", and have a different resolving strategy."),bf.forEach(u),to=b(cf),eo=v(cf,"P",{});var xf=y(eo);oo=E(xf,"Through the above illustration, we can see that resolving "),po=v(xf,"CODE",{});var jf=y(po);co=E(jf,"import './b'"),jf.forEach(u),lo=E(xf," is not as simple as it seems. Besides the default Node.js resolving behaviour, "),io=v(xf,"A",{href:!0,rel:!0});var Af=y(io);ro=E(Af,"webpack provides a lot more customisation options"),Af.forEach(u),uo=E(xf,", such as custom extensions, alias, modules folders, etc."),xf.forEach(u),ho=b(cf),ko=v(cf,"P",{});var Tf=y(ko);fo=E(Tf,"Here, I am showing you the "),mo=v(Tf,"EM",{});var Sf=y(mo);go=E(Sf,'"simplest"'),Sf.forEach(u),wo=E(Tf," resolver, which is to resolve relative path only:"),Tf.forEach(u),yo=b(cf),vo=v(cf,"PRE",{class:!0}),y(vo).forEach(u),Eo=b(cf),bo=v(cf,"BLOCKQUOTE",{});var Lf=y(bo);Io=v(Lf,"SMALL",{});var Of=y(Io);Po=E(Of,"**Note:** You should try out writing a full node resolvers that resolve relatively as well as absolutely from `node_modules/`"),Of.forEach(u),Lf.forEach(u),xo=b(cf),jo=v(cf,"P",{});var Mf=y(jo);Ao=E(Mf,"Now I know the actual requested file paths, I then create modules out of them."),Mf.forEach(u),To=b(cf),So=v(cf,"PRE",{class:!0}),y(So).forEach(u),Lo=b(cf),Oo=v(cf,"P",{});var Cf=y(Oo);Mo=E(Cf,"So, for each module, I find their dependencies, parse them, and find each dependency's dependencies, parse them as well, and find their dependencies, and so forth recursively. At the end of the process, I get a module dependency graph that looks something like this:"),Cf.forEach(u),Co=b(cf),qo=v(cf,"PRE",{class:!0}),y(qo).forEach(u),No=b(cf),Ro=v(cf,"P",{});var qf=y(Ro);$o=E(qf,"The root of the graph is our entry module, and you can traverse the graph through the "),Ho=v(qf,"CODE",{});var Nf=y(Ho);Do=E(Nf,"dependencies"),Nf.forEach(u),Go=E(qf," of the module. As you can see, the "),Bo=v(qf,"CODE",{});var Rf=y(Bo);Fo=E(Rf,"index.js"),Rf.forEach(u),Jo=E(qf," has 2 dependencies, the "),Uo=v(qf,"CODE",{});var $f=y(Uo);Wo=E($f,"square.js"),$f.forEach(u),_o=E(qf," and the "),zo=v(qf,"CODE",{});var Hf=y(zo);Vo=E(Hf,"circle.js"),Hf.forEach(u),Yo=E(qf,"."),qf.forEach(u),Ko=b(cf),Zo=v(cf,"BLOCKQUOTE",{});var Df=y(Zo);Qo=v(Df,"SMALL",{});var Gf=y(Qo);Xo=E(Gf,"**Note:** If you are following along, you can checkout the tag `feat-1-module-dependency-graph`, to see the code that I had written up till this point."),Gf.forEach(u),Df.forEach(u),cf.forEach(u),np=b(n),ap=v(n,"SECTION",{});var Bf=y(ap);sp=v(Bf,"H2",{});var Ff=y(sp);tp=v(Ff,"A",{href:!0,id:!0});var Jf=y(tp);ep=E(Jf,"Bundling"),Jf.forEach(u),Ff.forEach(u),op=b(Bf),pp=v(Bf,"P",{});var Uf=y(pp);cp=E(Uf,"With the module dependency graph, it's time to bundle them into a file!"),Uf.forEach(u),lp=b(Bf),ip=v(Bf,"P",{});var Wf=y(ip);rp=E(Wf,"At this point in time, we can choose whether we want to bundle it in the "),up=v(Wf,"STRONG",{});var _f=y(up);hp=E(_f,'"webpack way"'),_f.forEach(u),kp=E(Wf," or the "),dp=v(Wf,"STRONG",{});var zf=y(dp);fp=E(zf,'"rollup way"'),zf.forEach(u),mp=E(Wf,". In this article I am showing you how I did it the "),gp=v(Wf,"STRONG",{});var Vf=y(gp);wp=E(Vf,'"webpack way"'),Vf.forEach(u),yp=E(Wf,". I'll write about bundling in the "),vp=v(Wf,"STRONG",{});var Yf=y(vp);Ep=E(Yf,'"rollup way"'),Yf.forEach(u),bp=E(Wf," in the coming article."),Wf.forEach(u),Ip=b(Bf),Pp=v(Bf,"BLOCKQUOTE",{});var Kf=y(Pp);xp=v(Kf,"P",{});var Zf=y(xp);jp=E(Zf,"If you have no idea about what is the "),Ap=v(Zf,"STRONG",{});var Qf=y(Ap);Tp=E(Qf,'"webpack way"'),Qf.forEach(u),Sp=E(Zf," or "),Lp=v(Zf,"STRONG",{});var Xf=y(Lp);Op=E(Xf,'"rollup way"'),Xf.forEach(u),Mp=E(Zf,', I have "coined" the term in my '),Cp=v(Zf,"A",{href:!0});var nm=y(Cp);qp=E(nm,"previous article"),nm.forEach(u),Np=E(Zf," and have detailed explanation about them!"),Zf.forEach(u),Kf.forEach(u),Rp=b(Bf),$p=v(Bf,"P",{});var am=y($p);Hp=E(am,"Let's take a look how the final bundled file would look like:"),am.forEach(u),Dp=b(Bf),Gp=v(Bf,"PRE",{class:!0}),y(Gp).forEach(u),Bp=b(Bf),Fp=v(Bf,"P",{});var sm=y(Fp);Jp=E(sm,"Let's break it down to a few steps:"),sm.forEach(u),Up=b(Bf),Wp=v(Bf,"UL",{});var tm=y(Wp);_p=v(tm,"LI",{});var em=y(_p);zp=v(em,"STRONG",{});var om=y(zp);Vp=E(om,"Group modules into files"),om.forEach(u),em.forEach(u),Yp=b(tm),Kp=v(tm,"LI",{});var pm=y(Kp);Zp=v(pm,"STRONG",{});var cm=y(Zp);Qp=E(cm,"Create the module map"),cm.forEach(u),Xp=E(pm,' and wrapping each module in a "special" module factory function'),pm.forEach(u),nc=b(tm),ac=v(tm,"LI",{});var lm=y(ac);sc=v(lm,"STRONG",{});var im=y(sc);tc=E(im,'Create the "runtime"'),im.forEach(u),ec=E(lm,", the glue that links each module together."),lm.forEach(u),tm.forEach(u),Bf.forEach(u),oc=b(n),pc=v(n,"SECTION",{});var rm=y(pc);cc=v(rm,"H3",{});var um=y(cc);lc=v(um,"A",{href:!0,id:!0});var hm=y(lc);ic=E(hm,"Grouping modules into files"),hm.forEach(u),um.forEach(u),rc=b(rm),uc=v(rm,"P",{});var km=y(uc);hc=E(km,"This step is to decide which modules goes to which file. We can split modules into different files because of "),kc=v(km,"A",{href:!0,rel:!0});var dm=y(kc);dc=E(dm,"code splitting"),dm.forEach(u),fc=E(km," due to dynamic import as well as optimisation, such as the webpack's "),mc=v(km,"A",{href:!0,rel:!0});var fm=y(mc);gc=E(fm,"Chunk Splitting"),fm.forEach(u),wc=E(km,"."),km.forEach(u),yc=b(rm),vc=v(rm,"P",{});var mm=y(vc);Ec=E(mm,"I will support code splitting in the future. For now, I grouped all modules into 1 file."),mm.forEach(u),bc=b(rm),Ic=v(rm,"P",{});var gm=y(Ic);Pc=E(gm,"To collect all the modules from module graph into a list of modules, I did a graph traversal:"),gm.forEach(u),xc=b(rm),jc=v(rm,"PRE",{class:!0}),y(jc).forEach(u),Ac=b(rm),Tc=v(rm,"P",{});var wm=y(Tc);Sc=E(wm,"...and I used the list of modules to create a module map."),wm.forEach(u),rm.forEach(u),Lc=b(n),Oc=v(n,"SECTION",{});var ym=y(Oc);Mc=v(ym,"H3",{});var vm=y(Mc);Cc=v(vm,"A",{href:!0,id:!0});var Em=y(Cc);qc=E(Em,"Creating module map"),Em.forEach(u),vm.forEach(u),Nc=b(ym),Rc=v(ym,"P",{});var bm=y(Rc);$c=E(bm,"The module map I created is a string, that would be inlined into the final bundle file."),bm.forEach(u),Hc=b(ym),Dc=v(ym,"P",{});var Im=y(Dc);Gc=E(Im,"I looped through each module, and used "),Bc=v(Im,"CODE",{});var Pm=y(Bc);Fc=E(Pm,"module.filePath"),Pm.forEach(u),Jc=E(Im," as the key, and "),Uc=v(Im,"CODE",{});var xm=y(Uc);Wc=E(xm,"module.content"),xm.forEach(u),_c=E(Im," as the value."),Im.forEach(u),zc=b(ym),Vc=v(ym,"P",{});var jm=y(Vc);Yc=E(jm,"The reason I dont use "),Kc=v(jm,"CODE",{});var Am=y(Kc);Zc=E(Am,"JSON.stringify(moduleMap)"),Am.forEach(u),Qc=E(jm," instead of manually concatenating to build up the module map, is because JSON can only takes in "),Xc=v(jm,"A",{href:!0,rel:!0});var Tm=y(Xc);nl=E(Tm,"JSON primitive data type"),Tm.forEach(u),al=E(jm," as value, but what I built here is a JavaScript map, with "),sl=v(jm,"CODE",{});var Sm=y(sl);tl=E(Sm,"function"),Sm.forEach(u),el=E(jm," as value, but in string."),jm.forEach(u),ol=b(ym),pl=v(ym,"PRE",{class:!0}),y(pl).forEach(u),cl=b(ym),ll=v(ym,"P",{});var Lm=y(ll);il=E(Lm,"The function that wraps around the "),rl=v(Lm,"CODE",{});var Om=y(rl);ul=E(Om,"module.content"),Om.forEach(u),hl=E(Lm," is called the module factory function. It provides 2 parameter to the module:"),Lm.forEach(u),kl=b(ym),dl=v(ym,"UL",{});var Mm=y(dl);fl=v(Mm,"LI",{});var Cm=y(fl);ml=v(Cm,"CODE",{});var qm=y(ml);gl=E(qm,"exports"),qm.forEach(u),wl=E(Cm,", an object that the module can assign its exported value onto"),Cm.forEach(u),yl=b(Mm),vl=v(Mm,"LI",{});var Nm=y(vl);El=v(Nm,"CODE",{});var Rm=y(El);bl=E(Rm,"require"),Rm.forEach(u),Il=E(Nm,", a function that the module can invoke with module path to import exported value from another module"),Nm.forEach(u),Mm.forEach(u),Pl=b(ym),xl=v(ym,"P",{});var $m=y(xl);jl=E($m,"The module map right now is not something that can be executed:"),$m.forEach(u),Al=b(ym),Tl=v(ym,"PRE",{class:!0}),y(Tl).forEach(u),Sl=b(ym),Ll=v(ym,"P",{});var Hm=y(Ll);Ol=E(Hm,"because it still uses "),Ml=v(Hm,"CODE",{});var Dm=y(Ml);Cl=E(Dm,"import"),Dm.forEach(u),ql=E(Hm," and "),Nl=v(Hm,"CODE",{});var Gm=y(Nl);Rl=E(Gm,"export"),Gm.forEach(u),$l=E(Hm,". I had to transform them to use the "),Hl=v(Hm,"CODE",{});var Bm=y(Hl);Dl=E(Bm,"exports"),Bm.forEach(u),Gl=E(Hm," and "),Bl=v(Hm,"CODE",{});var Fm=y(Bl);Fl=E(Fm,"require"),Fm.forEach(u),Jl=E(Hm," that we pass in."),Hm.forEach(u),Ul=b(ym),Wl=v(ym,"P",{});var Jm=y(Wl);_l=E(Jm,"To transform the code, I used the AST of the module again: trasform the ast and generate the new code from the transformed ast."),Jm.forEach(u),zl=b(ym),Vl=v(ym,"P",{});var Um=y(Vl);Yl=E(Um,'What I need is to trasform the "from" to "to" of the following:'),Um.forEach(u),Kl=b(ym),Zl=v(ym,"PRE",{class:!0}),y(Zl).forEach(u),Ql=b(ym),Xl=v(ym,"BLOCKQUOTE",{});var Wm=y(Xl);ni=v(Wm,"P",{});var _m=y(ni);ai=E(_m,"I wrote a "),si=v(_m,"A",{href:!0});var zm=y(si);ti=E(zm,"step by step guide"),zm.forEach(u),ei=E(_m," on how to write babel transformation, please do check it out."),_m.forEach(u),Wm.forEach(u),oi=b(ym),pi=v(ym,"P",{});var Vm=y(pi);ci=E(Vm,"Knowing "),li=v(Vm,"STRONG",{});var Ym=y(li);ii=E(Ym,"what to target on AST"),Ym.forEach(u),ri=E(Vm," and "),ui=v(Vm,"STRONG",{});var Km=y(ui);hi=E(Km,"how the transformed AST look like"),Km.forEach(u),ki=E(Vm,", I wrote my transformation code:"),Vm.forEach(u),di=b(ym),fi=v(ym,"PRE",{class:!0}),y(fi).forEach(u),mi=b(ym),gi=v(ym,"P",{});var Zm=y(gi);wi=E(Zm,"I omitted the actual babel transformation code, because it is lengthy. If you are interested to read about it, you can check out "),yi=v(Zm,"A",{href:!0,rel:!0});var Qm=y(yi);vi=E(Qm,"from my Github repo"),Qm.forEach(u),Zm.forEach(u),Ei=b(ym),bi=v(ym,"P",{});var Xm=y(bi);Ii=E(Xm,"So, now the module map looks ready:"),Xm.forEach(u),Pi=b(ym),xi=v(ym,"PRE",{class:!0}),y(xi).forEach(u),ji=b(ym),Ai=v(ym,"P",{});var ng=y(Ai);Ti=E(ng,"One thing to take note is that, for the "),Si=v(ng,"CODE",{});var ag=y(Si);Li=E(ag,"require"),ag.forEach(u),Oi=E(ng," statements, I replaced the requested path to the actual resolved path, because I used the actual resolved path as the key to the module map."),ng.forEach(u),ym.forEach(u),Mi=b(n),Ci=v(n,"SECTION",{});var sg=y(Ci);qi=v(sg,"H3",{});var tg=y(qi);Ni=v(tg,"A",{href:!0,id:!0});var eg=y(Ni);Ri=v(eg,"STRONG",{});var og=y(Ri);$i=E(og,'Create the "runtime"'),og.forEach(u),eg.forEach(u),tg.forEach(u),Hi=b(sg),Di=v(sg,"P",{});var pg=y(Di);Gi=E(pg,"Now it's time to create the runtime. The runtime is a piece of code that is part of the output bundle, that runs when the application code is running, therefore, the runtime."),pg.forEach(u),Bi=b(sg),Fi=v(sg,"P",{});var cg=y(Fi);Ji=E(cg,"The runtime code can be from a template file, but for simplicity sake, I kept the runtime code as a string:"),cg.forEach(u),Ui=b(sg),Wi=v(sg,"PRE",{class:!0}),y(Wi).forEach(u),_i=b(sg),zi=v(sg,"P",{});var lg=y(zi);Vi=E(lg,"The code above is self explanatory, except if you have no idea what does the "),Yi=v(lg,"CODE",{});var ig=y(Yi);Ki=E(ig,"webpackStart()"),ig.forEach(u),Zi=E(lg," do, you can read more about it in "),Qi=v(lg,"A",{href:!0});var rg=y(Qi);Xi=E(rg,"my previous post"),rg.forEach(u),nr=E(lg,"."),lg.forEach(u),ar=b(sg),sr=v(sg,"P",{});var ug=y(sr);tr=E(ug,"Finally, I returned the module code from the "),er=v(ug,"CODE",{});var hg=y(er);or=E(hg,"bundle"),hg.forEach(u),pr=E(ug," function:"),ug.forEach(u),cr=b(sg),lr=v(sg,"PRE",{class:!0}),y(lr).forEach(u),ir=b(sg),rr=v(sg,"P",{});var kg=y(rr);ur=E(kg,"Now I run my bundler, it generates a "),hr=v(kg,"CODE",{});var dg=y(hr);kr=E(dg,"output/bundle.js"),dg.forEach(u),dr=E(kg," file. I run the generated file with node and I see:"),kg.forEach(u),fr=b(sg),mr=v(sg,"PRE",{class:!0}),y(mr).forEach(u),gr=b(sg),wr=v(sg,"P",{});var fg=y(wr);yr=E(fg,"That's it! A working module bundler!"),fg.forEach(u),vr=b(sg),Er=v(sg,"P",{});var mg=y(Er);br=E(mg,"Of course, the module bundler I've shown here is "),Ir=v(mg,"STRONG",{});var gg=y(Ir);Pr=E(gg,"nowhere near webpack"),gg.forEach(u),xr=E(mg,". Webpack supports more module system, resolving strategies, loading strategies, plugin system, optimisation, and many many more."),mg.forEach(u),sg.forEach(u),jr=b(n),Ar=v(n,"SECTION",{});var wg=y(Ar);Tr=v(wg,"H2",{});var yg=y(Tr);Sr=v(yg,"A",{href:!0,id:!0});var vg=y(Sr);Lr=E(vg,"Optimisation"),vg.forEach(u),yg.forEach(u),Or=b(wg),Mr=v(wg,"P",{});var Eg=y(Mr);Cr=E(Eg,"I played around my module bundler, and I quickly noticed a bug: "),qr=v(Eg,"STRONG",{});var bg=y(qr);Nr=E(bg,"Circular Dependency"),bg.forEach(u),Rr=E(Eg,"."),Eg.forEach(u),$r=b(wg),Hr=v(wg,"P",{});var Ig=y(Hr);Dr=E(Ig,"Here's my input files that I've tweaked:"),Ig.forEach(u),Gr=b(wg),Br=v(wg,"PRE",{class:!0}),y(Br).forEach(u),Fr=b(wg),Jr=v(wg,"PRE",{class:!0}),y(Jr).forEach(u),Ur=b(wg),Wr=v(wg,"P",{});var Pg=y(Wr);_r=E(Pg,"When I ran it through my module bunlder, immediately it ran into a stack overflow:"),Pg.forEach(u),zr=b(wg),Vr=v(wg,"PRE",{class:!0}),y(Vr).forEach(u),wg.forEach(u),Yr=b(n),Kr=v(n,"SECTION",{});var xg=y(Kr);Zr=v(xg,"H3",{});var jg=y(Zr);Qr=v(jg,"A",{href:!0,id:!0});var Ag=y(Qr);Xr=E(Ag,"Circular dependency"),Ag.forEach(u),jg.forEach(u),nu=b(xg),au=v(xg,"P",{});var Tg=y(au);su=E(Tg,"There were 2 junctures that the code did recursive traversal which have led to the endless loop:"),Tg.forEach(u),tu=b(xg),eu=v(xg,"UL",{});var Sg=y(eu);ou=v(Sg,"LI",{});var Lg=y(ou);pu=E(Lg,"Generating dependency graphs"),Lg.forEach(u),cu=b(Sg),lu=v(Sg,"LI",{});var Og=y(lu);iu=E(Og,"Traversing module graph for bundling"),Og.forEach(u),Sg.forEach(u),ru=b(xg),uu=v(xg,"PRE",{class:!0}),y(uu).forEach(u),hu=b(xg),ku=v(xg,"P",{});var Mg=y(ku);du=E(Mg,"Bundle with the latest code, the stack overflow is gone. However when I executed the output bundle, I saw"),Mg.forEach(u),fu=b(xg),mu=v(xg,"PRE",{class:!0}),y(mu).forEach(u),gu=b(xg),wu=v(xg,"P",{});var Cg=y(wu);yu=E(Cg,"So I took a look at the output bundle:"),Cg.forEach(u),vu=b(xg),Eu=v(xg,"PRE",{class:!0}),y(Eu).forEach(u),bu=b(xg),Iu=v(xg,"P",{});var qg=y(Iu);Pu=E(qg,"So, the problem is that I destructed "),xu=v(qg,"CODE",{});var Ng=y(xu);ju=E(Ng,"PI"),Ng.forEach(u),Au=E(qg," from the exports of "),Tu=v(qg,"CODE",{});var Rg=y(Tu);Su=E(Rg,"index.js"),Rg.forEach(u),Lu=E(qg," before it is defined, so naturally "),Ou=v(qg,"CODE",{});var $g=y(Ou);Mu=E($g,"PI"),$g.forEach(u),Cu=E(qg," within "),qu=v(qg,"CODE",{});var Hg=y(qu);Nu=E(Hg,"circle.js"),Hg.forEach(u),Ru=E(qg," would stay as "),$u=v(qg,"CODE",{});var Dg=y($u);Hu=E(Dg,"undefined"),Dg.forEach(u),Du=E(qg," throughout the application. However before I called "),Gu=v(qg,"CODE",{});var Gg=y(Gu);Bu=E(Gg,"circleArea"),Gg.forEach(u),Fu=E(qg,", we defined "),Ju=v(qg,"CODE",{});var Bg=y(Ju);Uu=E(Bg,"PI"),Bg.forEach(u),Wu=E(qg," on the "),_u=v(qg,"CODE",{});var Fg=y(_u);zu=E(Fg,"index.js"),Fg.forEach(u),Vu=E(qg,"'s export, I am expecting it to be available."),qg.forEach(u),Yu=b(xg),Ku=v(xg,"P",{});var Jg=y(Ku);Zu=E(Jg,"So I built my application with webpack and took a look at how webpack solved this problem."),Jg.forEach(u),Qu=b(xg),Xu=v(xg,"PRE",{class:!0}),y(Xu).forEach(u),nh=b(xg),ah=v(xg,"P",{});var Ug=y(ah);sh=E(Ug,"Brilliant! The key is to lazily get the value of "),th=v(Ug,"CODE",{});var Wg=y(th);eh=E(Wg,"PI"),Wg.forEach(u),oh=E(Ug," when needed!"),Ug.forEach(u),ph=b(xg),ch=v(xg,"P",{});var _g=y(ch);lh=E(_g,"I changed my babel transformation code, which I am not showing it here. If you are curious enough, you can check out "),ih=v(_g,"A",{href:!0,rel:!0});var zg=y(ih);rh=E(zg,"the changes I made from Github"),zg.forEach(u),uh=E(_g,"."),_g.forEach(u),xg.forEach(u),hh=b(n),kh=v(n,"SECTION",{});var Vg=y(kh);dh=v(Vg,"H2",{});var Yg=y(dh);fh=v(Yg,"A",{href:!0,id:!0});var Kg=y(fh);mh=E(Kg,"Summary"),Kg.forEach(u),Yg.forEach(u),gh=b(Vg),wh=v(Vg,"P",{});var Zg=y(wh);yh=E(Zg,"There's two phases in module bundling: "),vh=v(Zg,"STRONG",{});var Qg=y(vh);Eh=E(Qg,"Dependency Resolution"),Qg.forEach(u),bh=E(Zg," and "),Ih=v(Zg,"STRONG",{});var Xg=y(Ih);Ph=E(Xg,"Bundling"),Xg.forEach(u),xh=E(Zg,"."),Zg.forEach(u),jh=b(Vg),Ah=v(Vg,"P",{});var nw=y(Ah);Th=E(nw,"I showed you how I constructed the dependency graph, by finding import statements and resolving modules. I shared how I created module maps and transformed the imports / exports syntax during "),Sh=v(nw,"STRONG",{});var aw=y(Sh);Lh=E(aw,"bundling"),aw.forEach(u),Oh=E(nw,". Lastly, I fixed the circular dependency bug that was in the first version of my module bundler."),nw.forEach(u),Vg.forEach(u),Mh=b(n),Ch=v(n,"SECTION",{});var sw=y(Ch);qh=v(sw,"H3",{});var tw=y(qh);Nh=v(tw,"A",{href:!0,id:!0});var ew=y(Nh);Rh=E(ew,"Whats next?"),ew.forEach(u),tw.forEach(u),$h=b(sw),Hh=v(sw,"P",{});var ow=y(Hh);Dh=E(ow,"I have a few ideas that I will add to my module bundler, such as:"),ow.forEach(u),Gh=b(sw),Bh=v(sw,"UL",{});var pw=y(Bh);Fh=v(pw,"LI",{});var cw=y(Fh);Jh=E(cw,"code spliting"),cw.forEach(u),Uh=b(pw),Wh=v(pw,"LI",{});var lw=y(Wh);_h=E(lw,"watch mode and reloading"),lw.forEach(u),pw.forEach(u),zh=b(sw),Vh=v(sw,"P",{});var iw=y(Vh);Yh=E(iw,"which I will cover them in my next article when they are ready."),iw.forEach(u),Kh=b(sw),Zh=v(sw,"P",{});var rw=y(Zh);Qh=E(rw,"Till then. Cheers. 😎"),rw.forEach(u),sw.forEach(u),Xh=b(n),nk=v(n,"SECTION",{});var uw=y(nk);ak=v(uw,"H2",{});var hw=y(ak);sk=v(hw,"A",{href:!0,id:!0});var kw=y(sk);tk=E(kw,"Further Readings"),kw.forEach(u),hw.forEach(u),ek=b(uw),ok=v(uw,"UL",{});var dw=y(ok);pk=v(dw,"LI",{});var fw=y(pk);ck=v(fw,"A",{href:!0,rel:!0});var mw=y(ck);lk=E(mw,"Ronen Amiel, Build Your Own Webpack - You Gotta Love Frontend 2018"),mw.forEach(u),fw.forEach(u),ik=b(dw),rk=v(dw,"LI",{});var gw=y(rk);uk=v(gw,"A",{href:!0,rel:!0});var ww=y(uk);hk=E(ww,"Luciano Mammino, Unbundling the JavaScript module bundler - DublinJS July 2018"),ww.forEach(u),gw.forEach(u),kk=b(dw),dk=v(dw,"LI",{});var yw=y(dk);fk=v(yw,"A",{href:!0,rel:!0});var vw=y(fk);mk=E(vw,"Adam Kelly, Let’s learn how module bundlers work and then write one ourselves"),vw.forEach(u),yw.forEach(u),gk=b(dw),wk=v(dw,"LI",{});var Ew=y(wk);yk=v(Ew,"A",{href:!0,rel:!0});var bw=y(yk);vk=E(bw,"Webpack founder Tobias Koppers demos bundling live by hand"),bw.forEach(u),Ew.forEach(u),dw.forEach(u),uw.forEach(u),this.h()},h(){w(o,"href","#getting-started"),w(h,"href","#the-input"),w(I,"href","#writing"),w(j,"href","#resolving"),w(S,"href","#bundling"),w(C,"href","#grouping-modules-into-files"),w(R,"href","#creating-module-map"),w(D,"href","#"),w(B,"href","#optimisation"),w(W,"href","#circular-dependency"),w(V,"href","#summary"),w(Q,"href","#whats-next"),w(an,"href","#further-readings"),w(t,"class","sitemap"),w(t,"id","sitemap"),w(t,"role","navigation"),w(t,"aria-label","Table of Contents"),w(pn,"href","/what-is-module-bundler-and-how-does-it-work/"),w(rn,"href","https://webpack.js.org"),w(rn,"rel","nofollow"),w(kn,"href","https://rollupjs.org"),w(kn,"rel","nofollow"),w(Mn,"href","#getting-started"),w(Mn,"id","getting-started"),w($n,"href","/what-is-module-bundler-and-how-does-it-work/"),w(ka,"href","#the-input"),w(ka,"id","the-input"),w(ya,"class","language-js"),w(Ea,"class","language-js"),w(Ia,"class","language-js"),w(Aa,"href","https://github.com/tanhauhau/byo-bundler/tree/master/fixture"),w(Aa,"rel","nofollow"),w(Da,"href","#writing"),w(Da,"id","writing"),w(Wa,"class","language-js"),w(Xa,"href","https://en.wikipedia.org/wiki/Directed_graph"),w(Xa,"rel","nofollow"),w(ts,"class","language-js"),w(gs,"class","language-js"),w(xs,"class","language-js"),w(Ms,"href","http://babeljs.io"),w(Ms,"rel","nofollow"),w(Ds,"class","language-js"),w(Us,"class","language-js"),w(nt,"href","https://lihautan.com/babel-ast-explorer/#?eyJiYWJlbFNldHRpbmdzIjp7InZlcnNpb24iOiI3LjQuNSJ9LCJ0cmVlU2V0dGluZ3MiOnsiaGlkZUVtcHR5Ijp0cnVlLCJoaWRlTG9jYXRpb24iOnRydWUsImhpZGVUeXBlIjp0cnVlfSwiY29kZSI6ImltcG9ydCBzcXVhcmVBcmVhIGZyb20gJy4vc3F1YXJlLmpzJztcbmltcG9ydCBjaXJjbGVBcmVhIGZyb20gJy4vY2lyY2xlLmpzJztcblxuY29uc29sZS5sb2coJ0FyZWEgb2Ygc3F1YXJlOiAnLCBzcXVhcmVBcmVhKDUpKTtcbmNvbnNvbGUubG9nKCdBcmVhIG9mIGNpcmNsZScsIGNpcmNsZUFyZWEoNSkpO1xuIn0="),w(nt,"rel","nofollow"),w(pt,"type","image/webp"),w(pt,"srcset","f635154d6a84f142.webp"),w(ct,"type","image/jpeg"),w(ct,"srcset","f635154d6a84f142.png"),w(lt,"title","Visualizing AST through babel-ast-explorer"),w(lt,"alt","babel-ast-explorer"),w(lt,"data-src","f635154d6a84f142.png"),w(lt,"loading","lazy"),w(Tt,"class","language-js"),w(Zt,"class","language-js"),w(oe,"href","#resolving"),w(oe,"id","resolving"),w(ge,"class","language-js"),w(ye,"class","language-js"),w(je,"href","http://nodejs.org/api/modules.html#modules_all_together"),w(je,"rel","nofollow"),w(De,"class","language-null"),w(ze,"class","language-null"),w(io,"href","https://webpack.js.org/configuration/resolve/"),w(io,"rel","nofollow"),w(vo,"class","language-js"),w(So,"class","language-js"),w(qo,"class","language-js"),w(tp,"href","#bundling"),w(tp,"id","bundling"),w(Cp,"href","/what-is-module-bundler-and-how-does-it-work/"),w(Gp,"class","language-js"),w(lc,"href","#grouping-modules-into-files"),w(lc,"id","grouping-modules-into-files"),w(kc,"href","https://webpack.js.org/guides/code-splitting/"),w(kc,"rel","nofollow"),w(mc,"href","https://webpack.js.org/plugins/split-chunks-plugin/"),w(mc,"rel","nofollow"),w(jc,"class","language-js"),w(Cc,"href","#creating-module-map"),w(Cc,"id","creating-module-map"),w(Xc,"href","https://documentation.progress.com/output/ua/OpenEdge_latest/index.html#page/dvjsn/json-data-types.html"),w(Xc,"rel","nofollow"),w(pl,"class","language-js"),w(Tl,"class","language-js"),w(Zl,"class","language-js"),w(si,"href","/step-by-step-guide-for-writing-a-babel-transformation"),w(fi,"class","language-js"),w(yi,"href","https://github.com/tanhauhau/byo-bundler/blob/feat-2-bundling/src/index.js#L46-L138"),w(yi,"rel","nofollow"),w(xi,"class","language-js"),w(Ni,"href","#"),w(Ni,"id",""),w(Wi,"class","language-js"),w(Qi,"href","/what-is-module-bundler-and-how-does-it-work/"),w(lr,"class","language-js"),w(mr,"class","language-null"),w(Sr,"href","#optimisation"),w(Sr,"id","optimisation"),w(Br,"class","language-js"),w(Jr,"class","language-js"),w(Vr,"class","language-null"),w(Qr,"href","#circular-dependency"),w(Qr,"id","circular-dependency"),w(uu,"class","language-js"),w(mu,"class","language-sh"),w(Eu,"class","language-js"),w(Xu,"class","language-js"),w(ih,"href","https://github.com/tanhauhau/byo-bundler/compare/feat-2-bundling...feat-3-circular-dependency"),w(ih,"rel","nofollow"),w(fh,"href","#summary"),w(fh,"id","summary"),w(Nh,"href","#whats-next"),w(Nh,"id","whats-next"),w(sk,"href","#further-readings"),w(sk,"id","further-readings"),w(ck,"href","https://www.youtube.com/watch?v=Gc9-7PBqOC8"),w(ck,"rel","nofollow"),w(uk,"href","https://slides.com/lucianomammino/unbundling-the-javascript-module-bundler-dublinjs"),w(uk,"rel","nofollow"),w(fk,"href","https://www.freecodecamp.org/news/lets-learn-how-module-bundlers-work-and-then-write-one-ourselves-b2e3fe6c88ae/"),w(fk,"rel","nofollow"),w(yk,"href","https://www.youtube.com/watch?v=UNMkLHzofQI"),w(yk,"rel","nofollow")},m(n,a){r(n,s,a),i(s,t),i(t,e),i(e,o),i(o,p),i(t,c),i(c,l),i(l,h),i(h,d),i(t,g),i(g,I),i(I,P),i(t,x),i(x,j),i(j,A),i(t,T),i(T,S),i(S,L),i(t,O),i(O,M),i(M,C),i(C,q),i(O,N),i(N,R),i(R,$),i(O,H),i(H,D),i(t,G),i(G,B),i(B,F),i(t,J),i(J,U),i(U,W),i(W,_),i(t,z),i(z,V),i(V,Y),i(t,K),i(K,Z),i(Z,Q),i(Q,X),i(t,nn),i(nn,an),i(an,sn),r(n,tn,a),r(n,en,a),i(en,on),i(en,pn),i(pn,cn),i(en,ln),i(en,rn),i(rn,un),i(en,hn),i(en,kn),i(kn,dn),i(en,fn),r(n,mn,a),r(n,gn,a),i(gn,wn),r(n,yn,a),r(n,vn,a),r(n,En,a),r(n,bn,a),i(bn,In),i(bn,Pn),i(Pn,xn),i(bn,jn),r(n,An,a),r(n,Tn,a),r(n,Sn,a),r(n,Ln,a),i(Ln,On),i(On,Mn),i(Mn,Cn),i(Ln,qn),i(Ln,Nn),i(Nn,Rn),i(Nn,$n),i($n,Hn),i(Nn,Dn),i(Ln,Gn),i(Ln,Bn),i(Bn,Fn),i(Bn,Jn),i(Jn,Un),i(Bn,Wn),i(Ln,_n),i(Ln,zn),i(zn,Vn),i(Vn,Yn),i(Vn,Kn),i(Kn,Zn),i(zn,Qn),i(zn,Xn),i(Xn,na),i(Xn,aa),i(aa,sa),i(Ln,ta),i(Ln,ea),i(ea,oa),i(oa,pa),i(oa,ca),i(ca,la),i(oa,ia),r(n,ra,a),r(n,ua,a),i(ua,ha),i(ha,ka),i(ka,da),i(ua,fa),i(ua,ma),i(ma,ga),i(ua,wa),i(ua,ya),ya.innerHTML='<code class="language-js"><span class="token comment">// filename: index.js</span>\n<span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',i(ua,va),i(ua,Ea),Ea.innerHTML='<code class="language-js"><span class="token comment">// filename: square.js</span>\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',i(ua,ba),i(ua,Ia),Ia.innerHTML='<code class="language-js"><span class="token comment">// filename: circle.js</span>\n<span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',i(ua,Pa),i(ua,xa),i(xa,ja),i(xa,Aa),i(Aa,Ta),i(xa,Sa),i(xa,La),i(La,Oa),i(xa,Ma),i(xa,Ca),i(Ca,qa),i(xa,Na),r(n,Ra,a),r(n,$a,a),i($a,Ha),i(Ha,Da),i(Da,Ga),i($a,Ba),i($a,Fa),i(Fa,Ja),i($a,Ua),i($a,Wa),Wa.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">&#123;</span> entryFile<span class="token punctuation">,</span> outputFolder <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// build dependency graph</span>\n  <span class="token keyword">const</span> graph <span class="token operator">=</span> <span class="token function">createDependencyGraph</span><span class="token punctuation">(</span>entryFile<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// bundle the asset</span>\n  <span class="token keyword">const</span> outputFiles <span class="token operator">=</span> <span class="token function">bundle</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token comment">// write to output folder</span>\n  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">const</span> outputFile <span class="token keyword">of</span> outputFiles<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>\n      path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>outputFolder<span class="token punctuation">,</span> outputFile<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span>\n      outputFile<span class="token punctuation">.</span>content<span class="token punctuation">,</span>\n      <span class="token string">\'utf-8\'</span>\n    <span class="token punctuation">)</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',i($a,_a),i($a,za),i(za,Va),i(Va,Ya),i(Va,Ka),i(Ka,Za),i(Va,Qa),i(Va,Xa),i(Xa,ns),i(Va,as),i($a,ss),i($a,ts),ts.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">createDependencyGraph</span><span class="token punctuation">(</span><span class="token parameter">entryFile</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> rootModule <span class="token operator">=</span> <span class="token function">createModule</span><span class="token punctuation">(</span>entryFile<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">return</span> rootModule<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',i($a,es),i($a,os),i(os,ps),i($a,cs),i($a,ls),i(ls,is),i(ls,rs),i(rs,us),i(ls,hs),i(ls,ks),i(ks,ds),i(ls,fs),i($a,ms),i($a,gs),gs.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">createModule</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',i($a,ws),i($a,ys),i(ys,vs),i(ys,Es),i(Es,bs),i(ys,Is),i($a,Ps),i($a,xs),xs.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',i($a,js),i($a,As),i(As,Ts),i(As,Ss),i(Ss,Ls),i(As,Os),i(As,Ms),i(Ms,Cs),i(As,qs),i(As,Ns),i(Ns,Rs),i(As,$s),i($a,Hs),i($a,Ds),Ds.innerHTML='<code class="language-js"><span class="prism-highlight-code-line"><span class="token keyword">const</span> babel <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'@babel/core\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">parseSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',i($a,Gs),i($a,Bs),i(Bs,Fs),i($a,Js),i($a,Us),Us.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>filePath <span class="token operator">=</span> filePath<span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> <span class="token string">\'utf-8\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">parseSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="prism-highlight-code-line">  <span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">    <span class="token comment">//</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="token punctuation">&#125;</span></code>',i($a,Ws),i($a,_s),i(_s,zs),i($a,Vs),i($a,Ys),i(Ys,Ks),i(Ys,Zs),i(Zs,Qs),i(Ys,Xs),i(Ys,nt),i(nt,at),i(Ys,st),i($a,tt),i($a,et),i(et,ot),i(ot,pt),i(ot,ct),i(ot,lt),i($a,it),i($a,rt),i(rt,ut),i(rt,ht),i(ht,kt),i(rt,dt),i(rt,ft),i(ft,mt),i(rt,gt),i(rt,wt),i(wt,yt),i(rt,vt),i(rt,Et),i(Et,bt),i(rt,It),i(rt,Pt),i(Pt,xt),i(rt,jt),i($a,At),i($a,Tt),Tt.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body</span>\n<span class="prism-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span></span>\n<span class="prism-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span></span>\n<span class="token punctuation">&#125;</span></code>',i($a,St),i($a,Lt),i(Lt,Ot),i(Lt,Mt),i(Mt,Ct),i(Lt,qt),i(Lt,Nt),i(Nt,Rt),i(Lt,$t),i(Lt,Ht),i(Ht,Dt),i(Lt,Gt),i(Lt,Bt),i(Bt,Ft),i(Lt,Jt),i($a,Ut),i($a,Wt),i(Wt,_t),i(Wt,zt),i(zt,Vt),i(Wt,Yt),i($a,Kt),i($a,Zt),Zt.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n<span class="prism-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span> <span class="token operator">=></span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="token punctuation">&#125;</span>\n\n<span class="prism-highlight-code-line"><span class="token comment">// resolving</span></span>\n<span class="prism-highlight-code-line"><span class="token keyword">function</span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token parameter">requester<span class="token punctuation">,</span> requestedPath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">  <span class="token comment">//</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span></code>',i($a,Qt),i($a,Xt),i(Xt,ne),i(ne,ae),r(n,se,a),r(n,te,a),i(te,ee),i(ee,oe),i(oe,pe),i(te,ce),i(te,le),i(le,ie),i(le,re),i(re,ue),i(le,he),i(le,ke),i(ke,de),i(le,fe),i(te,me),i(te,ge),ge.innerHTML='<code class="language-js"><span class="token comment">// filename: project/a.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./b.js\'</span><span class="token punctuation">;</span></code>',i(te,we),i(te,ye),ye.innerHTML='<code class="language-js"><span class="token comment">// filename: project/foo/a.js</span>\n<span class="token keyword">import</span> <span class="token string">\'./b.js\'</span><span class="token punctuation">;</span></code>',i(te,ve),i(te,Ee),i(Ee,be),i(te,Ie),i(te,Pe),i(Pe,xe),i(Pe,je),i(je,Ae),i(Pe,Te),i(te,Se),i(te,Le),i(Le,Oe),i(Le,Me),i(Me,Ce),i(Le,qe),i(Le,Ne),i(Ne,Re),i(Le,$e),i(te,He),i(te,De),De.innerHTML='<code class="language-">b\nb.js\nb.json\nb.node</code>',i(te,Ge),i(te,Be),i(Be,Fe),i(Be,Je),i(Je,Ue),i(Be,We),i(te,_e),i(te,ze),ze.innerHTML='<code class="language-">&quot;main&quot; in b/package.json\nb/index.js\nb/index.json\nb/index.node</code>',i(te,Ve),i(te,Ye),i(Ye,Ke),i(Ye,Ze),i(Ze,Qe),i(Ye,Xe),i(Ye,no),i(no,ao),i(Ye,so),i(te,to),i(te,eo),i(eo,oo),i(eo,po),i(po,co),i(eo,lo),i(eo,io),i(io,ro),i(eo,uo),i(te,ho),i(te,ko),i(ko,fo),i(ko,mo),i(mo,go),i(ko,wo),i(te,yo),i(te,vo),vo.innerHTML='<code class="language-js"><span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'path\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line"><span class="token comment">// resolving</span></span>\n<span class="prism-highlight-code-line"><span class="token keyword">function</span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token parameter">requester<span class="token punctuation">,</span> requestedPath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">dirname</span><span class="token punctuation">(</span>requester<span class="token punctuation">)</span><span class="token punctuation">,</span> requestedPath<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span></code>',i(te,Eo),i(te,bo),i(bo,Io),i(Io,Po),i(te,xo),i(te,jo),i(jo,Ao),i(te,To),i(te,So),So.innerHTML='<code class="language-js"><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">.</span>program<span class="token punctuation">.</span>body\n    <span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">\'ImportDeclaration\'</span><span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">node</span> <span class="token operator">=></span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">)</span>\n    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">relativePath</span> <span class="token operator">=></span> <span class="token function">resolveRequest</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>filePath<span class="token punctuation">,</span> relativePath<span class="token punctuation">)</span><span class="token punctuation">)</span>\n<span class="prism-highlight-code-line">    <span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">absolutePath</span> <span class="token operator">=></span> <span class="token function">createModule</span><span class="token punctuation">(</span>absolutePath<span class="token punctuation">)</span><span class="token punctuation">)</span></span>\n<span class="token punctuation">&#125;</span></code>',i(te,Lo),i(te,Oo),i(Oo,Mo),i(te,Co),i(te,qo),qo.innerHTML='<code class="language-js">Module <span class="token punctuation">&#123;</span>\n  filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/index.js\'</span><span class="token punctuation">,</span>\n  content<span class="token punctuation">:</span>\n   <span class="token string">\'import squareArea from \'./square.js\';&#92;nimport circleArea from \'./circle.js\';&#92;n&#92;nconsole.log(\'Area of square: \', squareArea(5));&#92;nconsole.log(\'Area of circle\', circleArea(5));&#92;n\'</span><span class="token punctuation">,</span>\n  ast<span class="token punctuation">:</span>\n   Node <span class="token punctuation">&#123;</span> <span class="token comment">/*...*/</span> <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  dependencies<span class="token punctuation">:</span>\n   <span class="token punctuation">[</span> Module <span class="token punctuation">&#123;</span>\n       filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/square.js\'</span><span class="token punctuation">,</span>\n       content<span class="token punctuation">:</span>\n        <span class="token string">\'function area(side) &#123;&#92;n  return side * side;&#92;n&#125;&#92;nexport default area;&#92;n\'</span><span class="token punctuation">,</span>\n       ast<span class="token punctuation">:</span> Node <span class="token punctuation">&#123;</span><span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n       dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n     Module <span class="token punctuation">&#123;</span>\n       filePath<span class="token punctuation">:</span> <span class="token string">\'/Projects/byo-bundler/fixture/circle.js\'</span><span class="token punctuation">,</span>\n       content<span class="token punctuation">:</span>\n        <span class="token string">\'const PI = 3.141;&#92;nfunction area(radius) &#123;&#92;n    return PI * radius * radius;&#92;n&#125;&#92;nexport default area;&#92;n\'</span><span class="token punctuation">,</span>\n       ast<span class="token punctuation">:</span> Node <span class="token punctuation">&#123;</span><span class="token comment">/* ... */</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n       dependencies<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>\n      <span class="token punctuation">&#125;</span>\n   <span class="token punctuation">]</span>\n<span class="token punctuation">&#125;</span></code>',i(te,No),i(te,Ro),i(Ro,$o),i(Ro,Ho),i(Ho,Do),i(Ro,Go),i(Ro,Bo),i(Bo,Fo),i(Ro,Jo),i(Ro,Uo),i(Uo,Wo),i(Ro,_o),i(Ro,zo),i(zo,Vo),i(Ro,Yo),i(te,Ko),i(te,Zo),i(Zo,Qo),i(Qo,Xo),r(n,np,a),r(n,ap,a),i(ap,sp),i(sp,tp),i(tp,ep),i(ap,op),i(ap,pp),i(pp,cp),i(ap,lp),i(ap,ip),i(ip,rp),i(ip,up),i(up,hp),i(ip,kp),i(ip,dp),i(dp,fp),i(ip,mp),i(ip,gp),i(gp,wp),i(ip,yp),i(ip,vp),i(vp,Ep),i(ip,bp),i(ap,Ip),i(ap,Pp),i(Pp,xp),i(xp,jp),i(xp,Ap),i(Ap,Tp),i(xp,Sp),i(xp,Lp),i(Lp,Op),i(xp,Mp),i(xp,Cp),i(Cp,qp),i(xp,Np),i(ap,Rp),i(ap,$p),i($p,Hp),i(ap,Dp),i(ap,Gp),Gp.innerHTML='<code class="language-js"><span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">&#123;</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'square.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    exports<span class="token punctuation">.</span><span class="token function-variable function">default</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'app.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> squareArea <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>\n    <span class="token keyword">const</span> circleArea <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>default<span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n\n<span class="token function">webpackStart</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n  modules<span class="token punctuation">,</span>\n  entry<span class="token punctuation">:</span> <span class="token string">\'app.js\'</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',i(ap,Bp),i(ap,Fp),i(Fp,Jp),i(ap,Up),i(ap,Wp),i(Wp,_p),i(_p,zp),i(zp,Vp),i(Wp,Yp),i(Wp,Kp),i(Kp,Zp),i(Zp,Qp),i(Kp,Xp),i(Wp,nc),i(Wp,ac),i(ac,sc),i(sc,tc),i(ac,ec),r(n,oc,a),r(n,pc,a),i(pc,cc),i(cc,lc),i(lc,ic),i(pc,rc),i(pc,uc),i(uc,hc),i(uc,kc),i(kc,dc),i(uc,fc),i(uc,mc),i(mc,gc),i(uc,wc),i(pc,yc),i(pc,vc),i(vc,Ec),i(pc,bc),i(pc,Ic),i(Ic,Pc),i(pc,xc),i(pc,jc),jc.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n<span class="prism-highlight-code-line">  <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="prism-highlight-code-line"><span class="token keyword">function</span> <span class="token function">collectModules</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token function">collect</span><span class="token punctuation">(</span>graph<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> modules<span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line"></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">function</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">    modules<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">    module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=></span> <span class="token function">collect</span><span class="token punctuation">(</span>dependency<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span></code>',i(pc,Ac),i(pc,Tc),i(Tc,Sc),r(n,Lc,a),r(n,Oc,a),i(Oc,Mc),i(Mc,Cc),i(Cc,qc),i(Oc,Nc),i(Oc,Rc),i(Rc,$c),i(Oc,Hc),i(Oc,Dc),i(Dc,Gc),i(Dc,Bc),i(Bc,Fc),i(Dc,Jc),i(Dc,Uc),i(Uc,Wc),i(Dc,_c),i(Oc,zc),i(Oc,Vc),i(Vc,Yc),i(Vc,Kc),i(Kc,Zc),i(Vc,Qc),i(Vc,Xc),i(Xc,nl),i(Vc,al),i(Vc,sl),i(sl,tl),i(Vc,el),i(Oc,ol),i(Oc,pl),pl.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n\n<span class="prism-highlight-code-line"><span class="token keyword">function</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span><span class="token parameter">modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">let</span> moduleMap <span class="token operator">=</span> <span class="token string">\'\'</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  moduleMap <span class="token operator">+=</span> <span class="token string">\'&#123;\'</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line"></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">    moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">": </span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">    moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">function(exports, require) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;,</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="prism-highlight-code-line"></span>\n<span class="prism-highlight-code-line">  moduleMap <span class="token operator">+=</span> <span class="token string">\'&#125;\'</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> moduleMap<span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span></code>',i(Oc,cl),i(Oc,ll),i(ll,il),i(ll,rl),i(rl,ul),i(ll,hl),i(Oc,kl),i(Oc,dl),i(dl,fl),i(fl,ml),i(ml,gl),i(fl,wl),i(dl,yl),i(dl,vl),i(vl,El),i(El,bl),i(vl,Il),i(Oc,Pl),i(Oc,xl),i(xl,jl),i(Oc,Al),i(Oc,Tl),Tl.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">"index.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n    <span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"square.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    <span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"circle.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    <span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',i(Oc,Sl),i(Oc,Ll),i(Ll,Ol),i(Ll,Ml),i(Ml,Cl),i(Ll,ql),i(Ll,Nl),i(Nl,Rl),i(Ll,$l),i(Ll,Hl),i(Hl,Dl),i(Ll,Gl),i(Ll,Bl),i(Bl,Fl),i(Ll,Jl),i(Oc,Ul),i(Oc,Wl),i(Wl,_l),i(Oc,zl),i(Oc,Vl),i(Vl,Yl),i(Oc,Kl),i(Oc,Zl),Zl.innerHTML='<code class="language-js"><span class="token comment">// #1</span>\n<span class="token comment">// from</span>\n<span class="token keyword">import</span> a<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> b<span class="token punctuation">,</span> c <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'foo\'</span><span class="token punctuation">;</span>\n<span class="token comment">// to</span>\n<span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> a<span class="token punctuation">,</span> b<span class="token punctuation">,</span> c <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'foo\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment">// #2</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> a<span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token keyword">const</span> b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\n<span class="token keyword">export</span> <span class="token punctuation">&#123;</span> c <span class="token punctuation">&#125;</span><span class="token punctuation">;</span>\n<span class="token comment">// to</span>\nexports<span class="token punctuation">.</span>default <span class="token operator">=</span> a<span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>b <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>\nexports<span class="token punctuation">.</span>c <span class="token operator">=</span> c<span class="token punctuation">;</span></code>',i(Oc,Ql),i(Oc,Xl),i(Xl,ni),i(ni,ai),i(ni,si),i(si,ti),i(ni,ei),i(Oc,oi),i(Oc,pi),i(pi,ci),i(pi,li),i(li,ii),i(pi,ri),i(pi,ui),i(ui,hi),i(pi,ki),i(Oc,di),i(Oc,fi),fi.innerHTML='<code class="language-js"><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> module <span class="token keyword">of</span> modules<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n<span class="prism-highlight-code-line">  module<span class="token punctuation">.</span><span class="token function">transformModuleInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  moduleMap <span class="token operator">+=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>filePath<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">": function(exports, require) &#123; </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>module<span class="token punctuation">.</span>content<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string"> &#125;,</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token comment">// ...</span>\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n<span class="prism-highlight-code-line">  <span class="token function">transformModuleInterface</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> ast<span class="token punctuation">,</span> code <span class="token punctuation">&#125;</span> <span class="token operator">=</span> babel<span class="token punctuation">.</span><span class="token function">transformFromAstSync</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>ast<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>content<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> <span class="token operator">...</span> <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>ast <span class="token operator">=</span> ast<span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>content <span class="token operator">=</span> code<span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="token punctuation">&#125;</span></code>',i(Oc,mi),i(Oc,gi),i(gi,wi),i(gi,yi),i(yi,vi),i(Oc,Ei),i(Oc,bi),i(bi,Ii),i(Oc,Pi),i(Oc,xi),xi.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">"index.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> squareArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> circleArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"square.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">side</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> side <span class="token operator">*</span> side<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">"circle.js"</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',i(Oc,ji),i(Oc,Ai),i(Ai,Ti),i(Ai,Si),i(Si,Li),i(Ai,Oi),r(n,Mi,a),r(n,Ci,a),i(Ci,qi),i(qi,Ni),i(Ni,Ri),i(Ri,$i),i(Ci,Hi),i(Ci,Di),i(Di,Gi),i(Ci,Bi),i(Ci,Fi),i(Fi,Ji),i(Ci,Ui),i(Ci,Wi),Wi.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> moduleCode <span class="token operator">=</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="prism-highlight-code-line"><span class="token keyword">function</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span><span class="token parameter">moduleMap<span class="token punctuation">,</span> entryPoint</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string"></span></span>\n<span class="prism-highlight-code-line"><span class="token string">    const modules = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>moduleMap<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">    const entry = "</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>entryPoint<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">";</span></span>\n<span class="prism-highlight-code-line"><span class="token string">    function webpackStart(&#123; modules, entry &#125;) &#123;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">      const moduleCache = &#123;&#125;;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">      const require = moduleName => &#123;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        // if in cache, return the cached version</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        if (moduleCache[moduleName]) &#123;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">          return moduleCache[moduleName];</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        &#125;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        const exports = &#123;&#125;;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        // this will prevent infinite "require" loop</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        // from circular dependencies</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        moduleCache[moduleName] = exports;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">    </span></span>\n<span class="prism-highlight-code-line"><span class="token string">        // "require"-ing the module,</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        // exported stuff will assigned to "exports"</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        modules[moduleName](exports, require);</span></span>\n<span class="prism-highlight-code-line"><span class="token string">        return moduleCache[moduleName];</span></span>\n<span class="prism-highlight-code-line"><span class="token string">      &#125;;</span></span>\n<span class="prism-highlight-code-line"><span class="token string">    </span></span>\n<span class="prism-highlight-code-line"><span class="token string">      // start the program</span></span>\n<span class="prism-highlight-code-line"><span class="token string">      require(entry);</span></span>\n<span class="prism-highlight-code-line"><span class="token string">    &#125;</span></span>\n<span class="prism-highlight-code-line"><span class="token string"></span></span>\n<span class="prism-highlight-code-line"><span class="token string">    webpackStart(&#123; modules, entry &#125;);</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span>\n<span class="prism-highlight-code-line"></span>\n<span class="prism-highlight-code-line"><span class="token comment">// trim away spaces before the line</span></span>\n<span class="prism-highlight-code-line"><span class="token keyword">function</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> lines <span class="token operator">=</span> str<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">\'&#92;n\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>Boolean<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> padLength <span class="token operator">=</span> lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token operator">-</span> lines<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">trimLeft</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> regex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">^\\s&#123;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span>padLength<span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">&#125;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> lines<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">line</span> <span class="token operator">=></span> line<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span>regex<span class="token punctuation">,</span> <span class="token string">\'\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">\'&#92;n\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span></code>',i(Ci,_i),i(Ci,zi),i(zi,Vi),i(zi,Yi),i(Yi,Ki),i(zi,Zi),i(zi,Qi),i(Qi,Xi),i(zi,nr),i(Ci,ar),i(Ci,sr),i(sr,tr),i(sr,er),i(er,or),i(sr,pr),i(Ci,cr),i(Ci,lr),lr.innerHTML='<code class="language-js"><span class="token keyword">function</span> <span class="token function">bundle</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token function">collectModules</span><span class="token punctuation">(</span>graph<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleMap <span class="token operator">=</span> <span class="token function">toModuleMap</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> moduleCode <span class="token operator">=</span> <span class="token function">addRuntime</span><span class="token punctuation">(</span>moduleMap<span class="token punctuation">,</span> modules<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">&#123;</span> name<span class="token punctuation">:</span> <span class="token string">\'bundle.js\'</span><span class="token punctuation">,</span> content<span class="token punctuation">:</span> moduleCode <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>\n<span class="token punctuation">&#125;</span></code>',i(Ci,ir),i(Ci,rr),i(rr,ur),i(rr,hr),i(hr,kr),i(rr,dr),i(Ci,fr),i(Ci,mr),mr.innerHTML='<code class="language-">Area of square:  25\nArea of circle 78.525</code>',i(Ci,gr),i(Ci,wr),i(wr,yr),i(Ci,vr),i(Ci,Er),i(Er,br),i(Er,Ir),i(Ir,Pr),i(Er,xr),r(n,jr,a),r(n,Ar,a),i(Ar,Tr),i(Tr,Sr),i(Sr,Lr),i(Ar,Or),i(Ar,Mr),i(Mr,Cr),i(Mr,qr),i(qr,Nr),i(Mr,Rr),i(Ar,$r),i(Ar,Hr),i(Hr,Dr),i(Ar,Gr),i(Ar,Br),Br.innerHTML='<code class="language-js"><span class="token comment">// filename: index.js</span>\n<span class="token keyword">import</span> squareArea <span class="token keyword">from</span> <span class="token string">\'./square.js\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> circleArea <span class="token keyword">from</span> <span class="token string">\'./circle.js\'</span><span class="token punctuation">;</span>\n\n<span class="prism-highlight-code-line"><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span></span>\n\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nconsole<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',i(Ar,Fr),i(Ar,Jr),Jr.innerHTML='<code class="language-js"><span class="token comment">// filename: circle.js</span>\n<span class="prism-highlight-code-line"><span class="token comment">// const PI = 3.141;</span></span>\n<span class="prism-highlight-code-line"><span class="token keyword">import</span> <span class="token punctuation">&#123;</span> <span class="token constant">PI</span> <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'./index.js\'</span><span class="token punctuation">;</span></span>\n\n<span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span>\n<span class="token keyword">export</span> <span class="token keyword">default</span> area<span class="token punctuation">;</span></code>',i(Ar,Ur),i(Ar,Wr),i(Wr,_r),i(Ar,zr),i(Ar,Vr),Vr.innerHTML='<code class="language-">RangeError: Maximum call stack size exceeded</code>',r(n,Yr,a),r(n,Kr,a),i(Kr,Zr),i(Zr,Qr),i(Qr,Xr),i(Kr,nu),i(Kr,au),i(au,su),i(Kr,tu),i(Kr,eu),i(eu,ou),i(ou,pu),i(eu,cu),i(eu,lu),i(lu,iu),i(Kr,ru),i(Kr,uu),uu.innerHTML='<code class="language-js"><span class="token comment">// fixing circular dependencies when generating module graph</span>\n<span class="prism-highlight-code-line"><span class="token keyword">const</span> <span class="token constant">MODULE_CACHE</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n\n<span class="token keyword">function</span> <span class="token function">createModule</span><span class="token punctuation">(</span><span class="token parameter">filePath</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n<span class="prism-highlight-code-line"> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n   <span class="token keyword">const</span> module <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Module</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">   <span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>filePath<span class="token punctuation">,</span> module<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">   module<span class="token punctuation">.</span><span class="token function">initDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n <span class="token punctuation">&#125;</span>\n<span class="prism-highlight-code-line"> <span class="token keyword">return</span> <span class="token constant">MODULE_CACHE</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>filePath<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">Module</span> <span class="token punctuation">&#123;</span>\n  <span class="token operator">...</span>\n<span class="prism-highlight-code-line">  <span class="token function">initDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">    <span class="token keyword">this</span><span class="token punctuation">.</span>dependencies <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">findDependencies</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="token punctuation">&#125;</span>\n\n<span class="token comment">// fixing circular dependencies when traversing module graph</span>\n<span class="token keyword">function</span> <span class="token function">collectModules</span><span class="token punctuation">(</span><span class="token parameter">graph</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n<span class="prism-highlight-code-line">  <span class="token keyword">const</span> modules <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Set</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n  <span class="token function">collect</span><span class="token punctuation">(</span>graph<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="prism-highlight-code-line">  <span class="token keyword">return</span> Array<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>modules<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n\n<span class="prism-highlight-code-line">  <span class="token keyword">function</span> <span class="token function">collect</span><span class="token punctuation">(</span><span class="token parameter">module<span class="token punctuation">,</span> modules</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>modules<span class="token punctuation">.</span><span class="token function">has</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></span>\n<span class="prism-highlight-code-line">      modules<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">      module<span class="token punctuation">.</span>dependencies<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">dependency</span> <span class="token operator">=></span> <span class="token function">collect</span><span class="token punctuation">(</span>dependency<span class="token punctuation">,</span> modules<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>\n<span class="prism-highlight-code-line">    <span class="token punctuation">&#125;</span></span>\n<span class="prism-highlight-code-line">  <span class="token punctuation">&#125;</span></span>\n<span class="prism-highlight-code-line"><span class="token punctuation">&#125;</span></span></code>',i(Kr,hu),i(Kr,ku),i(ku,du),i(Kr,fu),i(Kr,mu),mu.innerHTML='<code class="language-sh">$ node output/bundle.js\nArea of square:  <span class="token number">25</span>\nArea of circle NaN</code>',i(Kr,gu),i(Kr,wu),i(wu,yu),i(Kr,vu),i(Kr,Eu),Eu.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">\'index.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> squareArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 1. require circle.js</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token keyword">default</span><span class="token punctuation">:</span> circleArea <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 3. define PI on exports</span>\n    exports<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> <span class="token function">squareArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 4. call &#96;circleArea&#96;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> <span class="token function">circleArea</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// 2. at the point of executing this, PI is not yet defined</span>\n    <span class="token keyword">const</span> <span class="token punctuation">&#123;</span> <span class="token constant">PI</span><span class="token punctuation">:</span> <span class="token constant">PI</span> <span class="token punctuation">&#125;</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'index.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// 5. PI is undefined</span>\n      <span class="token keyword">return</span> <span class="token constant">PI</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',i(Kr,bu),i(Kr,Iu),i(Iu,Pu),i(Iu,xu),i(xu,ju),i(Iu,Au),i(Iu,Tu),i(Tu,Su),i(Iu,Lu),i(Iu,Ou),i(Ou,Mu),i(Iu,Cu),i(Iu,qu),i(qu,Nu),i(Iu,Ru),i(Iu,$u),i($u,Hu),i(Iu,Du),i(Iu,Gu),i(Gu,Bu),i(Iu,Fu),i(Iu,Ju),i(Ju,Uu),i(Iu,Wu),i(Iu,_u),i(_u,zu),i(Iu,Vu),i(Kr,Yu),i(Kr,Ku),i(Ku,Zu),i(Kr,Qu),i(Kr,Xu),Xu.innerHTML='<code class="language-js"><span class="token punctuation">&#123;</span>\n  <span class="token string">\'index.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">const</span> square_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'square.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 1. require circle.js</span>\n    <span class="token keyword">const</span> circle_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'circle.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 3. define PI on exports</span>\n    exports<span class="token punctuation">.</span><span class="token constant">PI</span> <span class="token operator">=</span> <span class="token number">3.141</span><span class="token punctuation">;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of square: \'</span><span class="token punctuation">,</span> square_import<span class="token punctuation">[</span><span class="token string">\'default\'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// 4. call &#96;circleArea&#96;</span>\n    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">\'Area of circle\'</span><span class="token punctuation">,</span> circle_import<span class="token punctuation">[</span><span class="token string">\'default\'</span><span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n  <span class="token string">\'circle.js\'</span><span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">exports<span class="token punctuation">,</span> require</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token comment">// 2. we keep a reference of the &#96;index.js&#96;\'s &#96;exports&#96; object</span>\n    <span class="token keyword">const</span> index_import <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'index.js\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token keyword">function</span> <span class="token function">area</span><span class="token punctuation">(</span><span class="token parameter">radius</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// 5. we get PI from the &#96;exports&#96;</span>\n      <span class="token keyword">return</span> index_import<span class="token punctuation">[</span><span class="token string">\'PI\'</span><span class="token punctuation">]</span> <span class="token operator">*</span> radius <span class="token operator">*</span> radius<span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span>\n    exports<span class="token punctuation">.</span>default <span class="token operator">=</span> area<span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>\n<span class="token punctuation">&#125;</span></code>',i(Kr,nh),i(Kr,ah),i(ah,sh),i(ah,th),i(th,eh),i(ah,oh),i(Kr,ph),i(Kr,ch),i(ch,lh),i(ch,ih),i(ih,rh),i(ch,uh),r(n,hh,a),r(n,kh,a),i(kh,dh),i(dh,fh),i(fh,mh),i(kh,gh),i(kh,wh),i(wh,yh),i(wh,vh),i(vh,Eh),i(wh,bh),i(wh,Ih),i(Ih,Ph),i(wh,xh),i(kh,jh),i(kh,Ah),i(Ah,Th),i(Ah,Sh),i(Sh,Lh),i(Ah,Oh),r(n,Mh,a),r(n,Ch,a),i(Ch,qh),i(qh,Nh),i(Nh,Rh),i(Ch,$h),i(Ch,Hh),i(Hh,Dh),i(Ch,Gh),i(Ch,Bh),i(Bh,Fh),i(Fh,Jh),i(Bh,Uh),i(Bh,Wh),i(Wh,_h),i(Ch,zh),i(Ch,Vh),i(Vh,Yh),i(Ch,Kh),i(Ch,Zh),i(Zh,Qh),r(n,Xh,a),r(n,nk,a),i(nk,ak),i(ak,sk),i(sk,tk),i(nk,ek),i(nk,ok),i(ok,pk),i(pk,ck),i(ck,lk),i(ok,ik),i(ok,rk),i(rk,uk),i(uk,hk),i(ok,kk),i(ok,dk),i(dk,fk),i(fk,mk),i(ok,gk),i(ok,wk),i(wk,yk),i(yk,vk)},p:n,d(n){n&&u(s),n&&u(tn),n&&u(en),n&&u(mn),n&&u(gn),n&&u(yn),n&&u(vn),n&&u(En),n&&u(bn),n&&u(An),n&&u(Tn),n&&u(Sn),n&&u(Ln),n&&u(ra),n&&u(ua),n&&u(Ra),n&&u($a),n&&u(se),n&&u(te),n&&u(np),n&&u(ap),n&&u(oc),n&&u(pc),n&&u(Lc),n&&u(Oc),n&&u(Mi),n&&u(Ci),n&&u(jr),n&&u(Ar),n&&u(Yr),n&&u(Kr),n&&u(hh),n&&u(kh),n&&u(Mh),n&&u(Ch),n&&u(Xh),n&&u(nk)}}}function kn(n){let s,t;const e=[dn];let o={$$slots:{default:[hn]},$$scope:{ctx:n}};for(let n=0;n<e.length;n+=1)o=a(o,e[n]);return s=new un({props:o}),{c(){J(s.$$.fragment)},l(n){U(s.$$.fragment,n)},m(n,a){W(s,n,a),t=!0},p(n,[a]){const t=0&a?function(n,a){const s={},t={},e={$$scope:1};let o=n.length;for(;o--;){const p=n[o],c=a[o];if(c){for(const n in p)n in c||(t[n]=1);for(const n in c)e[n]||(s[n]=c[n],e[n]=1);n[o]=c}else for(const n in p)e[n]=1}for(const n in t)n in s||(s[n]=void 0);return s}(e,[(o=dn,"object"==typeof o&&null!==o?o:{})]):{};var o;1&a&&(t.$$scope={dirty:a,ctx:n}),s.$set(t)},i(n){t||(B(s.$$.fragment,n),t=!0)},o(n){F(s.$$.fragment,n),t=!1},d(n){_(s,n)}}}const dn={title:"I wrote my module bundler",date:"2019-09-18T08:00:00Z",tags:["JavaScript","module bundler","dev tool","webpack"],description:"In my previous article, I explained how module bundler works. In this article, I am going to show you how I wrote my module bundler...",series:"Write a module bundler",slug:"i-wrote-my-module-bundler",type:"blog"};class fn extends Y{constructor(n){super(),V(this,n,null,kn,p,{})}}setTimeout(()=>{new fn({target:document.querySelector("#app"),hydrate:!0});if(document.querySelector(".twitter-tweet")){const n=document.createElement("script");n.async=!0,n.src="https://platform.twitter.com/widgets.js",n.charset="utf-8",document.body.appendChild(n)}if("loading"in HTMLImageElement.prototype){document.querySelectorAll('img[loading="lazy"]').forEach(n=>{n.src=n.dataset.src})}else{const n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js",document.body.appendChild(n)}},3e3);
