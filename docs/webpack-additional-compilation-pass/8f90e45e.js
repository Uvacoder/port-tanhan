function n(){}function a(n,a){for(const s in a)n[s]=a[s];return n}function s(n){return n()}function t(){return Object.create(null)}function e(n){n.forEach(s)}function o(n){return"function"==typeof n}function p(n,a){return n!=n?a==a:n!==a||n&&"object"==typeof n||"function"==typeof n}function c(n,s,t,e){return n[1]&&e?a(t.ctx.slice(),n[1](e(s))):t.ctx}function i(n,a,s,t,e,o,p){const i=function(n,a,s,t){if(n[2]&&t){const e=n[2](t(s));if(void 0===a.dirty)return e;if("object"==typeof e){const n=[],s=Math.max(a.dirty.length,e.length);for(let t=0;t<s;t+=1)n[t]=a.dirty[t]|e[t];return n}return a.dirty|e}return a.dirty}(a,t,e,o);if(i){const e=c(a,s,t,p);n.p(e,i)}}function l(n,a){n.appendChild(a)}function r(n,a,s){n.insertBefore(a,s||null)}function u(n){n.parentNode.removeChild(n)}function h(n,a){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(a)}function k(n){return document.createElement(n)}function f(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function d(n){return document.createTextNode(n)}function m(){return d(" ")}function g(){return d("")}function w(n,a,s){null==s?n.removeAttribute(a):n.getAttribute(a)!==s&&n.setAttribute(a,s)}function E(n){return Array.from(n.childNodes)}function b(n,a,s,t){for(let t=0;t<n.length;t+=1){const e=n[t];if(e.nodeName===a){let a=0;const o=[];for(;a<e.attributes.length;){const n=e.attributes[a++];s[n.name]||o.push(n.name)}for(let n=0;n<o.length;n++)e.removeAttribute(o[n]);return n.splice(t,1)[0]}}return t?f(a):k(a)}function v(n,a){for(let s=0;s<n.length;s+=1){const t=n[s];if(3===t.nodeType)return t.data=""+a,n.splice(s,1)[0]}return d(a)}function y(n){return v(n," ")}function I(n,a){a=""+a,n.wholeText!==a&&(n.data=a)}function S(n,a){n.value=null==a?"":a}class A{constructor(n=null){this.a=n,this.e=this.n=null}m(n,a,s=null){this.e||(this.e=k(a.nodeName),this.t=a,this.h(n)),this.i(s)}h(n){this.e.innerHTML=n,this.n=Array.from(this.e.childNodes)}i(n){for(let a=0;a<this.n.length;a+=1)r(this.t,this.n[a],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(u)}}let T;function C(n){T=n}function P(n){(function(){if(!T)throw new Error("Function called outside component initialization");return T})().$$.on_mount.push(n)}const j=[],x=[],L=[],$=[],_=Promise.resolve();let M=!1;function O(n){L.push(n)}let H=!1;const F=new Set;function q(){if(!H){H=!0;do{for(let n=0;n<j.length;n+=1){const a=j[n];C(a),N(a.$$)}for(j.length=0;x.length;)x.pop()();for(let n=0;n<L.length;n+=1){const a=L[n];F.has(a)||(F.add(a),a())}L.length=0}while(j.length);for(;$.length;)$.pop()();M=!1,H=!1,F.clear()}}function N(n){if(null!==n.fragment){n.update(),e(n.before_update);const a=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,a),n.after_update.forEach(O)}}const D=new Set;function R(n,a){n&&n.i&&(D.delete(n),n.i(a))}function W(n,a,s,t){if(n&&n.o){if(D.has(n))return;D.add(n),(void 0).c.push(()=>{D.delete(n),t&&(s&&n.d(1),t())}),n.o(a)}}function U(n){n&&n.c()}function B(n,a){n&&n.l(a)}function z(n,a,t){const{fragment:p,on_mount:c,on_destroy:i,after_update:l}=n.$$;p&&p.m(a,t),O(()=>{const a=c.map(s).filter(o);i?i.push(...a):e(a),n.$$.on_mount=[]}),l.forEach(O)}function J(n,a){const s=n.$$;null!==s.fragment&&(e(s.on_destroy),s.fragment&&s.fragment.d(a),s.on_destroy=s.fragment=null,s.ctx=[])}function Y(n,a){-1===n.$$.dirty[0]&&(j.push(n),M||(M=!0,_.then(q)),n.$$.dirty.fill(0)),n.$$.dirty[a/31|0]|=1<<a%31}function G(a,s,o,p,c,i,l=[-1]){const r=T;C(a);const h=s.props||{},k=a.$$={fragment:null,ctx:null,props:i,update:n,not_equal:c,bound:t(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(r?r.$$.context:[]),callbacks:t(),dirty:l};let f=!1;if(k.ctx=o?o(a,h,(n,s,...t)=>{const e=t.length?t[0]:s;return k.ctx&&c(k.ctx[n],k.ctx[n]=e)&&(k.bound[n]&&k.bound[n](e),f&&Y(a,n)),s}):[],k.update(),f=!0,e(k.before_update),k.fragment=!!p&&p(k.ctx),s.target){if(s.hydrate){const n=E(s.target);k.fragment&&k.fragment.l(n),n.forEach(u)}else k.fragment&&k.fragment.c();s.intro&&R(a.$$.fragment),z(a,s.target,s.anchor),q()}C(r)}class V{$destroy(){J(this,1),this.$destroy=n}$on(n,a){const s=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return s.push(a),()=>{const n=s.indexOf(a);-1!==n&&s.splice(n,1)}}$set(){}}function K(a){let s,t,e,o,p,c,i,h,g,I,S,A,T,C,P,j,x,L,$,_,M,O,H,F,q,N,D,R,W,U,B,z,J,Y,G;return{c(){s=k("header"),t=k("nav"),e=k("ul"),o=k("li"),p=k("a"),c=d("Tan Li Hau"),i=m(),h=k("li"),g=k("a"),I=d("About"),S=m(),A=k("li"),T=k("a"),C=d("Writings"),P=m(),j=k("li"),x=k("a"),L=d("Talks"),$=m(),_=k("li"),M=k("a"),O=d("Notes"),H=m(),F=k("li"),q=k("a"),N=d("Newsletter"),D=m(),R=k("li"),W=k("a"),U=f("svg"),B=f("path"),z=m(),J=k("a"),Y=f("svg"),G=f("path"),this.h()},l(n){s=b(n,"HEADER",{class:!0});var a=E(s);t=b(a,"NAV",{});var l=E(t);e=b(l,"UL",{class:!0});var r=E(e);o=b(r,"LI",{class:!0});var k=E(o);p=b(k,"A",{href:!0,class:!0});var f=E(p);c=v(f,"Tan Li Hau"),f.forEach(u),k.forEach(u),i=y(r),h=b(r,"LI",{class:!0});var d=E(h);g=b(d,"A",{href:!0,class:!0});var m=E(g);I=v(m,"About"),m.forEach(u),d.forEach(u),S=y(r),A=b(r,"LI",{class:!0});var w=E(A);T=b(w,"A",{href:!0,class:!0});var V=E(T);C=v(V,"Writings"),V.forEach(u),w.forEach(u),P=y(r),j=b(r,"LI",{class:!0});var K=E(j);x=b(K,"A",{href:!0,class:!0});var Q=E(x);L=v(Q,"Talks"),Q.forEach(u),K.forEach(u),$=y(r),_=b(r,"LI",{class:!0});var Z=E(_);M=b(Z,"A",{href:!0,class:!0});var X=E(M);O=v(X,"Notes"),X.forEach(u),Z.forEach(u),H=y(r),F=b(r,"LI",{class:!0});var nn=E(F);q=b(nn,"A",{href:!0,class:!0});var an=E(q);N=v(an,"Newsletter"),an.forEach(u),nn.forEach(u),D=y(r),R=b(r,"LI",{class:!0});var sn=E(R);W=b(sn,"A",{"aria-label":!0,href:!0,class:!0});var tn=E(W);U=b(tn,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var en=E(U);B=b(en,"path",{d:!0},1),E(B).forEach(u),en.forEach(u),tn.forEach(u),z=y(sn),J=b(sn,"A",{"aria-label":!0,href:!0,class:!0});var on=E(J);Y=b(on,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var pn=E(Y);G=b(pn,"path",{d:!0},1),E(G).forEach(u),pn.forEach(u),on.forEach(u),sn.forEach(u),r.forEach(u),l.forEach(u),a.forEach(u),this.h()},h(){w(p,"href","/"),w(p,"class","svelte-f3e4uo"),w(o,"class","svelte-f3e4uo"),w(g,"href","/about"),w(g,"class","svelte-f3e4uo"),w(h,"class","svelte-f3e4uo"),w(T,"href","/blogs"),w(T,"class","svelte-f3e4uo"),w(A,"class","svelte-f3e4uo"),w(x,"href","/talks"),w(x,"class","svelte-f3e4uo"),w(j,"class","svelte-f3e4uo"),w(M,"href","/notes"),w(M,"class","svelte-f3e4uo"),w(_,"class","svelte-f3e4uo"),w(q,"href","/newsletter"),w(q,"class","svelte-f3e4uo"),w(F,"class","svelte-f3e4uo"),w(B,"d","M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66\n    10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5\n    4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"),w(U,"viewBox","0 0 24 24"),w(U,"width","1em"),w(U,"height","1em"),w(U,"class","svelte-f3e4uo"),w(W,"aria-label","Twitter account"),w(W,"href","https://twitter.com/lihautan"),w(W,"class","svelte-f3e4uo"),w(G,"d","M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0\n    0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07\n    5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65\n    5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42\n    3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"),w(Y,"viewBox","0 0 24 24"),w(Y,"width","1em"),w(Y,"height","1em"),w(Y,"class","svelte-f3e4uo"),w(J,"aria-label","Github account"),w(J,"href","https://github.com/tanhauhau"),w(J,"class","svelte-f3e4uo"),w(R,"class","social svelte-f3e4uo"),w(e,"class","svelte-f3e4uo"),w(s,"class","svelte-f3e4uo")},m(n,a){r(n,s,a),l(s,t),l(t,e),l(e,o),l(o,p),l(p,c),l(e,i),l(e,h),l(h,g),l(g,I),l(e,S),l(e,A),l(A,T),l(T,C),l(e,P),l(e,j),l(j,x),l(x,L),l(e,$),l(e,_),l(_,M),l(M,O),l(e,H),l(e,F),l(F,q),l(q,N),l(e,D),l(e,R),l(R,W),l(W,U),l(U,B),l(R,z),l(R,J),l(J,Y),l(Y,G)},p:n,i:n,o:n,d(n){n&&u(s)}}}class Q extends V{constructor(n){super(),G(this,n,null,K,p,{})}}function Z(a){let s,t,e,o,p,c,i,h,f,g,I,A,T,C,P,j,x,L,$,_;return{c(){s=k("div"),t=k("h1"),e=d("Subscribe to my newsletter"),o=m(),p=k("h2"),c=d("Get the latest blog posts and project updates delivered right to your inbox"),i=m(),h=k("form"),f=k("div"),g=k("input"),I=m(),A=k("input"),C=m(),P=k("input"),j=m(),x=k("p"),L=d("Powered by Buttondown."),this.h()},l(n){s=b(n,"DIV",{class:!0});var a=E(s);t=b(a,"H1",{});var l=E(t);e=v(l,"Subscribe to my newsletter"),l.forEach(u),o=y(a),p=b(a,"H2",{class:!0});var r=E(p);c=v(r,"Get the latest blog posts and project updates delivered right to your inbox"),r.forEach(u),i=y(a),h=b(a,"FORM",{action:!0,method:!0,target:!0,onsubmit:!0,class:!0});var k=E(h);f=b(k,"DIV",{class:!0});var d=E(f);g=b(d,"INPUT",{type:!0,name:!0,id:!0,"aria-label":!0,placeholder:!0,class:!0}),I=y(d),A=b(d,"INPUT",{type:!0,value:!0,disabled:!0,class:!0}),d.forEach(u),C=y(k),P=b(k,"INPUT",{type:!0,value:!0,name:!0,class:!0}),j=y(k),x=b(k,"P",{class:!0});var m=E(x);L=v(m,"Powered by Buttondown."),m.forEach(u),k.forEach(u),a.forEach(u),this.h()},h(){w(p,"class","svelte-1k1s1co"),w(g,"type","email"),w(g,"name","email"),w(g,"id","bd-email"),w(g,"aria-label","email address"),w(g,"placeholder","youremail@example.com"),w(g,"class","svelte-1k1s1co"),w(A,"type","submit"),A.value="Subscribe",A.disabled=T=!a[0],w(A,"class","svelte-1k1s1co"),w(f,"class","form-item svelte-1k1s1co"),w(P,"type","hidden"),P.value="1",w(P,"name","embed"),w(P,"class","svelte-1k1s1co"),w(x,"class","svelte-1k1s1co"),w(h,"action","https://buttondown.email/api/emails/embed-subscribe/lihautan"),w(h,"method","post"),w(h,"target","popupwindow"),w(h,"onsubmit","window.open('https://buttondown.email/lihautan', 'popupwindow')"),w(h,"class","embeddable-buttondown-form"),w(s,"class","form svelte-1k1s1co")},m(n,u){var k,d,m,w;r(n,s,u),l(s,t),l(t,e),l(s,o),l(s,p),l(p,c),l(s,i),l(s,h),l(h,f),l(f,g),S(g,a[0]),l(f,I),l(f,A),l(h,C),l(h,P),l(h,j),l(h,x),l(x,L),$||(k=g,d="input",m=a[1],k.addEventListener(d,m,w),_=()=>k.removeEventListener(d,m,w),$=!0)},p(n,[a]){1&a&&g.value!==n[0]&&S(g,n[0]),1&a&&T!==(T=!n[0])&&(A.disabled=T)},i:n,o:n,d(n){n&&u(s),$=!1,_()}}}function X(n,a,s){let t;return[t,function(){t=this.value,s(0,t)}]}class nn extends V{constructor(n){super(),G(this,n,X,Z,p,{})}}function an(n){return P(()=>(setTimeout(()=>{if(window.innerWidth>1080){const n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3E&placement=lihautancom",n.id="_carbonads_js",document.body.appendChild(n)}},5e3),()=>{try{const n=document.getElementById("carbonads");n.parentNode.removeChild(n)}catch(n){}})),[]}class sn extends V{constructor(n){super(),G(this,n,an,null,p,{})}}function tn(n,a,s){const t=n.slice();return t[6]=a[s],t}function en(n,a,s){const t=n.slice();return t[6]=a[s],t}function on(n){let a,s;return{c(){a=k("meta"),this.h()},l(n){a=b(n,"META",{name:!0,content:!0}),this.h()},h(){w(a,"name","keywords"),w(a,"content",s=n[6])},m(n,s){r(n,a,s)},p(n,t){4&t&&s!==(s=n[6])&&w(a,"content",s)},d(n){n&&u(a)}}}function pn(n){let a,s,t=n[6]+"";return{c(){a=k("span"),s=d(t),this.h()},l(n){a=b(n,"SPAN",{class:!0});var e=E(a);s=v(e,t),e.forEach(u),this.h()},h(){w(a,"class","svelte-9tqnza")},m(n,t){r(n,a,t),l(a,s)},p(n,a){4&a&&t!==(t=n[6]+"")&&I(s,t)},d(n){n&&u(a)}}}function cn(n){let a,s,t,e,o,p,f,S,T,C,P,j,x,L,$,_,M,O,H,F,q,N,D,Y,G,V,K,Z,X,an,cn,ln,rn,un,hn,kn,fn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`,dn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},name:"Homepage",position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fwebpack-additional-compilation-pass",name:n[0]},name:n[0],position:2}]})}<\/script>`;document.title=a=n[0]+" | Tan Li Hau";let mn=n[2],gn=[];for(let a=0;a<mn.length;a+=1)gn[a]=on(en(n,mn,a));D=new Q({});let wn=n[2],En=[];for(let a=0;a<wn.length;a+=1)En[a]=pn(tn(n,wn,a));const bn=n[5].default,vn=function(n,a,s,t){if(n){const e=c(n,a,s,t);return n[0](e)}}(bn,n,n[4],null);return rn=new nn({}),hn=new sn({}),{c(){s=k("meta"),t=k("meta"),e=k("meta"),o=k("meta"),p=k("meta"),f=k("meta"),S=k("meta"),T=k("meta"),C=k("meta"),P=k("meta"),j=k("meta");for(let n=0;n<gn.length;n+=1)gn[n].c();x=k("meta"),L=k("meta"),_=g(),O=g(),H=m(),F=k("a"),q=d("Skip to content"),N=m(),U(D.$$.fragment),Y=m(),G=k("main"),V=k("h1"),K=d(n[0]),Z=m();for(let n=0;n<En.length;n+=1)En[n].c();X=m(),an=k("article"),vn&&vn.c(),cn=m(),ln=k("footer"),U(rn.$$.fragment),un=m(),U(hn.$$.fragment),this.h()},l(a){const c=function(n,a=document.body){return Array.from(a.querySelectorAll(n))}('[data-svelte="svelte-15e3uyc"]',document.head);s=b(c,"META",{name:!0,content:!0}),t=b(c,"META",{name:!0,content:!0}),e=b(c,"META",{name:!0,content:!0}),o=b(c,"META",{name:!0,content:!0}),p=b(c,"META",{name:!0,content:!0}),f=b(c,"META",{name:!0,content:!0}),S=b(c,"META",{name:!0,content:!0}),T=b(c,"META",{name:!0,content:!0}),C=b(c,"META",{name:!0,content:!0}),P=b(c,"META",{name:!0,content:!0}),j=b(c,"META",{name:!0,content:!0});for(let n=0;n<gn.length;n+=1)gn[n].l(c);x=b(c,"META",{itemprop:!0,content:!0}),L=b(c,"META",{itemprop:!0,content:!0}),_=g(),O=g(),c.forEach(u),H=y(a),F=b(a,"A",{href:!0,class:!0});var i=E(F);q=v(i,"Skip to content"),i.forEach(u),N=y(a),B(D.$$.fragment,a),Y=y(a),G=b(a,"MAIN",{id:!0,class:!0});var l=E(G);V=b(l,"H1",{});var r=E(V);K=v(r,n[0]),r.forEach(u),Z=y(l);for(let n=0;n<En.length;n+=1)En[n].l(l);X=y(l),an=b(l,"ARTICLE",{});var h=E(an);vn&&vn.l(h),h.forEach(u),l.forEach(u),cn=y(a),ln=b(a,"FOOTER",{class:!0});var k=E(ln);B(rn.$$.fragment,k),un=y(k),B(hn.$$.fragment,k),k.forEach(u),this.h()},h(){w(s,"name","description"),w(s,"content",n[1]),w(t,"name","image"),w(t,"content",null),w(e,"name","og:image"),w(e,"content",null),w(o,"name","og:title"),w(o,"content",n[0]),w(p,"name","og:description"),w(p,"content",n[1]),w(f,"name","og:type"),w(f,"content","website"),w(S,"name","twitter:card"),w(S,"content","summary_large_image"),w(T,"name","twitter:creator"),w(T,"content","@lihautan"),w(C,"name","twitter:title"),w(C,"content",n[0]),w(P,"name","twitter:description"),w(P,"content",n[1]),w(j,"name","twitter:image"),w(j,"content",null),w(x,"itemprop","url"),w(x,"content","https%3A%2F%2Flihautan.com%2Fwebpack-additional-compilation-pass"),w(L,"itemprop","image"),w(L,"content",null),$=new A(_),M=new A(O),w(F,"href","#content"),w(F,"class","skip svelte-9tqnza"),w(G,"id","content"),w(G,"class","blog svelte-9tqnza"),w(ln,"class","svelte-9tqnza")},m(n,a){l(document.head,s),l(document.head,t),l(document.head,e),l(document.head,o),l(document.head,p),l(document.head,f),l(document.head,S),l(document.head,T),l(document.head,C),l(document.head,P),l(document.head,j);for(let n=0;n<gn.length;n+=1)gn[n].m(document.head,null);l(document.head,x),l(document.head,L),$.m(fn,document.head),l(document.head,_),M.m(dn,document.head),l(document.head,O),r(n,H,a),r(n,F,a),l(F,q),r(n,N,a),z(D,n,a),r(n,Y,a),r(n,G,a),l(G,V),l(V,K),l(G,Z);for(let n=0;n<En.length;n+=1)En[n].m(G,null);l(G,X),l(G,an),vn&&vn.m(an,null),r(n,cn,a),r(n,ln,a),z(rn,ln,null),l(ln,un),z(hn,ln,null),kn=!0},p(n,[t]){if((!kn||1&t)&&a!==(a=n[0]+" | Tan Li Hau")&&(document.title=a),(!kn||2&t)&&w(s,"content",n[1]),(!kn||1&t)&&w(o,"content",n[0]),(!kn||2&t)&&w(p,"content",n[1]),(!kn||1&t)&&w(C,"content",n[0]),(!kn||2&t)&&w(P,"content",n[1]),4&t){let a;for(mn=n[2],a=0;a<mn.length;a+=1){const s=en(n,mn,a);gn[a]?gn[a].p(s,t):(gn[a]=on(s),gn[a].c(),gn[a].m(x.parentNode,x))}for(;a<gn.length;a+=1)gn[a].d(1);gn.length=mn.length}if((!kn||3&t)&&fn!==(fn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`)&&$.p(fn),(!kn||1&t)&&dn!==(dn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},name:"Homepage",position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fwebpack-additional-compilation-pass",name:n[0]},name:n[0],position:2}]})}<\/script>`)&&M.p(dn),(!kn||1&t)&&I(K,n[0]),4&t){let a;for(wn=n[2],a=0;a<wn.length;a+=1){const s=tn(n,wn,a);En[a]?En[a].p(s,t):(En[a]=pn(s),En[a].c(),En[a].m(G,X))}for(;a<En.length;a+=1)En[a].d(1);En.length=wn.length}vn&&vn.p&&16&t&&i(vn,bn,n,n[4],t,null,null)},i(n){kn||(R(D.$$.fragment,n),R(vn,n),R(rn.$$.fragment,n),R(hn.$$.fragment,n),kn=!0)},o(n){W(D.$$.fragment,n),W(vn,n),W(rn.$$.fragment,n),W(hn.$$.fragment,n),kn=!1},d(n){u(s),u(t),u(e),u(o),u(p),u(f),u(S),u(T),u(C),u(P),u(j),h(gn,n),u(x),u(L),u(_),n&&$.d(),u(O),n&&M.d(),n&&u(H),n&&u(F),n&&u(N),J(D,n),n&&u(Y),n&&u(G),h(En,n),vn&&vn.d(n),n&&u(cn),n&&u(ln),J(rn),J(hn)}}}function ln(n,a,s){let{title:t=""}=a,{description:e=""}=a,{tags:o=[]}=a;const p={"@type":"Person",name:"Tan Li Hau"};let{$$slots:c={},$$scope:i}=a;return n.$set=n=>{"title"in n&&s(0,t=n.title),"description"in n&&s(1,e=n.description),"tags"in n&&s(2,o=n.tags),"$$scope"in n&&s(4,i=n.$$scope)},[t,e,o,p,i,c]}class rn extends V{constructor(n){super(),G(this,n,ln,cn,p,{title:0,description:1,tags:2})}}function un(a){let s,t,e,o,p,c,i,h,f,g,I,S,A,T,C,P,j,x,L,$,_,M,O,H,F,q,N,D,R,W,U,B,z,J,Y,G,V,K,Q,Z,X,nn,an,sn,tn,en,on,pn,cn,ln,rn,un,hn,kn,fn,dn,mn,gn,wn,En,bn,vn,yn,In,Sn,An,Tn,Cn,Pn,jn,xn,Ln,$n,_n,Mn,On,Hn,Fn,qn,Nn,Dn,Rn,Wn,Un,Bn,zn,Jn,Yn,Gn,Vn,Kn,Qn,Zn,Xn,na,aa,sa,ta,ea,oa,pa,ca,ia,la,ra,ua,ha,ka,fa,da,ma,ga,wa,Ea,ba,va,ya,Ia,Sa,Aa,Ta,Ca,Pa,ja,xa,La,$a,_a,Ma,Oa,Ha,Fa,qa,Na,Da,Ra,Wa,Ua,Ba,za,Ja,Ya,Ga,Va,Ka,Qa,Za,Xa,ns,as,ss,ts,es,os,ps,cs,is,ls,rs,us,hs,ks,fs,ds,ms,gs,ws,Es,bs,vs,ys,Is,Ss,As,Ts,Cs,Ps,js,xs,Ls,$s,_s,Ms,Os,Hs,Fs,qs,Ns,Ds,Rs,Ws,Us,Bs,zs,Js,Ys,Gs,Vs,Ks,Qs,Zs,Xs,nt,at,st,tt,et,ot,pt,ct,it,lt,rt,ut,ht,kt,ft,dt,mt,gt,wt,Et,bt,vt,yt,It,St,At,Tt,Ct,Pt,jt,xt,Lt,$t,_t,Mt,Ot,Ht,Ft,qt,Nt,Dt,Rt,Wt,Ut,Bt,zt,Jt,Yt,Gt,Vt,Kt,Qt,Zt,Xt,ne,ae,se,te,ee,oe,pe,ce,ie,le,re,ue,he,ke,fe,de,me,ge,we,Ee,be,ve,ye,Ie,Se,Ae,Te,Ce,Pe,je,xe,Le,$e,_e,Me,Oe,He,Fe,qe,Ne,De,Re,We,Ue,Be,ze,Je,Ye,Ge,Ve,Ke,Qe,Ze,Xe,no,ao,so,to,eo,oo,po,co,io,lo,ro,uo,ho,ko,fo,mo,go,wo,Eo,bo,vo,yo,Io,So,Ao,To,Co,Po,jo,xo,Lo,$o,_o,Mo,Oo,Ho,Fo,qo,No,Do,Ro,Wo,Uo,Bo,zo,Jo,Yo,Go,Vo,Ko,Qo,Zo,Xo,np,ap,sp,tp,ep,op,pp,cp,ip,lp,rp,up,hp,kp,fp,dp,mp,gp,wp,Ep,bp,vp,yp,Ip,Sp,Ap,Tp,Cp,Pp,jp,xp,Lp,$p,_p,Mp,Op,Hp,Fp,qp,Np,Dp,Rp,Wp,Up,Bp,zp,Jp,Yp,Gp,Vp,Kp,Qp,Zp,Xp,nc,ac,sc,tc,ec,oc,pc,cc,ic,lc,rc,uc,hc,kc,fc,dc,mc,gc,wc,Ec,bc,vc,yc,Ic;return{c(){s=k("section"),t=k("ul"),e=k("li"),o=k("a"),p=d("The problem"),c=k("li"),i=k("a"),h=d("The 1st approach"),f=k("ul"),g=k("li"),I=k("a"),S=k("li"),A=k("a"),T=d("The 2nd approach"),C=k("ul"),P=k("li"),j=k("a"),x=k("li"),L=k("a"),$=d("The 3rd approach"),_=k("li"),M=k("a"),O=d("Closing Notes"),H=k("ul"),F=k("li"),q=k("a"),N=m(),D=k("p"),R=d('Recently, I was working on a server-side rendering application, and encounter a scenario that I think it requires "double compilation" with webpack.'),W=m(),U=k("section"),B=k("h2"),z=k("a"),J=d("The problem"),Y=m(),G=k("p"),V=d("I am not entirely sure I am doing it in the right approach, feel free to suggest or discuss it with me. The following will be about the problem I faced and how I worked on it."),K=m(),Q=k("p"),Z=d("The server-side rendering application that I worked on, has an endpoint that takes in request and respond with a partial HTML content and CSS files required for styling:"),X=m(),nn=k("pre"),an=m(),sn=k("pre"),tn=m(),en=k("p"),on=d("The application code itself uses "),pn=k("a"),cn=d("Express"),ln=d(" and "),rn=k("a"),un=d("React"),hn=d(":"),kn=m(),fn=k("pre"),dn=m(),mn=k("p"),gn=d("Now, the problem is, how do I get the list of CSS files?"),wn=m(),En=k("p"),bn=d("The list of CSS files produced by the build is only available after I compile the application, but I need the information to be part of compiled code."),vn=m(),yn=k("p"),In=d("The compiled code being part of the compilation, needs to contain information of the compilation."),Sn=m(),An=k("section"),Tn=k("h2"),Cn=k("a"),Pn=d("The 1st approach"),jn=m(),xn=k("p"),Ln=d("A naive solution at first is to use "),$n=k("a"),_n=d("Webpack Manifest Plugin"),Mn=d(" to get the compilation manifest, and in the code, import the manifest as json and consumes it:"),On=m(),Hn=k("pre"),Fn=m(),qn=k("p"),Nn=d("Yet, the "),Dn=k("code"),Rn=d("./dist/webpack-manifest.json"),Wn=d(" is not available in the first place, before compiling the code."),Un=m(),Bn=k("p"),zn=d("Since the "),Jn=k("code"),Yn=d("./dist/webpack-manifest.json"),Gn=d(" can only be available after build, maybe we can import it during runtime, using "),Vn=k("a"),Kn=k("strong"),Qn=d("non_webpack_require"),Zn=d(". The difference between "),Xn=k("code"),na=d("require"),aa=d(" and "),sa=k("code"),ta=d("__non_webpack_require__"),ea=d(" is that the latter is webpack specific, which tells webpack to transform it to just pure "),oa=k("code"),pa=d("require()"),ca=d(" expression, without bundling the required module:"),ia=m(),la=k("pre"),ra=m(),ua=k("p"),ha=d("If you scrutinize the code, you may wonder whether "),ka=k("code"),fa=d("./dist/webpack-manifest.json"),da=d(" is the correct relative path from the compiled code?"),ma=m(),ga=k("p"),wa=d("Probably "),Ea=k("code"),ba=d("./webpack-manifest.json"),va=d(" would be more accurate, if our output folder looks like this:"),ya=m(),Ia=k("pre"),Sa=m(),Aa=k("p"),Ta=d("One can safely argue that, the approach above works and let's move on the next task. But, curiosity drives me to seek deeper for a more \"elegant\" solution, where one don't need "),Ca=k("code"),Pa=d("require('webpack-manifest.json')"),ja=d(" in runtime, but that information is compiled into the code."),xa=m(),La=k("section"),$a=k("h3"),_a=k("a"),Ma=d("[Updated Feb 27, 2020]"),Oa=m(),Ha=k("p"),Fa=d("Thanks to "),qa=k("a"),Na=d("@wSokra"),Da=d("'s "),Ra=k("a"),Wa=d("suggestion"),Ua=d(", instead of using "),Ba=k("code"),za=d("__non_webpack_require__()"),Ja=d(", you can use a normal import and declaring the manifest file as an external:"),Ya=m(),Ga=k("pre"),Va=m(),Ka=k("pre"),Qa=m(),Za=k("p"),Xa=d("What this output is something similar to the following:"),ns=m(),as=k("pre"),ss=m(),ts=k("p"),es=d("The reason we are using the relative path "),os=k("code"),ps=d("./webpack-manifest.json"),cs=d(" is that we are assuming the output folder looks like this:"),is=m(),ls=k("pre"),rs=m(),us=k("p"),hs=d("You can read more about webpack externals from "),ks=k("a"),fs=d("the webpack documentation"),ds=d("."),ms=m(),gs=k("section"),ws=k("h2"),Es=k("a"),bs=d("The 2nd approach"),vs=m(),ys=k("p"),Is=d('So, the next "intuitive" approach is to '),Ss=k("a"),As=d("write a custom template plugin"),Ts=d(", that adds the webpack manifest on top of the main bundle, an example of the output:"),Cs=m(),Ps=k("pre"),js=m(),xs=k("p"),Ls=d("In the source code, I will use the global variable "),$s=k("code"),_s=d("CSS_FILES"),Ms=d(", and hopefully it will get defined by webpack, by adding "),Os=k("code"),Hs=d("const CSS_FILES = ..."),Fs=d(" at the very top of the file."),qs=m(),Ns=k("p"),Ds=d("And to be extra careful, I have to make sure also that there's no variable "),Rs=k("code"),Ws=d("CSS_FILES"),Us=d(" declared between the global scope and the current scope the variable is being used."),Bs=m(),zs=k("pre"),Js=m(),Ys=k("p"),Gs=d("Apparently, this does not work at all. The compiled output shows:"),Vs=m(),Ks=k("pre"),Qs=m(),Zs=k("p"),Xs=d("After tracing through the code, I realised that I was ignorant of the sequence of execution of the "),nt=k("a"),at=d("compiler hooks"),st=d("."),tt=m(),et=k("p"),ot=d("In the "),pt=k("a"),ct=d("docs for compiler hooks"),it=d(", each hooks is executed in sequence:"),lt=m(),rt=k("ul"),ut=k("li"),ht=d("..."),kt=m(),ft=k("li"),dt=d("run"),mt=m(),gt=k("li"),wt=d("..."),Et=m(),bt=k("li"),vt=d("thisCompilation"),yt=m(),It=k("li"),St=d("..."),At=m(),Tt=k("li"),Ct=d("emit"),Pt=m(),jt=k("li"),xt=d("afterEmit"),Lt=m(),$t=k("li"),_t=d("..."),Mt=m(),Ot=k("p"),Ht=d("The webpack manifest plugin executes mainly "),Ft=k("a"),qt=d("during the "),Nt=k("code"),Dt=d("emit"),Rt=d(" phase"),Wt=d(", right before webpack writes all the assets into the output directory. And, we are modifying the template source in the "),Ut=k("code"),Bt=d("thisCompilation"),zt=d(" phase, which is way before the "),Jt=k("code"),Yt=d("emit"),Gt=d(" phase. That's why "),Vt=k("code"),Kt=d("this.manifest"),Qt=d(" property is still undefined at the time of execution."),Zt=m(),Xt=k("pre"),ne=m(),ae=k("p"),se=d("Upon reading the code fot he "),te=k("code"),ee=d("webpack-manifest-plugin"),oe=d(", I realised that during the "),pe=k("code"),ce=d("emit"),ie=d(" phase, I can access to the "),le=k("code"),re=d("compilation.assets"),ue=d(", and so, I could modifying the source for the assets during that time!"),he=m(),ke=k("pre"),fe=m(),de=k("p"),me=d("Apparently that works, but I wonder whether is it a good practice to modifying the source of an asset during the "),ge=k("code"),we=d("emit"),Ee=d(" phase? 🤔"),be=m(),ve=k("p"),ye=d("And, if you noticed, I need to append the "),Ie=k("code"),Se=d("const CSS_FILES = [...]"),Ae=d(" to every file, that's because I have no idea in which file "),Te=k("code"),Ce=d("CSS_FILES"),Pe=d(" is referenced. And because I declared it using "),je=k("code"),xe=d("const"),Le=d(", it only exists within the file's scope, so I have to redeclare it all the other files."),$e=m(),_e=k("section"),Me=k("h3"),Oe=k("a"),He=d("[Updated Feb 27, 2020]"),Fe=m(),qe=k("p"),Ne=d("According to "),De=k("a"),Re=d("@evilebottnawi"),We=d(" that this is not appropriate"),Ue=m(),Be=k("blockquote"),ze=k("p"),Je=d("A lot of plugin uses `compiler.hooks.emit` for emitting new assets, it is invalid. Ideally plugins should use `compilation.hooks.additionalAssets` for adding new assets."),Ye=d("— evilebottnawi (@evilebottnawi) "),Ge=k("a"),Ve=d("February 20, 2020"),Ke=m(),Qe=k("section"),Ze=k("h2"),Xe=k("a"),no=d("The 3rd approach"),ao=m(),so=k("p"),to=d("I was still not convinced that this is the best I could do, so I continued looking around webpack's doc. I found a particular compilation hooks, "),eo=k("a"),oo=k("code"),po=d("needAdditionalPass"),co=d(", which seems useful. It says, "),io=k("em"),lo=d('"Called to determine if an asset needs to be processed further after being emitted."'),ro=d("."),uo=m(),ho=k("p"),ko=d("So, if I return "),fo=k("code"),mo=d("true"),go=d(" in the "),wo=k("code"),Eo=d("needAdditionalPass"),bo=d(", webpack will re"),vo=k("code"),yo=d("compile"),Io=d(" the asset again:"),So=m(),Ao=k("pre"),To=m(),Co=k("pre"),Po=m(),jo=k("p"),xo=d("Note that using "),Lo=k("code"),$o=d("needAdditionalPass"),_o=d(" will cause the build time to roughly doubled!"),Mo=m(),Oo=k("p"),Ho=d("You may argue that why do we need to rerun the "),Fo=k("code"),qo=d("compilation"),No=d(" process again, isn't the end result can be equally achieved by modifying the assets source in the "),Do=k("code"),Ro=d("emit"),Wo=d(" phase?"),Uo=m(),Bo=k("p"),zo=d("Well, that's because, I realised I could make use "),Jo=k("a"),Yo=d("some of the code from the "),Go=k("code"),Vo=d("DefinePlugin"),Ko=d(", which could replace the usage of "),Qo=k("code"),Zo=d("CSS_FILES"),Xo=d(" throughout the code. That way, I don't have to prefix every file with "),np=k("code"),ap=d("const CSS_FILES = ..."),sp=d("."),tp=m(),ep=k("p"),op=d("DefinePlugin uses something called "),pp=k("a"),cp=k("strong"),ip=d("JavaScriptParser Hooks"),lp=d(", which you can rename a variable through "),rp=k("code"),up=d("canRename"),hp=d(" and "),kp=k("code"),fp=d("identifier"),dp=d(" hooks or replace an expression through the "),mp=k("code"),gp=d("expression"),wp=d(" hook:"),Ep=m(),bp=k("pre"),vp=m(),yp=k("p"),Ip=d("The complete code can be found in "),Sp=k("a"),Ap=d("this gist"),Tp=d("."),Cp=m(),Pp=k("p"),jp=d("An example of the compiled output:"),xp=m(),Lp=k("pre"),$p=m(),_p=k("section"),Mp=k("h2"),Op=k("a"),Hp=d("Closing Notes"),Fp=m(),qp=k("p"),Np=d("The compile output for the 3rd approach seemed to be better (more precise?) than the other, yet I am not entirely sure using a "),Dp=k("code"),Rp=d("needAdditionalPass"),Wp=d(" is the right way of going about it."),Up=m(),Bp=k("p"),zp=d("So, "),Jp=k("a"),Yp=d("let me know"),Gp=d(" if you have any thoughts or suggestions, yea?"),Vp=m(),Kp=k("section"),Qp=k("h3"),Zp=k("a"),Xp=d("[Updated Feb 27, 2020]"),nc=m(),ac=k("p"),sc=d("You can read "),tc=k("a"),ec=d("the discussions that's happening on Twitter"),oc=d(":"),pc=m(),cc=k("blockquote"),ic=k("p"),lc=d("Need some suggestions and inputs from "),rc=k("a"),uc=d("@webpack"),hc=d(" masters, I've written the problem and approaches that I've taken over here: "),kc=k("a"),fc=d("https://t.co/gLsPG9Joeq"),dc=d(", still I'm not sure I am doing it right 🙈"),mc=k("a"),gc=d("@wSokra"),wc=m(),Ec=k("a"),bc=d("@evilebottnawi"),vc=d("— Tan Li Hau (@lihautan) "),yc=k("a"),Ic=d("February 20, 2020"),this.h()},l(n){s=b(n,"SECTION",{});var a=E(s);t=b(a,"UL",{class:!0,id:!0,role:!0,"aria-label":!0});var l=E(t);e=b(l,"LI",{});var r=E(e);o=b(r,"A",{href:!0});var k=E(o);p=v(k,"The problem"),k.forEach(u),r.forEach(u),c=b(l,"LI",{});var d=E(c);i=b(d,"A",{href:!0});var m=E(i);h=v(m,"The 1st approach"),m.forEach(u),d.forEach(u),f=b(l,"UL",{});var w=E(f);g=b(w,"LI",{});var Sc=E(g);I=b(Sc,"A",{href:!0}),E(I).forEach(u),Sc.forEach(u),w.forEach(u),S=b(l,"LI",{});var Ac=E(S);A=b(Ac,"A",{href:!0});var Tc=E(A);T=v(Tc,"The 2nd approach"),Tc.forEach(u),Ac.forEach(u),C=b(l,"UL",{});var Cc=E(C);P=b(Cc,"LI",{});var Pc=E(P);j=b(Pc,"A",{href:!0}),E(j).forEach(u),Pc.forEach(u),Cc.forEach(u),x=b(l,"LI",{});var jc=E(x);L=b(jc,"A",{href:!0});var xc=E(L);$=v(xc,"The 3rd approach"),xc.forEach(u),jc.forEach(u),_=b(l,"LI",{});var Lc=E(_);M=b(Lc,"A",{href:!0});var $c=E(M);O=v($c,"Closing Notes"),$c.forEach(u),Lc.forEach(u),H=b(l,"UL",{});var _c=E(H);F=b(_c,"LI",{});var Mc=E(F);q=b(Mc,"A",{href:!0}),E(q).forEach(u),Mc.forEach(u),_c.forEach(u),l.forEach(u),a.forEach(u),N=y(n),D=b(n,"P",{});var Oc=E(D);R=v(Oc,'Recently, I was working on a server-side rendering application, and encounter a scenario that I think it requires "double compilation" with webpack.'),Oc.forEach(u),W=y(n),U=b(n,"SECTION",{});var Hc=E(U);B=b(Hc,"H2",{});var Fc=E(B);z=b(Fc,"A",{href:!0,id:!0});var qc=E(z);J=v(qc,"The problem"),qc.forEach(u),Fc.forEach(u),Y=y(Hc),G=b(Hc,"P",{});var Nc=E(G);V=v(Nc,"I am not entirely sure I am doing it in the right approach, feel free to suggest or discuss it with me. The following will be about the problem I faced and how I worked on it."),Nc.forEach(u),K=y(Hc),Q=b(Hc,"P",{});var Dc=E(Q);Z=v(Dc,"The server-side rendering application that I worked on, has an endpoint that takes in request and respond with a partial HTML content and CSS files required for styling:"),Dc.forEach(u),X=y(Hc),nn=b(Hc,"PRE",{class:!0}),E(nn).forEach(u),an=y(Hc),sn=b(Hc,"PRE",{class:!0}),E(sn).forEach(u),tn=y(Hc),en=b(Hc,"P",{});var Rc=E(en);on=v(Rc,"The application code itself uses "),pn=b(Rc,"A",{href:!0,rel:!0});var Wc=E(pn);cn=v(Wc,"Express"),Wc.forEach(u),ln=v(Rc," and "),rn=b(Rc,"A",{href:!0,rel:!0});var Uc=E(rn);un=v(Uc,"React"),Uc.forEach(u),hn=v(Rc,":"),Rc.forEach(u),kn=y(Hc),fn=b(Hc,"PRE",{class:!0}),E(fn).forEach(u),dn=y(Hc),mn=b(Hc,"P",{});var Bc=E(mn);gn=v(Bc,"Now, the problem is, how do I get the list of CSS files?"),Bc.forEach(u),wn=y(Hc),En=b(Hc,"P",{});var zc=E(En);bn=v(zc,"The list of CSS files produced by the build is only available after I compile the application, but I need the information to be part of compiled code."),zc.forEach(u),vn=y(Hc),yn=b(Hc,"P",{});var Jc=E(yn);In=v(Jc,"The compiled code being part of the compilation, needs to contain information of the compilation."),Jc.forEach(u),Hc.forEach(u),Sn=y(n),An=b(n,"SECTION",{});var Yc=E(An);Tn=b(Yc,"H2",{});var Gc=E(Tn);Cn=b(Gc,"A",{href:!0,id:!0});var Vc=E(Cn);Pn=v(Vc,"The 1st approach"),Vc.forEach(u),Gc.forEach(u),jn=y(Yc),xn=b(Yc,"P",{});var Kc=E(xn);Ln=v(Kc,"A naive solution at first is to use "),$n=b(Kc,"A",{href:!0,rel:!0});var Qc=E($n);_n=v(Qc,"Webpack Manifest Plugin"),Qc.forEach(u),Mn=v(Kc," to get the compilation manifest, and in the code, import the manifest as json and consumes it:"),Kc.forEach(u),On=y(Yc),Hn=b(Yc,"PRE",{class:!0}),E(Hn).forEach(u),Fn=y(Yc),qn=b(Yc,"P",{});var Zc=E(qn);Nn=v(Zc,"Yet, the "),Dn=b(Zc,"CODE",{});var Xc=E(Dn);Rn=v(Xc,"./dist/webpack-manifest.json"),Xc.forEach(u),Wn=v(Zc," is not available in the first place, before compiling the code."),Zc.forEach(u),Un=y(Yc),Bn=b(Yc,"P",{});var ni=E(Bn);zn=v(ni,"Since the "),Jn=b(ni,"CODE",{});var ai=E(Jn);Yn=v(ai,"./dist/webpack-manifest.json"),ai.forEach(u),Gn=v(ni," can only be available after build, maybe we can import it during runtime, using "),Vn=b(ni,"A",{href:!0,rel:!0});var si=E(Vn);Kn=b(si,"STRONG",{});var ti=E(Kn);Qn=v(ti,"non_webpack_require"),ti.forEach(u),si.forEach(u),Zn=v(ni,". The difference between "),Xn=b(ni,"CODE",{});var ei=E(Xn);na=v(ei,"require"),ei.forEach(u),aa=v(ni," and "),sa=b(ni,"CODE",{});var oi=E(sa);ta=v(oi,"__non_webpack_require__"),oi.forEach(u),ea=v(ni," is that the latter is webpack specific, which tells webpack to transform it to just pure "),oa=b(ni,"CODE",{});var pi=E(oa);pa=v(pi,"require()"),pi.forEach(u),ca=v(ni," expression, without bundling the required module:"),ni.forEach(u),ia=y(Yc),la=b(Yc,"PRE",{class:!0}),E(la).forEach(u),ra=y(Yc),ua=b(Yc,"P",{});var ci=E(ua);ha=v(ci,"If you scrutinize the code, you may wonder whether "),ka=b(ci,"CODE",{});var ii=E(ka);fa=v(ii,"./dist/webpack-manifest.json"),ii.forEach(u),da=v(ci," is the correct relative path from the compiled code?"),ci.forEach(u),ma=y(Yc),ga=b(Yc,"P",{});var li=E(ga);wa=v(li,"Probably "),Ea=b(li,"CODE",{});var ri=E(Ea);ba=v(ri,"./webpack-manifest.json"),ri.forEach(u),va=v(li," would be more accurate, if our output folder looks like this:"),li.forEach(u),ya=y(Yc),Ia=b(Yc,"PRE",{class:!0}),E(Ia).forEach(u),Sa=y(Yc),Aa=b(Yc,"P",{});var ui=E(Aa);Ta=v(ui,"One can safely argue that, the approach above works and let's move on the next task. But, curiosity drives me to seek deeper for a more \"elegant\" solution, where one don't need "),Ca=b(ui,"CODE",{});var hi=E(Ca);Pa=v(hi,"require('webpack-manifest.json')"),hi.forEach(u),ja=v(ui," in runtime, but that information is compiled into the code."),ui.forEach(u),Yc.forEach(u),xa=y(n),La=b(n,"SECTION",{});var ki=E(La);$a=b(ki,"H3",{});var fi=E($a);_a=b(fi,"A",{href:!0,id:!0});var di=E(_a);Ma=v(di,"[Updated Feb 27, 2020]"),di.forEach(u),fi.forEach(u),Oa=y(ki),Ha=b(ki,"P",{});var mi=E(Ha);Fa=v(mi,"Thanks to "),qa=b(mi,"A",{href:!0,rel:!0});var gi=E(qa);Na=v(gi,"@wSokra"),gi.forEach(u),Da=v(mi,"'s "),Ra=b(mi,"A",{href:!0,rel:!0});var wi=E(Ra);Wa=v(wi,"suggestion"),wi.forEach(u),Ua=v(mi,", instead of using "),Ba=b(mi,"CODE",{});var Ei=E(Ba);za=v(Ei,"__non_webpack_require__()"),Ei.forEach(u),Ja=v(mi,", you can use a normal import and declaring the manifest file as an external:"),mi.forEach(u),Ya=y(ki),Ga=b(ki,"PRE",{class:!0}),E(Ga).forEach(u),Va=y(ki),Ka=b(ki,"PRE",{class:!0}),E(Ka).forEach(u),Qa=y(ki),Za=b(ki,"P",{});var bi=E(Za);Xa=v(bi,"What this output is something similar to the following:"),bi.forEach(u),ns=y(ki),as=b(ki,"PRE",{class:!0}),E(as).forEach(u),ss=y(ki),ts=b(ki,"P",{});var vi=E(ts);es=v(vi,"The reason we are using the relative path "),os=b(vi,"CODE",{});var yi=E(os);ps=v(yi,"./webpack-manifest.json"),yi.forEach(u),cs=v(vi," is that we are assuming the output folder looks like this:"),vi.forEach(u),is=y(ki),ls=b(ki,"PRE",{class:!0}),E(ls).forEach(u),rs=y(ki),us=b(ki,"P",{});var Ii=E(us);hs=v(Ii,"You can read more about webpack externals from "),ks=b(Ii,"A",{href:!0,rel:!0});var Si=E(ks);fs=v(Si,"the webpack documentation"),Si.forEach(u),ds=v(Ii,"."),Ii.forEach(u),ki.forEach(u),ms=y(n),gs=b(n,"SECTION",{});var Ai=E(gs);ws=b(Ai,"H2",{});var Ti=E(ws);Es=b(Ti,"A",{href:!0,id:!0});var Ci=E(Es);bs=v(Ci,"The 2nd approach"),Ci.forEach(u),Ti.forEach(u),vs=y(Ai),ys=b(Ai,"P",{});var Pi=E(ys);Is=v(Pi,'So, the next "intuitive" approach is to '),Ss=b(Pi,"A",{href:!0});var ji=E(Ss);As=v(ji,"write a custom template plugin"),ji.forEach(u),Ts=v(Pi,", that adds the webpack manifest on top of the main bundle, an example of the output:"),Pi.forEach(u),Cs=y(Ai),Ps=b(Ai,"PRE",{class:!0}),E(Ps).forEach(u),js=y(Ai),xs=b(Ai,"P",{});var xi=E(xs);Ls=v(xi,"In the source code, I will use the global variable "),$s=b(xi,"CODE",{});var Li=E($s);_s=v(Li,"CSS_FILES"),Li.forEach(u),Ms=v(xi,", and hopefully it will get defined by webpack, by adding "),Os=b(xi,"CODE",{});var $i=E(Os);Hs=v($i,"const CSS_FILES = ..."),$i.forEach(u),Fs=v(xi," at the very top of the file."),xi.forEach(u),qs=y(Ai),Ns=b(Ai,"P",{});var _i=E(Ns);Ds=v(_i,"And to be extra careful, I have to make sure also that there's no variable "),Rs=b(_i,"CODE",{});var Mi=E(Rs);Ws=v(Mi,"CSS_FILES"),Mi.forEach(u),Us=v(_i," declared between the global scope and the current scope the variable is being used."),_i.forEach(u),Bs=y(Ai),zs=b(Ai,"PRE",{class:!0}),E(zs).forEach(u),Js=y(Ai),Ys=b(Ai,"P",{});var Oi=E(Ys);Gs=v(Oi,"Apparently, this does not work at all. The compiled output shows:"),Oi.forEach(u),Vs=y(Ai),Ks=b(Ai,"PRE",{class:!0}),E(Ks).forEach(u),Qs=y(Ai),Zs=b(Ai,"P",{});var Hi=E(Zs);Xs=v(Hi,"After tracing through the code, I realised that I was ignorant of the sequence of execution of the "),nt=b(Hi,"A",{href:!0,rel:!0});var Fi=E(nt);at=v(Fi,"compiler hooks"),Fi.forEach(u),st=v(Hi,"."),Hi.forEach(u),tt=y(Ai),et=b(Ai,"P",{});var qi=E(et);ot=v(qi,"In the "),pt=b(qi,"A",{href:!0,rel:!0});var Ni=E(pt);ct=v(Ni,"docs for compiler hooks"),Ni.forEach(u),it=v(qi,", each hooks is executed in sequence:"),qi.forEach(u),lt=y(Ai),rt=b(Ai,"UL",{});var Di=E(rt);ut=b(Di,"LI",{});var Ri=E(ut);ht=v(Ri,"..."),Ri.forEach(u),kt=y(Di),ft=b(Di,"LI",{});var Wi=E(ft);dt=v(Wi,"run"),Wi.forEach(u),mt=y(Di),gt=b(Di,"LI",{});var Ui=E(gt);wt=v(Ui,"..."),Ui.forEach(u),Et=y(Di),bt=b(Di,"LI",{});var Bi=E(bt);vt=v(Bi,"thisCompilation"),Bi.forEach(u),yt=y(Di),It=b(Di,"LI",{});var zi=E(It);St=v(zi,"..."),zi.forEach(u),At=y(Di),Tt=b(Di,"LI",{});var Ji=E(Tt);Ct=v(Ji,"emit"),Ji.forEach(u),Pt=y(Di),jt=b(Di,"LI",{});var Yi=E(jt);xt=v(Yi,"afterEmit"),Yi.forEach(u),Lt=y(Di),$t=b(Di,"LI",{});var Gi=E($t);_t=v(Gi,"..."),Gi.forEach(u),Di.forEach(u),Mt=y(Ai),Ot=b(Ai,"P",{});var Vi=E(Ot);Ht=v(Vi,"The webpack manifest plugin executes mainly "),Ft=b(Vi,"A",{href:!0,rel:!0});var Ki=E(Ft);qt=v(Ki,"during the "),Nt=b(Ki,"CODE",{});var Qi=E(Nt);Dt=v(Qi,"emit"),Qi.forEach(u),Rt=v(Ki," phase"),Ki.forEach(u),Wt=v(Vi,", right before webpack writes all the assets into the output directory. And, we are modifying the template source in the "),Ut=b(Vi,"CODE",{});var Zi=E(Ut);Bt=v(Zi,"thisCompilation"),Zi.forEach(u),zt=v(Vi," phase, which is way before the "),Jt=b(Vi,"CODE",{});var Xi=E(Jt);Yt=v(Xi,"emit"),Xi.forEach(u),Gt=v(Vi," phase. That's why "),Vt=b(Vi,"CODE",{});var nl=E(Vt);Kt=v(nl,"this.manifest"),nl.forEach(u),Qt=v(Vi," property is still undefined at the time of execution."),Vi.forEach(u),Zt=y(Ai),Xt=b(Ai,"PRE",{class:!0}),E(Xt).forEach(u),ne=y(Ai),ae=b(Ai,"P",{});var al=E(ae);se=v(al,"Upon reading the code fot he "),te=b(al,"CODE",{});var sl=E(te);ee=v(sl,"webpack-manifest-plugin"),sl.forEach(u),oe=v(al,", I realised that during the "),pe=b(al,"CODE",{});var tl=E(pe);ce=v(tl,"emit"),tl.forEach(u),ie=v(al," phase, I can access to the "),le=b(al,"CODE",{});var el=E(le);re=v(el,"compilation.assets"),el.forEach(u),ue=v(al,", and so, I could modifying the source for the assets during that time!"),al.forEach(u),he=y(Ai),ke=b(Ai,"PRE",{class:!0}),E(ke).forEach(u),fe=y(Ai),de=b(Ai,"P",{});var ol=E(de);me=v(ol,"Apparently that works, but I wonder whether is it a good practice to modifying the source of an asset during the "),ge=b(ol,"CODE",{});var pl=E(ge);we=v(pl,"emit"),pl.forEach(u),Ee=v(ol," phase? 🤔"),ol.forEach(u),be=y(Ai),ve=b(Ai,"P",{});var cl=E(ve);ye=v(cl,"And, if you noticed, I need to append the "),Ie=b(cl,"CODE",{});var il=E(Ie);Se=v(il,"const CSS_FILES = [...]"),il.forEach(u),Ae=v(cl," to every file, that's because I have no idea in which file "),Te=b(cl,"CODE",{});var ll=E(Te);Ce=v(ll,"CSS_FILES"),ll.forEach(u),Pe=v(cl," is referenced. And because I declared it using "),je=b(cl,"CODE",{});var rl=E(je);xe=v(rl,"const"),rl.forEach(u),Le=v(cl,", it only exists within the file's scope, so I have to redeclare it all the other files."),cl.forEach(u),Ai.forEach(u),$e=y(n),_e=b(n,"SECTION",{});var ul=E(_e);Me=b(ul,"H3",{});var hl=E(Me);Oe=b(hl,"A",{href:!0,id:!0});var kl=E(Oe);He=v(kl,"[Updated Feb 27, 2020]"),kl.forEach(u),hl.forEach(u),Fe=y(ul),qe=b(ul,"P",{});var fl=E(qe);Ne=v(fl,"According to "),De=b(fl,"A",{href:!0,rel:!0});var dl=E(De);Re=v(dl,"@evilebottnawi"),dl.forEach(u),We=v(fl," that this is not appropriate"),fl.forEach(u),Ue=y(ul),Be=b(ul,"BLOCKQUOTE",{class:!0});var ml=E(Be);ze=b(ml,"P",{lang:!0,dir:!0});var gl=E(ze);Je=v(gl,"A lot of plugin uses `compiler.hooks.emit` for emitting new assets, it is invalid. Ideally plugins should use `compilation.hooks.additionalAssets` for adding new assets."),gl.forEach(u),Ye=v(ml,"— evilebottnawi (@evilebottnawi) "),Ge=b(ml,"A",{href:!0});var wl=E(Ge);Ve=v(wl,"February 20, 2020"),wl.forEach(u),ml.forEach(u),ul.forEach(u),Ke=y(n),Qe=b(n,"SECTION",{});var El=E(Qe);Ze=b(El,"H2",{});var bl=E(Ze);Xe=b(bl,"A",{href:!0,id:!0});var vl=E(Xe);no=v(vl,"The 3rd approach"),vl.forEach(u),bl.forEach(u),ao=y(El),so=b(El,"P",{});var yl=E(so);to=v(yl,"I was still not convinced that this is the best I could do, so I continued looking around webpack's doc. I found a particular compilation hooks, "),eo=b(yl,"A",{href:!0,rel:!0});var Il=E(eo);oo=b(Il,"CODE",{});var Sl=E(oo);po=v(Sl,"needAdditionalPass"),Sl.forEach(u),Il.forEach(u),co=v(yl,", which seems useful. It says, "),io=b(yl,"EM",{});var Al=E(io);lo=v(Al,'"Called to determine if an asset needs to be processed further after being emitted."'),Al.forEach(u),ro=v(yl,"."),yl.forEach(u),uo=y(El),ho=b(El,"P",{});var Tl=E(ho);ko=v(Tl,"So, if I return "),fo=b(Tl,"CODE",{});var Cl=E(fo);mo=v(Cl,"true"),Cl.forEach(u),go=v(Tl," in the "),wo=b(Tl,"CODE",{});var Pl=E(wo);Eo=v(Pl,"needAdditionalPass"),Pl.forEach(u),bo=v(Tl,", webpack will re"),vo=b(Tl,"CODE",{});var jl=E(vo);yo=v(jl,"compile"),jl.forEach(u),Io=v(Tl," the asset again:"),Tl.forEach(u),So=y(El),Ao=b(El,"PRE",{class:!0}),E(Ao).forEach(u),To=y(El),Co=b(El,"PRE",{class:!0}),E(Co).forEach(u),Po=y(El),jo=b(El,"P",{});var xl=E(jo);xo=v(xl,"Note that using "),Lo=b(xl,"CODE",{});var Ll=E(Lo);$o=v(Ll,"needAdditionalPass"),Ll.forEach(u),_o=v(xl," will cause the build time to roughly doubled!"),xl.forEach(u),Mo=y(El),Oo=b(El,"P",{});var $l=E(Oo);Ho=v($l,"You may argue that why do we need to rerun the "),Fo=b($l,"CODE",{});var _l=E(Fo);qo=v(_l,"compilation"),_l.forEach(u),No=v($l," process again, isn't the end result can be equally achieved by modifying the assets source in the "),Do=b($l,"CODE",{});var Ml=E(Do);Ro=v(Ml,"emit"),Ml.forEach(u),Wo=v($l," phase?"),$l.forEach(u),Uo=y(El),Bo=b(El,"P",{});var Ol=E(Bo);zo=v(Ol,"Well, that's because, I realised I could make use "),Jo=b(Ol,"A",{href:!0,rel:!0});var Hl=E(Jo);Yo=v(Hl,"some of the code from the "),Go=b(Hl,"CODE",{});var Fl=E(Go);Vo=v(Fl,"DefinePlugin"),Fl.forEach(u),Hl.forEach(u),Ko=v(Ol,", which could replace the usage of "),Qo=b(Ol,"CODE",{});var ql=E(Qo);Zo=v(ql,"CSS_FILES"),ql.forEach(u),Xo=v(Ol," throughout the code. That way, I don't have to prefix every file with "),np=b(Ol,"CODE",{});var Nl=E(np);ap=v(Nl,"const CSS_FILES = ..."),Nl.forEach(u),sp=v(Ol,"."),Ol.forEach(u),tp=y(El),ep=b(El,"P",{});var Dl=E(ep);op=v(Dl,"DefinePlugin uses something called "),pp=b(Dl,"A",{href:!0,rel:!0});var Rl=E(pp);cp=b(Rl,"STRONG",{});var Wl=E(cp);ip=v(Wl,"JavaScriptParser Hooks"),Wl.forEach(u),Rl.forEach(u),lp=v(Dl,", which you can rename a variable through "),rp=b(Dl,"CODE",{});var Ul=E(rp);up=v(Ul,"canRename"),Ul.forEach(u),hp=v(Dl," and "),kp=b(Dl,"CODE",{});var Bl=E(kp);fp=v(Bl,"identifier"),Bl.forEach(u),dp=v(Dl," hooks or replace an expression through the "),mp=b(Dl,"CODE",{});var zl=E(mp);gp=v(zl,"expression"),zl.forEach(u),wp=v(Dl," hook:"),Dl.forEach(u),Ep=y(El),bp=b(El,"PRE",{class:!0}),E(bp).forEach(u),vp=y(El),yp=b(El,"P",{});var Jl=E(yp);Ip=v(Jl,"The complete code can be found in "),Sp=b(Jl,"A",{href:!0,rel:!0});var Yl=E(Sp);Ap=v(Yl,"this gist"),Yl.forEach(u),Tp=v(Jl,"."),Jl.forEach(u),Cp=y(El),Pp=b(El,"P",{});var Gl=E(Pp);jp=v(Gl,"An example of the compiled output:"),Gl.forEach(u),xp=y(El),Lp=b(El,"PRE",{class:!0}),E(Lp).forEach(u),El.forEach(u),$p=y(n),_p=b(n,"SECTION",{});var Vl=E(_p);Mp=b(Vl,"H2",{});var Kl=E(Mp);Op=b(Kl,"A",{href:!0,id:!0});var Ql=E(Op);Hp=v(Ql,"Closing Notes"),Ql.forEach(u),Kl.forEach(u),Fp=y(Vl),qp=b(Vl,"P",{});var Zl=E(qp);Np=v(Zl,"The compile output for the 3rd approach seemed to be better (more precise?) than the other, yet I am not entirely sure using a "),Dp=b(Zl,"CODE",{});var Xl=E(Dp);Rp=v(Xl,"needAdditionalPass"),Xl.forEach(u),Wp=v(Zl," is the right way of going about it."),Zl.forEach(u),Up=y(Vl),Bp=b(Vl,"P",{});var nr=E(Bp);zp=v(nr,"So, "),Jp=b(nr,"A",{href:!0,rel:!0});var ar=E(Jp);Yp=v(ar,"let me know"),ar.forEach(u),Gp=v(nr," if you have any thoughts or suggestions, yea?"),nr.forEach(u),Vl.forEach(u),Vp=y(n),Kp=b(n,"SECTION",{});var sr=E(Kp);Qp=b(sr,"H3",{});var tr=E(Qp);Zp=b(tr,"A",{href:!0,id:!0});var er=E(Zp);Xp=v(er,"[Updated Feb 27, 2020]"),er.forEach(u),tr.forEach(u),nc=y(sr),ac=b(sr,"P",{});var or=E(ac);sc=v(or,"You can read "),tc=b(or,"A",{href:!0,rel:!0});var pr=E(tc);ec=v(pr,"the discussions that's happening on Twitter"),pr.forEach(u),oc=v(or,":"),or.forEach(u),pc=y(sr),cc=b(sr,"BLOCKQUOTE",{class:!0});var cr=E(cc);ic=b(cr,"P",{lang:!0,dir:!0});var ir=E(ic);lc=v(ir,"Need some suggestions and inputs from "),rc=b(ir,"A",{href:!0});var lr=E(rc);uc=v(lr,"@webpack"),lr.forEach(u),hc=v(ir," masters, I've written the problem and approaches that I've taken over here: "),kc=b(ir,"A",{href:!0});var rr=E(kc);fc=v(rr,"https://t.co/gLsPG9Joeq"),rr.forEach(u),dc=v(ir,", still I'm not sure I am doing it right 🙈"),mc=b(ir,"A",{href:!0});var ur=E(mc);gc=v(ur,"@wSokra"),ur.forEach(u),wc=y(ir),Ec=b(ir,"A",{href:!0});var hr=E(Ec);bc=v(hr,"@evilebottnawi"),hr.forEach(u),ir.forEach(u),vc=v(cr,"— Tan Li Hau (@lihautan) "),yc=b(cr,"A",{href:!0});var kr=E(yc);Ic=v(kr,"February 20, 2020"),kr.forEach(u),cr.forEach(u),sr.forEach(u),this.h()},h(){w(o,"href","#the-problem"),w(i,"href","#the-st-approach"),w(I,"href","#"),w(A,"href","#the-nd-approach"),w(j,"href","#"),w(L,"href","#the-rd-approach"),w(M,"href","#closing-notes"),w(q,"href","#"),w(t,"class","sitemap"),w(t,"id","sitemap"),w(t,"role","navigation"),w(t,"aria-label","Table of Contents"),w(z,"href","#the-problem"),w(z,"id","the-problem"),w(nn,"class","language-json"),w(sn,"class","language-css"),w(pn,"href","https://expressjs.com/"),w(pn,"rel","nofollow"),w(rn,"href","https://reactjs.org/"),w(rn,"rel","nofollow"),w(fn,"class","language-js"),w(Cn,"href","#the-st-approach"),w(Cn,"id","the-st-approach"),w($n,"href","https://www.npmjs.com/package/webpack-manifest-plugin"),w($n,"rel","nofollow"),w(Hn,"class","language-js"),w(Vn,"href","https://webpack.js.org/api/module-variables/#__non_webpack_require__-webpack-specific"),w(Vn,"rel","nofollow"),w(la,"class","language-js"),w(Ia,"class","language-null"),w(_a,"href","#"),w(_a,"id",""),w(qa,"href","https://twitter.com/wSokra"),w(qa,"rel","nofollow"),w(Ra,"href","https://twitter.com/wSokra/status/1230448421351444482"),w(Ra,"rel","nofollow"),w(Ga,"class","language-js"),w(Ka,"class","language-js"),w(as,"class","language-js"),w(ls,"class","language-null"),w(ks,"href","https://webpack.js.org/configuration/externals/"),w(ks,"rel","nofollow"),w(Es,"href","#the-nd-approach"),w(Es,"id","the-nd-approach"),w(Ss,"href","/webpack-plugin-main-template"),w(Ps,"class","language-js"),w(zs,"class","language-js"),w(Ks,"class","language-js"),w(nt,"href","https://webpack.js.org/api/compiler-hooks/"),w(nt,"rel","nofollow"),w(pt,"href","https://webpack.js.org/api/compiler-hooks/"),w(pt,"rel","nofollow"),w(Ft,"href","https://github.com/danethurber/webpack-manifest-plugin/blob/63d3ee2/lib/plugin.js#L255"),w(Ft,"rel","nofollow"),w(Xt,"class","language-js"),w(ke,"class","language-js"),w(Oe,"href","#"),w(Oe,"id",""),w(De,"href","https://twitter.com/evilebottnawi"),w(De,"rel","nofollow"),w(ze,"lang","en"),w(ze,"dir","ltr"),w(Ge,"href","https://twitter.com/evilebottnawi/status/1230417598677954560?ref_src=twsrc%5Etfw"),w(Be,"class","twitter-tweet"),w(Xe,"href","#the-rd-approach"),w(Xe,"id","the-rd-approach"),w(eo,"href","https://webpack.js.org/api/compilation-hooks/#needadditionalpass"),w(eo,"rel","nofollow"),w(Ao,"class","language-js"),w(Co,"class","language-js"),w(Jo,"href","https://github.com/webpack/webpack/blob/d426b6c/lib/DefinePlugin.js"),w(Jo,"rel","nofollow"),w(pp,"href","https://webpack.js.org/api/parser/"),w(pp,"rel","nofollow"),w(bp,"class","language-js"),w(Sp,"href","https://gist.github.com/tanhauhau/2dc6cc376fd190e05d14901b984c7fc1"),w(Sp,"rel","nofollow"),w(Lp,"class","language-js"),w(Op,"href","#closing-notes"),w(Op,"id","closing-notes"),w(Jp,"href","https://twitter.com/lihautan"),w(Jp,"rel","nofollow"),w(Zp,"href","#"),w(Zp,"id",""),w(tc,"href","https://twitter.com/lihautan/status/1230301241533583360"),w(tc,"rel","nofollow"),w(rc,"href","https://twitter.com/webpack?ref_src=twsrc%5Etfw"),w(kc,"href","https://t.co/gLsPG9Joeq"),w(mc,"href","https://twitter.com/wSokra?ref_src=twsrc%5Etfw"),w(Ec,"href","https://twitter.com/evilebottnawi?ref_src=twsrc%5Etfw"),w(ic,"lang","en"),w(ic,"dir","ltr"),w(yc,"href","https://twitter.com/lihautan/status/1230301241533583360?ref_src=twsrc%5Etfw"),w(cc,"class","twitter-tweet")},m(n,a){r(n,s,a),l(s,t),l(t,e),l(e,o),l(o,p),l(t,c),l(c,i),l(i,h),l(t,f),l(f,g),l(g,I),l(t,S),l(S,A),l(A,T),l(t,C),l(C,P),l(P,j),l(t,x),l(x,L),l(L,$),l(t,_),l(_,M),l(M,O),l(t,H),l(H,F),l(F,q),r(n,N,a),r(n,D,a),l(D,R),r(n,W,a),r(n,U,a),l(U,B),l(B,z),l(z,J),l(U,Y),l(U,G),l(G,V),l(U,K),l(U,Q),l(Q,Z),l(U,X),l(U,nn),nn.innerHTML='<code class="language-json"><span class="token punctuation">&#123;</span>\n  <span class="token property">"css"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"http://cdn/assets/style.xxx.css"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token property">"html"</span><span class="token operator">:</span> <span class="token string">"&lt;div class="container_xyz">Hello world&lt;/div>"</span>\n<span class="token punctuation">&#125;</span></code>',l(U,an),l(U,sn),sn.innerHTML='<code class="language-css"><span class="token comment">/* filename: http://cdn/assets/style.xxx.css */</span>\n<span class="token selector">.container_xyz</span> <span class="token punctuation">&#123;</span>\n  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">\'Comic Sans\'</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',l(U,tn),l(U,en),l(en,on),l(en,pn),l(pn,cn),l(en,ln),l(en,rn),l(rn,un),l(en,hn),l(U,kn),l(U,fn),fn.innerHTML='<code class="language-js"><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">\'express\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> renderToStaticMarkup <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'react-dom/server\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">\'./app.scss\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">&#123;</span>styles<span class="token punctuation">.</span>container<span class="token punctuation">&#125;</span><span class="token operator">></span>Hello world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> <span class="token function">renderToStaticMarkup</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napp<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',l(U,dn),l(U,mn),l(mn,gn),l(U,wn),l(U,En),l(En,bn),l(U,vn),l(U,yn),l(yn,In),r(n,Sn,a),r(n,An,a),l(An,Tn),l(Tn,Cn),l(Cn,Pn),l(An,jn),l(An,xn),l(xn,Ln),l(xn,$n),l($n,_n),l(xn,Mn),l(An,On),l(An,Hn),Hn.innerHTML='<code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> webpackManifest <span class="token keyword">from</span> <span class="token string">\'./dist/webpack-manifest.json\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> cssFiles<span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',l(An,Fn),l(An,qn),l(qn,Nn),l(qn,Dn),l(Dn,Rn),l(qn,Wn),l(An,Un),l(An,Bn),l(Bn,zn),l(Bn,Jn),l(Jn,Yn),l(Bn,Gn),l(Bn,Vn),l(Vn,Kn),l(Kn,Qn),l(Bn,Zn),l(Bn,Xn),l(Xn,na),l(Bn,aa),l(Bn,sa),l(sa,ta),l(Bn,ea),l(Bn,oa),l(oa,pa),l(Bn,ca),l(An,ia),l(An,la),la.innerHTML='<code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> webpackManifest <span class="token operator">=</span> <span class="token function">__non_webpack_require__</span><span class="token punctuation">(</span><span class="token string">\'./dist/webpack-manifest.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> cssFiles<span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',l(An,ra),l(An,ua),l(ua,ha),l(ua,ka),l(ka,fa),l(ua,da),l(An,ma),l(An,ga),l(ga,wa),l(ga,Ea),l(Ea,ba),l(ga,va),l(An,ya),l(An,Ia),Ia.innerHTML='\n<code class="language-">dist\n├── webpack-manifest.json\n└── bundle.js  // &lt;-- the main output bundle</code>',l(An,Sa),l(An,Aa),l(Aa,Ta),l(Aa,Ca),l(Ca,Pa),l(Aa,ja),r(n,xa,a),r(n,La,a),l(La,$a),l($a,_a),l(_a,Ma),l(La,Oa),l(La,Ha),l(Ha,Fa),l(Ha,qa),l(qa,Na),l(Ha,Da),l(Ha,Ra),l(Ra,Wa),l(Ha,Ua),l(Ha,Ba),l(Ba,za),l(Ha,Ja),l(La,Ya),l(La,Ga),Ga.innerHTML='<code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> webpackManifest <span class="token keyword">from</span> <span class="token string">\'webpack-manifest\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',l(La,Va),l(La,Ka),Ka.innerHTML='<code class="language-js"><span class="token comment">// filename: webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>\n  externals<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>\n    <span class="token string">\'webpack-manifest\'</span><span class="token punctuation">:</span> <span class="token string">"commonjs2 ./webpack-manifest.json"</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',l(La,Qa),l(La,Za),l(Za,Xa),l(La,ns),l(La,as),as.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token keyword">const</span> webpackManifest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./webpack-manifest.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',l(La,ss),l(La,ts),l(ts,es),l(ts,os),l(os,ps),l(ts,cs),l(La,is),l(La,ls),ls.innerHTML='\n<code class="language-">dist\n├── bundle.js  // &lt;-- the main output bundle\n└── webpack-manifest.json // &lt;-- relative to bundle.js</code>',l(La,rs),l(La,us),l(us,hs),l(us,ks),l(ks,fs),l(us,ds),r(n,ms,a),r(n,gs,a),l(gs,ws),l(ws,Es),l(Es,bs),l(gs,vs),l(gs,ys),l(ys,Is),l(ys,Ss),l(Ss,As),l(ys,Ts),l(gs,Cs),l(gs,Ps),Ps.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token comment">// added by template plugin</span>\n<span class="token keyword">const</span> <span class="token constant">CSS_FILES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'http://cdn/assets/style.xxx.css\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token comment">// END added by template plugin</span>\n<span class="token comment">// ...the main bundle</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> <span class="token constant">CSS_FILES</span><span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',l(gs,js),l(gs,xs),l(xs,Ls),l(xs,$s),l($s,_s),l(xs,Ms),l(xs,Os),l(Os,Hs),l(xs,Fs),l(gs,qs),l(gs,Ns),l(Ns,Ds),l(Ns,Rs),l(Rs,Ws),l(Ns,Us),l(gs,Bs),l(gs,zs),zs.innerHTML='<code class="language-js"><span class="token keyword">const</span> ManifestPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack-manifest-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">new</span> <span class="token class-name">ManifestPlugin</span><span class="token punctuation">(</span>manifestOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// get manifest from &#96;webpack-manifest-plugin&#96;</span>\n    ManifestPlugin<span class="token punctuation">.</span><span class="token function">getCompilerHooks</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">.</span>afterEmit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>\n      <span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span>\n      <span class="token parameter">manifest</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// see https://lihautan.com/webpack-plugin-main-template</span>\n    <span class="token comment">// on writing template plugin</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// ...</span>\n      hooks<span class="token punctuation">.</span>render<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> chunk<span class="token punctuation">,</span> chunkGraph <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token comment">// ...</span>\n        <span class="token comment">// highlight-start</span>\n        <span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">const CSS_FILES = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ConcatSource</span><span class="token punctuation">(</span>prefix<span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// highlight-end</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',l(gs,Js),l(gs,Ys),l(Ys,Gs),l(gs,Vs),l(gs,Ks),Ks.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token keyword">const</span> <span class="token constant">CSS_FILES</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>\n<span class="token comment">// ...continue with bundle.js</span></code>',l(gs,Qs),l(gs,Zs),l(Zs,Xs),l(Zs,nt),l(nt,at),l(Zs,st),l(gs,tt),l(gs,et),l(et,ot),l(et,pt),l(pt,ct),l(et,it),l(gs,lt),l(gs,rt),l(rt,ut),l(ut,ht),l(rt,kt),l(rt,ft),l(ft,dt),l(rt,mt),l(rt,gt),l(gt,wt),l(rt,Et),l(rt,bt),l(bt,vt),l(rt,yt),l(rt,It),l(It,St),l(rt,At),l(rt,Tt),l(Tt,Ct),l(rt,Pt),l(rt,jt),l(jt,xt),l(rt,Lt),l(rt,$t),l($t,_t),l(gs,Mt),l(gs,Ot),l(Ot,Ht),l(Ot,Ft),l(Ft,qt),l(Ft,Nt),l(Nt,Dt),l(Ft,Rt),l(Ot,Wt),l(Ot,Ut),l(Ut,Bt),l(Ot,zt),l(Ot,Jt),l(Jt,Yt),l(Ot,Gt),l(Ot,Vt),l(Vt,Kt),l(Ot,Qt),l(gs,Zt),l(gs,Xt),Xt.innerHTML='<code class="language-js"><span class="token operator">-</span> <span class="token function">thisCompliation</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token punctuation">)</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">)</span> <span class="token comment">// too late!</span></code>',l(gs,ne),l(gs,ae),l(ae,se),l(ae,te),l(te,ee),l(ae,oe),l(ae,pe),l(pe,ce),l(ae,ie),l(ae,le),l(le,re),l(ae,ue),l(gs,he),l(gs,ke),ke.innerHTML='<code class="language-js"><span class="token keyword">const</span> ManifestPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack-manifest-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">new</span> <span class="token class-name">ManifestPlugin</span><span class="token punctuation">(</span>manifestOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// get manifest from &#96;webpack-manifest-plugin&#96;</span>\n    ManifestPlugin<span class="token punctuation">.</span><span class="token function">getCompilerHooks</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">.</span>afterEmit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>\n      <span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span>\n      <span class="token parameter">manifest</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">const CSS_FILES = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n\n      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> file <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">\'.js\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>\n        compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcatSource</span><span class="token punctuation">(</span>\n          prefix<span class="token punctuation">,</span>\n          compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span>\n        <span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',l(gs,fe),l(gs,de),l(de,me),l(de,ge),l(ge,we),l(de,Ee),l(gs,be),l(gs,ve),l(ve,ye),l(ve,Ie),l(Ie,Se),l(ve,Ae),l(ve,Te),l(Te,Ce),l(ve,Pe),l(ve,je),l(je,xe),l(ve,Le),r(n,$e,a),r(n,_e,a),l(_e,Me),l(Me,Oe),l(Oe,He),l(_e,Fe),l(_e,qe),l(qe,Ne),l(qe,De),l(De,Re),l(qe,We),l(_e,Ue),l(_e,Be),l(Be,ze),l(ze,Je),l(Be,Ye),l(Be,Ge),l(Ge,Ve),r(n,Ke,a),r(n,Qe,a),l(Qe,Ze),l(Ze,Xe),l(Xe,no),l(Qe,ao),l(Qe,so),l(so,to),l(so,eo),l(eo,oo),l(oo,po),l(so,co),l(so,io),l(io,lo),l(so,ro),l(Qe,uo),l(Qe,ho),l(ho,ko),l(ho,fo),l(fo,mo),l(ho,go),l(ho,wo),l(wo,Eo),l(ho,bo),l(ho,vo),l(vo,yo),l(ho,Io),l(Qe,So),l(Qe,Ao),Ao.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n      compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>needAdditionalPass<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n        <span class="token comment">// if it is always true, will lead to infinite loop!</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',l(Qe,To),l(Qe,Co),Co.innerHTML='<code class="language-js"><span class="token operator">-</span> <span class="token function">thisCompliation</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token punctuation">)</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">)</span> <span class="token comment">// too late!</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">needAddtionalPass</span> <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// to start the compilation again</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">thisCompilation</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">==</span> manifest<span class="token punctuation">)</span> <span class="token comment">// now &#96;this.manifest&#96; is available</span>\n<span class="token operator">-</span> <span class="token comment">// ... will continue run through every stages again</span>\n<span class="token operator">-</span> <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">)</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span></code>',l(Qe,Po),l(Qe,jo),l(jo,xo),l(jo,Lo),l(Lo,$o),l(jo,_o),l(Qe,Mo),l(Qe,Oo),l(Oo,Ho),l(Oo,Fo),l(Fo,qo),l(Oo,No),l(Oo,Do),l(Do,Ro),l(Oo,Wo),l(Qe,Uo),l(Qe,Bo),l(Bo,zo),l(Bo,Jo),l(Jo,Yo),l(Jo,Go),l(Go,Vo),l(Bo,Ko),l(Bo,Qo),l(Qo,Zo),l(Bo,Xo),l(Bo,np),l(np,ap),l(Bo,sp),l(Qe,tp),l(Qe,ep),l(ep,op),l(ep,pp),l(pp,cp),l(cp,ip),l(ep,lp),l(ep,rp),l(rp,up),l(ep,hp),l(ep,kp),l(kp,fp),l(ep,dp),l(ep,mp),l(mp,gp),l(ep,wp),l(Qe,Ep),l(Qe,bp),bp.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>\n      <span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span>\n      <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> normalModuleFactory <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        normalModuleFactory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>parser\n          <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">\'javascript/auto\'</span><span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">parser</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n            <span class="token comment">// highlight-start</span>\n            parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>expression\n              <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">\'CSS_FILES\'</span><span class="token punctuation">)</span>\n              <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">expr</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n                <span class="token keyword">return</span> ParserHelpers<span class="token punctuation">.</span><span class="token function">toConstantDependency</span><span class="token punctuation">(</span>\n                  parser<span class="token punctuation">,</span>\n                  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest<span class="token punctuation">)</span>\n                <span class="token punctuation">)</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">// highlight-end</span>\n          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',l(Qe,vp),l(Qe,yp),l(yp,Ip),l(yp,Sp),l(Sp,Ap),l(yp,Tp),l(Qe,Cp),l(Qe,Pp),l(Pp,jp),l(Qe,xp),l(Qe,Lp),Lp.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token comment">// ...</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    <span class="token comment">// replaced via parser hooks</span>\n    <span class="token comment">// highlight-next-line</span>\n    css<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'http://cdn/assets/style.xxx.css\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',r(n,$p,a),r(n,_p,a),l(_p,Mp),l(Mp,Op),l(Op,Hp),l(_p,Fp),l(_p,qp),l(qp,Np),l(qp,Dp),l(Dp,Rp),l(qp,Wp),l(_p,Up),l(_p,Bp),l(Bp,zp),l(Bp,Jp),l(Jp,Yp),l(Bp,Gp),r(n,Vp,a),r(n,Kp,a),l(Kp,Qp),l(Qp,Zp),l(Zp,Xp),l(Kp,nc),l(Kp,ac),l(ac,sc),l(ac,tc),l(tc,ec),l(ac,oc),l(Kp,pc),l(Kp,cc),l(cc,ic),l(ic,lc),l(ic,rc),l(rc,uc),l(ic,hc),l(ic,kc),l(kc,fc),l(ic,dc),l(ic,mc),l(mc,gc),l(ic,wc),l(ic,Ec),l(Ec,bc),l(cc,vc),l(cc,yc),l(yc,Ic)},p:n,d(n){n&&u(s),n&&u(N),n&&u(D),n&&u(W),n&&u(U),n&&u(Sn),n&&u(An),n&&u(xa),n&&u(La),n&&u(ms),n&&u(gs),n&&u($e),n&&u(_e),n&&u(Ke),n&&u(Qe),n&&u($p),n&&u(_p),n&&u(Vp),n&&u(Kp)}}}function hn(n){let s,t;const e=[kn];let o={$$slots:{default:[un]},$$scope:{ctx:n}};for(let n=0;n<e.length;n+=1)o=a(o,e[n]);return s=new rn({props:o}),{c(){U(s.$$.fragment)},l(n){B(s.$$.fragment,n)},m(n,a){z(s,n,a),t=!0},p(n,[a]){const t=0&a?function(n,a){const s={},t={},e={$$scope:1};let o=n.length;for(;o--;){const p=n[o],c=a[o];if(c){for(const n in p)n in c||(t[n]=1);for(const n in c)e[n]||(s[n]=c[n],e[n]=1);n[o]=c}else for(const n in p)e[n]=1}for(const n in t)n in s||(s[n]=void 0);return s}(e,[(o=kn,"object"==typeof o&&null!==o?o:{})]):{};var o;1&a&&(t.$$scope={dirty:a,ctx:n}),s.$set(t)},i(n){t||(R(s.$$.fragment,n),t=!0)},o(n){W(s.$$.fragment,n),t=!1},d(n){J(s,n)}}}const kn={title:"Webpack Additional Compilation Pass",date:"2020-02-20T08:00:00Z",lastUpdated:"2020-02-27T08:00:00Z",slug:"webpack-additional-compilation-pass",type:"blog"};class fn extends V{constructor(n){super(),G(this,n,null,hn,p,{})}}setTimeout(()=>{new fn({target:document.querySelector("#app"),hydrate:!0});if(document.querySelector(".twitter-tweet")){const n=document.createElement("script");n.async=!0,n.src="https://platform.twitter.com/widgets.js",n.charset="utf-8",document.body.appendChild(n)}if("loading"in HTMLImageElement.prototype){document.querySelectorAll('img[loading="lazy"]').forEach(n=>{n.src=n.dataset.src})}else{const n=document.createElement("script");n.src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js",document.body.appendChild(n)}},3e3);
