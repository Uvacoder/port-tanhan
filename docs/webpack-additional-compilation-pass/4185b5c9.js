function n(){}function a(n,a){for(const s in a)n[s]=a[s];return n}function s(n){return n()}function t(){return Object.create(null)}function e(n){n.forEach(s)}function o(n){return"function"==typeof n}function p(n,a){return n!=n?a==a:n!==a||n&&"object"==typeof n||"function"==typeof n}function c(n,s,t,e){return n[1]&&e?a(t.ctx.slice(),n[1](e(s))):t.ctx}function i(n,a,s,t,e,o,p){const i=function(n,a,s,t){if(n[2]&&t){const e=n[2](t(s));if(void 0===a.dirty)return e;if("object"==typeof e){const n=[],s=Math.max(a.dirty.length,e.length);for(let t=0;t<s;t+=1)n[t]=a.dirty[t]|e[t];return n}return a.dirty|e}return a.dirty}(a,t,e,o);if(i){const e=c(a,s,t,p);n.p(e,i)}}function r(n,a){n.appendChild(a)}function l(n,a,s){n.insertBefore(a,s||null)}function u(n){n.parentNode.removeChild(n)}function h(n,a){for(let s=0;s<n.length;s+=1)n[s]&&n[s].d(a)}function k(n){return document.createElement(n)}function f(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function d(n){return document.createTextNode(n)}function m(){return d(" ")}function g(){return d("")}function w(n,a,s){null==s?n.removeAttribute(a):n.getAttribute(a)!==s&&n.setAttribute(a,s)}function b(n){return Array.from(n.childNodes)}function E(n,a,s,t){for(let t=0;t<n.length;t+=1){const e=n[t];if(e.nodeName===a){let a=0;const o=[];for(;a<e.attributes.length;){const n=e.attributes[a++];s[n.name]||o.push(n.name)}for(let n=0;n<o.length;n++)e.removeAttribute(o[n]);return n.splice(t,1)[0]}}return t?f(a):k(a)}function v(n,a){for(let s=0;s<n.length;s+=1){const t=n[s];if(3===t.nodeType)return t.data=""+a,n.splice(s,1)[0]}return d(a)}function y(n){return v(n," ")}function I(n,a){a=""+a,n.wholeText!==a&&(n.data=a)}function S(n,a){n.value=null==a?"":a}class A{constructor(n=null){this.a=n,this.e=this.n=null}m(n,a,s=null){this.e||(this.e=k(a.nodeName),this.t=a,this.h(n)),this.i(s)}h(n){this.e.innerHTML=n,this.n=Array.from(this.e.childNodes)}i(n){for(let a=0;a<this.n.length;a+=1)l(this.t,this.n[a],n)}p(n){this.d(),this.h(n),this.i(this.a)}d(){this.n.forEach(u)}}let T;function C(n){T=n}function P(n){(function(){if(!T)throw new Error("Function called outside component initialization");return T})().$$.on_mount.push(n)}const x=[],j=[],L=[],$=[],_=Promise.resolve();let M=!1;function O(n){L.push(n)}let F=!1;const H=new Set;function q(){if(!F){F=!0;do{for(let n=0;n<x.length;n+=1){const a=x[n];C(a),N(a.$$)}for(x.length=0;j.length;)j.pop()();for(let n=0;n<L.length;n+=1){const a=L[n];H.has(a)||(H.add(a),a())}L.length=0}while(x.length);for(;$.length;)$.pop()();M=!1,F=!1,H.clear()}}function N(n){if(null!==n.fragment){n.update(),e(n.before_update);const a=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,a),n.after_update.forEach(O)}}const D=new Set;function R(n,a){n&&n.i&&(D.delete(n),n.i(a))}function W(n,a,s,t){if(n&&n.o){if(D.has(n))return;D.add(n),(void 0).c.push(()=>{D.delete(n),t&&(s&&n.d(1),t())}),n.o(a)}}function U(n){n&&n.c()}function B(n,a){n&&n.l(a)}function J(n,a,t){const{fragment:p,on_mount:c,on_destroy:i,after_update:r}=n.$$;p&&p.m(a,t),O(()=>{const a=c.map(s).filter(o);i?i.push(...a):e(a),n.$$.on_mount=[]}),r.forEach(O)}function z(n,a){const s=n.$$;null!==s.fragment&&(e(s.on_destroy),s.fragment&&s.fragment.d(a),s.on_destroy=s.fragment=null,s.ctx=[])}function Y(n,a){-1===n.$$.dirty[0]&&(x.push(n),M||(M=!0,_.then(q)),n.$$.dirty.fill(0)),n.$$.dirty[a/31|0]|=1<<a%31}function G(a,s,o,p,c,i,r=[-1]){const l=T;C(a);const h=s.props||{},k=a.$$={fragment:null,ctx:null,props:i,update:n,not_equal:c,bound:t(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(l?l.$$.context:[]),callbacks:t(),dirty:r};let f=!1;if(k.ctx=o?o(a,h,(n,s,...t)=>{const e=t.length?t[0]:s;return k.ctx&&c(k.ctx[n],k.ctx[n]=e)&&(k.bound[n]&&k.bound[n](e),f&&Y(a,n)),s}):[],k.update(),f=!0,e(k.before_update),k.fragment=!!p&&p(k.ctx),s.target){if(s.hydrate){const n=b(s.target);k.fragment&&k.fragment.l(n),n.forEach(u)}else k.fragment&&k.fragment.c();s.intro&&R(a.$$.fragment),J(a,s.target,s.anchor),q()}C(l)}class V{$destroy(){z(this,1),this.$destroy=n}$on(n,a){const s=this.$$.callbacks[n]||(this.$$.callbacks[n]=[]);return s.push(a),()=>{const n=s.indexOf(a);-1!==n&&s.splice(n,1)}}$set(){}}function K(a){let s,t,e,o,p,c,i,h,g,I,S,A,T,C,P,x,j,L,$,_,M,O,F,H,q,N,D,R,W,U,B,J,z,Y,G;return{c(){s=k("header"),t=k("nav"),e=k("ul"),o=k("li"),p=k("a"),c=d("Tan Li Hau"),i=m(),h=k("li"),g=k("a"),I=d("About"),S=m(),A=k("li"),T=k("a"),C=d("Writings"),P=m(),x=k("li"),j=k("a"),L=d("Talks"),$=m(),_=k("li"),M=k("a"),O=d("Notes"),F=m(),H=k("li"),q=k("a"),N=d("Newsletter"),D=m(),R=k("li"),W=k("a"),U=f("svg"),B=f("path"),J=m(),z=k("a"),Y=f("svg"),G=f("path"),this.h()},l(n){s=E(n,"HEADER",{class:!0});var a=b(s);t=E(a,"NAV",{});var r=b(t);e=E(r,"UL",{class:!0});var l=b(e);o=E(l,"LI",{class:!0});var k=b(o);p=E(k,"A",{href:!0,class:!0});var f=b(p);c=v(f,"Tan Li Hau"),f.forEach(u),k.forEach(u),i=y(l),h=E(l,"LI",{class:!0});var d=b(h);g=E(d,"A",{href:!0,class:!0});var m=b(g);I=v(m,"About"),m.forEach(u),d.forEach(u),S=y(l),A=E(l,"LI",{class:!0});var w=b(A);T=E(w,"A",{href:!0,class:!0});var V=b(T);C=v(V,"Writings"),V.forEach(u),w.forEach(u),P=y(l),x=E(l,"LI",{class:!0});var K=b(x);j=E(K,"A",{href:!0,class:!0});var Q=b(j);L=v(Q,"Talks"),Q.forEach(u),K.forEach(u),$=y(l),_=E(l,"LI",{class:!0});var Z=b(_);M=E(Z,"A",{href:!0,class:!0});var X=b(M);O=v(X,"Notes"),X.forEach(u),Z.forEach(u),F=y(l),H=E(l,"LI",{class:!0});var nn=b(H);q=E(nn,"A",{href:!0,class:!0});var an=b(q);N=v(an,"Newsletter"),an.forEach(u),nn.forEach(u),D=y(l),R=E(l,"LI",{class:!0});var sn=b(R);W=E(sn,"A",{"aria-label":!0,href:!0,class:!0});var tn=b(W);U=E(tn,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var en=b(U);B=E(en,"path",{d:!0},1),b(B).forEach(u),en.forEach(u),tn.forEach(u),J=y(sn),z=E(sn,"A",{"aria-label":!0,href:!0,class:!0});var on=b(z);Y=E(on,"svg",{viewBox:!0,width:!0,height:!0,class:!0},1);var pn=b(Y);G=E(pn,"path",{d:!0},1),b(G).forEach(u),pn.forEach(u),on.forEach(u),sn.forEach(u),l.forEach(u),r.forEach(u),a.forEach(u),this.h()},h(){w(p,"href","/"),w(p,"class","svelte-f3e4uo"),w(o,"class","svelte-f3e4uo"),w(g,"href","/about"),w(g,"class","svelte-f3e4uo"),w(h,"class","svelte-f3e4uo"),w(T,"href","/blogs"),w(T,"class","svelte-f3e4uo"),w(A,"class","svelte-f3e4uo"),w(j,"href","/talks"),w(j,"class","svelte-f3e4uo"),w(x,"class","svelte-f3e4uo"),w(M,"href","/notes"),w(M,"class","svelte-f3e4uo"),w(_,"class","svelte-f3e4uo"),w(q,"href","/newsletter"),w(q,"class","svelte-f3e4uo"),w(H,"class","svelte-f3e4uo"),w(B,"d","M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66\n    10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5\n    4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"),w(U,"viewBox","0 0 24 24"),w(U,"width","1em"),w(U,"height","1em"),w(U,"class","svelte-f3e4uo"),w(W,"aria-label","Twitter account"),w(W,"href","https://twitter.com/lihautan"),w(W,"class","svelte-f3e4uo"),w(G,"d","M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0\n    0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07\n    5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65\n    5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42\n    3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"),w(Y,"viewBox","0 0 24 24"),w(Y,"width","1em"),w(Y,"height","1em"),w(Y,"class","svelte-f3e4uo"),w(z,"aria-label","Github account"),w(z,"href","https://github.com/tanhauhau"),w(z,"class","svelte-f3e4uo"),w(R,"class","social svelte-f3e4uo"),w(e,"class","svelte-f3e4uo"),w(s,"class","svelte-f3e4uo")},m(n,a){l(n,s,a),r(s,t),r(t,e),r(e,o),r(o,p),r(p,c),r(e,i),r(e,h),r(h,g),r(g,I),r(e,S),r(e,A),r(A,T),r(T,C),r(e,P),r(e,x),r(x,j),r(j,L),r(e,$),r(e,_),r(_,M),r(M,O),r(e,F),r(e,H),r(H,q),r(q,N),r(e,D),r(e,R),r(R,W),r(W,U),r(U,B),r(R,J),r(R,z),r(z,Y),r(Y,G)},p:n,i:n,o:n,d(n){n&&u(s)}}}class Q extends V{constructor(n){super(),G(this,n,null,K,p,{})}}function Z(a){let s,t,e,o,p,c,i,h,f,g,I,A,T,C,P,x,j,L,$,_;return{c(){s=k("div"),t=k("h1"),e=d("Subscribe to my newsletter"),o=m(),p=k("h2"),c=d("Get the latest blog posts and project updates delivered right to your inbox"),i=m(),h=k("form"),f=k("div"),g=k("input"),I=m(),A=k("input"),C=m(),P=k("input"),x=m(),j=k("p"),L=d("Powered by Buttondown."),this.h()},l(n){s=E(n,"DIV",{class:!0});var a=b(s);t=E(a,"H1",{});var r=b(t);e=v(r,"Subscribe to my newsletter"),r.forEach(u),o=y(a),p=E(a,"H2",{class:!0});var l=b(p);c=v(l,"Get the latest blog posts and project updates delivered right to your inbox"),l.forEach(u),i=y(a),h=E(a,"FORM",{action:!0,method:!0,target:!0,onsubmit:!0,class:!0});var k=b(h);f=E(k,"DIV",{class:!0});var d=b(f);g=E(d,"INPUT",{type:!0,name:!0,id:!0,"aria-label":!0,placeholder:!0,class:!0}),I=y(d),A=E(d,"INPUT",{type:!0,value:!0,disabled:!0,class:!0}),d.forEach(u),C=y(k),P=E(k,"INPUT",{type:!0,value:!0,name:!0,class:!0}),x=y(k),j=E(k,"P",{class:!0});var m=b(j);L=v(m,"Powered by Buttondown."),m.forEach(u),k.forEach(u),a.forEach(u),this.h()},h(){w(p,"class","svelte-1k1s1co"),w(g,"type","email"),w(g,"name","email"),w(g,"id","bd-email"),w(g,"aria-label","email address"),w(g,"placeholder","youremail@example.com"),w(g,"class","svelte-1k1s1co"),w(A,"type","submit"),A.value="Subscribe",A.disabled=T=!a[0],w(A,"class","svelte-1k1s1co"),w(f,"class","form-item svelte-1k1s1co"),w(P,"type","hidden"),P.value="1",w(P,"name","embed"),w(P,"class","svelte-1k1s1co"),w(j,"class","svelte-1k1s1co"),w(h,"action","https://buttondown.email/api/emails/embed-subscribe/lihautan"),w(h,"method","post"),w(h,"target","popupwindow"),w(h,"onsubmit","window.open('https://buttondown.email/lihautan', 'popupwindow')"),w(h,"class","embeddable-buttondown-form"),w(s,"class","form svelte-1k1s1co")},m(n,u){var k,d,m,w;l(n,s,u),r(s,t),r(t,e),r(s,o),r(s,p),r(p,c),r(s,i),r(s,h),r(h,f),r(f,g),S(g,a[0]),r(f,I),r(f,A),r(h,C),r(h,P),r(h,x),r(h,j),r(j,L),$||(k=g,d="input",m=a[1],k.addEventListener(d,m,w),_=()=>k.removeEventListener(d,m,w),$=!0)},p(n,[a]){1&a&&g.value!==n[0]&&S(g,n[0]),1&a&&T!==(T=!n[0])&&(A.disabled=T)},i:n,o:n,d(n){n&&u(s),$=!1,_()}}}function X(n,a,s){let t;return[t,function(){t=this.value,s(0,t)}]}class nn extends V{constructor(n){super(),G(this,n,X,Z,p,{})}}function an(n){return P(()=>(setTimeout(()=>{if(window.innerWidth>1080){const n=document.createElement("script");n.async=!0,n.type="text/javascript",n.src="//cdn.carbonads.com/carbon.js?serve=CE7ITK3E&placement=lihautancom",n.id="_carbonads_js",document.body.appendChild(n)}},5e3),()=>{try{const n=document.getElementById("carbonads");n.parentNode.removeChild(n)}catch(n){}})),[]}class sn extends V{constructor(n){super(),G(this,n,an,null,p,{})}}function tn(n,a,s){const t=n.slice();return t[6]=a[s],t}function en(n,a,s){const t=n.slice();return t[6]=a[s],t}function on(n){let a,s;return{c(){a=k("meta"),this.h()},l(n){a=E(n,"META",{name:!0,content:!0}),this.h()},h(){w(a,"name","keywords"),w(a,"content",s=n[6])},m(n,s){l(n,a,s)},p(n,t){4&t&&s!==(s=n[6])&&w(a,"content",s)},d(n){n&&u(a)}}}function pn(n){let a,s,t=n[6]+"";return{c(){a=k("span"),s=d(t),this.h()},l(n){a=E(n,"SPAN",{class:!0});var e=b(a);s=v(e,t),e.forEach(u),this.h()},h(){w(a,"class","svelte-9tqnza")},m(n,t){l(n,a,t),r(a,s)},p(n,a){4&a&&t!==(t=n[6]+"")&&I(s,t)},d(n){n&&u(a)}}}function cn(n){let a,s,t,e,o,p,f,S,T,C,P,x,j,L,$,_,M,O,F,H,q,N,D,Y,G,V,K,Z,X,an,cn,rn,ln,un,hn,kn,fn,dn,mn,gn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`,wn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fwebpack-additional-compilation-pass",name:n[0]},position:2}]})}<\/script>`;document.title=a=n[0]+" | Tan Li Hau";let bn=n[2],En=[];for(let a=0;a<bn.length;a+=1)En[a]=on(en(n,bn,a));D=new Q({});let vn=n[2],yn=[];for(let a=0;a<vn.length;a+=1)yn[a]=pn(tn(n,vn,a));const In=n[5].default,Sn=function(n,a,s,t){if(n){const e=c(n,a,s,t);return n[0](e)}}(In,n,n[4],null);return ln=new nn({}),hn=new sn({}),{c(){s=k("meta"),t=k("meta"),e=k("meta"),o=k("meta"),p=k("meta"),f=k("meta"),S=k("meta"),T=k("meta"),C=k("meta"),P=k("meta"),x=k("meta");for(let n=0;n<En.length;n+=1)En[n].c();j=k("meta"),L=k("meta"),_=g(),O=g(),F=m(),H=k("a"),q=d("Skip to content"),N=m(),U(D.$$.fragment),Y=m(),G=k("main"),V=k("h1"),K=d(n[0]),Z=m();for(let n=0;n<yn.length;n+=1)yn[n].c();X=m(),an=k("article"),Sn&&Sn.c(),cn=m(),rn=k("footer"),U(ln.$$.fragment),un=m(),U(hn.$$.fragment),kn=m(),dn=g(),this.h()},l(a){const c=function(n,a=document.body){return Array.from(a.querySelectorAll(n))}('[data-svelte="svelte-n0q11s"]',document.head);s=E(c,"META",{name:!0,content:!0}),t=E(c,"META",{name:!0,content:!0}),e=E(c,"META",{name:!0,content:!0}),o=E(c,"META",{name:!0,content:!0}),p=E(c,"META",{name:!0,content:!0}),f=E(c,"META",{name:!0,content:!0}),S=E(c,"META",{name:!0,content:!0}),T=E(c,"META",{name:!0,content:!0}),C=E(c,"META",{name:!0,content:!0}),P=E(c,"META",{name:!0,content:!0}),x=E(c,"META",{name:!0,content:!0});for(let n=0;n<En.length;n+=1)En[n].l(c);j=E(c,"META",{itemprop:!0,content:!0}),L=E(c,"META",{itemprop:!0,content:!0}),_=g(),O=g(),c.forEach(u),F=y(a),H=E(a,"A",{href:!0,class:!0});var i=b(H);q=v(i,"Skip to content"),i.forEach(u),N=y(a),B(D.$$.fragment,a),Y=y(a),G=E(a,"MAIN",{id:!0,class:!0});var r=b(G);V=E(r,"H1",{});var l=b(V);K=v(l,n[0]),l.forEach(u),Z=y(r);for(let n=0;n<yn.length;n+=1)yn[n].l(r);X=y(r),an=E(r,"ARTICLE",{});var h=b(an);Sn&&Sn.l(h),h.forEach(u),r.forEach(u),cn=y(a),rn=E(a,"FOOTER",{class:!0});var k=b(rn);B(ln.$$.fragment,k),un=y(k),B(hn.$$.fragment,k),k.forEach(u),kn=y(a),dn=g(),this.h()},h(){w(s,"name","description"),w(s,"content",n[1]),w(t,"name","image"),w(t,"content",null),w(e,"name","og:image"),w(e,"content",null),w(o,"name","og:title"),w(o,"content",n[0]),w(p,"name","og:description"),w(p,"content",n[1]),w(f,"name","og:type"),w(f,"content","website"),w(S,"name","twitter:card"),w(S,"content","summary_large_image"),w(T,"name","twitter:creator"),w(T,"content","@lihautan"),w(C,"name","twitter:title"),w(C,"content",n[0]),w(P,"name","twitter:description"),w(P,"content",n[1]),w(x,"name","twitter:image"),w(x,"content",null),w(j,"itemprop","url"),w(j,"content","https%3A%2F%2Flihautan.com%2Fwebpack-additional-compilation-pass"),w(L,"itemprop","image"),w(L,"content",null),$=new A(_),M=new A(O),w(H,"href","#content"),w(H,"class","skip svelte-9tqnza"),w(G,"id","content"),w(G,"class","blog svelte-9tqnza"),w(rn,"class","svelte-9tqnza"),fn=new A(dn)},m(n,a){r(document.head,s),r(document.head,t),r(document.head,e),r(document.head,o),r(document.head,p),r(document.head,f),r(document.head,S),r(document.head,T),r(document.head,C),r(document.head,P),r(document.head,x);for(let n=0;n<En.length;n+=1)En[n].m(document.head,null);r(document.head,j),r(document.head,L),$.m(gn,document.head),r(document.head,_),M.m(wn,document.head),r(document.head,O),l(n,F,a),l(n,H,a),r(H,q),l(n,N,a),J(D,n,a),l(n,Y,a),l(n,G,a),r(G,V),r(V,K),r(G,Z);for(let n=0;n<yn.length;n+=1)yn[n].m(G,null);r(G,X),r(G,an),Sn&&Sn.m(an,null),l(n,cn,a),l(n,rn,a),J(ln,rn,null),r(rn,un),J(hn,rn,null),l(n,kn,a),fn.m('<script async defer src="https://platform.twitter.com/widgets.js" charset="utf-8"><\/script>',n,a),l(n,dn,a),mn=!0},p(n,[t]){if((!mn||1&t)&&a!==(a=n[0]+" | Tan Li Hau")&&(document.title=a),(!mn||2&t)&&w(s,"content",n[1]),(!mn||1&t)&&w(o,"content",n[0]),(!mn||2&t)&&w(p,"content",n[1]),(!mn||1&t)&&w(C,"content",n[0]),(!mn||2&t)&&w(P,"content",n[1]),4&t){let a;for(bn=n[2],a=0;a<bn.length;a+=1){const s=en(n,bn,a);En[a]?En[a].p(s,t):(En[a]=on(s),En[a].c(),En[a].m(j.parentNode,j))}for(;a<En.length;a+=1)En[a].d(1);En.length=bn.length}if((!mn||3&t)&&gn!==(gn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"Article",author:n[3],copyrightHolder:n[3],copyrightYear:"2020",creator:n[3],publisher:n[3],description:n[1],headline:n[0],name:n[0],inLanguage:"en"})}<\/script>`)&&$.p(gn),(!mn||1&t)&&wn!==(wn=`<script type="application/ld+json">${JSON.stringify({"@context":"https://schema.org","@type":"BreadcrumbList",description:"Breadcrumbs list",name:"Breadcrumbs",itemListElement:[{"@type":"ListItem",item:{"@id":"https://lihautan.com",name:"Homepage"},position:1},{"@type":"ListItem",item:{"@id":"https%3A%2F%2Flihautan.com%2Fwebpack-additional-compilation-pass",name:n[0]},position:2}]})}<\/script>`)&&M.p(wn),(!mn||1&t)&&I(K,n[0]),4&t){let a;for(vn=n[2],a=0;a<vn.length;a+=1){const s=tn(n,vn,a);yn[a]?yn[a].p(s,t):(yn[a]=pn(s),yn[a].c(),yn[a].m(G,X))}for(;a<yn.length;a+=1)yn[a].d(1);yn.length=vn.length}Sn&&Sn.p&&16&t&&i(Sn,In,n,n[4],t,null,null)},i(n){mn||(R(D.$$.fragment,n),R(Sn,n),R(ln.$$.fragment,n),R(hn.$$.fragment,n),mn=!0)},o(n){W(D.$$.fragment,n),W(Sn,n),W(ln.$$.fragment,n),W(hn.$$.fragment,n),mn=!1},d(n){u(s),u(t),u(e),u(o),u(p),u(f),u(S),u(T),u(C),u(P),u(x),h(En,n),u(j),u(L),u(_),n&&$.d(),u(O),n&&M.d(),n&&u(F),n&&u(H),n&&u(N),z(D,n),n&&u(Y),n&&u(G),h(yn,n),Sn&&Sn.d(n),n&&u(cn),n&&u(rn),z(ln),z(hn),n&&u(kn),n&&u(dn),n&&fn.d()}}}function rn(n,a,s){let{title:t=""}=a,{description:e=""}=a,{tags:o=[]}=a;const p={"@type":"Person",name:"Tan Li Hau"};let{$$slots:c={},$$scope:i}=a;return n.$set=n=>{"title"in n&&s(0,t=n.title),"description"in n&&s(1,e=n.description),"tags"in n&&s(2,o=n.tags),"$$scope"in n&&s(4,i=n.$$scope)},[t,e,o,p,i,c]}class ln extends V{constructor(n){super(),G(this,n,rn,cn,p,{title:0,description:1,tags:2})}}function un(a){let s,t,e,o,p,c,i,h,f,g,I,S,A,T,C,P,x,j,L,$,_,M,O,F,H,q,N,D,R,W,U,B,J,z,Y,G,V,K,Q,Z,X,nn,an,sn,tn,en,on,pn,cn,rn,ln,un,hn,kn,fn,dn,mn,gn,wn,bn,En,vn,yn,In,Sn,An,Tn,Cn,Pn,xn,jn,Ln,$n,_n,Mn,On,Fn,Hn,qn,Nn,Dn,Rn,Wn,Un,Bn,Jn,zn,Yn,Gn,Vn,Kn,Qn,Zn,Xn,na,aa,sa,ta,ea,oa,pa,ca,ia,ra,la,ua,ha,ka,fa,da,ma,ga,wa,ba,Ea,va,ya,Ia,Sa,Aa,Ta,Ca,Pa,xa,ja,La,$a,_a,Ma,Oa,Fa,Ha,qa,Na,Da,Ra,Wa,Ua,Ba,Ja,za,Ya,Ga,Va,Ka,Qa,Za,Xa,ns,as,ss,ts,es,os,ps,cs,is,rs,ls,us,hs,ks,fs,ds,ms,gs,ws,bs,Es,vs,ys,Is,Ss,As,Ts,Cs,Ps,xs,js,Ls,$s,_s,Ms,Os,Fs,Hs,qs,Ns,Ds,Rs,Ws,Us,Bs,Js,zs,Ys,Gs,Vs,Ks,Qs,Zs,Xs,nt,at,st,tt,et,ot,pt,ct,it,rt,lt,ut,ht,kt,ft,dt,mt,gt,wt,bt,Et,vt,yt,It,St,At,Tt,Ct,Pt,xt,jt,Lt,$t,_t,Mt,Ot,Ft,Ht,qt,Nt,Dt,Rt,Wt,Ut,Bt,Jt,zt,Yt,Gt,Vt,Kt,Qt,Zt,Xt,ne,ae,se,te,ee,oe,pe,ce,ie,re,le,ue,he,ke,fe,de,me,ge,we,be,Ee,ve,ye,Ie,Se,Ae,Te,Ce,Pe,xe,je,Le,$e,_e,Me,Oe,Fe,He,qe,Ne,De,Re,We,Ue,Be,Je,ze,Ye,Ge,Ve,Ke,Qe,Ze,Xe,no,ao,so,to,eo,oo,po,co,io,ro,lo,uo,ho,ko,fo,mo,go,wo,bo,Eo,vo,yo,Io,So,Ao,To,Co,Po,xo,jo,Lo,$o,_o,Mo,Oo,Fo,Ho,qo,No,Do,Ro,Wo,Uo,Bo,Jo,zo,Yo,Go,Vo,Ko,Qo,Zo,Xo,np,ap,sp,tp,ep,op,pp,cp,ip,rp,lp,up,hp,kp,fp,dp,mp,gp,wp,bp,Ep,vp,yp,Ip,Sp,Ap,Tp,Cp,Pp,xp,jp,Lp,$p,_p,Mp,Op,Fp,Hp,qp,Np,Dp,Rp,Wp,Up,Bp,Jp,zp,Yp,Gp,Vp,Kp,Qp,Zp,Xp,nc,ac,sc,tc,ec,oc,pc,cc,ic,rc,lc,uc,hc,kc,fc,dc,mc,gc,wc,bc,Ec,vc,yc,Ic;return{c(){s=k("section"),t=k("ul"),e=k("li"),o=k("a"),p=d("The problem"),c=k("li"),i=k("a"),h=d("The 1st approach"),f=k("ul"),g=k("li"),I=k("a"),S=k("li"),A=k("a"),T=d("The 2nd approach"),C=k("ul"),P=k("li"),x=k("a"),j=k("li"),L=k("a"),$=d("The 3rd approach"),_=k("li"),M=k("a"),O=d("Closing Notes"),F=k("ul"),H=k("li"),q=k("a"),N=m(),D=k("p"),R=d('Recently, I was working on a server-side rendering application, and encounter a scenario that I think it requires "double compilation" with webpack.'),W=m(),U=k("section"),B=k("h2"),J=k("a"),z=d("The problem"),Y=m(),G=k("p"),V=d("I am not entirely sure I am doing it in the right approach, feel free to suggest or discuss it with me. The following will be about the problem I faced and how I worked on it."),K=m(),Q=k("p"),Z=d("The server-side rendering application that I worked on, has an endpoint that takes in request and respond with a partial HTML content and CSS files required for styling:"),X=m(),nn=k("pre"),an=m(),sn=k("pre"),tn=m(),en=k("p"),on=d("The application code itself uses "),pn=k("a"),cn=d("Express"),rn=d(" and "),ln=k("a"),un=d("React"),hn=d(":"),kn=m(),fn=k("pre"),dn=m(),mn=k("p"),gn=d("Now, the problem is, how do I get the list of CSS files?"),wn=m(),bn=k("p"),En=d("The list of CSS files produced by the build is only available after I compile the application, but I need the information to be part of compiled code."),vn=m(),yn=k("p"),In=d("The compiled code being part of the compilation, needs to contain information of the compilation."),Sn=m(),An=k("section"),Tn=k("h2"),Cn=k("a"),Pn=d("The 1st approach"),xn=m(),jn=k("p"),Ln=d("A naive solution at first is to use "),$n=k("a"),_n=d("Webpack Manifest Plugin"),Mn=d(" to get the compilation manifest, and in the code, import the manifest as json and consumes it:"),On=m(),Fn=k("pre"),Hn=m(),qn=k("p"),Nn=d("Yet, the "),Dn=k("code"),Rn=d("./dist/webpack-manifest.json"),Wn=d(" is not available in the first place, before compiling the code."),Un=m(),Bn=k("p"),Jn=d("Since the "),zn=k("code"),Yn=d("./dist/webpack-manifest.json"),Gn=d(" can only be available after build, maybe we can import it during runtime, using "),Vn=k("a"),Kn=k("strong"),Qn=d("non_webpack_require"),Zn=d(". The difference between "),Xn=k("code"),na=d("require"),aa=d(" and "),sa=k("code"),ta=d("__non_webpack_require__"),ea=d(" is that the latter is webpack specific, which tells webpack to transform it to just pure "),oa=k("code"),pa=d("require()"),ca=d(" expression, without bundling the required module:"),ia=m(),ra=k("pre"),la=m(),ua=k("p"),ha=d("If you scrutinize the code, you may wonder whether "),ka=k("code"),fa=d("./dist/webpack-manifest.json"),da=d(" is the correct relative path from the compiled code?"),ma=m(),ga=k("p"),wa=d("Probably "),ba=k("code"),Ea=d("./webpack-manifest.json"),va=d(" would be more accurate, if our output folder looks like this:"),ya=m(),Ia=k("pre"),Sa=m(),Aa=k("p"),Ta=d("One can safely argue that, the approach above works and let's move on the next task. But, curiosity drives me to seek deeper for a more \"elegant\" solution, where one don't need "),Ca=k("code"),Pa=d("require('webpack-manifest.json')"),xa=d(" in runtime, but that information is compiled into the code."),ja=m(),La=k("section"),$a=k("h3"),_a=k("a"),Ma=d("[Updated Feb 27, 2020]"),Oa=m(),Fa=k("p"),Ha=d("Thanks to "),qa=k("a"),Na=d("@wSokra"),Da=d("'s "),Ra=k("a"),Wa=d("suggestion"),Ua=d(", instead of using "),Ba=k("code"),Ja=d("__non_webpack_require__()"),za=d(", you can use a normal import and declaring the manifest file as an external:"),Ya=m(),Ga=k("pre"),Va=m(),Ka=k("pre"),Qa=m(),Za=k("p"),Xa=d("What this output is something similar to the following:"),ns=m(),as=k("pre"),ss=m(),ts=k("p"),es=d("The reason we are using the relative path "),os=k("code"),ps=d("./webpack-manifest.json"),cs=d(" is that we are assuming the output folder looks like this:"),is=m(),rs=k("pre"),ls=m(),us=k("p"),hs=d("You can read more about webpack externals from "),ks=k("a"),fs=d("the webpack documentation"),ds=d("."),ms=m(),gs=k("section"),ws=k("h2"),bs=k("a"),Es=d("The 2nd approach"),vs=m(),ys=k("p"),Is=d('So, the next "intuitive" approach is to '),Ss=k("a"),As=d("write a custom template plugin"),Ts=d(", that adds the webpack manifest on top of the main bundle, an example of the output:"),Cs=m(),Ps=k("pre"),xs=m(),js=k("p"),Ls=d("In the source code, I will use the global variable "),$s=k("code"),_s=d("CSS_FILES"),Ms=d(", and hopefully it will get defined by webpack, by adding "),Os=k("code"),Fs=d("const CSS_FILES = ..."),Hs=d(" at the very top of the file."),qs=m(),Ns=k("p"),Ds=d("And to be extra careful, I have to make sure also that there's no variable "),Rs=k("code"),Ws=d("CSS_FILES"),Us=d(" declared between the global scope and the current scope the variable is being used."),Bs=m(),Js=k("pre"),zs=m(),Ys=k("p"),Gs=d("Apparently, this does not work at all. The compiled output shows:"),Vs=m(),Ks=k("pre"),Qs=m(),Zs=k("p"),Xs=d("After tracing through the code, I realised that I was ignorant of the sequence of execution of the "),nt=k("a"),at=d("compiler hooks"),st=d("."),tt=m(),et=k("p"),ot=d("In the "),pt=k("a"),ct=d("docs for compiler hooks"),it=d(", each hooks is executed in sequence:"),rt=m(),lt=k("ul"),ut=k("li"),ht=d("..."),kt=m(),ft=k("li"),dt=d("run"),mt=m(),gt=k("li"),wt=d("..."),bt=m(),Et=k("li"),vt=d("thisCompilation"),yt=m(),It=k("li"),St=d("..."),At=m(),Tt=k("li"),Ct=d("emit"),Pt=m(),xt=k("li"),jt=d("afterEmit"),Lt=m(),$t=k("li"),_t=d("..."),Mt=m(),Ot=k("p"),Ft=d("The webpack manifest plugin executes mainly "),Ht=k("a"),qt=d("during the "),Nt=k("code"),Dt=d("emit"),Rt=d(" phase"),Wt=d(", right before webpack writes all the assets into the output directory. And, we are modifying the template source in the "),Ut=k("code"),Bt=d("thisCompilation"),Jt=d(" phase, which is way before the "),zt=k("code"),Yt=d("emit"),Gt=d(" phase. That's why "),Vt=k("code"),Kt=d("this.manifest"),Qt=d(" property is still undefined at the time of execution."),Zt=m(),Xt=k("pre"),ne=m(),ae=k("p"),se=d("Upon reading the code fot he "),te=k("code"),ee=d("webpack-manifest-plugin"),oe=d(", I realised that during the "),pe=k("code"),ce=d("emit"),ie=d(" phase, I can access to the "),re=k("code"),le=d("compilation.assets"),ue=d(", and so, I could modifying the source for the assets during that time!"),he=m(),ke=k("pre"),fe=m(),de=k("p"),me=d("Apparently that works, but I wonder whether is it a good practice to modifying the source of an asset during the "),ge=k("code"),we=d("emit"),be=d(" phase? 🤔"),Ee=m(),ve=k("p"),ye=d("And, if you noticed, I need to append the "),Ie=k("code"),Se=d("const CSS_FILES = [...]"),Ae=d(" to every file, that's because I have no idea in which file "),Te=k("code"),Ce=d("CSS_FILES"),Pe=d(" is referenced. And because I declared it using "),xe=k("code"),je=d("const"),Le=d(", it only exists within the file's scope, so I have to redeclare it all the other files."),$e=m(),_e=k("section"),Me=k("h3"),Oe=k("a"),Fe=d("[Updated Feb 27, 2020]"),He=m(),qe=k("p"),Ne=d("According to "),De=k("a"),Re=d("@evilebottnawi"),We=d(" that this is not appropriate"),Ue=m(),Be=k("blockquote"),Je=k("p"),ze=d("A lot of plugin uses `compiler.hooks.emit` for emitting new assets, it is invalid. Ideally plugins should use `compilation.hooks.additionalAssets` for adding new assets."),Ye=d("— evilebottnawi (@evilebottnawi) "),Ge=k("a"),Ve=d("February 20, 2020"),Ke=m(),Qe=k("section"),Ze=k("h2"),Xe=k("a"),no=d("The 3rd approach"),ao=m(),so=k("p"),to=d("I was still not convinced that this is the best I could do, so I continued looking around webpack's doc. I found a particular compilation hooks, "),eo=k("a"),oo=k("code"),po=d("needAdditionalPass"),co=d(", which seems useful. It says, "),io=k("em"),ro=d('"Called to determine if an asset needs to be processed further after being emitted."'),lo=d("."),uo=m(),ho=k("p"),ko=d("So, if I return "),fo=k("code"),mo=d("true"),go=d(" in the "),wo=k("code"),bo=d("needAdditionalPass"),Eo=d(", webpack will re"),vo=k("code"),yo=d("compile"),Io=d(" the asset again:"),So=m(),Ao=k("pre"),To=m(),Co=k("pre"),Po=m(),xo=k("p"),jo=d("Note that using "),Lo=k("code"),$o=d("needAdditionalPass"),_o=d(" will cause the build time to roughly doubled!"),Mo=m(),Oo=k("p"),Fo=d("You may argue that why do we need to rerun the "),Ho=k("code"),qo=d("compilation"),No=d(" process again, isn't the end result can be equally achieved by modifying the assets source in the "),Do=k("code"),Ro=d("emit"),Wo=d(" phase?"),Uo=m(),Bo=k("p"),Jo=d("Well, that's because, I realised I could make use "),zo=k("a"),Yo=d("some of the code from the "),Go=k("code"),Vo=d("DefinePlugin"),Ko=d(", which could replace the usage of "),Qo=k("code"),Zo=d("CSS_FILES"),Xo=d(" throughout the code. That way, I don't have to prefix every file with "),np=k("code"),ap=d("const CSS_FILES = ..."),sp=d("."),tp=m(),ep=k("p"),op=d("DefinePlugin uses something called "),pp=k("a"),cp=k("strong"),ip=d("JavaScriptParser Hooks"),rp=d(", which you can rename a variable through "),lp=k("code"),up=d("canRename"),hp=d(" and "),kp=k("code"),fp=d("identifier"),dp=d(" hooks or replace an expression through the "),mp=k("code"),gp=d("expression"),wp=d(" hook:"),bp=m(),Ep=k("pre"),vp=m(),yp=k("p"),Ip=d("The complete code can be found in "),Sp=k("a"),Ap=d("this gist"),Tp=d("."),Cp=m(),Pp=k("p"),xp=d("An example of the compiled output:"),jp=m(),Lp=k("pre"),$p=m(),_p=k("section"),Mp=k("h2"),Op=k("a"),Fp=d("Closing Notes"),Hp=m(),qp=k("p"),Np=d("The compile output for the 3rd approach seemed to be better (more precise?) than the other, yet I am not entirely sure using a "),Dp=k("code"),Rp=d("needAdditionalPass"),Wp=d(" is the right way of going about it."),Up=m(),Bp=k("p"),Jp=d("So, "),zp=k("a"),Yp=d("let me know"),Gp=d(" if you have any thoughts or suggestions, yea?"),Vp=m(),Kp=k("section"),Qp=k("h3"),Zp=k("a"),Xp=d("[Updated Feb 27, 2020]"),nc=m(),ac=k("p"),sc=d("You can read "),tc=k("a"),ec=d("the discussions that's happening on Twitter"),oc=d(":"),pc=m(),cc=k("blockquote"),ic=k("p"),rc=d("Need some suggestions and inputs from "),lc=k("a"),uc=d("@webpack"),hc=d(" masters, I've written the problem and approaches that I've taken over here: "),kc=k("a"),fc=d("https://t.co/gLsPG9Joeq"),dc=d(", still I'm not sure I am doing it right 🙈"),mc=k("a"),gc=d("@wSokra"),wc=m(),bc=k("a"),Ec=d("@evilebottnawi"),vc=d("— Tan Li Hau (@lihautan) "),yc=k("a"),Ic=d("February 20, 2020"),this.h()},l(n){s=E(n,"SECTION",{});var a=b(s);t=E(a,"UL",{class:!0,id:!0,role:!0,"aria-label":!0});var r=b(t);e=E(r,"LI",{});var l=b(e);o=E(l,"A",{href:!0});var k=b(o);p=v(k,"The problem"),k.forEach(u),l.forEach(u),c=E(r,"LI",{});var d=b(c);i=E(d,"A",{href:!0});var m=b(i);h=v(m,"The 1st approach"),m.forEach(u),d.forEach(u),f=E(r,"UL",{});var w=b(f);g=E(w,"LI",{});var Sc=b(g);I=E(Sc,"A",{href:!0}),b(I).forEach(u),Sc.forEach(u),w.forEach(u),S=E(r,"LI",{});var Ac=b(S);A=E(Ac,"A",{href:!0});var Tc=b(A);T=v(Tc,"The 2nd approach"),Tc.forEach(u),Ac.forEach(u),C=E(r,"UL",{});var Cc=b(C);P=E(Cc,"LI",{});var Pc=b(P);x=E(Pc,"A",{href:!0}),b(x).forEach(u),Pc.forEach(u),Cc.forEach(u),j=E(r,"LI",{});var xc=b(j);L=E(xc,"A",{href:!0});var jc=b(L);$=v(jc,"The 3rd approach"),jc.forEach(u),xc.forEach(u),_=E(r,"LI",{});var Lc=b(_);M=E(Lc,"A",{href:!0});var $c=b(M);O=v($c,"Closing Notes"),$c.forEach(u),Lc.forEach(u),F=E(r,"UL",{});var _c=b(F);H=E(_c,"LI",{});var Mc=b(H);q=E(Mc,"A",{href:!0}),b(q).forEach(u),Mc.forEach(u),_c.forEach(u),r.forEach(u),a.forEach(u),N=y(n),D=E(n,"P",{});var Oc=b(D);R=v(Oc,'Recently, I was working on a server-side rendering application, and encounter a scenario that I think it requires "double compilation" with webpack.'),Oc.forEach(u),W=y(n),U=E(n,"SECTION",{});var Fc=b(U);B=E(Fc,"H2",{});var Hc=b(B);J=E(Hc,"A",{href:!0,id:!0});var qc=b(J);z=v(qc,"The problem"),qc.forEach(u),Hc.forEach(u),Y=y(Fc),G=E(Fc,"P",{});var Nc=b(G);V=v(Nc,"I am not entirely sure I am doing it in the right approach, feel free to suggest or discuss it with me. The following will be about the problem I faced and how I worked on it."),Nc.forEach(u),K=y(Fc),Q=E(Fc,"P",{});var Dc=b(Q);Z=v(Dc,"The server-side rendering application that I worked on, has an endpoint that takes in request and respond with a partial HTML content and CSS files required for styling:"),Dc.forEach(u),X=y(Fc),nn=E(Fc,"PRE",{class:!0}),b(nn).forEach(u),an=y(Fc),sn=E(Fc,"PRE",{class:!0}),b(sn).forEach(u),tn=y(Fc),en=E(Fc,"P",{});var Rc=b(en);on=v(Rc,"The application code itself uses "),pn=E(Rc,"A",{href:!0,rel:!0});var Wc=b(pn);cn=v(Wc,"Express"),Wc.forEach(u),rn=v(Rc," and "),ln=E(Rc,"A",{href:!0,rel:!0});var Uc=b(ln);un=v(Uc,"React"),Uc.forEach(u),hn=v(Rc,":"),Rc.forEach(u),kn=y(Fc),fn=E(Fc,"PRE",{class:!0}),b(fn).forEach(u),dn=y(Fc),mn=E(Fc,"P",{});var Bc=b(mn);gn=v(Bc,"Now, the problem is, how do I get the list of CSS files?"),Bc.forEach(u),wn=y(Fc),bn=E(Fc,"P",{});var Jc=b(bn);En=v(Jc,"The list of CSS files produced by the build is only available after I compile the application, but I need the information to be part of compiled code."),Jc.forEach(u),vn=y(Fc),yn=E(Fc,"P",{});var zc=b(yn);In=v(zc,"The compiled code being part of the compilation, needs to contain information of the compilation."),zc.forEach(u),Fc.forEach(u),Sn=y(n),An=E(n,"SECTION",{});var Yc=b(An);Tn=E(Yc,"H2",{});var Gc=b(Tn);Cn=E(Gc,"A",{href:!0,id:!0});var Vc=b(Cn);Pn=v(Vc,"The 1st approach"),Vc.forEach(u),Gc.forEach(u),xn=y(Yc),jn=E(Yc,"P",{});var Kc=b(jn);Ln=v(Kc,"A naive solution at first is to use "),$n=E(Kc,"A",{href:!0,rel:!0});var Qc=b($n);_n=v(Qc,"Webpack Manifest Plugin"),Qc.forEach(u),Mn=v(Kc," to get the compilation manifest, and in the code, import the manifest as json and consumes it:"),Kc.forEach(u),On=y(Yc),Fn=E(Yc,"PRE",{class:!0}),b(Fn).forEach(u),Hn=y(Yc),qn=E(Yc,"P",{});var Zc=b(qn);Nn=v(Zc,"Yet, the "),Dn=E(Zc,"CODE",{});var Xc=b(Dn);Rn=v(Xc,"./dist/webpack-manifest.json"),Xc.forEach(u),Wn=v(Zc," is not available in the first place, before compiling the code."),Zc.forEach(u),Un=y(Yc),Bn=E(Yc,"P",{});var ni=b(Bn);Jn=v(ni,"Since the "),zn=E(ni,"CODE",{});var ai=b(zn);Yn=v(ai,"./dist/webpack-manifest.json"),ai.forEach(u),Gn=v(ni," can only be available after build, maybe we can import it during runtime, using "),Vn=E(ni,"A",{href:!0,rel:!0});var si=b(Vn);Kn=E(si,"STRONG",{});var ti=b(Kn);Qn=v(ti,"non_webpack_require"),ti.forEach(u),si.forEach(u),Zn=v(ni,". The difference between "),Xn=E(ni,"CODE",{});var ei=b(Xn);na=v(ei,"require"),ei.forEach(u),aa=v(ni," and "),sa=E(ni,"CODE",{});var oi=b(sa);ta=v(oi,"__non_webpack_require__"),oi.forEach(u),ea=v(ni," is that the latter is webpack specific, which tells webpack to transform it to just pure "),oa=E(ni,"CODE",{});var pi=b(oa);pa=v(pi,"require()"),pi.forEach(u),ca=v(ni," expression, without bundling the required module:"),ni.forEach(u),ia=y(Yc),ra=E(Yc,"PRE",{class:!0}),b(ra).forEach(u),la=y(Yc),ua=E(Yc,"P",{});var ci=b(ua);ha=v(ci,"If you scrutinize the code, you may wonder whether "),ka=E(ci,"CODE",{});var ii=b(ka);fa=v(ii,"./dist/webpack-manifest.json"),ii.forEach(u),da=v(ci," is the correct relative path from the compiled code?"),ci.forEach(u),ma=y(Yc),ga=E(Yc,"P",{});var ri=b(ga);wa=v(ri,"Probably "),ba=E(ri,"CODE",{});var li=b(ba);Ea=v(li,"./webpack-manifest.json"),li.forEach(u),va=v(ri," would be more accurate, if our output folder looks like this:"),ri.forEach(u),ya=y(Yc),Ia=E(Yc,"PRE",{class:!0}),b(Ia).forEach(u),Sa=y(Yc),Aa=E(Yc,"P",{});var ui=b(Aa);Ta=v(ui,"One can safely argue that, the approach above works and let's move on the next task. But, curiosity drives me to seek deeper for a more \"elegant\" solution, where one don't need "),Ca=E(ui,"CODE",{});var hi=b(Ca);Pa=v(hi,"require('webpack-manifest.json')"),hi.forEach(u),xa=v(ui," in runtime, but that information is compiled into the code."),ui.forEach(u),Yc.forEach(u),ja=y(n),La=E(n,"SECTION",{});var ki=b(La);$a=E(ki,"H3",{});var fi=b($a);_a=E(fi,"A",{href:!0,id:!0});var di=b(_a);Ma=v(di,"[Updated Feb 27, 2020]"),di.forEach(u),fi.forEach(u),Oa=y(ki),Fa=E(ki,"P",{});var mi=b(Fa);Ha=v(mi,"Thanks to "),qa=E(mi,"A",{href:!0,rel:!0});var gi=b(qa);Na=v(gi,"@wSokra"),gi.forEach(u),Da=v(mi,"'s "),Ra=E(mi,"A",{href:!0,rel:!0});var wi=b(Ra);Wa=v(wi,"suggestion"),wi.forEach(u),Ua=v(mi,", instead of using "),Ba=E(mi,"CODE",{});var bi=b(Ba);Ja=v(bi,"__non_webpack_require__()"),bi.forEach(u),za=v(mi,", you can use a normal import and declaring the manifest file as an external:"),mi.forEach(u),Ya=y(ki),Ga=E(ki,"PRE",{class:!0}),b(Ga).forEach(u),Va=y(ki),Ka=E(ki,"PRE",{class:!0}),b(Ka).forEach(u),Qa=y(ki),Za=E(ki,"P",{});var Ei=b(Za);Xa=v(Ei,"What this output is something similar to the following:"),Ei.forEach(u),ns=y(ki),as=E(ki,"PRE",{class:!0}),b(as).forEach(u),ss=y(ki),ts=E(ki,"P",{});var vi=b(ts);es=v(vi,"The reason we are using the relative path "),os=E(vi,"CODE",{});var yi=b(os);ps=v(yi,"./webpack-manifest.json"),yi.forEach(u),cs=v(vi," is that we are assuming the output folder looks like this:"),vi.forEach(u),is=y(ki),rs=E(ki,"PRE",{class:!0}),b(rs).forEach(u),ls=y(ki),us=E(ki,"P",{});var Ii=b(us);hs=v(Ii,"You can read more about webpack externals from "),ks=E(Ii,"A",{href:!0,rel:!0});var Si=b(ks);fs=v(Si,"the webpack documentation"),Si.forEach(u),ds=v(Ii,"."),Ii.forEach(u),ki.forEach(u),ms=y(n),gs=E(n,"SECTION",{});var Ai=b(gs);ws=E(Ai,"H2",{});var Ti=b(ws);bs=E(Ti,"A",{href:!0,id:!0});var Ci=b(bs);Es=v(Ci,"The 2nd approach"),Ci.forEach(u),Ti.forEach(u),vs=y(Ai),ys=E(Ai,"P",{});var Pi=b(ys);Is=v(Pi,'So, the next "intuitive" approach is to '),Ss=E(Pi,"A",{href:!0});var xi=b(Ss);As=v(xi,"write a custom template plugin"),xi.forEach(u),Ts=v(Pi,", that adds the webpack manifest on top of the main bundle, an example of the output:"),Pi.forEach(u),Cs=y(Ai),Ps=E(Ai,"PRE",{class:!0}),b(Ps).forEach(u),xs=y(Ai),js=E(Ai,"P",{});var ji=b(js);Ls=v(ji,"In the source code, I will use the global variable "),$s=E(ji,"CODE",{});var Li=b($s);_s=v(Li,"CSS_FILES"),Li.forEach(u),Ms=v(ji,", and hopefully it will get defined by webpack, by adding "),Os=E(ji,"CODE",{});var $i=b(Os);Fs=v($i,"const CSS_FILES = ..."),$i.forEach(u),Hs=v(ji," at the very top of the file."),ji.forEach(u),qs=y(Ai),Ns=E(Ai,"P",{});var _i=b(Ns);Ds=v(_i,"And to be extra careful, I have to make sure also that there's no variable "),Rs=E(_i,"CODE",{});var Mi=b(Rs);Ws=v(Mi,"CSS_FILES"),Mi.forEach(u),Us=v(_i," declared between the global scope and the current scope the variable is being used."),_i.forEach(u),Bs=y(Ai),Js=E(Ai,"PRE",{class:!0}),b(Js).forEach(u),zs=y(Ai),Ys=E(Ai,"P",{});var Oi=b(Ys);Gs=v(Oi,"Apparently, this does not work at all. The compiled output shows:"),Oi.forEach(u),Vs=y(Ai),Ks=E(Ai,"PRE",{class:!0}),b(Ks).forEach(u),Qs=y(Ai),Zs=E(Ai,"P",{});var Fi=b(Zs);Xs=v(Fi,"After tracing through the code, I realised that I was ignorant of the sequence of execution of the "),nt=E(Fi,"A",{href:!0,rel:!0});var Hi=b(nt);at=v(Hi,"compiler hooks"),Hi.forEach(u),st=v(Fi,"."),Fi.forEach(u),tt=y(Ai),et=E(Ai,"P",{});var qi=b(et);ot=v(qi,"In the "),pt=E(qi,"A",{href:!0,rel:!0});var Ni=b(pt);ct=v(Ni,"docs for compiler hooks"),Ni.forEach(u),it=v(qi,", each hooks is executed in sequence:"),qi.forEach(u),rt=y(Ai),lt=E(Ai,"UL",{});var Di=b(lt);ut=E(Di,"LI",{});var Ri=b(ut);ht=v(Ri,"..."),Ri.forEach(u),kt=y(Di),ft=E(Di,"LI",{});var Wi=b(ft);dt=v(Wi,"run"),Wi.forEach(u),mt=y(Di),gt=E(Di,"LI",{});var Ui=b(gt);wt=v(Ui,"..."),Ui.forEach(u),bt=y(Di),Et=E(Di,"LI",{});var Bi=b(Et);vt=v(Bi,"thisCompilation"),Bi.forEach(u),yt=y(Di),It=E(Di,"LI",{});var Ji=b(It);St=v(Ji,"..."),Ji.forEach(u),At=y(Di),Tt=E(Di,"LI",{});var zi=b(Tt);Ct=v(zi,"emit"),zi.forEach(u),Pt=y(Di),xt=E(Di,"LI",{});var Yi=b(xt);jt=v(Yi,"afterEmit"),Yi.forEach(u),Lt=y(Di),$t=E(Di,"LI",{});var Gi=b($t);_t=v(Gi,"..."),Gi.forEach(u),Di.forEach(u),Mt=y(Ai),Ot=E(Ai,"P",{});var Vi=b(Ot);Ft=v(Vi,"The webpack manifest plugin executes mainly "),Ht=E(Vi,"A",{href:!0,rel:!0});var Ki=b(Ht);qt=v(Ki,"during the "),Nt=E(Ki,"CODE",{});var Qi=b(Nt);Dt=v(Qi,"emit"),Qi.forEach(u),Rt=v(Ki," phase"),Ki.forEach(u),Wt=v(Vi,", right before webpack writes all the assets into the output directory. And, we are modifying the template source in the "),Ut=E(Vi,"CODE",{});var Zi=b(Ut);Bt=v(Zi,"thisCompilation"),Zi.forEach(u),Jt=v(Vi," phase, which is way before the "),zt=E(Vi,"CODE",{});var Xi=b(zt);Yt=v(Xi,"emit"),Xi.forEach(u),Gt=v(Vi," phase. That's why "),Vt=E(Vi,"CODE",{});var nr=b(Vt);Kt=v(nr,"this.manifest"),nr.forEach(u),Qt=v(Vi," property is still undefined at the time of execution."),Vi.forEach(u),Zt=y(Ai),Xt=E(Ai,"PRE",{class:!0}),b(Xt).forEach(u),ne=y(Ai),ae=E(Ai,"P",{});var ar=b(ae);se=v(ar,"Upon reading the code fot he "),te=E(ar,"CODE",{});var sr=b(te);ee=v(sr,"webpack-manifest-plugin"),sr.forEach(u),oe=v(ar,", I realised that during the "),pe=E(ar,"CODE",{});var tr=b(pe);ce=v(tr,"emit"),tr.forEach(u),ie=v(ar," phase, I can access to the "),re=E(ar,"CODE",{});var er=b(re);le=v(er,"compilation.assets"),er.forEach(u),ue=v(ar,", and so, I could modifying the source for the assets during that time!"),ar.forEach(u),he=y(Ai),ke=E(Ai,"PRE",{class:!0}),b(ke).forEach(u),fe=y(Ai),de=E(Ai,"P",{});var or=b(de);me=v(or,"Apparently that works, but I wonder whether is it a good practice to modifying the source of an asset during the "),ge=E(or,"CODE",{});var pr=b(ge);we=v(pr,"emit"),pr.forEach(u),be=v(or," phase? 🤔"),or.forEach(u),Ee=y(Ai),ve=E(Ai,"P",{});var cr=b(ve);ye=v(cr,"And, if you noticed, I need to append the "),Ie=E(cr,"CODE",{});var ir=b(Ie);Se=v(ir,"const CSS_FILES = [...]"),ir.forEach(u),Ae=v(cr," to every file, that's because I have no idea in which file "),Te=E(cr,"CODE",{});var rr=b(Te);Ce=v(rr,"CSS_FILES"),rr.forEach(u),Pe=v(cr," is referenced. And because I declared it using "),xe=E(cr,"CODE",{});var lr=b(xe);je=v(lr,"const"),lr.forEach(u),Le=v(cr,", it only exists within the file's scope, so I have to redeclare it all the other files."),cr.forEach(u),Ai.forEach(u),$e=y(n),_e=E(n,"SECTION",{});var ur=b(_e);Me=E(ur,"H3",{});var hr=b(Me);Oe=E(hr,"A",{href:!0,id:!0});var kr=b(Oe);Fe=v(kr,"[Updated Feb 27, 2020]"),kr.forEach(u),hr.forEach(u),He=y(ur),qe=E(ur,"P",{});var fr=b(qe);Ne=v(fr,"According to "),De=E(fr,"A",{href:!0,rel:!0});var dr=b(De);Re=v(dr,"@evilebottnawi"),dr.forEach(u),We=v(fr," that this is not appropriate"),fr.forEach(u),Ue=y(ur),Be=E(ur,"BLOCKQUOTE",{class:!0});var mr=b(Be);Je=E(mr,"P",{lang:!0,dir:!0});var gr=b(Je);ze=v(gr,"A lot of plugin uses `compiler.hooks.emit` for emitting new assets, it is invalid. Ideally plugins should use `compilation.hooks.additionalAssets` for adding new assets."),gr.forEach(u),Ye=v(mr,"— evilebottnawi (@evilebottnawi) "),Ge=E(mr,"A",{href:!0});var wr=b(Ge);Ve=v(wr,"February 20, 2020"),wr.forEach(u),mr.forEach(u),ur.forEach(u),Ke=y(n),Qe=E(n,"SECTION",{});var br=b(Qe);Ze=E(br,"H2",{});var Er=b(Ze);Xe=E(Er,"A",{href:!0,id:!0});var vr=b(Xe);no=v(vr,"The 3rd approach"),vr.forEach(u),Er.forEach(u),ao=y(br),so=E(br,"P",{});var yr=b(so);to=v(yr,"I was still not convinced that this is the best I could do, so I continued looking around webpack's doc. I found a particular compilation hooks, "),eo=E(yr,"A",{href:!0,rel:!0});var Ir=b(eo);oo=E(Ir,"CODE",{});var Sr=b(oo);po=v(Sr,"needAdditionalPass"),Sr.forEach(u),Ir.forEach(u),co=v(yr,", which seems useful. It says, "),io=E(yr,"EM",{});var Ar=b(io);ro=v(Ar,'"Called to determine if an asset needs to be processed further after being emitted."'),Ar.forEach(u),lo=v(yr,"."),yr.forEach(u),uo=y(br),ho=E(br,"P",{});var Tr=b(ho);ko=v(Tr,"So, if I return "),fo=E(Tr,"CODE",{});var Cr=b(fo);mo=v(Cr,"true"),Cr.forEach(u),go=v(Tr," in the "),wo=E(Tr,"CODE",{});var Pr=b(wo);bo=v(Pr,"needAdditionalPass"),Pr.forEach(u),Eo=v(Tr,", webpack will re"),vo=E(Tr,"CODE",{});var xr=b(vo);yo=v(xr,"compile"),xr.forEach(u),Io=v(Tr," the asset again:"),Tr.forEach(u),So=y(br),Ao=E(br,"PRE",{class:!0}),b(Ao).forEach(u),To=y(br),Co=E(br,"PRE",{class:!0}),b(Co).forEach(u),Po=y(br),xo=E(br,"P",{});var jr=b(xo);jo=v(jr,"Note that using "),Lo=E(jr,"CODE",{});var Lr=b(Lo);$o=v(Lr,"needAdditionalPass"),Lr.forEach(u),_o=v(jr," will cause the build time to roughly doubled!"),jr.forEach(u),Mo=y(br),Oo=E(br,"P",{});var $r=b(Oo);Fo=v($r,"You may argue that why do we need to rerun the "),Ho=E($r,"CODE",{});var _r=b(Ho);qo=v(_r,"compilation"),_r.forEach(u),No=v($r," process again, isn't the end result can be equally achieved by modifying the assets source in the "),Do=E($r,"CODE",{});var Mr=b(Do);Ro=v(Mr,"emit"),Mr.forEach(u),Wo=v($r," phase?"),$r.forEach(u),Uo=y(br),Bo=E(br,"P",{});var Or=b(Bo);Jo=v(Or,"Well, that's because, I realised I could make use "),zo=E(Or,"A",{href:!0,rel:!0});var Fr=b(zo);Yo=v(Fr,"some of the code from the "),Go=E(Fr,"CODE",{});var Hr=b(Go);Vo=v(Hr,"DefinePlugin"),Hr.forEach(u),Fr.forEach(u),Ko=v(Or,", which could replace the usage of "),Qo=E(Or,"CODE",{});var qr=b(Qo);Zo=v(qr,"CSS_FILES"),qr.forEach(u),Xo=v(Or," throughout the code. That way, I don't have to prefix every file with "),np=E(Or,"CODE",{});var Nr=b(np);ap=v(Nr,"const CSS_FILES = ..."),Nr.forEach(u),sp=v(Or,"."),Or.forEach(u),tp=y(br),ep=E(br,"P",{});var Dr=b(ep);op=v(Dr,"DefinePlugin uses something called "),pp=E(Dr,"A",{href:!0,rel:!0});var Rr=b(pp);cp=E(Rr,"STRONG",{});var Wr=b(cp);ip=v(Wr,"JavaScriptParser Hooks"),Wr.forEach(u),Rr.forEach(u),rp=v(Dr,", which you can rename a variable through "),lp=E(Dr,"CODE",{});var Ur=b(lp);up=v(Ur,"canRename"),Ur.forEach(u),hp=v(Dr," and "),kp=E(Dr,"CODE",{});var Br=b(kp);fp=v(Br,"identifier"),Br.forEach(u),dp=v(Dr," hooks or replace an expression through the "),mp=E(Dr,"CODE",{});var Jr=b(mp);gp=v(Jr,"expression"),Jr.forEach(u),wp=v(Dr," hook:"),Dr.forEach(u),bp=y(br),Ep=E(br,"PRE",{class:!0}),b(Ep).forEach(u),vp=y(br),yp=E(br,"P",{});var zr=b(yp);Ip=v(zr,"The complete code can be found in "),Sp=E(zr,"A",{href:!0,rel:!0});var Yr=b(Sp);Ap=v(Yr,"this gist"),Yr.forEach(u),Tp=v(zr,"."),zr.forEach(u),Cp=y(br),Pp=E(br,"P",{});var Gr=b(Pp);xp=v(Gr,"An example of the compiled output:"),Gr.forEach(u),jp=y(br),Lp=E(br,"PRE",{class:!0}),b(Lp).forEach(u),br.forEach(u),$p=y(n),_p=E(n,"SECTION",{});var Vr=b(_p);Mp=E(Vr,"H2",{});var Kr=b(Mp);Op=E(Kr,"A",{href:!0,id:!0});var Qr=b(Op);Fp=v(Qr,"Closing Notes"),Qr.forEach(u),Kr.forEach(u),Hp=y(Vr),qp=E(Vr,"P",{});var Zr=b(qp);Np=v(Zr,"The compile output for the 3rd approach seemed to be better (more precise?) than the other, yet I am not entirely sure using a "),Dp=E(Zr,"CODE",{});var Xr=b(Dp);Rp=v(Xr,"needAdditionalPass"),Xr.forEach(u),Wp=v(Zr," is the right way of going about it."),Zr.forEach(u),Up=y(Vr),Bp=E(Vr,"P",{});var nl=b(Bp);Jp=v(nl,"So, "),zp=E(nl,"A",{href:!0,rel:!0});var al=b(zp);Yp=v(al,"let me know"),al.forEach(u),Gp=v(nl," if you have any thoughts or suggestions, yea?"),nl.forEach(u),Vr.forEach(u),Vp=y(n),Kp=E(n,"SECTION",{});var sl=b(Kp);Qp=E(sl,"H3",{});var tl=b(Qp);Zp=E(tl,"A",{href:!0,id:!0});var el=b(Zp);Xp=v(el,"[Updated Feb 27, 2020]"),el.forEach(u),tl.forEach(u),nc=y(sl),ac=E(sl,"P",{});var ol=b(ac);sc=v(ol,"You can read "),tc=E(ol,"A",{href:!0,rel:!0});var pl=b(tc);ec=v(pl,"the discussions that's happening on Twitter"),pl.forEach(u),oc=v(ol,":"),ol.forEach(u),pc=y(sl),cc=E(sl,"BLOCKQUOTE",{class:!0});var cl=b(cc);ic=E(cl,"P",{lang:!0,dir:!0});var il=b(ic);rc=v(il,"Need some suggestions and inputs from "),lc=E(il,"A",{href:!0});var rl=b(lc);uc=v(rl,"@webpack"),rl.forEach(u),hc=v(il," masters, I've written the problem and approaches that I've taken over here: "),kc=E(il,"A",{href:!0});var ll=b(kc);fc=v(ll,"https://t.co/gLsPG9Joeq"),ll.forEach(u),dc=v(il,", still I'm not sure I am doing it right 🙈"),mc=E(il,"A",{href:!0});var ul=b(mc);gc=v(ul,"@wSokra"),ul.forEach(u),wc=y(il),bc=E(il,"A",{href:!0});var hl=b(bc);Ec=v(hl,"@evilebottnawi"),hl.forEach(u),il.forEach(u),vc=v(cl,"— Tan Li Hau (@lihautan) "),yc=E(cl,"A",{href:!0});var kl=b(yc);Ic=v(kl,"February 20, 2020"),kl.forEach(u),cl.forEach(u),sl.forEach(u),this.h()},h(){w(o,"href","#the-problem"),w(i,"href","#the-st-approach"),w(I,"href","#"),w(A,"href","#the-nd-approach"),w(x,"href","#"),w(L,"href","#the-rd-approach"),w(M,"href","#closing-notes"),w(q,"href","#"),w(t,"class","sitemap"),w(t,"id","sitemap"),w(t,"role","navigation"),w(t,"aria-label","Table of Contents"),w(J,"href","#the-problem"),w(J,"id","the-problem"),w(nn,"class","language-json"),w(sn,"class","language-css"),w(pn,"href","https://expressjs.com/"),w(pn,"rel","nofollow"),w(ln,"href","https://reactjs.org/"),w(ln,"rel","nofollow"),w(fn,"class","language-js"),w(Cn,"href","#the-st-approach"),w(Cn,"id","the-st-approach"),w($n,"href","https://www.npmjs.com/package/webpack-manifest-plugin"),w($n,"rel","nofollow"),w(Fn,"class","language-js"),w(Vn,"href","https://webpack.js.org/api/module-variables/#__non_webpack_require__-webpack-specific"),w(Vn,"rel","nofollow"),w(ra,"class","language-js"),w(Ia,"class","language-null"),w(_a,"href","#"),w(_a,"id",""),w(qa,"href","https://twitter.com/wSokra"),w(qa,"rel","nofollow"),w(Ra,"href","https://twitter.com/wSokra/status/1230448421351444482"),w(Ra,"rel","nofollow"),w(Ga,"class","language-js"),w(Ka,"class","language-js"),w(as,"class","language-js"),w(rs,"class","language-null"),w(ks,"href","https://webpack.js.org/configuration/externals/"),w(ks,"rel","nofollow"),w(bs,"href","#the-nd-approach"),w(bs,"id","the-nd-approach"),w(Ss,"href","/webpack-plugin-main-template"),w(Ps,"class","language-js"),w(Js,"class","language-js"),w(Ks,"class","language-js"),w(nt,"href","https://webpack.js.org/api/compiler-hooks/"),w(nt,"rel","nofollow"),w(pt,"href","https://webpack.js.org/api/compiler-hooks/"),w(pt,"rel","nofollow"),w(Ht,"href","https://github.com/danethurber/webpack-manifest-plugin/blob/63d3ee2/lib/plugin.js#L255"),w(Ht,"rel","nofollow"),w(Xt,"class","language-js"),w(ke,"class","language-js"),w(Oe,"href","#"),w(Oe,"id",""),w(De,"href","https://twitter.com/evilebottnawi"),w(De,"rel","nofollow"),w(Je,"lang","en"),w(Je,"dir","ltr"),w(Ge,"href","https://twitter.com/evilebottnawi/status/1230417598677954560?ref_src=twsrc%5Etfw"),w(Be,"class","twitter-tweet"),w(Xe,"href","#the-rd-approach"),w(Xe,"id","the-rd-approach"),w(eo,"href","https://webpack.js.org/api/compilation-hooks/#needadditionalpass"),w(eo,"rel","nofollow"),w(Ao,"class","language-js"),w(Co,"class","language-js"),w(zo,"href","https://github.com/webpack/webpack/blob/d426b6c/lib/DefinePlugin.js"),w(zo,"rel","nofollow"),w(pp,"href","https://webpack.js.org/api/parser/"),w(pp,"rel","nofollow"),w(Ep,"class","language-js"),w(Sp,"href","https://gist.github.com/tanhauhau/2dc6cc376fd190e05d14901b984c7fc1"),w(Sp,"rel","nofollow"),w(Lp,"class","language-js"),w(Op,"href","#closing-notes"),w(Op,"id","closing-notes"),w(zp,"href","https://twitter.com/lihautan"),w(zp,"rel","nofollow"),w(Zp,"href","#"),w(Zp,"id",""),w(tc,"href","https://twitter.com/lihautan/status/1230301241533583360"),w(tc,"rel","nofollow"),w(lc,"href","https://twitter.com/webpack?ref_src=twsrc%5Etfw"),w(kc,"href","https://t.co/gLsPG9Joeq"),w(mc,"href","https://twitter.com/wSokra?ref_src=twsrc%5Etfw"),w(bc,"href","https://twitter.com/evilebottnawi?ref_src=twsrc%5Etfw"),w(ic,"lang","en"),w(ic,"dir","ltr"),w(yc,"href","https://twitter.com/lihautan/status/1230301241533583360?ref_src=twsrc%5Etfw"),w(cc,"class","twitter-tweet")},m(n,a){l(n,s,a),r(s,t),r(t,e),r(e,o),r(o,p),r(t,c),r(c,i),r(i,h),r(t,f),r(f,g),r(g,I),r(t,S),r(S,A),r(A,T),r(t,C),r(C,P),r(P,x),r(t,j),r(j,L),r(L,$),r(t,_),r(_,M),r(M,O),r(t,F),r(F,H),r(H,q),l(n,N,a),l(n,D,a),r(D,R),l(n,W,a),l(n,U,a),r(U,B),r(B,J),r(J,z),r(U,Y),r(U,G),r(G,V),r(U,K),r(U,Q),r(Q,Z),r(U,X),r(U,nn),nn.innerHTML='<code class="language-json"><span class="token punctuation">&#123;</span>\n  <span class="token property">"css"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"http://cdn/assets/style.xxx.css"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n  <span class="token property">"html"</span><span class="token operator">:</span> <span class="token string">"&lt;div class="container_xyz">Hello world&lt;/div>"</span>\n<span class="token punctuation">&#125;</span></code>',r(U,an),r(U,sn),sn.innerHTML='<code class="language-css"><span class="token comment">/* filename: http://cdn/assets/style.xxx.css */</span>\n<span class="token selector">.container_xyz</span> <span class="token punctuation">&#123;</span>\n  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">\'Comic Sans\'</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span></code>',r(U,tn),r(U,en),r(en,on),r(en,pn),r(pn,cn),r(en,rn),r(en,ln),r(ln,un),r(en,hn),r(U,kn),r(U,fn),fn.innerHTML='<code class="language-js"><span class="token keyword">import</span> express <span class="token keyword">from</span> <span class="token string">\'express\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">\'react\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> <span class="token punctuation">&#123;</span> renderToStaticMarkup <span class="token punctuation">&#125;</span> <span class="token keyword">from</span> <span class="token string">\'react-dom/server\'</span><span class="token punctuation">;</span>\n<span class="token keyword">import</span> styles <span class="token keyword">from</span> <span class="token string">\'./app.scss\'</span><span class="token punctuation">;</span>\n\n<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">&#123;</span>styles<span class="token punctuation">.</span>container<span class="token punctuation">&#125;</span><span class="token operator">></span>Hello world<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">;</span>\n  <span class="token keyword">const</span> htmlContent <span class="token operator">=</span> <span class="token function">renderToStaticMarkup</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\napp<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">PORT</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',r(U,dn),r(U,mn),r(mn,gn),r(U,wn),r(U,bn),r(bn,En),r(U,vn),r(U,yn),r(yn,In),l(n,Sn,a),l(n,An,a),r(An,Tn),r(Tn,Cn),r(Cn,Pn),r(An,xn),r(An,jn),r(jn,Ln),r(jn,$n),r($n,_n),r(jn,Mn),r(An,On),r(An,Fn),Fn.innerHTML='<code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> webpackManifest <span class="token keyword">from</span> <span class="token string">\'./dist/webpack-manifest.json\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> cssFiles<span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',r(An,Hn),r(An,qn),r(qn,Nn),r(qn,Dn),r(Dn,Rn),r(qn,Wn),r(An,Un),r(An,Bn),r(Bn,Jn),r(Bn,zn),r(zn,Yn),r(Bn,Gn),r(Bn,Vn),r(Vn,Kn),r(Kn,Qn),r(Bn,Zn),r(Bn,Xn),r(Xn,na),r(Bn,aa),r(Bn,sa),r(sa,ta),r(Bn,ea),r(Bn,oa),r(oa,pa),r(Bn,ca),r(An,ia),r(An,ra),ra.innerHTML='<code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">const</span> webpackManifest <span class="token operator">=</span> <span class="token function">__non_webpack_require__</span><span class="token punctuation">(</span><span class="token string">\'./dist/webpack-manifest.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> cssFiles<span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',r(An,la),r(An,ua),r(ua,ha),r(ua,ka),r(ka,fa),r(ua,da),r(An,ma),r(An,ga),r(ga,wa),r(ga,ba),r(ba,Ea),r(ga,va),r(An,ya),r(An,Ia),Ia.innerHTML='\n<code class="language-">dist\n├── webpack-manifest.json\n└── bundle.js  // &lt;-- the main output bundle</code>',r(An,Sa),r(An,Aa),r(Aa,Ta),r(Aa,Ca),r(Ca,Pa),r(Aa,xa),l(n,ja,a),l(n,La,a),r(La,$a),r($a,_a),r(_a,Ma),r(La,Oa),r(La,Fa),r(Fa,Ha),r(Fa,qa),r(qa,Na),r(Fa,Da),r(Fa,Ra),r(Ra,Wa),r(Fa,Ua),r(Fa,Ba),r(Ba,Ja),r(Fa,za),r(La,Ya),r(La,Ga),Ga.innerHTML='<code class="language-js"><span class="token comment">// ...</span>\n<span class="token keyword">import</span> webpackManifest <span class="token keyword">from</span> <span class="token string">\'webpack-manifest\'</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',r(La,Va),r(La,Ka),Ka.innerHTML='<code class="language-js"><span class="token comment">// filename: webpack.config.js</span>\nmodule<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">&#123;</span>\n  externals<span class="token punctuation">:</span> <span class="token punctuation">&#123;</span>\n    <span class="token string">\'webpack-manifest\'</span><span class="token punctuation">:</span> <span class="token string">"commonjs2 ./webpack-manifest.json"</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',r(La,Qa),r(La,Za),r(Za,Xa),r(La,ns),r(La,as),as.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token keyword">const</span> webpackManifest <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'./webpack-manifest.json\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">const</span> cssFiles <span class="token operator">=</span> <span class="token function">filterCssFiles</span><span class="token punctuation">(</span>webpackManifest<span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment">// ...</span></code>',r(La,ss),r(La,ts),r(ts,es),r(ts,os),r(os,ps),r(ts,cs),r(La,is),r(La,rs),rs.innerHTML='\n<code class="language-">dist\n├── bundle.js  // &lt;-- the main output bundle\n└── webpack-manifest.json // &lt;-- relative to bundle.js</code>',r(La,ls),r(La,us),r(us,hs),r(us,ks),r(ks,fs),r(us,ds),l(n,ms,a),l(n,gs,a),r(gs,ws),r(ws,bs),r(bs,Es),r(gs,vs),r(gs,ys),r(ys,Is),r(ys,Ss),r(Ss,As),r(ys,Ts),r(gs,Cs),r(gs,Ps),Ps.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token comment">// added by template plugin</span>\n<span class="token keyword">const</span> <span class="token constant">CSS_FILES</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">\'http://cdn/assets/style.xxx.css\'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>\n<span class="token comment">// END added by template plugin</span>\n<span class="token comment">// ...the main bundle</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    css<span class="token punctuation">:</span> <span class="token constant">CSS_FILES</span><span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',r(gs,xs),r(gs,js),r(js,Ls),r(js,$s),r($s,_s),r(js,Ms),r(js,Os),r(Os,Fs),r(js,Hs),r(gs,qs),r(gs,Ns),r(Ns,Ds),r(Ns,Rs),r(Rs,Ws),r(Ns,Us),r(gs,Bs),r(gs,Js),Js.innerHTML='<code class="language-js"><span class="token keyword">const</span> ManifestPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack-manifest-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">new</span> <span class="token class-name">ManifestPlugin</span><span class="token punctuation">(</span>manifestOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// get manifest from &#96;webpack-manifest-plugin&#96;</span>\n    ManifestPlugin<span class="token punctuation">.</span><span class="token function">getCompilerHooks</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">.</span>afterEmit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>\n      <span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span>\n      <span class="token parameter">manifest</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n    <span class="token comment">// see https://lihautan.com/webpack-plugin-main-template</span>\n    <span class="token comment">// on writing template plugin</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n      <span class="token comment">// ...</span>\n      hooks<span class="token punctuation">.</span>render<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> chunk<span class="token punctuation">,</span> chunkGraph <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token comment">// ...</span>\n        <span class="token comment">// highlight-start</span>\n        <span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">const CSS_FILES = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ConcatSource</span><span class="token punctuation">(</span>prefix<span class="token punctuation">,</span> source<span class="token punctuation">)</span><span class="token punctuation">;</span>\n        <span class="token comment">// highlight-end</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',r(gs,zs),r(gs,Ys),r(Ys,Gs),r(gs,Vs),r(gs,Ks),Ks.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token keyword">const</span> <span class="token constant">CSS_FILES</span> <span class="token operator">=</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>\n<span class="token comment">// ...continue with bundle.js</span></code>',r(gs,Qs),r(gs,Zs),r(Zs,Xs),r(Zs,nt),r(nt,at),r(Zs,st),r(gs,tt),r(gs,et),r(et,ot),r(et,pt),r(pt,ct),r(et,it),r(gs,rt),r(gs,lt),r(lt,ut),r(ut,ht),r(lt,kt),r(lt,ft),r(ft,dt),r(lt,mt),r(lt,gt),r(gt,wt),r(lt,bt),r(lt,Et),r(Et,vt),r(lt,yt),r(lt,It),r(It,St),r(lt,At),r(lt,Tt),r(Tt,Ct),r(lt,Pt),r(lt,xt),r(xt,jt),r(lt,Lt),r(lt,$t),r($t,_t),r(gs,Mt),r(gs,Ot),r(Ot,Ft),r(Ot,Ht),r(Ht,qt),r(Ht,Nt),r(Nt,Dt),r(Ht,Rt),r(Ot,Wt),r(Ot,Ut),r(Ut,Bt),r(Ot,Jt),r(Ot,zt),r(zt,Yt),r(Ot,Gt),r(Ot,Vt),r(Vt,Kt),r(Ot,Qt),r(gs,Zt),r(gs,Xt),Xt.innerHTML='<code class="language-js"><span class="token operator">-</span> <span class="token function">thisCompliation</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token punctuation">)</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">)</span> <span class="token comment">// too late!</span></code>',r(gs,ne),r(gs,ae),r(ae,se),r(ae,te),r(te,ee),r(ae,oe),r(ae,pe),r(pe,ce),r(ae,ie),r(ae,re),r(re,le),r(ae,ue),r(gs,he),r(gs,ke),ke.innerHTML='<code class="language-js"><span class="token keyword">const</span> ManifestPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">\'webpack-manifest-plugin\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    <span class="token keyword">new</span> <span class="token class-name">ManifestPlugin</span><span class="token punctuation">(</span>manifestOptions<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token comment">// get manifest from &#96;webpack-manifest-plugin&#96;</span>\n    ManifestPlugin<span class="token punctuation">.</span><span class="token function">getCompilerHooks</span><span class="token punctuation">(</span>compiler<span class="token punctuation">)</span><span class="token punctuation">.</span>afterEmit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>\n      <span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span>\n      <span class="token parameter">manifest</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>emit<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n      <span class="token keyword">const</span> prefix <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">&#96;</span><span class="token string">const CSS_FILES = </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$&#123;</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest<span class="token punctuation">)</span><span class="token interpolation-punctuation punctuation">&#125;</span></span><span class="token string">;</span><span class="token template-punctuation string">&#96;</span></span><span class="token punctuation">;</span>\n\n      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> file <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>compilation<span class="token punctuation">.</span>assets<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>file<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">\'.js\'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">continue</span><span class="token punctuation">;</span>\n        compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ConcatSource</span><span class="token punctuation">(</span>\n          prefix<span class="token punctuation">,</span>\n          compilation<span class="token punctuation">.</span>assets<span class="token punctuation">[</span>file<span class="token punctuation">]</span>\n        <span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',r(gs,fe),r(gs,de),r(de,me),r(de,ge),r(ge,we),r(de,be),r(gs,Ee),r(gs,ve),r(ve,ye),r(ve,Ie),r(Ie,Se),r(ve,Ae),r(ve,Te),r(Te,Ce),r(ve,Pe),r(ve,xe),r(xe,je),r(ve,Le),l(n,$e,a),l(n,_e,a),r(_e,Me),r(Me,Oe),r(Oe,Fe),r(_e,He),r(_e,qe),r(qe,Ne),r(qe,De),r(De,Re),r(qe,We),r(_e,Ue),r(_e,Be),r(Be,Je),r(Je,ze),r(Be,Ye),r(Be,Ge),r(Ge,Ve),l(n,Ke,a),l(n,Qe,a),r(Qe,Ze),r(Ze,Xe),r(Xe,no),r(Qe,ao),r(Qe,so),r(so,to),r(so,eo),r(eo,oo),r(oo,po),r(so,co),r(so,io),r(io,ro),r(so,lo),r(Qe,uo),r(Qe,ho),r(ho,ko),r(ho,fo),r(fo,mo),r(ho,go),r(ho,wo),r(wo,bo),r(ho,Eo),r(ho,vo),r(vo,yo),r(ho,Io),r(Qe,So),r(Qe,Ao),Ao.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">compilation</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n      compilation<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>needAdditionalPass<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>\n        <span class="token comment">// if it is always true, will lead to infinite loop!</span>\n      <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',r(Qe,To),r(Qe,Co),Co.innerHTML='<code class="language-js"><span class="token operator">-</span> <span class="token function">thisCompliation</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">==</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span><span class="token punctuation">)</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">)</span> <span class="token comment">// too late!</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">needAddtionalPass</span> <span class="token punctuation">(</span><span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token comment">// to start the compilation again</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span>\n<span class="token operator">-</span> <span class="token function">thisCompilation</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">==</span> manifest<span class="token punctuation">)</span> <span class="token comment">// now &#96;this.manifest&#96; is available</span>\n<span class="token operator">-</span> <span class="token comment">// ... will continue run through every stages again</span>\n<span class="token operator">-</span> <span class="token function">emit</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest <span class="token operator">=</span> manifest<span class="token punctuation">)</span>\n<span class="token operator">-</span> <span class="token comment">// ...</span></code>',r(Qe,Po),r(Qe,xo),r(xo,jo),r(xo,Lo),r(Lo,$o),r(xo,_o),r(Qe,Mo),r(Qe,Oo),r(Oo,Fo),r(Oo,Ho),r(Ho,qo),r(Oo,No),r(Oo,Do),r(Do,Ro),r(Oo,Wo),r(Qe,Uo),r(Qe,Bo),r(Bo,Jo),r(Bo,zo),r(zo,Yo),r(zo,Go),r(Go,Vo),r(Bo,Ko),r(Bo,Qo),r(Qo,Zo),r(Bo,Xo),r(Bo,np),r(np,ap),r(Bo,sp),r(Qe,tp),r(Qe,ep),r(ep,op),r(ep,pp),r(pp,cp),r(cp,ip),r(ep,rp),r(ep,lp),r(lp,up),r(ep,hp),r(ep,kp),r(kp,fp),r(ep,dp),r(ep,mp),r(mp,gp),r(ep,wp),r(Qe,bp),r(Qe,Ep),Ep.innerHTML='<code class="language-js"><span class="token keyword">class</span> <span class="token class-name">MyWebpackPlugin</span> <span class="token punctuation">&#123;</span>\n  <span class="token function">apply</span><span class="token punctuation">(</span><span class="token parameter">compiler</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>\n    compiler<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>thisCompilation<span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span>\n      <span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span>\n      <span class="token punctuation">(</span><span class="token parameter">compilation<span class="token punctuation">,</span> <span class="token punctuation">&#123;</span> normalModuleFactory <span class="token punctuation">&#125;</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n        normalModuleFactory<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>parser\n          <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">\'javascript/auto\'</span><span class="token punctuation">)</span>\n          <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">parser</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n            <span class="token comment">// highlight-start</span>\n            parser<span class="token punctuation">.</span>hooks<span class="token punctuation">.</span>expression\n              <span class="token punctuation">.</span><span class="token function">for</span><span class="token punctuation">(</span><span class="token string">\'CSS_FILES\'</span><span class="token punctuation">)</span>\n              <span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token string">\'MyWebpackPlugin\'</span><span class="token punctuation">,</span> <span class="token parameter">expr</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n                <span class="token keyword">return</span> ParserHelpers<span class="token punctuation">.</span><span class="token function">toConstantDependency</span><span class="token punctuation">(</span>\n                  parser<span class="token punctuation">,</span>\n                  <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>manifest<span class="token punctuation">)</span>\n                <span class="token punctuation">)</span><span class="token punctuation">(</span>expr<span class="token punctuation">)</span><span class="token punctuation">;</span>\n              <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n            <span class="token comment">// highlight-end</span>\n          <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n      <span class="token punctuation">&#125;</span>\n    <span class="token punctuation">)</span><span class="token punctuation">;</span>\n  <span class="token punctuation">&#125;</span>\n<span class="token punctuation">&#125;</span></code>',r(Qe,vp),r(Qe,yp),r(yp,Ip),r(yp,Sp),r(Sp,Ap),r(yp,Tp),r(Qe,Cp),r(Qe,Pp),r(Pp,xp),r(Qe,jp),r(Qe,Lp),Lp.innerHTML='<code class="language-js"><span class="token comment">// filename: bundle.js</span>\n<span class="token comment">// ...</span>\napp<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">\'/\'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>\n  <span class="token comment">// ...</span>\n  res<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>\n    <span class="token comment">// replaced via parser hooks</span>\n    <span class="token comment">// highlight-next-line</span>\n    css<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'http://cdn/assets/style.xxx.css\'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>\n    html<span class="token punctuation">:</span> htmlContent<span class="token punctuation">,</span>\n  <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code>',l(n,$p,a),l(n,_p,a),r(_p,Mp),r(Mp,Op),r(Op,Fp),r(_p,Hp),r(_p,qp),r(qp,Np),r(qp,Dp),r(Dp,Rp),r(qp,Wp),r(_p,Up),r(_p,Bp),r(Bp,Jp),r(Bp,zp),r(zp,Yp),r(Bp,Gp),l(n,Vp,a),l(n,Kp,a),r(Kp,Qp),r(Qp,Zp),r(Zp,Xp),r(Kp,nc),r(Kp,ac),r(ac,sc),r(ac,tc),r(tc,ec),r(ac,oc),r(Kp,pc),r(Kp,cc),r(cc,ic),r(ic,rc),r(ic,lc),r(lc,uc),r(ic,hc),r(ic,kc),r(kc,fc),r(ic,dc),r(ic,mc),r(mc,gc),r(ic,wc),r(ic,bc),r(bc,Ec),r(cc,vc),r(cc,yc),r(yc,Ic)},p:n,d(n){n&&u(s),n&&u(N),n&&u(D),n&&u(W),n&&u(U),n&&u(Sn),n&&u(An),n&&u(ja),n&&u(La),n&&u(ms),n&&u(gs),n&&u($e),n&&u(_e),n&&u(Ke),n&&u(Qe),n&&u($p),n&&u(_p),n&&u(Vp),n&&u(Kp)}}}function hn(n){let s,t;const e=[kn];let o={$$slots:{default:[un]},$$scope:{ctx:n}};for(let n=0;n<e.length;n+=1)o=a(o,e[n]);return s=new ln({props:o}),{c(){U(s.$$.fragment)},l(n){B(s.$$.fragment,n)},m(n,a){J(s,n,a),t=!0},p(n,[a]){const t=0&a?function(n,a){const s={},t={},e={$$scope:1};let o=n.length;for(;o--;){const p=n[o],c=a[o];if(c){for(const n in p)n in c||(t[n]=1);for(const n in c)e[n]||(s[n]=c[n],e[n]=1);n[o]=c}else for(const n in p)e[n]=1}for(const n in t)n in s||(s[n]=void 0);return s}(e,[(o=kn,"object"==typeof o&&null!==o?o:{})]):{};var o;1&a&&(t.$$scope={dirty:a,ctx:n}),s.$set(t)},i(n){t||(R(s.$$.fragment,n),t=!0)},o(n){W(s.$$.fragment,n),t=!1},d(n){z(s,n)}}}const kn={title:"Webpack Additional Compilation Pass",date:"2020-02-20T08:00:00Z",lastUpdated:"2020-02-27T08:00:00Z",slug:"webpack-additional-compilation-pass",type:"blog"};class fn extends V{constructor(n){super(),G(this,n,null,hn,p,{})}}setTimeout(()=>{new fn({target:document.querySelector("#app"),hydrate:!0})},3e3);
