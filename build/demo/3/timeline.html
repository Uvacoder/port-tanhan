<!DOCTYPE html><html><head><meta http-equiv="Content-Type" content="text/html;charset=utf-8"/><link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"><style type="text/css">.graph{
        height: 100%;
    }
	/*normal path*/
	.foreground path, .time{
		opacity: 1;
	}
	.foreground path {
	  fill: none;
	  stroke-width: 1.2px;
	  shape-rendering: crispEdges;
	}
	.foreground path.thick{
		stroke-width: 2.5px;
	}
	/*path when hovered*/
	.foreground path.thick.hovered{
		stroke-width: 2.8px;
	}
	.foreground path.hovered{
		stroke-width: 2px;
	}
	.graph.hovered .foreground path:not(.hovered){
		opacity: 0.005;
	}
	/* path type label */
	.foreground path.type1{
		stroke: #f00;
	}
	.foreground path.type2{
		stroke: #000;
	}
	.foreground path.type3{
		stroke: #00f;
	}
	.foreground path.type4{
		/* 	fin or fin ack */
		stroke: #090;
	}
	.foreground path.type0{
		stroke: #f0f;
	}
	.foreground path.type5,
	.foreground path.type6,
	.foreground path.type7,
	.foreground path.type8,
	.foreground path.type9{
		stroke-dasharray: 3,3;
		stroke: black;
	}

	#legendcontainer{
		position: fixed;
		bottom: 10px;
		left: 10px;
		background-color: #fff;
		color: #fff;
		-webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
		cursor: default;
	}
	#legendcontainer td{
		padding: 3px 6px;
		border-radius: 5px;
	}
	#legendcontainer .type1{
		background-color: #f00;
	}
	#legendcontainer .type2{
		background-color: #000;
	}
	#legendcontainer .type3{
		background-color: #00f;
	}
	#legendcontainer .type4{
		/* 	fin or fin ack */
		background-color: #090;
	}
	#legendcontainer .type0{
		background-color: #f0f;
	}
	#legendcontainer:hover td:not(:hover){
		opacity: 0.3;
	}
	/*axis*/
	.axis{
		stroke: rgba(0,0,0,0.4);
		stroke-width: 1.5px;
	}
	body{
		font-family: sans-serif;
	}
	.text{
		font-size: 10px;
	}
	.title{
		text-anchor: middle;
		font-weight: bold;
	}
	.title text.hovered{
		font-size: 12px;
	}
	.time text{
		opacity: 0;
	}
	.time text.hovered{
		opacity: 1;
	}
	.time, .title{
		-webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;
		cursor:default;
	}
	/* info */
	#info{
		position: fixed;
		opacity: 1;
		transition: opacity 0.5s;
		background-color: rgba(255,255,255,0.8);
		padding: 5px;
		border: 1px solid rgba(0,0,0,0.5);
		border-radius: 4px;
		font-size: 12px;
	}
	#info.hide{
		opacity: 0;
	}
	#info table td:first-child{
		padding-right: 5px;
	}
	/*graph*/
/*
	div.graph{
		padding: 5px;
		border: 1px solid rgba(0,0,0,0.8);
		border-radius:3px;
	}
 */
	#rstcontainer{
		position: fixed;
		top: 10px;
		left: 10px;
	}
	#rstcontainer btn,
	#rstcontainer btn:focus,
	#rstcontainer btn:active{
		/* not able to highlight text */
		-webkit-touch-callout: none;
		-webkit-user-select: none;
		-khtml-user-select: none;
		-moz-user-select: none;
		-ms-user-select: none;
		user-select: none;

		background-image: none;
		cursor: pointer;
		display: inline-block;
		padding: 6px 10px;
		border-radius: 4px;
		vertical-align: middle;
		text-align: center;

		color: #adadad;
		border: 0px;
		outline: 0px;
		font-size: 14px;
		transition: 0.5s;
	}
	#rstcontainer btn:hover{
		color: #333;
		text-decoration: none;
	}
	#rstcontainer btn:focus{
		color: #adadad;
	}
	#rstcontainer.hide,
	#loadingcontainer.hide{
		display: none;
	}
	#loadingcontainer{
		position: absolute;
		text-align: center;
		top: 0px;
		font-size: 36px;
		color: #555;
		width: 100%;
	}
	#savingcontainer{
		position: absolute;
		top: 0px;
		font-size: 16px;
	}</style></head><body><div class="graph"></div><div id="info" class="hide text"><table><tr><td>Source</td><td id="src-td"></td></tr><tr><td>Destination</td><td id="dst-td"></td></tr><tr><td>SourcePort</td><td id="srcport-td"></td></tr><tr><td>DestinationPort</td><td id="dstport-td"></td></tr><tr><td>Size</td><td id="size-td"></td></tr></table></div><div id="rstcontainer" class="hide"><btn>Reset</btn></div><div id="legendcontainer"><table><tr><td class="type1">Sync</td></tr><tr><td class="type2">Sync-Ack</td></tr><tr><td class="type3">Ack</td></tr><tr><td class="type4">Fin/Fin-Ack</td></tr><tr><td class="type0">Rst/Rst-Ack</td></tr></table></div><div id="loadingcontainer"><i class="fa fa-spinner"></i> Processing Data...</div><div id="savingcontainer"></div><script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/d3/3.4.9/d3.js"></script><script src="http://code.jquery.com/jquery-1.10.1.min.js"></script><script type="text/javascript">$(function(){$("body").height($(window).height());var h,v,g,f,m=["199.16.201.237","98.43.169.211"],x=$(".graph").width(),P=450,S=d3.time.format("%X.%L"),t=d3.behavior.zoom().scaleExtent([.01,20]).on("zoom",function(){A.attr("transform","translate("+d3.event.translate+")scale("+d3.event.scale+")"),$("#rstcontainer").removeClass("hide")}),A=d3.select(".graph").append("svg:svg").attr("width","100%").attr("height","100%").append("svg:g").call(t).append("g");A.append("rect").attr("x",50*-x).attr("y",-900).attr("width",100*x).attr("height",4*P).attr("fill","white").attr("opacity",0);function e(e){return function(t){return t.index==e}}function D(t){h.filter(e(t.index)).classed("hovered",!0),v.filter(e(t.index)).classed("hovered",!0),g.filter(e(t.index)).classed("hovered",!0),f.filter(e(t.index)).classed("hovered",!0),$(".graph").addClass("hovered"),function(t){var e=$("#info");e.removeClass("hide"),e.css("left",d3.event.pageX+10+"px");var r=$(window).height(),a=e.height(),n=$(document).scrollTop(),s=d3.event.pageY;r<s-n+a?e.css("top",s-n-a-10+"px"):e.css("top",s-n+10+"px"),$("#src-td").html(t.SourceIP),$("#srcport-td").html(t.SourcePort),$("#dst-td").html(t.DestIP),$("#dstport-td").html(t.DestPort),$("#size-td").html(t.Size)}(t)}function w(){var t=$("#info");t.addClass("hide"),t.css("top","999px"),t.css("left","999px"),h.classed("hovered",!1),v.classed("hovered",!1),g.classed("hovered",!1),f.classed("hovered",!1),$(".graph").removeClass("hovered")}function y(t,e){var r;r=e?$(".foreground path.src.sport"+t+", .foreground path.dst.dport"+t):$(".foreground path.src.dport"+t+", .foreground path.dst.sport"+t),d3.selectAll(r).classed("hovered",!0),$(".graph").addClass("hovered")}d3.csv("data.csv",function(t){var r=d3.time.format("%x %X.%L"),a=d3.set(),n=d3.set();t.forEach(function(t,e){t.time=r.parse("03/31/2001 "+t.time.substring(0,t.time.length-3)).getTime(),t.index=e,t.SourcePort=+t.SourcePort,t.DestPort=+t.DestPort,t.SourceIP==m[0]?(t.dir="src",a.add(t.SourcePort),n.add(t.DestPort)):(t.dir="dst",a.add(t.DestPort),n.add(t.SourcePort))});var e=20,s=80,o=200,d=[x/2-100,x/2+100],i=d3.scale.ordinal().domain(m).rangePoints(d),c=d3.scale.linear().domain([d3.min(t,function(t){return t.time}),d3.max(t,function(t){return t.time})+s]).range([e,430]),l=d3.scale.ordinal().domain(a.values()).rangePoints([x/2-o,x/2-o-a.size()*o/2]),u=d3.scale.ordinal().domain(n.values()).rangePoints([x/2+o,x/2+o+n.size()*o/2]);A.append("svg:defs").append("svg:marker").attr("id","arrow").attr("viewBox","0 0 10 10").attr("refX",9).attr("refY",5).attr("markerWidth",7.5).attr("markerHeight",7.5).attr("orient","auto").attr("markerUnits","userSpaceOnUse").append("svg:path").attr("d","M0 0 L 10 5 L 0 10 z").attr("fill","context-stroke");var p=d3.svg.line();h=A.append("svg:g").attr("class","foreground").attr("marker-end","url(#arrow)").selectAll("path").data(t).enter().append("svg:path").attr("d",function(t){return p([[i(t.SourceIP),c(t.time)],[i(t.DestIP),c(t.time+s)]])}).attr("class",function(t){return"type"+t.Type+" "+t.dir+" sport"+t.SourcePort+" dport"+t.DestPort}).classed("thick",function(t){return 0<+t.Size}).on("mouseover",D).on("mouseout",w);A.append("svg:g").attr("class","axis").selectAll("path").data(d).enter().append("svg:path").attr("d",function(t){return p([[t,10],[t,P]])}),A.append("svg:g").attr("class","title text").selectAll("text").data(m).enter().append("svg:text").attr("x",function(t){return i(t)}).attr("y",function(){return 8}).text(function(t){return t}).on("mouseover",function(t,e){d3.selectAll($("svg ."+["src","dst"][e])).classed("hovered",!0),$(".graph").addClass("hovered"),d3.select(this).classed("hovered",!0)}).on("mouseout",function(){w(),d3.select(this).classed("hovered",!1)});v=A.append("svg:g").attr("class","time text").selectAll("text").data(t).enter().append("svg:text").attr("x",function(t){var e;return(e="src"==t.dir?l(t.SourcePort):u(t.SourcePort))<x/2?e-2:e+2}).attr("y",function(t){return c(t.time)-1}).text(function(t){return S(new Date(t.time))}).attr("text-anchor",function(t){return i(t.SourceIP)<x/2?"end":"start"}).attr("class",function(t){return t.dir}).on("mouseover",D).on("mouseout",w),sportAxis=A.append("svg:g").attr("class","axis sport-axis").selectAll("path").data(a.values()).enter().append("svg:path").attr("d",function(t){return p([[l(t),10],[l(t),P]])}).attr("class",function(t){return"sport"+t}),dportAxis=A.append("svg:g").attr("class","axis dport-axis").selectAll("path").data(n.values()).enter().append("svg:path").attr("d",function(t){return p([[u(t),10],[u(t),P]])}).attr("class",function(t){return"dport"+t}),dportTitle=A.append("svg:g").attr("class","text title dport-title").selectAll("text").data(n.values()).enter().append("svg:text").text(function(t){return"Port "+t.toString()}).attr("x",function(t){return u(t)}).attr("y",function(){return 8}).on("mouseover",function(t){y(t,!1)}).on("mouseout",w),sportTitle=A.append("svg:g").attr("class","text title sport-title").selectAll("text").data(a.values()).enter().append("svg:text").text(function(t){return"Port "+t.toString()}).attr("x",function(t){return l(t)}).attr("y",function(){return 8}).on("mouseover",function(t){y(t,!0)}).on("mouseout",w),g=A.append("svg:g").attr("class","sportline foreground").selectAll("path").data(t).enter().append("svg:path").attr("d",function(t){return"src"==t.dir?p([[l(t.SourcePort),c(t.time)],[i(t.SourceIP),c(t.time)]]):p([[i(t.DestIP),c(t.time+s)],[l(t.DestPort),c(t.time+s)]])}).attr("class",function(t){return"type"+t.Type+" "+t.dir+" sport"+t.SourcePort+" dport"+t.DestPort}).classed("thick",function(t){return 0<+t.Size}).attr("marker-end",function(t){return"dst"==t.dir?"url(#arrow)":null}).on("mouseover",D).on("mouseout",w),f=A.append("svg:g").attr("class","dportline foreground").selectAll("path").data(t).enter().append("svg:path").attr("d",function(t){return"src"==t.dir?p([[i(t.DestIP),c(t.time+s)],[u(t.DestPort),c(t.time+s)]]):p([[u(t.SourcePort),c(t.time)],[i(t.SourceIP),c(t.time)]])}).attr("class",function(t){return"type"+t.Type+" "+t.dir+" sport"+t.SourcePort+" dport"+t.DestPort}).classed("thick",function(t){return 0<+t.Size}).attr("marker-end",function(t){return"src"==t.dir?"url(#arrow)":null}).on("mouseover",D).on("mouseout",w),$("#legendcontainer td").hover(function(t){d3.selectAll($(".graph .foreground path."+$(this).attr("class"))).classed("hovered",!0),$(".graph").addClass("hovered",!0)},w),$("#loadingcontainer").addClass("hide")});$("#rstcontainer btn").click(function(){A.transition().duration(500).attr("transform","translate(0,0)scale(1)"),t.translate([0,0]).scale(1),$("#rstcontainer").addClass("hide")})})</script></body></html>