import{S as $i,i as Hi,s as Ni,C as mr,w as ri,x as li,y as ii,z as Vi,A as ti,q as ci,o as pi,B as hi,r as Bi,R as oi,k as l,e as a,t,m as i,c as n,a as r,h as o,d as s,b as c,Q as Gi,g as _,F as e,O as Fi}from"../../chunks/vendor-ea160616.js";import{B as Wi}from"../../chunks/BlogLayout-1be3dc1e.js";import{T as Ui}from"../../chunks/TableOfContent-c4f5cb6e.js";import"../../chunks/stores-7d7fda0c.js";import"../../chunks/WebMentions-d768a574.js";/* empty css                                */var zi="/_app/assets/github-blame-3d247017.webp",ai="/_app/assets/github-blame-9514ce69.png",Qi="/_app/assets/hero-twitter-c4dc1746.jpg";function Ji(de){let w,A,O,N,x,E,ke,lt,V,di=`<pre class="prism language-"><code><span class="line">ERROR in bundle.xxxx.js from Terser</span>
<span class="line">undefined</span>
<span class="line"></span>
<span class="line">...</span>
<span class="line"></span>
<span class="line">Command failed with exit code 2</span>
<span class="line">Visit https://yarnpkg.com/en/docs/cli/run for documentation about this command.</span>
<span class="line">Error: Command failed: yarn build</span></code></pre>`,it,ue,Ot,ct,ve,us,Ct,pt,v,vs,B,Pt,At,R,jt,ye,Dt,St,fe,qt,Rt,Lt,me,ki=`<div class="filename">webpackConfig.prod.js</div><pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-constant)">module</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">exports</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  plugins</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> [</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// ...</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// disable terser first</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// new TerserPlugin(&#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// 	terserOptions: &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">//     // ...</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">//   &#125;,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// &#125;),</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  ]</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;;</span></span></code></pre>`,Mt,ys,$t,Ht,fs,Nt,Vt,we,ui=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">terser</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">require</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;terser&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">fs</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">require</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;fs&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">path</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">require</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;path&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">input</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">fs</span><span style="color: var(--shiki-token-function)">.readFileSync</span><span style="color: var(--shiki-color-text)">(</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">path</span><span style="color: var(--shiki-token-function)">.join</span><span style="color: var(--shiki-color-text)">(__dirname</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;dist/bundle.xxxx.js&#39;</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;utf-8&#39;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">output</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">terser</span><span style="color: var(--shiki-token-function)">.minify</span><span style="color: var(--shiki-color-text)">(input</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// ...terser options</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(output);</span></span></code></pre>`,Bt,ms,Gt,Ft,ge,vi=`<pre class="prism language-"><code><span class="line">&#123;</span>
<span class="line">  &quot;error&quot;:</span>
<span class="line">  TypeError: Cannot read property &#39;name&#39; of undefined</span>
<span class="line">      at A.f (node_modules/terser/dist/bundle.js:44:146028)</span>
<span class="line">      at D (node_modules/terser/dist/bundle.js:44:2863)</span>
<span class="line">      at A (node_modules/terser/dist/bundle.js:44:146075)</span>
<span class="line">      at k (node_modules/terser/dist/bundle.js:44:146998)</span>
<span class="line">      at vn (node_modules/terser/dist/bundle.js:44:133003)</span>
<span class="line">      at node_modules/terser/dist/bundle.js:44:165250</span>
<span class="line">      at AST_BlockStatement.optimize (node_modules/terser/dist/bundle.js:44:121400)</span>
<span class="line">      at Ct.before (node_modules/terser/dist/bundle.js:44:121157)</span>
<span class="line">      at AST_BlockStatement.transform (node_modules/terser/dist/bundle.js:44:78200)</span>
<span class="line">      at node_modules/terser/dist/bundle.js:44:78849</span>
<span class="line">&#125;</span></code></pre>`,Wt,xe,Ut,ws,zt,Qt,gs,Jt,Kt,_e,be,Zt,Xt,Yt,xs,eo,so,Ee,yi=`<pre class="prism language-"><code><span class="line">...</span>
<span class="line">s) &#125; else if (u instanceof Se &amp;&amp; r === u.expression &amp;&amp; (p(e, t, i, u, o = n(o, u.property), a + 1,</span>
<span class="line">  s + 1), o)) return; a &gt; 0 || u instanceof Be &amp;&amp; r !== u.tail_node() || u instanceof S ||</span>
<span class="line">(t.direct_access = !0) &#125; e(F, u); var d = new qn(function (e) &#123; if (e instanceof Je) &#123; var n =</span>
<span class="line">e.definition(); n &amp;&amp; (e instanceof hn &amp;&amp; n.references.push(e), n.fixed = !1) &#125; &#125;); function h(e, n,</span>
<span class="line">t) &#123; this.inlined = !1; var r = e.safe_ids; return e.safe_ids = Object.create(null), i(e, t, this),</span>
<span class="line">n(), e.safe_ids = r, !0 &#125; function m(e, n, t) &#123; var r, o = this; return o.inlined = !1, a(e), i(e,</span>
<span class="line">t, o), !o.name &amp;&amp; (r = e.parent()) instanceof ke &amp;&amp; r.expression === o &amp;&amp; o.argnames.forEach(</span>
<span class="line">function (n, t) &#123; if (n.definition) &#123; var i = n.definition(); void 0 !== i.fixed || o.uses_arguments</span>
<span class="line">&amp;&amp; !e.has_directive(&quot;use strict&quot;) ? i.fixed = !1 : (i.fixed = function () &#123; return r.args[t] || v(kn, r)</span>
<span class="line">...</span></code></pre>`,to,_s,oo,ao,bs,no,ht,d,Es,G,ro,lo,Is,io,co,F,po,Ie,ho,ko,uo,L,vo,Te,yo,fo,Oe,mo,wo,go,C,Ts,xo,_o,Ce,bo,Eo,Pe,Io,To,Ae,Oo,Co,Po,Os,Ao,jo,je,fi='<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Error</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#96;</span><span style="color: var(--shiki-token-keyword)">$&#123;</span><span style="color: var(--shiki-color-text)">file</span><span style="color: var(--shiki-token-keyword)">&#125;</span><span style="color: var(--shiki-token-string-expression)"> from Terser&#92;n</span><span style="color: var(--shiki-token-keyword)">$&#123;</span><span style="color: var(--shiki-token-constant)">err</span><span style="color: var(--shiki-color-text)">.message</span><span style="color: var(--shiki-token-keyword)">&#125;</span><span style="color: var(--shiki-token-string-expression)">&#96;</span><span style="color: var(--shiki-color-text)">);</span></span></code></pre>',Do,T,So,De,qo,Ro,Se,Lo,Mo,qe,$o,Ho,Re,No,Vo,Bo,W,Go,Le,Fo,Wo,Uo,Me,Cs,zo,Qo,Jo,U,z,Ko,Q,Zo,Xo,Yo,Ps,ea,sa,$e,mi=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">someFunction</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (someConditionThatLeadsToErrorLaterOn) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">try</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">throw</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Error</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125; </span><span style="color: var(--shiki-token-keyword)">catch</span><span style="color: var(--shiki-color-text)"> (error) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(error);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,ta,As,oa,aa,J,na,He,ra,la,ia,Ne,wi=`<pre class="prism language-"><code><span class="line">&#123;</span>
<span class="line">  &quot;error&quot;:</span>
<span class="line">  TypeError: Cannot read property &#39;name&#39; of undefined</span>
<span class="line">      at A.f (node_modules/terser/dist/bundle.js:44:146028)</span>
<span class="line">      at D (node_modules/terser/dist/bundle.js:44:2863)</span>
<span class="line">      at A (node_modules/terser/dist/bundle.js:44:146075)</span>
<span class="line">      at k (node_modules/terser/dist/bundle.js:44:146998)</span>
<span class="line">      at vn (node_modules/terser/dist/bundle.js:44:133003)</span>
<span class="line">      at node_modules/terser/dist/bundle.js:44:165250</span>
<span class="line">      at AST_BlockStatement.optimize (node_modules/terser/dist/bundle.js:44:121400)</span>
<span class="line">      at Ct.before (node_modules/terser/dist/bundle.js:44:121157)</span>
<span class="line">      at AST_BlockStatement.transform (node_modules/terser/dist/bundle.js:44:78200)</span>
<span class="line">      at node_modules/terser/dist/bundle.js:44:78849</span>
<span class="line">&#125;</span></code></pre>`,ca,js,pa,ha,j,Ds,da,ka,Ve,ua,va,Be,ya,fa,dt,k,Ss,K,ma,wa,qs,ga,xa,Rs,_a,ba,Ge,gi=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">var</span><span style="color: var(--shiki-color-text)"> f </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">n</span><span style="color: var(--shiki-token-function)">.option</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;ecma&quot;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">6</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">n</span><span style="color: var(--shiki-token-function)">.has_directive</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;use strict&quot;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">?</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (e) &#123; </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">e</span><span style="color: var(--shiki-color-text)">.key</span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)">u </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">e</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)">.name</span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)">u &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">                                        </span><span style="color: var(--shiki-token-keyword)">^</span></span></code></pre>`,Ea,Ls,Ia,Ta,Z,Oa,Fe,Ca,Pa,Aa,X,ja,Y,Da,Sa,qa,P,Ms,Ra,La,ee,Ma,$a,We,Ha,Na,Ue,Va,Ba,Ga,$s,Fa,Wa,se,Ua,ze,za,Qa,Ja,Qe,xi=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">var</span><span style="color: var(--shiki-color-text)"> diff </span><span style="color: var(--shiki-token-keyword)">=</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">compressor</span><span style="color: var(--shiki-token-function)">.option</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;ecma&#39;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">6</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">compressor</span><span style="color: var(--shiki-token-function)">.has_directive</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;use strict&#39;</span><span style="color: var(--shiki-color-text)">)</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">(node) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.key </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> prop </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)">.name </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> prop;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">(node) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)">.name </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> prop;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;;</span></span></code></pre>`,Ka,Hs,Za,Xa,te,Ya,Je,en,sn,tn,Ke,_i=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">var</span><span style="color: var(--shiki-color-text)"> f </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">n</span><span style="color: var(--shiki-token-function)">.option</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;ecma&quot;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">6</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">n</span><span style="color: var(--shiki-token-function)">.has_directive</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;use strict&quot;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">?</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> (e) &#123; </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">!</span><span style="color: var(--shiki-token-constant)">e</span><span style="color: var(--shiki-color-text)">.key) &#123; </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(e); &#125; </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">e</span><span style="color: var(--shiki-color-text)">.key</span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)">u</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">               </span><span style="color: var(--shiki-token-keyword)">^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">e</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)">.name</span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)">u &#125;</span></span></code></pre>`,on,b,an,Ze,nn,rn,Xe,ln,cn,Ye,pn,hn,es,dn,kn,ss,un,vn,ts,yn,fn,mn,Ns,wn,kt,h,Vs,oe,gn,xn,Bs,_n,bn,Gs,En,In,os,bi=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">var</span><span style="color: var(--shiki-color-text)"> diff </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">compressor</span><span style="color: var(--shiki-token-function)">.option</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;ecma&quot;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">&lt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2015</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">compressor</span><span style="color: var(--shiki-token-function)">.has_directive</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&quot;use strict&quot;</span><span style="color: var(--shiki-color-text)">) </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">(node) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.key </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> prop </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.key </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)">.name </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> prop);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125; </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">(node) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.key </span><span style="color: var(--shiki-token-keyword)">&amp;&amp;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">node</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)">.name </span><span style="color: var(--shiki-token-keyword)">!=</span><span style="color: var(--shiki-color-text)"> prop;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;;</span></span></code></pre>`,Tn,H,as,On,Cn,ns,Pn,An,jn,Fs,Dn,Sn,Ws,qn,Rn,Us,Ln,Mn,rs,zs,$n,Hn,Nn,Qs,ae,Js,Ks,ne,wr,Vn,Zs,Bn,Gn,Xs,Ys,re,Fn,Wn,le,Un,ie,zn,Qn,Jn,et,Kn,Zn,D,ls,Xn,Yn,is,er,sr,cs,tr,or,ar,ps,Ei=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-color-text)">&#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">&quot;resolution&quot;</span><span style="color: var(--shiki-token-punctuation)">:</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">&quot;terser&quot;</span><span style="color: var(--shiki-token-punctuation)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&quot;3.17.0&quot;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,nr,st,rr,lr,tt,ir,ut,S,ot,ce,cr,pr,at,hr,dr,nt,kr,vt;return w=new Ui({props:{data:[{link:"act-i-the-first-attempt",title:"Act I - The First Attempt"},{link:"act-ii-terser-webpack-plugin",title:"Act II - terser-webpack-plugin"},{link:"act-iii-terser",title:"Act III - Terser"},{link:"final-act-the-resolution",title:"Final Act - The Resolution"},{link:"closing-note",title:"Closing Note"}]}}),{c(){ri(w.$$.fragment),A=l(),O=a("p"),N=t("The following is a record of the steps I went through when debugging a build-time bug I encountered during work."),x=l(),E=a("p"),ke=t("It all started with an error message during the build."),lt=l(),V=a("div"),it=l(),ue=a("p"),Ot=t("What is wrong with Terser and our code?"),ct=l(),ve=a("p"),us=a("strong"),Ct=t("I must find the root cause of this!"),pt=l(),v=a("section"),vs=a("h2"),B=a("a"),Pt=t("Act I - The First Attempt"),At=l(),R=a("p"),jt=t("We used Terser to minify our build code. It was part of our webpack pipeline, installed through "),ye=a("code"),Dt=t("terser-webpack-plugin"),St=t(". Since terser is throwing an error, so I disabled "),fe=a("code"),qt=t("terser-webpack-plugin"),Rt=t(" and build again."),Lt=l(),me=a("div"),Mt=l(),ys=a("p"),$t=t("Ok. The build was successful. Nothing wrong with the code nor the build."),Ht=l(),fs=a("p"),Nt=t("So, I run the terser manually:"),Vt=l(),we=a("div"),Bt=l(),ms=a("p"),Gt=t("The console output an error that was cryptic"),Ft=l(),ge=a("div"),Wt=l(),xe=a("p"),Ut=t("I clicked into the terser source code to see what was going wrong over there. "),ws=a("em"),zt=t("(Maybe it's my chance to contribute to terser?)"),Qt=l(),gs=a("p"),Jt=t("Little did I know, how wrong I could be."),Kt=l(),_e=a("p"),be=a("code"),Zt=t("terser/dist/bundle.js"),Xt=t(" was a minified code and it wasn't meant for humans eyes \u{1F62D}"),Yt=l(),xs=a("p"),eo=t("Allow me to share a small snippet of what I saw:"),so=l(),Ee=a("div"),to=l(),_s=a("p"),oo=t("At this point in time, I had another meeting to attend, so I stopped at this juncture."),ao=l(),bs=a("p"),no=t("On my way there, I was thinking, well, maybe I should probe this later in another direction."),ht=l(),d=a("section"),Es=a("h2"),G=a("a"),ro=t("Act II - terser-webpack-plugin"),lo=l(),Is=a("p"),io=t("After the meeting, I was thinking, well let me reenable the terser plugin, and try to probe through the plugin."),co=l(),F=a("p"),po=t("Remember the error message: "),Ie=a("code"),ho=t('"ERROR in bundle.xxxx.js from Terser"'),ko=t(" ?"),uo=l(),L=a("p"),vo=t("I looked into the "),Te=a("code"),yo=t("node_modules/terser-webpack/plugin/dist/index.js"),fo=t(" and search for the word "),Oe=a("code"),mo=t('"from Terser"'),wo=t("."),go=l(),C=a("p"),Ts=a("strong"),xo=t("Tip:"),_o=t(" Usually when you want to debug a library installed in "),Ce=a("code"),bo=t("node_modules"),Eo=t(", you can first look at the "),Pe=a("code"),Io=t("package.json"),To=t(", it usually has an entry called "),Ae=a("code"),Oo=t('"main"'),Co=t(" that tells you the entry file to first look into. The main file usually exports all the public API that you use, so it is a good place to start diving into."),Po=l(),Os=a("p"),Ao=t("So I found the line:"),jo=l(),je=a("div"),Do=l(),T=a("p"),So=t("After adding logs "),De=a("code"),qo=t("console.log(err)"),Ro=t(" and run the build again, I realised the err is an empty object "),Se=a("code"),Lo=t("{}"),Mo=t(", which explained why I saw "),qe=a("code"),$o=t("undefined"),Ho=t(" after the "),Re=a("code"),No=t("ERROR in ... from Terser"),Vo=t("."),Bo=l(),W=a("p"),Go=t("So, I slowly traced back the caller, and find out where this "),Le=a("code"),Fo=t("err"),Wo=t(" object was initially created."),Uo=l(),Me=a("p"),Cs=a("strong"),zo=t("Tip:"),Qo=t(" To trace the callers of a function that leads up to a certain state of your application, you can:"),Jo=l(),U=a("ul"),z=a("li"),Ko=t("Use a "),Q=a("a"),Zo=t("conditional breakpoint"),Xo=t(" if you are debugging through a debugger"),Yo=l(),Ps=a("li"),ea=t("Throw an error within a try catch"),sa=l(),$e=a("div"),ta=l(),As=a("p"),oa=t("This is especially useful if you are tracing an unfamiliar code, you can quickly get a call stack that leads up to the current condition."),aa=l(),J=a("p"),na=t("After tracing through the call stack, I ended up at the line where the "),He=a("code"),ra=t("terser-webpack-plugin"),la=t(" calls the terser, and when I logged out the error, it shows:"),ia=l(),Ne=a("div"),ca=l(),js=a("p"),pa=t("So familiar! After an hour of tracing and debugging, I ended up at the same place."),ha=l(),j=a("p"),Ds=a("strong"),da=t("Note:"),ka=t(" the error must have lost somewhere from the terser to the actual print out of "),Ve=a("code"),ua=t("terser-webpack-plugin"),va=t(", it might have fixed in a later version of "),Be=a("code"),ya=t("terser-webpack-plugin"),fa=t(", but I'm not sure of it yet. Anyone interested can help check."),dt=l(),k=a("section"),Ss=a("h2"),K=a("a"),ma=t("Act III - Terser"),wa=l(),qs=a("p"),ga=t("The circumstances left me with no choice. I needed to face the cryptic minified code."),xa=l(),Rs=a("p"),_a=t("Luckily VSCode still able to open the huge minified file, and able to set the cursor to the right line and column:"),ba=l(),Ge=a("div"),Ea=l(),Ls=a("p"),Ia=t("(By the way, in the minified code, all the code is in one line. \u{1F926}\u200D\u2642\uFE0F)"),Ta=l(),Z=a("p"),Oa=t("Well, this may seem like the right place to throw the "),Fe=a("code"),Ca=t(`"Cannot read property 'name' of undefined"`),Pa=t(" error."),Aa=l(),X=a("p"),ja=t("To understand what is going on in this line, I cloned "),Y=a("a"),Da=t("terser"),Sa=t(", checked out to the version tag that was installed in our codebase, and tried to figure out where that line was in the original code."),qa=l(),P=a("p"),Ms=a("strong"),Ra=t("Tip:"),La=t(" String, property and method names are usually the best marker to trace a "),ee=a("a"),Ma=t("mangled code"),$a=t(". Even though all the variables have mangled into a single character variable name, you can still clearly see the method "),We=a("code"),Ha=t("has_directive()"),Na=t(" and the string "),Ue=a("code"),Va=t('"use strict"'),Ba=t("."),Ga=l(),$s=a("p"),Fa=t("Conversely, please don't write long windy property / method names, it doesn't mangle well."),Wa=l(),se=a("p"),Ua=t("So I global searched the keyword "),ze=a("code"),za=t('has_directive("use strict")'),Qa=t(" and landed with a small number of results, which I looked through every one of them and ended up with the following line:"),Ja=l(),Qe=a("div"),Ka=l(),Hs=a("p"),Za=t("Which I was and still am clueless of what this code was trying to do."),Xa=l(),te=a("p"),Ya=t("So I did the most reasonable thing, add a "),Je=a("code"),en=t("console.log(node)"),sn=t("."),tn=l(),Ke=a("div"),on=l(),b=a("p"),an=t("I found out that the "),Ze=a("code"),nn=t("node"),rn=t(" is an object, that does not have a property "),Xe=a("code"),ln=t("key"),cn=t(", which explains the error. And "),Ye=a("code"),pn=t("node"),hn=t(" has a property call "),es=a("code"),dn=t("name"),kn=t(" that has a value "),ss=a("code"),un=t('"foobar"'),vn=t(", which I assumed is a variable name in our codebase. Luckily "),ts=a("code"),yn=t("foobar"),fn=t(" wasn't commonly used in our codebase, and I managed to find only 1 instance of it, and astonishingly, the code was last changed 1 year ago!"),mn=l(),Ns=a("p"),wn=t("So Terser just decided to break, without a sign, on a line of code that was written 1 year ago. This is the life of a programmer."),kt=l(),h=a("section"),Vs=a("h2"),oe=a("a"),gn=t("Final Act - The Resolution"),xn=l(),Bs=a("p"),_n=t("I kind of concluded that the root cause was a Terser bug, (because I can't just change the code that wasn't touched for nearly 1 year for no good reason), so the obvious thing to do next was to figured out whether someone fixed it on Terser upstream."),bn=l(),Gs=a("p"),En=t("So, I checked out the master branch of Terser, found out the code has changed to"),In=l(),os=a("div"),Tn=l(),H=a("p"),as=a("code"),On=t("node.key"),Cn=t(" is checked to be existed before checking "),ns=a("code"),Pn=t("node.key.name"),An=t(". What a simple patch!"),jn=l(),Fs=a("p"),Dn=t("The next thing I needed to figure out was when was this fix landed, whether I can upgrade it."),Sn=l(),Ws=a("p"),qn=t("The Terser in the codebase was one major version behind the latest Terser version, so, I was more reserved to upgrade to the latest version."),Rn=l(),Us=a("p"),Ln=t("The git blame for the line of code was for some code refactoring, so I went to Github to trace the blame."),Mn=l(),rs=a("p"),zs=a("strong"),$n=t("Tip:"),Hn=t(" Github blame has this very useful button, that allows you to view blame prior to the change."),Nn=l(),Qs=a("p"),ae=a("picture"),Js=a("source"),Ks=a("source"),ne=a("img"),Vn=l(),Zs=a("p"),Bn=t("A few blame traces later, I ended up with a commit that fixed the bug:"),Gn=l(),Xs=a("blockquote"),Ys=a("p"),re=a("a"),Fn=t("fix node.key crashing lib/compress by hytromo \xB7 Pull Request #286 \xB7 terser/terser"),Wn=l(),le=a("p"),Un=t("By looking at the MR merged date, I found that the commit was landed in between "),ie=a("a"),zn=t("v3.16.0 and v3.17.0"),Qn=t("."),Jn=l(),et=a("p"),Kn=t("v3.17.0 was a minor version bump for our codebase, so I assumed it has no breaking changes."),Zn=l(),D=a("p"),ls=a("code"),Xn=t("terser"),Yn=t(" was installed as a dependency of "),is=a("code"),er=t("terser-webpack-plugin"),sr=t(", which we had no control on the terser version, so I added a resolution to our "),cs=a("code"),tr=t("package.json"),or=t(":"),ar=l(),ps=a("div"),nr=l(),st=a("p"),rr=t("After I upgraded terser, I build the code again."),lr=l(),tt=a("p"),ir=t("The build was successful! \u{1F389}"),ut=l(),S=a("section"),ot=a("h2"),ce=a("a"),cr=t("Closing Note"),pr=l(),at=a("p"),hr=t("As I was explaining all these to my colleague, I realised that should I upgraded the terser once I found out that it was a terser error, it would have fixed the bug as well. I wouldn't need to go through all these to end up in the same fix."),dr=l(),nt=a("p"),kr=t("Oh well. \u{1F937}\u200D\u2642\uFE0F"),this.h()},l(p){li(w.$$.fragment,p),A=i(p),O=n(p,"P",{});var g=r(O);N=o(g,"The following is a record of the steps I went through when debugging a build-time bug I encountered during work."),g.forEach(s),x=i(p),E=n(p,"P",{});var gr=r(E);ke=o(gr,"It all started with an error message during the build."),gr.forEach(s),lt=i(p),V=n(p,"DIV",{class:!0});var Ii=r(V);Ii.forEach(s),it=i(p),ue=n(p,"P",{});var xr=r(ue);Ot=o(xr,"What is wrong with Terser and our code?"),xr.forEach(s),ct=i(p),ve=n(p,"P",{});var _r=r(ve);us=n(_r,"STRONG",{});var br=r(us);Ct=o(br,"I must find the root cause of this!"),br.forEach(s),_r.forEach(s),pt=i(p),v=n(p,"SECTION",{});var m=r(v);vs=n(m,"H2",{});var Er=r(vs);B=n(Er,"A",{href:!0,id:!0});var Ir=r(B);Pt=o(Ir,"Act I - The First Attempt"),Ir.forEach(s),Er.forEach(s),At=i(m),R=n(m,"P",{});var hs=r(R);jt=o(hs,"We used Terser to minify our build code. It was part of our webpack pipeline, installed through "),ye=n(hs,"CODE",{class:!0});var Tr=r(ye);Dt=o(Tr,"terser-webpack-plugin"),Tr.forEach(s),St=o(hs,". Since terser is throwing an error, so I disabled "),fe=n(hs,"CODE",{class:!0});var Or=r(fe);qt=o(Or,"terser-webpack-plugin"),Or.forEach(s),Rt=o(hs," and build again."),hs.forEach(s),Lt=i(m),me=n(m,"DIV",{class:!0});var Ti=r(me);Ti.forEach(s),Mt=i(m),ys=n(m,"P",{});var Cr=r(ys);$t=o(Cr,"Ok. The build was successful. Nothing wrong with the code nor the build."),Cr.forEach(s),Ht=i(m),fs=n(m,"P",{});var Pr=r(fs);Nt=o(Pr,"So, I run the terser manually:"),Pr.forEach(s),Vt=i(m),we=n(m,"DIV",{class:!0});var Oi=r(we);Oi.forEach(s),Bt=i(m),ms=n(m,"P",{});var Ar=r(ms);Gt=o(Ar,"The console output an error that was cryptic"),Ar.forEach(s),Ft=i(m),ge=n(m,"DIV",{class:!0});var Ci=r(ge);Ci.forEach(s),Wt=i(m),xe=n(m,"P",{});var ur=r(xe);Ut=o(ur,"I clicked into the terser source code to see what was going wrong over there. "),ws=n(ur,"EM",{});var jr=r(ws);zt=o(jr,"(Maybe it's my chance to contribute to terser?)"),jr.forEach(s),ur.forEach(s),Qt=i(m),gs=n(m,"P",{});var Dr=r(gs);Jt=o(Dr,"Little did I know, how wrong I could be."),Dr.forEach(s),Kt=i(m),_e=n(m,"P",{});var vr=r(_e);be=n(vr,"CODE",{class:!0});var Sr=r(be);Zt=o(Sr,"terser/dist/bundle.js"),Sr.forEach(s),Xt=o(vr," was a minified code and it wasn't meant for humans eyes \u{1F62D}"),vr.forEach(s),Yt=i(m),xs=n(m,"P",{});var qr=r(xs);eo=o(qr,"Allow me to share a small snippet of what I saw:"),qr.forEach(s),so=i(m),Ee=n(m,"DIV",{class:!0});var Pi=r(Ee);Pi.forEach(s),to=i(m),_s=n(m,"P",{});var Rr=r(_s);oo=o(Rr,"At this point in time, I had another meeting to attend, so I stopped at this juncture."),Rr.forEach(s),ao=i(m),bs=n(m,"P",{});var Lr=r(bs);no=o(Lr,"On my way there, I was thinking, well, maybe I should probe this later in another direction."),Lr.forEach(s),m.forEach(s),ht=i(p),d=n(p,"SECTION",{});var y=r(d);Es=n(y,"H2",{});var Mr=r(Es);G=n(Mr,"A",{href:!0,id:!0});var $r=r(G);ro=o($r,"Act II - terser-webpack-plugin"),$r.forEach(s),Mr.forEach(s),lo=i(y),Is=n(y,"P",{});var Hr=r(Is);io=o(Hr,"After the meeting, I was thinking, well let me reenable the terser plugin, and try to probe through the plugin."),Hr.forEach(s),co=i(y),F=n(y,"P",{});var yt=r(F);po=o(yt,"Remember the error message: "),Ie=n(yt,"CODE",{class:!0});var Nr=r(Ie);ho=o(Nr,'"ERROR in bundle.xxxx.js from Terser"'),Nr.forEach(s),ko=o(yt," ?"),yt.forEach(s),uo=i(y),L=n(y,"P",{});var ds=r(L);vo=o(ds,"I looked into the "),Te=n(ds,"CODE",{class:!0});var Vr=r(Te);yo=o(Vr,"node_modules/terser-webpack/plugin/dist/index.js"),Vr.forEach(s),fo=o(ds," and search for the word "),Oe=n(ds,"CODE",{class:!0});var Br=r(Oe);mo=o(Br,'"from Terser"'),Br.forEach(s),wo=o(ds,"."),ds.forEach(s),go=i(y),C=n(y,"P",{});var M=r(C);Ts=n(M,"STRONG",{});var Gr=r(Ts);xo=o(Gr,"Tip:"),Gr.forEach(s),_o=o(M," Usually when you want to debug a library installed in "),Ce=n(M,"CODE",{class:!0});var Fr=r(Ce);bo=o(Fr,"node_modules"),Fr.forEach(s),Eo=o(M,", you can first look at the "),Pe=n(M,"CODE",{class:!0});var Wr=r(Pe);Io=o(Wr,"package.json"),Wr.forEach(s),To=o(M,", it usually has an entry called "),Ae=n(M,"CODE",{class:!0});var Ur=r(Ae);Oo=o(Ur,'"main"'),Ur.forEach(s),Co=o(M," that tells you the entry file to first look into. The main file usually exports all the public API that you use, so it is a good place to start diving into."),M.forEach(s),Po=i(y),Os=n(y,"P",{});var zr=r(Os);Ao=o(zr,"So I found the line:"),zr.forEach(s),jo=i(y),je=n(y,"DIV",{class:!0});var Ai=r(je);Ai.forEach(s),Do=i(y),T=n(y,"P",{});var q=r(T);So=o(q,"After adding logs "),De=n(q,"CODE",{class:!0});var Qr=r(De);qo=o(Qr,"console.log(err)"),Qr.forEach(s),Ro=o(q," and run the build again, I realised the err is an empty object "),Se=n(q,"CODE",{class:!0});var Jr=r(Se);Lo=o(Jr,"{}"),Jr.forEach(s),Mo=o(q,", which explained why I saw "),qe=n(q,"CODE",{class:!0});var Kr=r(qe);$o=o(Kr,"undefined"),Kr.forEach(s),Ho=o(q," after the "),Re=n(q,"CODE",{class:!0});var Zr=r(Re);No=o(Zr,"ERROR in ... from Terser"),Zr.forEach(s),Vo=o(q,"."),q.forEach(s),Bo=i(y),W=n(y,"P",{});var ft=r(W);Go=o(ft,"So, I slowly traced back the caller, and find out where this "),Le=n(ft,"CODE",{class:!0});var Xr=r(Le);Fo=o(Xr,"err"),Xr.forEach(s),Wo=o(ft," object was initially created."),ft.forEach(s),Uo=i(y),Me=n(y,"P",{});var yr=r(Me);Cs=n(yr,"STRONG",{});var Yr=r(Cs);zo=o(Yr,"Tip:"),Yr.forEach(s),Qo=o(yr," To trace the callers of a function that leads up to a certain state of your application, you can:"),yr.forEach(s),Jo=i(y),U=n(y,"UL",{});var mt=r(U);z=n(mt,"LI",{});var wt=r(z);Ko=o(wt,"Use a "),Q=n(wt,"A",{href:!0,rel:!0});var el=r(Q);Zo=o(el,"conditional breakpoint"),el.forEach(s),Xo=o(wt," if you are debugging through a debugger"),wt.forEach(s),Yo=i(mt),Ps=n(mt,"LI",{});var sl=r(Ps);ea=o(sl,"Throw an error within a try catch"),sl.forEach(s),mt.forEach(s),sa=i(y),$e=n(y,"DIV",{class:!0});var ji=r($e);ji.forEach(s),ta=i(y),As=n(y,"P",{});var tl=r(As);oa=o(tl,"This is especially useful if you are tracing an unfamiliar code, you can quickly get a call stack that leads up to the current condition."),tl.forEach(s),aa=i(y),J=n(y,"P",{});var gt=r(J);na=o(gt,"After tracing through the call stack, I ended up at the line where the "),He=n(gt,"CODE",{class:!0});var ol=r(He);ra=o(ol,"terser-webpack-plugin"),ol.forEach(s),la=o(gt," calls the terser, and when I logged out the error, it shows:"),gt.forEach(s),ia=i(y),Ne=n(y,"DIV",{class:!0});var Di=r(Ne);Di.forEach(s),ca=i(y),js=n(y,"P",{});var al=r(js);pa=o(al,"So familiar! After an hour of tracing and debugging, I ended up at the same place."),al.forEach(s),ha=i(y),j=n(y,"P",{});var pe=r(j);Ds=n(pe,"STRONG",{});var nl=r(Ds);da=o(nl,"Note:"),nl.forEach(s),ka=o(pe," the error must have lost somewhere from the terser to the actual print out of "),Ve=n(pe,"CODE",{class:!0});var rl=r(Ve);ua=o(rl,"terser-webpack-plugin"),rl.forEach(s),va=o(pe,", it might have fixed in a later version of "),Be=n(pe,"CODE",{class:!0});var ll=r(Be);ya=o(ll,"terser-webpack-plugin"),ll.forEach(s),fa=o(pe,", but I'm not sure of it yet. Anyone interested can help check."),pe.forEach(s),y.forEach(s),dt=i(p),k=n(p,"SECTION",{});var f=r(k);Ss=n(f,"H2",{});var il=r(Ss);K=n(il,"A",{href:!0,id:!0});var cl=r(K);ma=o(cl,"Act III - Terser"),cl.forEach(s),il.forEach(s),wa=i(f),qs=n(f,"P",{});var pl=r(qs);ga=o(pl,"The circumstances left me with no choice. I needed to face the cryptic minified code."),pl.forEach(s),xa=i(f),Rs=n(f,"P",{});var hl=r(Rs);_a=o(hl,"Luckily VSCode still able to open the huge minified file, and able to set the cursor to the right line and column:"),hl.forEach(s),ba=i(f),Ge=n(f,"DIV",{class:!0});var Si=r(Ge);Si.forEach(s),Ea=i(f),Ls=n(f,"P",{});var dl=r(Ls);Ia=o(dl,"(By the way, in the minified code, all the code is in one line. \u{1F926}\u200D\u2642\uFE0F)"),dl.forEach(s),Ta=i(f),Z=n(f,"P",{});var xt=r(Z);Oa=o(xt,"Well, this may seem like the right place to throw the "),Fe=n(xt,"CODE",{class:!0});var kl=r(Fe);Ca=o(kl,`"Cannot read property 'name' of undefined"`),kl.forEach(s),Pa=o(xt," error."),xt.forEach(s),Aa=i(f),X=n(f,"P",{});var _t=r(X);ja=o(_t,"To understand what is going on in this line, I cloned "),Y=n(_t,"A",{href:!0,rel:!0});var ul=r(Y);Da=o(ul,"terser"),ul.forEach(s),Sa=o(_t,", checked out to the version tag that was installed in our codebase, and tried to figure out where that line was in the original code."),_t.forEach(s),qa=i(f),P=n(f,"P",{});var $=r(P);Ms=n($,"STRONG",{});var vl=r(Ms);Ra=o(vl,"Tip:"),vl.forEach(s),La=o($," String, property and method names are usually the best marker to trace a "),ee=n($,"A",{href:!0,rel:!0});var yl=r(ee);Ma=o(yl,"mangled code"),yl.forEach(s),$a=o($,". Even though all the variables have mangled into a single character variable name, you can still clearly see the method "),We=n($,"CODE",{class:!0});var fl=r(We);Ha=o(fl,"has_directive()"),fl.forEach(s),Na=o($," and the string "),Ue=n($,"CODE",{class:!0});var ml=r(Ue);Va=o(ml,'"use strict"'),ml.forEach(s),Ba=o($,"."),$.forEach(s),Ga=i(f),$s=n(f,"P",{});var wl=r($s);Fa=o(wl,"Conversely, please don't write long windy property / method names, it doesn't mangle well."),wl.forEach(s),Wa=i(f),se=n(f,"P",{});var bt=r(se);Ua=o(bt,"So I global searched the keyword "),ze=n(bt,"CODE",{class:!0});var gl=r(ze);za=o(gl,'has_directive("use strict")'),gl.forEach(s),Qa=o(bt," and landed with a small number of results, which I looked through every one of them and ended up with the following line:"),bt.forEach(s),Ja=i(f),Qe=n(f,"DIV",{class:!0});var qi=r(Qe);qi.forEach(s),Ka=i(f),Hs=n(f,"P",{});var xl=r(Hs);Za=o(xl,"Which I was and still am clueless of what this code was trying to do."),xl.forEach(s),Xa=i(f),te=n(f,"P",{});var Et=r(te);Ya=o(Et,"So I did the most reasonable thing, add a "),Je=n(Et,"CODE",{class:!0});var _l=r(Je);en=o(_l,"console.log(node)"),_l.forEach(s),sn=o(Et,"."),Et.forEach(s),tn=i(f),Ke=n(f,"DIV",{class:!0});var Ri=r(Ke);Ri.forEach(s),on=i(f),b=n(f,"P",{});var I=r(b);an=o(I,"I found out that the "),Ze=n(I,"CODE",{class:!0});var bl=r(Ze);nn=o(bl,"node"),bl.forEach(s),rn=o(I," is an object, that does not have a property "),Xe=n(I,"CODE",{class:!0});var El=r(Xe);ln=o(El,"key"),El.forEach(s),cn=o(I,", which explains the error. And "),Ye=n(I,"CODE",{class:!0});var Il=r(Ye);pn=o(Il,"node"),Il.forEach(s),hn=o(I," has a property call "),es=n(I,"CODE",{class:!0});var Tl=r(es);dn=o(Tl,"name"),Tl.forEach(s),kn=o(I," that has a value "),ss=n(I,"CODE",{class:!0});var Ol=r(ss);un=o(Ol,'"foobar"'),Ol.forEach(s),vn=o(I,", which I assumed is a variable name in our codebase. Luckily "),ts=n(I,"CODE",{class:!0});var Cl=r(ts);yn=o(Cl,"foobar"),Cl.forEach(s),fn=o(I," wasn't commonly used in our codebase, and I managed to find only 1 instance of it, and astonishingly, the code was last changed 1 year ago!"),I.forEach(s),mn=i(f),Ns=n(f,"P",{});var Pl=r(Ns);wn=o(Pl,"So Terser just decided to break, without a sign, on a line of code that was written 1 year ago. This is the life of a programmer."),Pl.forEach(s),f.forEach(s),kt=i(p),h=n(p,"SECTION",{});var u=r(h);Vs=n(u,"H2",{});var Al=r(Vs);oe=n(Al,"A",{href:!0,id:!0});var jl=r(oe);gn=o(jl,"Final Act - The Resolution"),jl.forEach(s),Al.forEach(s),xn=i(u),Bs=n(u,"P",{});var Dl=r(Bs);_n=o(Dl,"I kind of concluded that the root cause was a Terser bug, (because I can't just change the code that wasn't touched for nearly 1 year for no good reason), so the obvious thing to do next was to figured out whether someone fixed it on Terser upstream."),Dl.forEach(s),bn=i(u),Gs=n(u,"P",{});var Sl=r(Gs);En=o(Sl,"So, I checked out the master branch of Terser, found out the code has changed to"),Sl.forEach(s),In=i(u),os=n(u,"DIV",{class:!0});var Li=r(os);Li.forEach(s),Tn=i(u),H=n(u,"P",{});var rt=r(H);as=n(rt,"CODE",{class:!0});var ql=r(as);On=o(ql,"node.key"),ql.forEach(s),Cn=o(rt," is checked to be existed before checking "),ns=n(rt,"CODE",{class:!0});var Rl=r(ns);Pn=o(Rl,"node.key.name"),Rl.forEach(s),An=o(rt,". What a simple patch!"),rt.forEach(s),jn=i(u),Fs=n(u,"P",{});var Ll=r(Fs);Dn=o(Ll,"The next thing I needed to figure out was when was this fix landed, whether I can upgrade it."),Ll.forEach(s),Sn=i(u),Ws=n(u,"P",{});var Ml=r(Ws);qn=o(Ml,"The Terser in the codebase was one major version behind the latest Terser version, so, I was more reserved to upgrade to the latest version."),Ml.forEach(s),Rn=i(u),Us=n(u,"P",{});var $l=r(Us);Ln=o($l,"The git blame for the line of code was for some code refactoring, so I went to Github to trace the blame."),$l.forEach(s),Mn=i(u),rs=n(u,"P",{});var fr=r(rs);zs=n(fr,"STRONG",{});var Hl=r(zs);$n=o(Hl,"Tip:"),Hl.forEach(s),Hn=o(fr," Github blame has this very useful button, that allows you to view blame prior to the change."),fr.forEach(s),Nn=i(u),Qs=n(u,"P",{});var Nl=r(Qs);ae=n(Nl,"PICTURE",{});var It=r(ae);Js=n(It,"SOURCE",{type:!0,srcset:!0}),Ks=n(It,"SOURCE",{type:!0,srcset:!0}),ne=n(It,"IMG",{src:!0,loading:!0,alt:!0}),It.forEach(s),Nl.forEach(s),Vn=i(u),Zs=n(u,"P",{});var Vl=r(Zs);Bn=o(Vl,"A few blame traces later, I ended up with a commit that fixed the bug:"),Vl.forEach(s),Gn=i(u),Xs=n(u,"BLOCKQUOTE",{});var Bl=r(Xs);Ys=n(Bl,"P",{});var Gl=r(Ys);re=n(Gl,"A",{href:!0,rel:!0});var Fl=r(re);Fn=o(Fl,"fix node.key crashing lib/compress by hytromo \xB7 Pull Request #286 \xB7 terser/terser"),Fl.forEach(s),Gl.forEach(s),Bl.forEach(s),Wn=i(u),le=n(u,"P",{});var Tt=r(le);Un=o(Tt,"By looking at the MR merged date, I found that the commit was landed in between "),ie=n(Tt,"A",{href:!0,rel:!0});var Wl=r(ie);zn=o(Wl,"v3.16.0 and v3.17.0"),Wl.forEach(s),Qn=o(Tt,"."),Tt.forEach(s),Jn=i(u),et=n(u,"P",{});var Ul=r(et);Kn=o(Ul,"v3.17.0 was a minor version bump for our codebase, so I assumed it has no breaking changes."),Ul.forEach(s),Zn=i(u),D=n(u,"P",{});var he=r(D);ls=n(he,"CODE",{class:!0});var zl=r(ls);Xn=o(zl,"terser"),zl.forEach(s),Yn=o(he," was installed as a dependency of "),is=n(he,"CODE",{class:!0});var Ql=r(is);er=o(Ql,"terser-webpack-plugin"),Ql.forEach(s),sr=o(he,", which we had no control on the terser version, so I added a resolution to our "),cs=n(he,"CODE",{class:!0});var Jl=r(cs);tr=o(Jl,"package.json"),Jl.forEach(s),or=o(he,":"),he.forEach(s),ar=i(u),ps=n(u,"DIV",{class:!0});var Mi=r(ps);Mi.forEach(s),nr=i(u),st=n(u,"P",{});var Kl=r(st);rr=o(Kl,"After I upgraded terser, I build the code again."),Kl.forEach(s),lr=i(u),tt=n(u,"P",{});var Zl=r(tt);ir=o(Zl,"The build was successful! \u{1F389}"),Zl.forEach(s),u.forEach(s),ut=i(p),S=n(p,"SECTION",{});var ks=r(S);ot=n(ks,"H2",{});var Xl=r(ot);ce=n(Xl,"A",{href:!0,id:!0});var Yl=r(ce);cr=o(Yl,"Closing Note"),Yl.forEach(s),Xl.forEach(s),pr=i(ks),at=n(ks,"P",{});var ei=r(at);hr=o(ei,"As I was explaining all these to my colleague, I realised that should I upgraded the terser once I found out that it was a terser error, it would have fixed the bug as well. I wouldn't need to go through all these to end up in the same fix."),ei.forEach(s),dr=i(ks),nt=n(ks,"P",{});var si=r(nt);kr=o(si,"Oh well. \u{1F937}\u200D\u2642\uFE0F"),si.forEach(s),ks.forEach(s),this.h()},h(){c(V,"class","code-section"),c(B,"href","#act-i-the-first-attempt"),c(B,"id","act-i-the-first-attempt"),c(ye,"class","inline"),c(fe,"class","inline"),c(me,"class","code-section"),c(we,"class","code-section"),c(ge,"class","code-section"),c(be,"class","inline"),c(Ee,"class","code-section"),c(G,"href","#act-ii-terser-webpack-plugin"),c(G,"id","act-ii-terser-webpack-plugin"),c(Ie,"class","inline"),c(Te,"class","inline"),c(Oe,"class","inline"),c(Ce,"class","inline"),c(Pe,"class","inline"),c(Ae,"class","inline"),c(je,"class","code-section"),c(De,"class","inline"),c(Se,"class","inline"),c(qe,"class","inline"),c(Re,"class","inline"),c(Le,"class","inline"),c(Q,"href","https://blittle.github.io/chrome-dev-tools/sources/conditional-breakpoints.html"),c(Q,"rel","nofollow"),c($e,"class","code-section"),c(He,"class","inline"),c(Ne,"class","code-section"),c(Ve,"class","inline"),c(Be,"class","inline"),c(K,"href","#act-iii-terser"),c(K,"id","act-iii-terser"),c(Ge,"class","code-section"),c(Fe,"class","inline"),c(Y,"href","https://github.com/terser/terser"),c(Y,"rel","nofollow"),c(ee,"href","http://lisperator.net/uglifyjs/mangle"),c(ee,"rel","nofollow"),c(We,"class","inline"),c(Ue,"class","inline"),c(ze,"class","inline"),c(Qe,"class","code-section"),c(Je,"class","inline"),c(Ke,"class","code-section"),c(Ze,"class","inline"),c(Xe,"class","inline"),c(Ye,"class","inline"),c(es,"class","inline"),c(ss,"class","inline"),c(ts,"class","inline"),c(oe,"href","#final-act-the-resolution"),c(oe,"id","final-act-the-resolution"),c(os,"class","code-section"),c(as,"class","inline"),c(ns,"class","inline"),c(Js,"type","image/webp"),c(Js,"srcset",zi),c(Ks,"type","image/png"),c(Ks,"srcset",ai),Gi(ne.src,wr=ai)||c(ne,"src",wr),c(ne,"loading","lazy"),c(ne,"alt","Github: view blame prior to the change"),c(re,"href","https://github.com/terser/terser/pull/286"),c(re,"rel","nofollow"),c(ie,"href","https://github.com/terser/terser/compare/v3.16.0...v3.17.0"),c(ie,"rel","nofollow"),c(ls,"class","inline"),c(is,"class","inline"),c(cs,"class","inline"),c(ps,"class","code-section"),c(ce,"href","#closing-note"),c(ce,"id","closing-note")},m(p,g){ii(w,p,g),_(p,A,g),_(p,O,g),e(O,N),_(p,x,g),_(p,E,g),e(E,ke),_(p,lt,g),_(p,V,g),V.innerHTML=di,_(p,it,g),_(p,ue,g),e(ue,Ot),_(p,ct,g),_(p,ve,g),e(ve,us),e(us,Ct),_(p,pt,g),_(p,v,g),e(v,vs),e(vs,B),e(B,Pt),e(v,At),e(v,R),e(R,jt),e(R,ye),e(ye,Dt),e(R,St),e(R,fe),e(fe,qt),e(R,Rt),e(v,Lt),e(v,me),me.innerHTML=ki,e(v,Mt),e(v,ys),e(ys,$t),e(v,Ht),e(v,fs),e(fs,Nt),e(v,Vt),e(v,we),we.innerHTML=ui,e(v,Bt),e(v,ms),e(ms,Gt),e(v,Ft),e(v,ge),ge.innerHTML=vi,e(v,Wt),e(v,xe),e(xe,Ut),e(xe,ws),e(ws,zt),e(v,Qt),e(v,gs),e(gs,Jt),e(v,Kt),e(v,_e),e(_e,be),e(be,Zt),e(_e,Xt),e(v,Yt),e(v,xs),e(xs,eo),e(v,so),e(v,Ee),Ee.innerHTML=yi,e(v,to),e(v,_s),e(_s,oo),e(v,ao),e(v,bs),e(bs,no),_(p,ht,g),_(p,d,g),e(d,Es),e(Es,G),e(G,ro),e(d,lo),e(d,Is),e(Is,io),e(d,co),e(d,F),e(F,po),e(F,Ie),e(Ie,ho),e(F,ko),e(d,uo),e(d,L),e(L,vo),e(L,Te),e(Te,yo),e(L,fo),e(L,Oe),e(Oe,mo),e(L,wo),e(d,go),e(d,C),e(C,Ts),e(Ts,xo),e(C,_o),e(C,Ce),e(Ce,bo),e(C,Eo),e(C,Pe),e(Pe,Io),e(C,To),e(C,Ae),e(Ae,Oo),e(C,Co),e(d,Po),e(d,Os),e(Os,Ao),e(d,jo),e(d,je),je.innerHTML=fi,e(d,Do),e(d,T),e(T,So),e(T,De),e(De,qo),e(T,Ro),e(T,Se),e(Se,Lo),e(T,Mo),e(T,qe),e(qe,$o),e(T,Ho),e(T,Re),e(Re,No),e(T,Vo),e(d,Bo),e(d,W),e(W,Go),e(W,Le),e(Le,Fo),e(W,Wo),e(d,Uo),e(d,Me),e(Me,Cs),e(Cs,zo),e(Me,Qo),e(d,Jo),e(d,U),e(U,z),e(z,Ko),e(z,Q),e(Q,Zo),e(z,Xo),e(U,Yo),e(U,Ps),e(Ps,ea),e(d,sa),e(d,$e),$e.innerHTML=mi,e(d,ta),e(d,As),e(As,oa),e(d,aa),e(d,J),e(J,na),e(J,He),e(He,ra),e(J,la),e(d,ia),e(d,Ne),Ne.innerHTML=wi,e(d,ca),e(d,js),e(js,pa),e(d,ha),e(d,j),e(j,Ds),e(Ds,da),e(j,ka),e(j,Ve),e(Ve,ua),e(j,va),e(j,Be),e(Be,ya),e(j,fa),_(p,dt,g),_(p,k,g),e(k,Ss),e(Ss,K),e(K,ma),e(k,wa),e(k,qs),e(qs,ga),e(k,xa),e(k,Rs),e(Rs,_a),e(k,ba),e(k,Ge),Ge.innerHTML=gi,e(k,Ea),e(k,Ls),e(Ls,Ia),e(k,Ta),e(k,Z),e(Z,Oa),e(Z,Fe),e(Fe,Ca),e(Z,Pa),e(k,Aa),e(k,X),e(X,ja),e(X,Y),e(Y,Da),e(X,Sa),e(k,qa),e(k,P),e(P,Ms),e(Ms,Ra),e(P,La),e(P,ee),e(ee,Ma),e(P,$a),e(P,We),e(We,Ha),e(P,Na),e(P,Ue),e(Ue,Va),e(P,Ba),e(k,Ga),e(k,$s),e($s,Fa),e(k,Wa),e(k,se),e(se,Ua),e(se,ze),e(ze,za),e(se,Qa),e(k,Ja),e(k,Qe),Qe.innerHTML=xi,e(k,Ka),e(k,Hs),e(Hs,Za),e(k,Xa),e(k,te),e(te,Ya),e(te,Je),e(Je,en),e(te,sn),e(k,tn),e(k,Ke),Ke.innerHTML=_i,e(k,on),e(k,b),e(b,an),e(b,Ze),e(Ze,nn),e(b,rn),e(b,Xe),e(Xe,ln),e(b,cn),e(b,Ye),e(Ye,pn),e(b,hn),e(b,es),e(es,dn),e(b,kn),e(b,ss),e(ss,un),e(b,vn),e(b,ts),e(ts,yn),e(b,fn),e(k,mn),e(k,Ns),e(Ns,wn),_(p,kt,g),_(p,h,g),e(h,Vs),e(Vs,oe),e(oe,gn),e(h,xn),e(h,Bs),e(Bs,_n),e(h,bn),e(h,Gs),e(Gs,En),e(h,In),e(h,os),os.innerHTML=bi,e(h,Tn),e(h,H),e(H,as),e(as,On),e(H,Cn),e(H,ns),e(ns,Pn),e(H,An),e(h,jn),e(h,Fs),e(Fs,Dn),e(h,Sn),e(h,Ws),e(Ws,qn),e(h,Rn),e(h,Us),e(Us,Ln),e(h,Mn),e(h,rs),e(rs,zs),e(zs,$n),e(rs,Hn),e(h,Nn),e(h,Qs),e(Qs,ae),e(ae,Js),e(ae,Ks),e(ae,ne),e(h,Vn),e(h,Zs),e(Zs,Bn),e(h,Gn),e(h,Xs),e(Xs,Ys),e(Ys,re),e(re,Fn),e(h,Wn),e(h,le),e(le,Un),e(le,ie),e(ie,zn),e(le,Qn),e(h,Jn),e(h,et),e(et,Kn),e(h,Zn),e(h,D),e(D,ls),e(ls,Xn),e(D,Yn),e(D,is),e(is,er),e(D,sr),e(D,cs),e(cs,tr),e(D,or),e(h,ar),e(h,ps),ps.innerHTML=Ei,e(h,nr),e(h,st),e(st,rr),e(h,lr),e(h,tt),e(tt,ir),_(p,ut,g),_(p,S,g),e(S,ot),e(ot,ce),e(ce,cr),e(S,pr),e(S,at),e(at,hr),e(S,dr),e(S,nt),e(nt,kr),vt=!0},p:Fi,i(p){vt||(ci(w.$$.fragment,p),vt=!0)},o(p){pi(w.$$.fragment,p),vt=!1},d(p){hi(w,p),p&&s(A),p&&s(O),p&&s(x),p&&s(E),p&&s(lt),p&&s(V),p&&s(it),p&&s(ue),p&&s(ct),p&&s(ve),p&&s(pt),p&&s(v),p&&s(ht),p&&s(d),p&&s(dt),p&&s(k),p&&s(kt),p&&s(h),p&&s(ut),p&&s(S)}}}function Ki(de){let w,A;const O=[de[0],ni];let N={$$slots:{default:[Ji]},$$scope:{ctx:de}};for(let x=0;x<O.length;x+=1)N=mr(N,O[x]);return w=new Wi({props:N}),{c(){ri(w.$$.fragment)},l(x){li(w.$$.fragment,x)},m(x,E){ii(w,x,E),A=!0},p(x,[E]){const ke=E&1?Vi(O,[E&1&&ti(x[0]),E&0&&ti(ni)]):{};E&2&&(ke.$$scope={dirty:E,ctx:x}),w.$set(ke)},i(x){A||(ci(w.$$.fragment,x),A=!0)},o(x){pi(w.$$.fragment,x),A=!1},d(x){hi(w,x)}}}const ni={title:"Debugging Story: Build failed, error from Terser",date:"2020-01-08T08:00:00Z",tags:["debugging"],description:"It all started with an error message during the build: 'ERROR in bundle.xxx.js from Terser'.",label:"blog"};function Zi(de,w,A){return Bi("blog",{image:Qi}),de.$$set=O=>{A(0,w=mr(mr({},w),oi(O)))},w=oi(w),[w]}class ac extends $i{constructor(w){super();Hi(this,w,Zi,Ki,Ni,{})}}export{ac as default,ni as metadata};
