import{S as _d,i as Td,s as Sd,C as Lh,w as Hv,x as Lv,y as Uv,z as Pd,A as Cv,q as Nv,o as Wv,B as Mv,r as Id,R as Av,k as l,e,t,m as i,c as n,a as r,h as a,d as o,b as p,g as j,F as s,O as jd}from"../../chunks/vendor-6bf294e3.js";import{B as Od}from"../../chunks/BlogLayout-152f599b.js";import{T as Cd}from"../../chunks/TableOfContent-1b9e4572.js";import{_ as Ad}from"../../chunks/twitter-card-image-a57df29d.js";import"../../chunks/stores-e20b7872.js";import"../../chunks/WebMentions-745413ea.js";/* empty css                                */function Dd(so){let g,W,v,K,b,M,oo,Dt,$e,Be,Ht,Je,Ye,Lt,Ge,Ke,Ut,Fe,Qe,to,Rv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">root</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">document</span><span style="color: var(--shiki-token-function)">.getElementById</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;app&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">root</span><span style="color: var(--shiki-color-text)">.innerHTML </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#96;</span></span>
<span class="line"><span style="color: var(--shiki-token-string-expression)">  &lt;button&gt;-&lt;/button&gt;</span></span>
<span class="line"><span style="color: var(--shiki-token-string-expression)">  &lt;span&gt;0&lt;/span&gt;</span></span>
<span class="line"><span style="color: var(--shiki-token-string-expression)">  &lt;button&gt;+&lt;/button&gt;</span></span>
<span class="line"><span style="color: var(--shiki-token-string-expression)">&#96;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">decrementBtn</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">incrementBtn</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">root</span><span style="color: var(--shiki-token-function)">.querySelectorAll</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;button&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">span</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">root</span><span style="color: var(--shiki-token-function)">.querySelector</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;span&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">let</span><span style="color: var(--shiki-color-text)"> count </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">decrementBtn</span><span style="color: var(--shiki-token-function)">.addEventListener</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;click&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  count</span><span style="color: var(--shiki-token-keyword)">--</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">span</span><span style="color: var(--shiki-color-text)">.innerText </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> count;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">incrementBtn</span><span style="color: var(--shiki-token-function)">.addEventListener</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;click&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> () </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  count</span><span style="color: var(--shiki-token-keyword)">++</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">span</span><span style="color: var(--shiki-color-text)">.innerText </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> count;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;);</span></span></code></pre>`,ze,Nt,Ze,Xe,ao,qv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &lt;</span><span style="color: var(--shiki-token-string-expression)">div</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &lt;</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">v-on:click</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-string-expression)">&quot;counter -= 1&quot;</span><span style="color: var(--shiki-color-text)">&gt;-&lt;/</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &lt;</span><span style="color: var(--shiki-token-string-expression)">span</span><span style="color: var(--shiki-color-text)">&gt;&#123;&#123; counter &#125;&#125;&lt;/</span><span style="color: var(--shiki-token-string-expression)">span</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &lt;</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">v-on:click</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-token-string-expression)">&quot;counter += 1&quot;</span><span style="color: var(--shiki-color-text)">&gt;+&lt;/</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &lt;/</span><span style="color: var(--shiki-token-string-expression)">div</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">&lt;</span><span style="color: var(--shiki-token-string-expression)">script</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">export</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">default</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">data</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        counter</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&lt;/</span><span style="color: var(--shiki-token-string-expression)">script</span><span style="color: var(--shiki-color-text)">&gt;</span></span></code></pre>`,sn,Wt,on,tn,eo,Vv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">App</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">counter</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">setCounter</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">React</span><span style="color: var(--shiki-token-function)">.useState</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> (</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &lt;&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &lt;</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">onClick</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">&#123;() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">setCounter</span><span style="color: var(--shiki-color-text)">(counter </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> counter </span><span style="color: var(--shiki-token-keyword)">-</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)&#125;&gt;-&lt;/</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &lt;</span><span style="color: var(--shiki-token-string-expression)">span</span><span style="color: var(--shiki-color-text)">&gt;&#123;counter&#125;&lt;/</span><span style="color: var(--shiki-token-string-expression)">span</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &lt;</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">onClick</span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)">&#123;() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">setCounter</span><span style="color: var(--shiki-color-text)">(counter </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> counter </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">)&#125;&gt;+&lt;/</span><span style="color: var(--shiki-token-string-expression)">button</span><span style="color: var(--shiki-color-text)">&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &lt;/&gt;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  );</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,an,F,en,Mt,Rt,nn,rn,qt,Vt,ln,pn,cn,Q,hn,no,kn,yn,ro,vn,dn,un,$t,fn,xn,Bt,wn,mn,Jt,Yt,gn,ye,D,Gt,hs,bn,En,Kt,_n,Tn,ks,Ft,Sn,Pn,Qt,In,jn,rs,zt,On,Cn,Zt,An,Dn,Hn,H,Ln,Xt,Un,Nn,sa,Wn,Mn,oa,Rn,qn,ta,Vn,$n,ve,S,aa,ys,Bn,Jn,ea,Yn,Gn,L,Kn,lo,Fn,Qn,io,zn,Zn,po,Xn,sr,vs,or,tr,ar,na,er,nr,co,$v=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Todos</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">todos</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">setTodos</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">useState</span><span style="color: var(--shiki-color-text)">([]);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">totalTodos</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">setTotalTodos</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">useState</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">onAddTodo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> todo </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">setTodos</span><span style="color: var(--shiki-color-text)">(todos </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-color-text)">todos</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> todo]);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">setTotalTodos</span><span style="color: var(--shiki-color-text)">(totalTodos </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> totalTodos </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// ...</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,rr,ho,lr,ra,ir,pr,la,V,cr,ko,hr,kr,yo,yr,vr,ds,dr,ur,ia,fr,de,u,pa,us,xr,wr,ca,mr,gr,ha,br,Er,ka,_r,Tr,ya,Sr,Pr,vo,Bv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">let</span><span style="color: var(--shiki-color-text)"> data </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">(data);</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// changes to the data will not be propagated into the render function</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">data </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">(data) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// data is a value</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// however it is changed in the outside world</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// got nothing to do with me</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">setInterval</span><span style="color: var(--shiki-color-text)">(() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(data); </span><span style="color: var(--shiki-token-comment)">// will always console out &#96;1&#96;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,Ir,va,jr,Or,uo,Jv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">let</span><span style="color: var(--shiki-color-text)"> data </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> &#123; foo</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)"> &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">(data);</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// mutate data some time later</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">setTimeout</span><span style="color: var(--shiki-color-text)">(() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">data</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">render</span><span style="color: var(--shiki-color-text)">(data) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// data is referenced to the same object</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// changes to data.foo can be observed here</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">setInterval</span><span style="color: var(--shiki-color-text)">(() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">data</span><span style="color: var(--shiki-color-text)">.foo); </span><span style="color: var(--shiki-token-comment)">// initially &#96;1&#96;, after mutation, its &#96;2&#96;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,Cr,R,Ar,fo,Dr,Hr,xo,Lr,Ur,wo,Nr,Wr,Mr,da,Rr,qr,ua,Vr,$r,mo,z,Br,go,Jr,Yr,bo,Gr,Kr,Fr,Qr,fa,zr,ue,d,xa,fs,Zr,Xr,wa,sl,ol,Eo,Yv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(obj) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (obj[</span><span style="color: var(--shiki-token-constant)">Symbol</span><span style="color: var(--shiki-token-function)">.for</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;isTracked&#39;</span><span style="color: var(--shiki-color-text)">)]) </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> obj;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">tracked</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Array</span><span style="color: var(--shiki-token-function)">.isArray</span><span style="color: var(--shiki-color-text)">(obj) </span><span style="color: var(--shiki-token-keyword)">?</span><span style="color: var(--shiki-color-text)"> [] </span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> &#123;&#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">in</span><span style="color: var(--shiki-color-text)"> obj) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">Object</span><span style="color: var(--shiki-token-function)">.defineProperty</span><span style="color: var(--shiki-color-text)">(tracked</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> key</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      configurable</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      enumerable</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-function)">get</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> obj[key];</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-function)">set</span><span style="color: var(--shiki-color-text)">(value) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">typeof</span><span style="color: var(--shiki-color-text)"> value </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;object&#39;</span><span style="color: var(--shiki-color-text)">) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">          value </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(value);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        obj[key] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> value;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#96;&#39;</span><span style="color: var(--shiki-token-keyword)">$&#123;</span><span style="color: var(--shiki-color-text)">key</span><span style="color: var(--shiki-token-keyword)">&#125;</span><span style="color: var(--shiki-token-string-expression)">&#39; has changed.&#96;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// marked as &#39;tracked&#39;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">Object</span><span style="color: var(--shiki-token-function)">.defineProperty</span><span style="color: var(--shiki-color-text)">(tracked</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Symbol</span><span style="color: var(--shiki-token-function)">.for</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;isTracked&#39;</span><span style="color: var(--shiki-color-text)">)</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    configurable</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">false</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    enumerable</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">false</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    value</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">true</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> tracked;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// track app state</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(&#123; foo</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)"> &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// log &#96;&#39;foo&#39; has changed.&#96;</span></span></code></pre>`,tl,xs,al,ws,el,nl,rl,ma,ll,il,Z,pl,ms,_o,cl,hl,To,kl,yl,vl,I,dl,So,ul,fl,Po,xl,wl,Io,ml,gl,jo,bl,El,Oo,_l,Tl,Co,Sl,Pl,Ao,Il,jl,Ol,ga,Cl,Al,Do,Gv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">TrackableArrayProto</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Object</span><span style="color: var(--shiki-token-function)">.create</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">Array</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">prototype</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">method</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">of</span><span style="color: var(--shiki-color-text)"> [</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;push&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;pop&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;splice&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;unshift&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;shift&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;sort&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-string-expression)">&#39;reverse&#39;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">]) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">original</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Array</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">prototype</span><span style="color: var(--shiki-color-text)">[method];</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  TrackableArrayProto[method] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">result</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">original</span><span style="color: var(--shiki-token-function)">.apply</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> arguments);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#96;&#39;</span><span style="color: var(--shiki-token-keyword)">$&#123;</span><span style="color: var(--shiki-color-text)">method</span><span style="color: var(--shiki-token-keyword)">&#125;</span><span style="color: var(--shiki-token-string-expression)">&#39; was called&#96;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (method </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;push&#39;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">||</span><span style="color: var(--shiki-color-text)"> method </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;unshift&#39;</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">||</span><span style="color: var(--shiki-color-text)"> method </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;splice&#39;</span><span style="color: var(--shiki-color-text)">) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-comment)">// TODO track newly added item too!</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> result;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableArray</span><span style="color: var(--shiki-color-text)">(arr) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">trackedArray</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(arr);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-comment)">// set the prototype to the patched prototype</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-constant)">trackedArray</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">__proto__</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> TrackableArrayProto;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> trackedArray;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// track app state</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableArray</span><span style="color: var(--shiki-color-text)">([</span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">]);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">); </span><span style="color: var(--shiki-token-comment)">// log &#96;&#39;push&#39; was called.&#96;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">appState[</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;foo&#39;</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// log &#96;&#39;0&#39; has changed.</span></span></code></pre>`,Dl,gs,Hl,bs,Ll,Ul,Nl,ba,Ho,Wl,Es,Ml,Rl,Ea,ql,Vl,_a,$l,Bl,_s,Jl,Ts,Yl,Gl,fe,f,Ta,Ss,Kl,Fl,X,Ql,Lo,zl,Zl,Uo,Xl,si,oi,No,Kv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(obj) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">for</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">key</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">in</span><span style="color: var(--shiki-color-text)"> obj) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">typeof</span><span style="color: var(--shiki-color-text)"> obj[key] </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;object&#39;</span><span style="color: var(--shiki-color-text)">) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      obj[key] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(obj[key]);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">new</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">Proxy</span><span style="color: var(--shiki-color-text)">(obj</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">set</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">(target</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> key</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> value) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#96;&#39;</span><span style="color: var(--shiki-token-keyword)">$&#123;</span><span style="color: var(--shiki-color-text)">key</span><span style="color: var(--shiki-token-keyword)">&#125;</span><span style="color: var(--shiki-token-string-expression)">&#39; has changed&#96;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">if</span><span style="color: var(--shiki-color-text)"> (</span><span style="color: var(--shiki-token-keyword)">typeof</span><span style="color: var(--shiki-color-text)"> value </span><span style="color: var(--shiki-token-keyword)">===</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;object&#39;</span><span style="color: var(--shiki-color-text)">) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        value </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(value);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> (target[key] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> value);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">deleteProperty</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)">(target</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> key) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#96;&#39;</span><span style="color: var(--shiki-token-keyword)">$&#123;</span><span style="color: var(--shiki-color-text)">key</span><span style="color: var(--shiki-token-keyword)">&#125;</span><span style="color: var(--shiki-token-string-expression)">&#39; was deleted&#96;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">delete</span><span style="color: var(--shiki-color-text)"> target[key];</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(&#123; foo</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> bar</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">] &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// log &#96;&#39;foo&#39; has changed.&#96;</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">bar</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">); </span><span style="color: var(--shiki-token-comment)">// log &#96;&#39;2&#39; has changed.&#96;, &#96;&#39;length&#39; has changed&#96;</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.bar[</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;foo&#39;</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// log &#96;&#39;0&#39; has changed.</span></span></code></pre>`,ti,Sa,Pa,ai,ei,Ps,ni,Wo,ri,li,ii,Mo,Fv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">3</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">bar</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">4</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.bar[</span><span style="color: var(--shiki-token-constant)">0</span><span style="color: var(--shiki-color-text)">] </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;foo&#39;</span><span style="color: var(--shiki-color-text)">;</span></span></code></pre>`,pi,Ia,ci,hi,ss,ja,ki,yi,Oa,vi,di,Ca,ui,fi,Ro,Qv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// track a property of the component</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">(initialState) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.state </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(initialState);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">UserComponent</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">(&#123; foo</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)"> &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">state</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// Log &#96;&#39;foo&#39; has changed&#96;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">other</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">2</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// Does not track this</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// track the component instance itself</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">return</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">getTrackableObject</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">UserComponent</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-keyword)">constructor</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">super</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// Log &#96;&#39;foo&#39; has changed&#96;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,xi,os,wi,qo,mi,gi,Vo,bi,Ei,_i,Is,Ti,js,Si,Pi,Ii,Aa,ji,xe,h,Da,ls,Oi,$o,Ci,Ai,Ha,Di,Hi,Os,Li,Bo,Ui,Ni,Wi,Jo,zv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-comment)">// instead of</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-token-function)">scheduleUpdate</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// you have to use the frameworks API</span></span>
<span class="line"><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setAppState</span><span style="color: var(--shiki-color-text)">(&#123; one</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)"> &#125;);</span></span></code></pre>`,Mi,La,Ri,qi,Yo,Zv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">setAppState</span><span style="color: var(--shiki-color-text)">(appState) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.appState </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> appState;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">scheduleUpdate</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,Vi,Cs,$i,is,Bi,Go,Ji,Yi,Gi,Ua,Ki,Fi,Ko,Xv=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">MyComponent</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// if setting the state directly, instead of calling &#96;setAppState&#96;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// this will not schedule an update, and thus no reactivity</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,Qi,Na,zi,Zi,Fo,sd=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">MyComponent</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// this will not schedule update</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">list</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;one&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// you need to call setAppState after the .push()</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setAppState</span><span style="color: var(--shiki-color-text)">(&#123; list</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.list &#125;);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// or instead, for a one-liner</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.setAppState</span><span style="color: var(--shiki-color-text)">(&#123; list</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> [</span><span style="color: var(--shiki-token-keyword)">...</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.list</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;one&#39;</span><span style="color: var(--shiki-color-text)">] &#125;);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,Xi,As,sp,Qo,op,tp,ap,q,Wa,ep,np,ts,rp,zo,lp,ip,Zo,pp,cp,hp,Ma,kp,yp,Ra,vp,dp,Ds,up,Xo,fp,xp,wp,st,od=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">timeout</span><span style="color: var(--shiki-color-text)">(fn</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> delay) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">setTimeout</span><span style="color: var(--shiki-color-text)">(() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">fn</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">scheduleUpdate</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> delay);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span>
<span class="line"><span style="color: var(--shiki-token-comment)">// user code</span></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">import</span><span style="color: var(--shiki-color-text)"> &#123; $timeout &#125; </span><span style="color: var(--shiki-token-keyword)">from</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;my-custom-framework&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">UserComponent</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">extends</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">Component</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-comment)">// will schedule update after the callback fires.</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">$timeout</span><span style="color: var(--shiki-color-text)">(() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">setTimeout</span><span style="color: var(--shiki-color-text)">(() </span><span style="color: var(--shiki-token-keyword)">=&gt;</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-comment)">// this will not schedule update</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.two </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;2&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1000</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,mp,ot,gp,Hs,bp,Ep,Ls,_p,tt,Tp,Sp,Pp,at,Ip,Us,jp,Op,U,Cp,et,Ap,Dp,nt,Hp,Lp,qa,Up,Np,Va,Wp,Mp,Rp,$a,qp,Vp,Ns,Ba,$p,Bp,Ja,Jp,Yp,as,Gp,rt,Kp,Fp,Ya,Qp,zp,Zp,Ga,Xp,we,x,Ka,Ws,sc,oc,Fa,tc,ac,lt,td=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">UserComponent</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,ec,Qa,nc,rc,it,ad=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">UserComponent</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">scheduleUpdate</span><span style="color: var(--shiki-color-text)">(); </span><span style="color: var(--shiki-token-comment)">// &lt;-- insert this during compilation</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,lc,za,ic,pc,Ms,cc,pt,hc,kc,yc,ct,ed=`<pre class="shiki" style="background-color: var(--shiki-color-background)"><code><span class="line"><span style="color: var(--shiki-token-keyword)">class</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">UserComponent</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  </span><span style="color: var(--shiki-token-function)">someHandler</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// &lt;-- \u2705changes to application state</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.foo </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;bar&#39;</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// &lt;-- \u26D4\uFE0F not changing application state</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">const</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">foo</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.appState;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">foo</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// \u{1F937}\u200D\u2642\uFE0Fdo we know that this is changing application state?</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-function)">doSomethingMutable</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.appState);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-keyword)">function</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-function)">doSomethingMutable</span><span style="color: var(--shiki-color-text)">(foo) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-constant)">foo</span><span style="color: var(--shiki-color-text)">.one </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// \u{1F937}\u200D\u2642\uFE0Fdo we know that this is changing application state?</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.obj </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      data</span><span style="color: var(--shiki-token-keyword)">:</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-function)">increment</span><span style="color: var(--shiki-color-text)">() &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.data </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.data </span><span style="color: var(--shiki-token-keyword)">+</span><span style="color: var(--shiki-color-text)"> </span><span style="color: var(--shiki-token-constant)">1</span><span style="color: var(--shiki-color-text)">; </span><span style="color: var(--shiki-token-comment)">// \u{1F937}\u200D\u2642\uFE0Fdo we know that this is changing application state?</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">obj</span><span style="color: var(--shiki-token-function)">.increment</span><span style="color: var(--shiki-color-text)">();</span></span>
<span class="line"></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">data</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">); </span><span style="color: var(--shiki-token-comment)">// \u{1F937}\u200D\u2642\uFE0Fis push mutable?</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-color-text)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-color-text)">.list </span><span style="color: var(--shiki-token-keyword)">=</span><span style="color: var(--shiki-color-text)"> &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      </span><span style="color: var(--shiki-token-function)">push</span><span style="color: var(--shiki-color-text)">(item) &#123;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">        </span><span style="color: var(--shiki-token-constant)">console</span><span style="color: var(--shiki-token-function)">.log</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;nothing change&#39;</span><span style="color: var(--shiki-color-text)">);</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">      &#125;</span><span style="color: var(--shiki-token-punctuation)">,</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    &#125;;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">    </span><span style="color: var(--shiki-token-constant)">this</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">appState</span><span style="color: var(--shiki-token-function)">.</span><span style="color: var(--shiki-token-constant)">list</span><span style="color: var(--shiki-token-function)">.push</span><span style="color: var(--shiki-color-text)">(</span><span style="color: var(--shiki-token-string-expression)">&#39;1&#39;</span><span style="color: var(--shiki-color-text)">); </span><span style="color: var(--shiki-token-comment)">// \u{1F937}\u200D\u2642\uFE0Fis this push mutable?</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">  &#125;</span></span>
<span class="line"><span style="color: var(--shiki-color-text)">&#125;</span></span></code></pre>`,vc,Za,dc,uc,Rs,$,fc,ht,xc,wc,kt,mc,gc,yt,bc,Ec,qs,_c,vt,Tc,Sc,Pc,A,Ic,Vs,jc,Oc,dt,Cc,Ac,ut,Dc,Hc,ft,Lc,Uc,xt,Nc,Wc,Mc,$s,Rc,Bs,qc,Vc,me,E,Xa,Js,$c,Bc,se,Jc,Yc,es,oe,Gc,Kc,wt,Fc,mt,Qc,zc,te,Zc,Xc,ae,sh,oh,Ys,ee,Gs,th,gt,ah,eh,nh,ns,ne,rh,lh,re,ih,ph,Ks,le,ch,hh,ie,kh,yh,pe,vh,dh,ce,uh,fh,Fs,xh,he,wh,mh,gh,bh,Eh,Qs,_h,zs,Th,Sh,ge;return g=new Cd({props:{data:[{link:"the-when",title:"the WHEN"},{link:"mutation-tracking",title:"Mutation Tracking",nested:[{link:"prior-proxy",title:"Prior Proxy"},{link:"with-proxy",title:"With Proxy"},{link:"just-call-scheduleupdate",title:"Just call  `scheduleUpdate`"},{link:"static-analysis",title:"Static analysis"}]},{link:"summary",title:"Summary"}]}}),{c(){Hv(g.$$.fragment),W=l(),v=e("section"),K=e("h1"),b=e("a"),M=t("What is Reactivity?"),oo=l(),Dt=e("p"),$e=t("Reactivity is the ability of a web framework to update your view whenever the application state has changed."),Be=l(),Ht=e("p"),Je=t("It is the core of any modern web framework."),Ye=l(),Lt=e("p"),Ge=t("To understand what reactivity is, let\u2019s look at an example counter app."),Ke=l(),Ut=e("p"),Fe=t("This is how you would write in plain JavaScript:"),Qe=l(),to=e("div"),ze=l(),Nt=e("p"),Ze=t("This is how you would do it in Vue:"),Xe=l(),ao=e("div"),sn=l(),Wt=e("p"),on=t("\u2026 and this in React:"),tn=l(),eo=e("div"),an=l(),F=e("p"),en=t("Notice that with a web framework, your code focus more on "),Mt=e("em"),Rt=e("u"),nn=t("updating the application state based on business requirements"),rn=t(" and "),qt=e("em"),Vt=e("u"),ln=t("describing how our view looks like using templating language or JSX expression"),pn=t(`.
The framework will bridge the application state and the view, updating the view whenever the application state changes.`),cn=l(),Q=e("p"),hn=t("No more pesky DOM manipulation statements ("),no=e("code"),kn=t("span.innerText = counter"),yn=t(") sprinkled alongside with state update statements ("),ro=e("code"),vn=t("counter ++;"),dn=t("). No more elusive bugs of unsynchronized view and application state, when one forgets to update the view when updating the application state."),un=l(),$t=e("p"),fn=t("All these problems are now past tense when web frameworks now ship in reactivity by default, always making sure that the view is up to date of the application state changes."),xn=l(),Bt=e("p"),wn=t("So the main idea we are going to discuss next is,"),mn=l(),Jt=e("blockquote"),Yt=e("p"),gn=t("How do web frameworks achieve reactivity?"),ye=l(),D=e("section"),Gt=e("h1"),hs=e("a"),bn=t("The WHEN and the WHAT"),En=l(),Kt=e("p"),_n=t("To achieve reactivity, the framework has to answer 2 questions"),Tn=l(),ks=e("ul"),Ft=e("li"),Sn=t("When does the application state change?"),Pn=l(),Qt=e("li"),In=t("What has the application state changed?"),jn=l(),rs=e("p"),zt=e("strong"),On=t("The WHEN"),Cn=t(" answers when the framework needs to start to do its job on updating the view. Knowing "),Zt=e("strong"),An=t("the WHAT"),Dn=t(", allows the framework to optimise it's work, only update part of the view that has changed."),Hn=l(),H=e("p"),Ln=t("We are going to discuss different strategies to determine "),Xt=e("strong"),Un=t("the WHEN"),Nn=t(" and "),sa=e("strong"),Wn=t("the WHAT"),Mn=t(", along with code snippets for each strategy. You could combine different strategies to determine "),oa=e("strong"),Rn=t("the WHEN"),qn=t(" and "),ta=e("strong"),Vn=t("the WHAT"),$n=t(", yet certain combinations may remind you of some of the popular web frameworks."),ve=l(),S=e("section"),aa=e("h2"),ys=e("a"),Bn=t("the WHEN"),Jn=l(),ea=e("p"),Yn=t("The WHEN notifies the framework that the application state has changed, so that the framework knows that it needs to do its job to update the view."),Gn=l(),L=e("p"),Kn=t("Different frameworks employ different strategies to detect when the application state has changed, but in essence, it usually boils down to calling a "),lo=e("code"),Fn=t("scheduleUpdate()"),Qn=t(` in the framework.
`),io=e("code"),zn=t("scheduleUpdate"),Zn=t(" is usually a debounced "),po=e("code"),Xn=t("update"),sr=t(" function of the framework. Because changes in the application state may cause derived state changes, or the framework user may change different parts of the application state consecutively. If the framework updates the view on every state change, it may change the view too frequent, which may be inefficient, or it may have an inconsistent view ("),vs=e("a"),or=t("may result in tearing"),tr=t(")."),ar=l(),na=e("p"),er=t("Imagine this contrived React example:"),nr=l(),co=e("div"),rr=l(),ho=e("p"),lr=t("If the framework synchronously updates the todos in the view then updates the total todos count, it may have a split second where the todos and the count go out of sync. "),ra=e("em"),ir=t("(Although it may seem impossible even in this contrived example, but you get the point. )"),pr=l(),la=e("blockquote"),V=e("p"),cr=t("By the way, you should not set "),ko=e("code"),hr=t("totalTodos"),kr=t(" this way, you should derived it from "),yo=e("code"),yr=t("todos.length"),vr=t(", see "),ds=e("a"),dr=t(`"Don't Sync State. Derive it!" by Kent C. Dodds.`),ur=l(),ia=e("p"),fr=t("So how do you know when the application state has changed?"),de=l(),u=e("section"),pa=e("h2"),us=e("a"),xr=t("Mutation Tracking"),wr=l(),ca=e("p"),mr=t("So we want to know when the application state has changed? Let\u2019s track it!"),gr=l(),ha=e("p"),br=t("First of all, why is it called mutation tracking? That\u2019s because we can only track mutation."),Er=l(),ka=e("p"),_r=t("By the word mutation, it infers that our application state has to be an object, because you can\u2019t mutate a primitive."),Tr=l(),ya=e("p"),Sr=t("Primitives like numbers, string, boolean, are passed by value into a function. So, if you reassign the primitive to another value, the reassignment will never be able to be observed within the function:"),Pr=l(),vo=e("div"),Ir=l(),va=e("p"),jr=t("Object on the other hand, is passed by reference. So any changes to the same object can be observed from within:"),Or=l(),uo=e("div"),Cr=l(),R=e("p"),Ar=t("This is also why most frameworks\u2019 application state is accessed via "),fo=e("code"),Dr=t("this"),Hr=t(", because "),xo=e("code"),Lr=t("this"),Ur=t(" is an object, changes to "),wo=e("code"),Nr=t("this.appState"),Wr=t(" can be observed / tracked by the framework."),Mr=l(),da=e("p"),Rr=t("Now we understand why is it called mutation tracking, let\u2019s take a look at how mutation tracking is implemented."),qr=l(),ua=e("p"),Vr=t("We are going to look at the two common types of object in JavaScript, the plain object and the array."),$r=l(),mo=e("p"),z=e("em"),Br=t("(Though if you "),go=e("code"),Jr=t("typeof"),Yr=t(" for both object or array, they are both "),bo=e("code"),Gr=t('"object"'),Kr=t(")"),Fr=t("."),Qr=l(),fa=e("p"),zr=t("With the introduction of ES6 Proxy, the mutation tracking method has become much straightforward. But still, let\u2019s take a look at how you can implement a mutation tracking with / without ES6 Proxy."),ue=l(),d=e("section"),xa=e("h3"),fs=e("a"),Zr=t("Prior Proxy"),Xr=l(),wa=e("p"),sl=t("To track mutation without proxy, we can define a custom getters and setters for all the property of the object. So whenever the framework user changes the value of a property, the custom setter will be called, and we will know that something has changed:"),ol=l(),Eo=e("div"),tl=l(),xs=e("p"),al=t("Inspired by "),ws=e("a"),el=t("Vue.js 2.0\u2019s observer"),nl=t("."),rl=l(),ma=e("p"),ll=t("However, you may notice that if we are defining getters and setters on the existing properties of the object, we may miss out changes via adding or deleting property from the object."),il=l(),Z=e("p"),pl=t("This is something you can\u2019t fix without a better JavaScript API, so a probable workaround for this caveat is to provide a helper function instead. For example, in Vue, you need to use the helper function "),ms=e("a"),_o=e("code"),cl=t("Vue.set(object, propertyName, value)"),hl=t(" instead of "),To=e("code"),kl=t("object[propertyName] = value"),yl=t("."),vl=l(),I=e("p"),dl=t("Tracking mutation of an array is similar to mutation tracking for an object. However, besides being able to change the array item through assignment, it is possible to mutate an array through its mutating method, eg: "),So=e("code"),ul=t("push"),fl=t(", "),Po=e("code"),xl=t("pop"),wl=t(", "),Io=e("code"),ml=t("splice"),gl=t(", "),jo=e("code"),bl=t("unshift"),El=t(", "),Oo=e("code"),_l=t("shift"),Tl=t(", "),Co=e("code"),Sl=t("sort"),Pl=t(" and "),Ao=e("code"),Il=t("reverse"),jl=t("."),Ol=l(),ga=e("p"),Cl=t("To track changes made by these methods, you have to patch them:"),Al=l(),Do=e("div"),Dl=l(),gs=e("p"),Hl=t("Inspired by "),bs=e("a"),Ll=t("Vue.js 2.0\u2019s array observer"),Ul=t("."),Nl=l(),ba=e("blockquote"),Ho=e("p"),Wl=t("CodeSandbox for "),Es=e("a"),Ml=t("mutation tracking of object and array"),Rl=l(),Ea=e("p"),ql=t("In summary, to track mutation on an object or array without Proxy, you need to define custom getters/setters for all properties, so that you can capture when the property is being set. Besides that, you need to patch all the mutating methods as well, because that will mutate your object without triggering the custom setter."),Vl=l(),_a=e("p"),$l=t("Yet, there\u2019s still edge cases that cannot be covered, such as adding new property or deleting property."),Bl=l(),_s=e("p"),Jl=t("There\u2019s where "),Ts=e("a"),Yl=t("ES6 Proxy"),Gl=t(" comes to help."),fe=l(),f=e("section"),Ta=e("h3"),Ss=e("a"),Kl=t("With Proxy"),Fl=l(),X=e("p"),Ql=t("Proxy allow us to define custom behaviours on fundamental operations on the target object. This is great for mutation tracking, because Proxy allow us to intercept setting and deleting property, irrelevant to whether we uses index assignment, "),Lo=e("code"),zl=t("obj[key] = value"),Zl=t(" or mutating methods, "),Uo=e("code"),Xl=t("obj.push(value)"),si=t(":"),oi=l(),No=e("div"),ti=l(),Sa=e("p"),Pa=e("strong"),ai=t("So how do we use mutation tracking?"),ei=l(),Ps=e("p"),ni=t("The good thing about mutation tracking is that, if you noticed in the example above, the framework user is unaware of the tracking and treats "),Wo=e("code"),ri=t("appState"),li=t(" as a normal object:"),ii=l(),Mo=e("div"),pi=l(),Ia=e("p"),ci=t("We can set up the tracking during the initialisation of the component, either:"),hi=l(),ss=e("ul"),ja=e("li"),ki=t("track a property of the component,"),yi=l(),Oa=e("li"),vi=t("track the component instance itself,"),di=l(),Ca=e("li"),ui=t("or something in between the above"),fi=l(),Ro=e("div"),xi=l(),os=e("p"),wi=t("Once you\u2019ve able to track application state changes, the next thing to do is to call "),qo=e("code"),mi=t("scheduleUpdate"),gi=t(" instead of "),Vo=e("code"),bi=t("console.log"),Ei=t("."),_i=l(),Is=e("p"),Ti=t("You may concern whether all these complexities is worth the effort. Or you may be worried that "),js=e("a"),Si=t("Proxy is not supported to older browsers"),Pi=t("."),Ii=l(),Aa=e("p"),ji=t("Your concern is not entirely baseless. Not all frameworks use mutation tracking."),xe=l(),h=e("section"),Da=e("h3"),ls=e("a"),Oi=t("Just call "),$o=e("code"),Ci=t("scheduleUpdate"),Ai=l(),Ha=e("p"),Di=t("Some frameworks design their API in the way such that it \u201Ctricks\u201D the framework user to tell the framework that the application state has changed."),Hi=l(),Os=e("p"),Li=t("Instead of remembering to call "),Bo=e("code"),Ui=t("scheduleUpdate"),Ni=t(" whenever you change the application state, the framework forces you to use their API to change application state:"),Wi=l(),Jo=e("div"),Mi=l(),La=e("p"),Ri=t("This gives us a much simpler design and less edge case to handle:"),qi=l(),Yo=e("div"),Vi=l(),Cs=e("p"),$i=t("Inspired by "),is=e("a"),Bi=t("React\u2019s "),Go=e("code"),Ji=t("setState"),Yi=t("."),Gi=l(),Ua=e("p"),Ki=t("However, this may trip new developers into the framework:"),Fi=l(),Ko=e("div"),Qi=l(),Na=e("p"),zi=t("... and it maybe a bit clumsy when adding / removing items from an array:"),Zi=l(),Fo=e("div"),Xi=l(),As=e("p"),sp=t("A different approach that may have the best of both world is to insert "),Qo=e("code"),op=t("scheduleUpdate"),tp=t(" in scenarios that you think that changes may most likely happen:"),ap=l(),q=e("ul"),Wa=e("li"),ep=t("Event handlers"),np=l(),ts=e("li"),rp=t("Timeout (eg: "),zo=e("code"),lp=t("setTimeout"),ip=t(", "),Zo=e("code"),pp=t("setInterval"),cp=t(", ...)"),hp=l(),Ma=e("li"),kp=t("API handling, promises handling"),yp=l(),Ra=e("li"),vp=t("..."),dp=l(),Ds=e("p"),up=t("So, instead of enforcing framework users to use "),Xo=e("code"),fp=t("setAppState()"),xp=t(`, framework users should use the
custom timeouts, api handlers, ...:`),wp=l(),st=e("div"),mp=l(),ot=e("p"),gp=t("Inspired by "),Hs=e("a"),bp=t("AngularJS\u2019s \\$timeout"),Ep=l(),Ls=e("p"),_p=t("Your framework user can now be free to change the application state the way he wants, as long as the changes are done within your custom handlers. Because at the end of the handler, you will call "),tt=e("code"),Tp=t("scheduleUpdate()"),Sp=t("."),Pp=l(),at=e("p"),Ip=t("Similarly, this may trip new developers into the framework too! Try search "),Us=e("a"),jp=t('"AngularJS $timeout vs window.setTimeout"'),Op=l(),U=e("p"),Cp=t("You may think, what if there are no state changes in the handler function, wouldn\u2019t calling an extra "),et=e("code"),Ap=t("scheduleUpdate()"),Dp=t(" be inefficient? Well so far, we haven\u2019t discussed what\u2019s happening in "),nt=e("code"),Hp=t("scheduleUpdate()"),Lp=t(", we can check "),qa=e("strong"),Up=t("what has changed"),Np=t(" (which will be covered in the next section)"),Va=e("strong"),Wp=t(","),Mp=t(" and if there\u2019s nothing change, we can skip the subsequent steps."),Rp=l(),$a=e("p"),qp=t("If you look at the strategies that we have tried so far, you may have noticed a common struggle:"),Vp=l(),Ns=e("ul"),Ba=e("li"),$p=t("allow framework user to change the application state in any way he wants"),Bp=l(),Ja=e("li"),Jp=t("achieve reactivity without much runtime complexity."),Yp=l(),as=e("p"),Gp=t("At this point, you got to agree that enforcing framework developers to call "),rt=e("code"),Kp=t("setAppState"),Fp=t(" whenever they want to change the application state, requires "),Ya=e("strong"),Qp=t("less runtime complexity"),zp=t(" from the framework, and it\u2019s unlikely to have any corner cases or caveats that need to handle."),Zp=l(),Ga=e("p"),Xp=t("If the dilemma is between developer expressiveness versus runtime complexity, probably we could get the best of both worlds by shifting the complexity from runtime to build time?"),we=l(),x=e("section"),Ka=e("h3"),Ws=e("a"),sc=t("Static analysis"),oc=l(),Fa=e("p"),tc=t("If we have a compiler that allow framework users to write:"),ac=l(),lt=e("div"),ec=l(),Qa=e("p"),nc=t("and compiles it to:"),rc=l(),it=e("div"),lc=l(),za=e("p"),ic=t("Then, we would really have best of both worlds! \u{1F60E}"),pc=l(),Ms=e("p"),cc=t("Let\u2019s look at different scenarios that the framework user would write, and see whether we know when to insert the "),pt=e("code"),hc=t("scheduleUpdate()"),kc=t(":"),yc=l(),ct=e("div"),vc=l(),Za=e("p"),dc=t("Allow me to summarise some complexities faced in the example above:"),uc=l(),Rs=e("ul"),$=e("li"),fc=t("It is easy to track direct changes to the application state, but it is extremely difficult to track changes made indirectly, eg: "),ht=e("code"),xc=t("foo.one"),wc=t(", "),kt=e("code"),mc=t("doSomethingMutable(this.appState)"),gc=t(" or "),yt=e("code"),bc=t("this.appState.obj.increment()"),Ec=l(),qs=e("li"),_c=t("It is easy to track changes through assignment statements, but extremely difficult to track changes made through mutating methods, eg: "),vt=e("code"),Tc=t("this.appState.list.push('1')"),Sc=t(", I mean how do you know the method is mutating?"),Pc=l(),A=e("p"),Ic=t("So, for "),Vs=e("a"),jc=t("Svelte"),Oc=t(", one of the frameworks that use static analysis to achieve reactivity, it only ensures reactivity through assignment operators (eg: "),dt=e("code"),Cc=t("="),Ac=t(", "),ut=e("code"),Dc=t("+="),Hc=t(", \u2026) and unary arithmetic operators (eg: "),ft=e("code"),Lc=t("++"),Uc=t(" and "),xt=e("code"),Nc=t("--"),Wc=t(")."),Mc=l(),$s=e("p"),Rc=t("I believe that there\u2019s room yet to be explored in this space, especially at the "),Bs=e("a"),qc=t("rise of TypeScript"),Vc=t(", we may be able to understand our application state better through static types."),me=l(),E=e("section"),Xa=e("h2"),Js=e("a"),$c=t("Summary"),Bc=l(),se=e("p"),Jc=t("We\u2019ve gone through different strategies of knowing when the application state has changed:"),Yc=l(),es=e("ul"),oe=e("li"),Gc=t("mutation tracking"),Kc=l(),wt=e("li"),Fc=t("just call "),mt=e("code"),Qc=t("scheduleUpdate"),zc=l(),te=e("li"),Zc=t("static analysis"),Xc=l(),ae=e("p"),sh=t("Different strategies manifests itself in terms of the API of the framework:"),oh=l(),Ys=e("ul"),ee=e("li"),Gs=e("p"),th=t("Is the framework user going to change the application state with simple object manipulation? or have to use API like "),gt=e("code"),ah=t("setAppState()"),eh=t("?"),nh=l(),ns=e("li"),ne=e("p"),rh=t("Is there caveats that the framework user needs to be aware of?"),lh=l(),re=e("p"),ih=t("For example:"),ph=l(),Ks=e("ul"),le=e("li"),ch=t("Can only use assignment statement to achieve reactivity?"),hh=l(),ie=e("li"),kh=t("Does framework user need to use a helper function for adding new reactive property to the application state?"),yh=l(),pe=e("p"),vh=t("Knowing when an application state has changed, allow frameworks to know when to update our view. Yet, to optimise the updates, frameworks need to know what has changed in the application state."),dh=l(),ce=e("p"),uh=t("Are we going to remove and recreate every DOM element in the view? Do we know that which part of the view is going to change based on what has changed in the application state?"),fh=l(),Fs=e("p"),xh=t("That is, if we know "),he=e("strong"),wh=t("the WHAT"),mh=t("."),gh=l(),bh=e("hr"),Eh=l(),Qs=e("p"),_h=t("I\u2019d like to thank "),zs=e("a"),Th=t("Rich Harris"),Sh=t(" for pointing out some inaccuracies in the previous version of this article and providing valuable feedbacks. All the remaining errors are mine.."),this.h()},l(c){Lv(g.$$.fragment,c),W=i(c),v=n(c,"SECTION",{});var k=r(v);K=n(k,"H1",{});var Uh=r(K);b=n(Uh,"A",{href:!0,id:!0});var Nh=r(b);M=a(Nh,"What is Reactivity?"),Nh.forEach(o),Uh.forEach(o),oo=i(k),Dt=n(k,"P",{});var Wh=r(Dt);$e=a(Wh,"Reactivity is the ability of a web framework to update your view whenever the application state has changed."),Wh.forEach(o),Be=i(k),Ht=n(k,"P",{});var Mh=r(Ht);Je=a(Mh,"It is the core of any modern web framework."),Mh.forEach(o),Ye=i(k),Lt=n(k,"P",{});var Rh=r(Lt);Ge=a(Rh,"To understand what reactivity is, let\u2019s look at an example counter app."),Rh.forEach(o),Ke=i(k),Ut=n(k,"P",{});var qh=r(Ut);Fe=a(qh,"This is how you would write in plain JavaScript:"),qh.forEach(o),Qe=i(k),to=n(k,"DIV",{class:!0});var nd=r(to);nd.forEach(o),ze=i(k),Nt=n(k,"P",{});var Vh=r(Nt);Ze=a(Vh,"This is how you would do it in Vue:"),Vh.forEach(o),Xe=i(k),ao=n(k,"DIV",{class:!0});var rd=r(ao);rd.forEach(o),sn=i(k),Wt=n(k,"P",{});var $h=r(Wt);on=a($h,"\u2026 and this in React:"),$h.forEach(o),tn=i(k),eo=n(k,"DIV",{class:!0});var ld=r(eo);ld.forEach(o),an=i(k),F=n(k,"P",{});var bt=r(F);en=a(bt,"Notice that with a web framework, your code focus more on "),Mt=n(bt,"EM",{});var Bh=r(Mt);Rt=n(Bh,"U",{});var Jh=r(Rt);nn=a(Jh,"updating the application state based on business requirements"),Jh.forEach(o),Bh.forEach(o),rn=a(bt," and "),qt=n(bt,"EM",{});var Yh=r(qt);Vt=n(Yh,"U",{});var Gh=r(Vt);ln=a(Gh,"describing how our view looks like using templating language or JSX expression"),Gh.forEach(o),Yh.forEach(o),pn=a(bt,`.
The framework will bridge the application state and the view, updating the view whenever the application state changes.`),bt.forEach(o),cn=i(k),Q=n(k,"P",{});var Et=r(Q);hn=a(Et,"No more pesky DOM manipulation statements ("),no=n(Et,"CODE",{class:!0});var Kh=r(no);kn=a(Kh,"span.innerText = counter"),Kh.forEach(o),yn=a(Et,") sprinkled alongside with state update statements ("),ro=n(Et,"CODE",{class:!0});var Fh=r(ro);vn=a(Fh,"counter ++;"),Fh.forEach(o),dn=a(Et,"). No more elusive bugs of unsynchronized view and application state, when one forgets to update the view when updating the application state."),Et.forEach(o),un=i(k),$t=n(k,"P",{});var Qh=r($t);fn=a(Qh,"All these problems are now past tense when web frameworks now ship in reactivity by default, always making sure that the view is up to date of the application state changes."),Qh.forEach(o),xn=i(k),Bt=n(k,"P",{});var zh=r(Bt);wn=a(zh,"So the main idea we are going to discuss next is,"),zh.forEach(o),mn=i(k),Jt=n(k,"BLOCKQUOTE",{});var Zh=r(Jt);Yt=n(Zh,"P",{});var Xh=r(Yt);gn=a(Xh,"How do web frameworks achieve reactivity?"),Xh.forEach(o),Zh.forEach(o),k.forEach(o),ye=i(c),D=n(c,"SECTION",{});var B=r(D);Gt=n(B,"H1",{});var sk=r(Gt);hs=n(sk,"A",{href:!0,id:!0});var ok=r(hs);bn=a(ok,"The WHEN and the WHAT"),ok.forEach(o),sk.forEach(o),En=i(B),Kt=n(B,"P",{});var tk=r(Kt);_n=a(tk,"To achieve reactivity, the framework has to answer 2 questions"),tk.forEach(o),Tn=i(B),ks=n(B,"UL",{});var be=r(ks);Ft=n(be,"LI",{});var ak=r(Ft);Sn=a(ak,"When does the application state change?"),ak.forEach(o),Pn=i(be),Qt=n(be,"LI",{});var ek=r(Qt);In=a(ek,"What has the application state changed?"),ek.forEach(o),be.forEach(o),jn=i(B),rs=n(B,"P",{});var ke=r(rs);zt=n(ke,"STRONG",{});var nk=r(zt);On=a(nk,"The WHEN"),nk.forEach(o),Cn=a(ke," answers when the framework needs to start to do its job on updating the view. Knowing "),Zt=n(ke,"STRONG",{});var rk=r(Zt);An=a(rk,"the WHAT"),rk.forEach(o),Dn=a(ke,", allows the framework to optimise it's work, only update part of the view that has changed."),ke.forEach(o),Hn=i(B),H=n(B,"P",{});var J=r(H);Ln=a(J,"We are going to discuss different strategies to determine "),Xt=n(J,"STRONG",{});var lk=r(Xt);Un=a(lk,"the WHEN"),lk.forEach(o),Nn=a(J," and "),sa=n(J,"STRONG",{});var ik=r(sa);Wn=a(ik,"the WHAT"),ik.forEach(o),Mn=a(J,", along with code snippets for each strategy. You could combine different strategies to determine "),oa=n(J,"STRONG",{});var pk=r(oa);Rn=a(pk,"the WHEN"),pk.forEach(o),qn=a(J," and "),ta=n(J,"STRONG",{});var ck=r(ta);Vn=a(ck,"the WHAT"),ck.forEach(o),$n=a(J,", yet certain combinations may remind you of some of the popular web frameworks."),J.forEach(o),B.forEach(o),ve=i(c),S=n(c,"SECTION",{});var O=r(S);aa=n(O,"H2",{});var hk=r(aa);ys=n(hk,"A",{href:!0,id:!0});var kk=r(ys);Bn=a(kk,"the WHEN"),kk.forEach(o),hk.forEach(o),Jn=i(O),ea=n(O,"P",{});var yk=r(ea);Yn=a(yk,"The WHEN notifies the framework that the application state has changed, so that the framework knows that it needs to do its job to update the view."),yk.forEach(o),Gn=i(O),L=n(O,"P",{});var Y=r(L);Kn=a(Y,"Different frameworks employ different strategies to detect when the application state has changed, but in essence, it usually boils down to calling a "),lo=n(Y,"CODE",{class:!0});var vk=r(lo);Fn=a(vk,"scheduleUpdate()"),vk.forEach(o),Qn=a(Y,` in the framework.
`),io=n(Y,"CODE",{class:!0});var dk=r(io);zn=a(dk,"scheduleUpdate"),dk.forEach(o),Zn=a(Y," is usually a debounced "),po=n(Y,"CODE",{class:!0});var uk=r(po);Xn=a(uk,"update"),uk.forEach(o),sr=a(Y," function of the framework. Because changes in the application state may cause derived state changes, or the framework user may change different parts of the application state consecutively. If the framework updates the view on every state change, it may change the view too frequent, which may be inefficient, or it may have an inconsistent view ("),vs=n(Y,"A",{href:!0,rel:!0});var fk=r(vs);or=a(fk,"may result in tearing"),fk.forEach(o),tr=a(Y,")."),Y.forEach(o),ar=i(O),na=n(O,"P",{});var xk=r(na);er=a(xk,"Imagine this contrived React example:"),xk.forEach(o),nr=i(O),co=n(O,"DIV",{class:!0});var id=r(co);id.forEach(o),rr=i(O),ho=n(O,"P",{});var Ph=r(ho);lr=a(Ph,"If the framework synchronously updates the todos in the view then updates the total todos count, it may have a split second where the todos and the count go out of sync. "),ra=n(Ph,"EM",{});var wk=r(ra);ir=a(wk,"(Although it may seem impossible even in this contrived example, but you get the point. )"),wk.forEach(o),Ph.forEach(o),pr=i(O),la=n(O,"BLOCKQUOTE",{});var mk=r(la);V=n(mk,"P",{});var Zs=r(V);cr=a(Zs,"By the way, you should not set "),ko=n(Zs,"CODE",{class:!0});var gk=r(ko);hr=a(gk,"totalTodos"),gk.forEach(o),kr=a(Zs," this way, you should derived it from "),yo=n(Zs,"CODE",{class:!0});var bk=r(yo);yr=a(bk,"todos.length"),bk.forEach(o),vr=a(Zs,", see "),ds=n(Zs,"A",{href:!0,rel:!0});var Ek=r(ds);dr=a(Ek,`"Don't Sync State. Derive it!" by Kent C. Dodds.`),Ek.forEach(o),Zs.forEach(o),mk.forEach(o),ur=i(O),ia=n(O,"P",{});var _k=r(ia);fr=a(_k,"So how do you know when the application state has changed?"),_k.forEach(o),O.forEach(o),de=i(c),u=n(c,"SECTION",{});var m=r(u);pa=n(m,"H2",{});var Tk=r(pa);us=n(Tk,"A",{href:!0,id:!0});var Sk=r(us);xr=a(Sk,"Mutation Tracking"),Sk.forEach(o),Tk.forEach(o),wr=i(m),ca=n(m,"P",{});var Pk=r(ca);mr=a(Pk,"So we want to know when the application state has changed? Let\u2019s track it!"),Pk.forEach(o),gr=i(m),ha=n(m,"P",{});var Ik=r(ha);br=a(Ik,"First of all, why is it called mutation tracking? That\u2019s because we can only track mutation."),Ik.forEach(o),Er=i(m),ka=n(m,"P",{});var jk=r(ka);_r=a(jk,"By the word mutation, it infers that our application state has to be an object, because you can\u2019t mutate a primitive."),jk.forEach(o),Tr=i(m),ya=n(m,"P",{});var Ok=r(ya);Sr=a(Ok,"Primitives like numbers, string, boolean, are passed by value into a function. So, if you reassign the primitive to another value, the reassignment will never be able to be observed within the function:"),Ok.forEach(o),Pr=i(m),vo=n(m,"DIV",{class:!0});var pd=r(vo);pd.forEach(o),Ir=i(m),va=n(m,"P",{});var Ck=r(va);jr=a(Ck,"Object on the other hand, is passed by reference. So any changes to the same object can be observed from within:"),Ck.forEach(o),Or=i(m),uo=n(m,"DIV",{class:!0});var cd=r(uo);cd.forEach(o),Cr=i(m),R=n(m,"P",{});var ps=r(R);Ar=a(ps,"This is also why most frameworks\u2019 application state is accessed via "),fo=n(ps,"CODE",{class:!0});var Ak=r(fo);Dr=a(Ak,"this"),Ak.forEach(o),Hr=a(ps,", because "),xo=n(ps,"CODE",{class:!0});var Dk=r(xo);Lr=a(Dk,"this"),Dk.forEach(o),Ur=a(ps," is an object, changes to "),wo=n(ps,"CODE",{class:!0});var Hk=r(wo);Nr=a(Hk,"this.appState"),Hk.forEach(o),Wr=a(ps," can be observed / tracked by the framework."),ps.forEach(o),Mr=i(m),da=n(m,"P",{});var Lk=r(da);Rr=a(Lk,"Now we understand why is it called mutation tracking, let\u2019s take a look at how mutation tracking is implemented."),Lk.forEach(o),qr=i(m),ua=n(m,"P",{});var Uk=r(ua);Vr=a(Uk,"We are going to look at the two common types of object in JavaScript, the plain object and the array."),Uk.forEach(o),$r=i(m),mo=n(m,"P",{});var Ih=r(mo);z=n(Ih,"EM",{});var _t=r(z);Br=a(_t,"(Though if you "),go=n(_t,"CODE",{class:!0});var Nk=r(go);Jr=a(Nk,"typeof"),Nk.forEach(o),Yr=a(_t," for both object or array, they are both "),bo=n(_t,"CODE",{class:!0});var Wk=r(bo);Gr=a(Wk,'"object"'),Wk.forEach(o),Kr=a(_t,")"),_t.forEach(o),Fr=a(Ih,"."),Ih.forEach(o),Qr=i(m),fa=n(m,"P",{});var Mk=r(fa);zr=a(Mk,"With the introduction of ES6 Proxy, the mutation tracking method has become much straightforward. But still, let\u2019s take a look at how you can implement a mutation tracking with / without ES6 Proxy."),Mk.forEach(o),m.forEach(o),ue=i(c),d=n(c,"SECTION",{});var w=r(d);xa=n(w,"H3",{});var Rk=r(xa);fs=n(Rk,"A",{href:!0,id:!0});var qk=r(fs);Zr=a(qk,"Prior Proxy"),qk.forEach(o),Rk.forEach(o),Xr=i(w),wa=n(w,"P",{});var Vk=r(wa);sl=a(Vk,"To track mutation without proxy, we can define a custom getters and setters for all the property of the object. So whenever the framework user changes the value of a property, the custom setter will be called, and we will know that something has changed:"),Vk.forEach(o),ol=i(w),Eo=n(w,"DIV",{class:!0});var hd=r(Eo);hd.forEach(o),tl=i(w),xs=n(w,"P",{});var Ee=r(xs);al=a(Ee,"Inspired by "),ws=n(Ee,"A",{href:!0,rel:!0});var $k=r(ws);el=a($k,"Vue.js 2.0\u2019s observer"),$k.forEach(o),nl=a(Ee,"."),Ee.forEach(o),rl=i(w),ma=n(w,"P",{});var Bk=r(ma);ll=a(Bk,"However, you may notice that if we are defining getters and setters on the existing properties of the object, we may miss out changes via adding or deleting property from the object."),Bk.forEach(o),il=i(w),Z=n(w,"P",{});var Tt=r(Z);pl=a(Tt,"This is something you can\u2019t fix without a better JavaScript API, so a probable workaround for this caveat is to provide a helper function instead. For example, in Vue, you need to use the helper function "),ms=n(Tt,"A",{href:!0,rel:!0});var Jk=r(ms);_o=n(Jk,"CODE",{class:!0});var Yk=r(_o);cl=a(Yk,"Vue.set(object, propertyName, value)"),Yk.forEach(o),Jk.forEach(o),hl=a(Tt," instead of "),To=n(Tt,"CODE",{class:!0});var Gk=r(To);kl=a(Gk,"object[propertyName] = value"),Gk.forEach(o),yl=a(Tt,"."),Tt.forEach(o),vl=i(w),I=n(w,"P",{});var C=r(I);dl=a(C,"Tracking mutation of an array is similar to mutation tracking for an object. However, besides being able to change the array item through assignment, it is possible to mutate an array through its mutating method, eg: "),So=n(C,"CODE",{class:!0});var Kk=r(So);ul=a(Kk,"push"),Kk.forEach(o),fl=a(C,", "),Po=n(C,"CODE",{class:!0});var Fk=r(Po);xl=a(Fk,"pop"),Fk.forEach(o),wl=a(C,", "),Io=n(C,"CODE",{class:!0});var Qk=r(Io);ml=a(Qk,"splice"),Qk.forEach(o),gl=a(C,", "),jo=n(C,"CODE",{class:!0});var zk=r(jo);bl=a(zk,"unshift"),zk.forEach(o),El=a(C,", "),Oo=n(C,"CODE",{class:!0});var Zk=r(Oo);_l=a(Zk,"shift"),Zk.forEach(o),Tl=a(C,", "),Co=n(C,"CODE",{class:!0});var Xk=r(Co);Sl=a(Xk,"sort"),Xk.forEach(o),Pl=a(C," and "),Ao=n(C,"CODE",{class:!0});var sy=r(Ao);Il=a(sy,"reverse"),sy.forEach(o),jl=a(C,"."),C.forEach(o),Ol=i(w),ga=n(w,"P",{});var oy=r(ga);Cl=a(oy,"To track changes made by these methods, you have to patch them:"),oy.forEach(o),Al=i(w),Do=n(w,"DIV",{class:!0});var kd=r(Do);kd.forEach(o),Dl=i(w),gs=n(w,"P",{});var _e=r(gs);Hl=a(_e,"Inspired by "),bs=n(_e,"A",{href:!0,rel:!0});var ty=r(bs);Ll=a(ty,"Vue.js 2.0\u2019s array observer"),ty.forEach(o),Ul=a(_e,"."),_e.forEach(o),Nl=i(w),ba=n(w,"BLOCKQUOTE",{});var ay=r(ba);Ho=n(ay,"P",{});var jh=r(Ho);Wl=a(jh,"CodeSandbox for "),Es=n(jh,"A",{href:!0,rel:!0});var ey=r(Es);Ml=a(ey,"mutation tracking of object and array"),ey.forEach(o),jh.forEach(o),ay.forEach(o),Rl=i(w),Ea=n(w,"P",{});var ny=r(Ea);ql=a(ny,"In summary, to track mutation on an object or array without Proxy, you need to define custom getters/setters for all properties, so that you can capture when the property is being set. Besides that, you need to patch all the mutating methods as well, because that will mutate your object without triggering the custom setter."),ny.forEach(o),Vl=i(w),_a=n(w,"P",{});var ry=r(_a);$l=a(ry,"Yet, there\u2019s still edge cases that cannot be covered, such as adding new property or deleting property."),ry.forEach(o),Bl=i(w),_s=n(w,"P",{});var Te=r(_s);Jl=a(Te,"There\u2019s where "),Ts=n(Te,"A",{href:!0,rel:!0});var ly=r(Ts);Yl=a(ly,"ES6 Proxy"),ly.forEach(o),Gl=a(Te," comes to help."),Te.forEach(o),w.forEach(o),fe=i(c),f=n(c,"SECTION",{});var _=r(f);Ta=n(_,"H3",{});var iy=r(Ta);Ss=n(iy,"A",{href:!0,id:!0});var py=r(Ss);Kl=a(py,"With Proxy"),py.forEach(o),iy.forEach(o),Fl=i(_),X=n(_,"P",{});var St=r(X);Ql=a(St,"Proxy allow us to define custom behaviours on fundamental operations on the target object. This is great for mutation tracking, because Proxy allow us to intercept setting and deleting property, irrelevant to whether we uses index assignment, "),Lo=n(St,"CODE",{class:!0});var cy=r(Lo);zl=a(cy,"obj[key] = value"),cy.forEach(o),Zl=a(St," or mutating methods, "),Uo=n(St,"CODE",{class:!0});var hy=r(Uo);Xl=a(hy,"obj.push(value)"),hy.forEach(o),si=a(St,":"),St.forEach(o),oi=i(_),No=n(_,"DIV",{class:!0});var yd=r(No);yd.forEach(o),ti=i(_),Sa=n(_,"P",{});var ky=r(Sa);Pa=n(ky,"STRONG",{});var yy=r(Pa);ai=a(yy,"So how do we use mutation tracking?"),yy.forEach(o),ky.forEach(o),ei=i(_),Ps=n(_,"P",{});var Se=r(Ps);ni=a(Se,"The good thing about mutation tracking is that, if you noticed in the example above, the framework user is unaware of the tracking and treats "),Wo=n(Se,"CODE",{class:!0});var vy=r(Wo);ri=a(vy,"appState"),vy.forEach(o),li=a(Se," as a normal object:"),Se.forEach(o),ii=i(_),Mo=n(_,"DIV",{class:!0});var vd=r(Mo);vd.forEach(o),pi=i(_),Ia=n(_,"P",{});var dy=r(Ia);ci=a(dy,"We can set up the tracking during the initialisation of the component, either:"),dy.forEach(o),hi=i(_),ss=n(_,"UL",{});var Pt=r(ss);ja=n(Pt,"LI",{});var uy=r(ja);ki=a(uy,"track a property of the component,"),uy.forEach(o),yi=i(Pt),Oa=n(Pt,"LI",{});var fy=r(Oa);vi=a(fy,"track the component instance itself,"),fy.forEach(o),di=i(Pt),Ca=n(Pt,"LI",{});var xy=r(Ca);ui=a(xy,"or something in between the above"),xy.forEach(o),Pt.forEach(o),fi=i(_),Ro=n(_,"DIV",{class:!0});var dd=r(Ro);dd.forEach(o),xi=i(_),os=n(_,"P",{});var It=r(os);wi=a(It,"Once you\u2019ve able to track application state changes, the next thing to do is to call "),qo=n(It,"CODE",{class:!0});var wy=r(qo);mi=a(wy,"scheduleUpdate"),wy.forEach(o),gi=a(It," instead of "),Vo=n(It,"CODE",{class:!0});var my=r(Vo);bi=a(my,"console.log"),my.forEach(o),Ei=a(It,"."),It.forEach(o),_i=i(_),Is=n(_,"P",{});var Pe=r(Is);Ti=a(Pe,"You may concern whether all these complexities is worth the effort. Or you may be worried that "),js=n(Pe,"A",{href:!0,rel:!0});var gy=r(js);Si=a(gy,"Proxy is not supported to older browsers"),gy.forEach(o),Pi=a(Pe,"."),Pe.forEach(o),Ii=i(_),Aa=n(_,"P",{});var by=r(Aa);ji=a(by,"Your concern is not entirely baseless. Not all frameworks use mutation tracking."),by.forEach(o),_.forEach(o),xe=i(c),h=n(c,"SECTION",{});var y=r(h);Da=n(y,"H3",{});var Ey=r(Da);ls=n(Ey,"A",{href:!0,id:!0});var Oh=r(ls);Oi=a(Oh,"Just call "),$o=n(Oh,"CODE",{class:!0});var _y=r($o);Ci=a(_y,"scheduleUpdate"),_y.forEach(o),Oh.forEach(o),Ey.forEach(o),Ai=i(y),Ha=n(y,"P",{});var Ty=r(Ha);Di=a(Ty,"Some frameworks design their API in the way such that it \u201Ctricks\u201D the framework user to tell the framework that the application state has changed."),Ty.forEach(o),Hi=i(y),Os=n(y,"P",{});var Ie=r(Os);Li=a(Ie,"Instead of remembering to call "),Bo=n(Ie,"CODE",{class:!0});var Sy=r(Bo);Ui=a(Sy,"scheduleUpdate"),Sy.forEach(o),Ni=a(Ie," whenever you change the application state, the framework forces you to use their API to change application state:"),Ie.forEach(o),Wi=i(y),Jo=n(y,"DIV",{class:!0});var ud=r(Jo);ud.forEach(o),Mi=i(y),La=n(y,"P",{});var Py=r(La);Ri=a(Py,"This gives us a much simpler design and less edge case to handle:"),Py.forEach(o),qi=i(y),Yo=n(y,"DIV",{class:!0});var fd=r(Yo);fd.forEach(o),Vi=i(y),Cs=n(y,"P",{});var je=r(Cs);$i=a(je,"Inspired by "),is=n(je,"A",{href:!0,rel:!0});var Ch=r(is);Bi=a(Ch,"React\u2019s "),Go=n(Ch,"CODE",{class:!0});var Iy=r(Go);Ji=a(Iy,"setState"),Iy.forEach(o),Ch.forEach(o),Yi=a(je,"."),je.forEach(o),Gi=i(y),Ua=n(y,"P",{});var jy=r(Ua);Ki=a(jy,"However, this may trip new developers into the framework:"),jy.forEach(o),Fi=i(y),Ko=n(y,"DIV",{class:!0});var xd=r(Ko);xd.forEach(o),Qi=i(y),Na=n(y,"P",{});var Oy=r(Na);zi=a(Oy,"... and it maybe a bit clumsy when adding / removing items from an array:"),Oy.forEach(o),Zi=i(y),Fo=n(y,"DIV",{class:!0});var wd=r(Fo);wd.forEach(o),Xi=i(y),As=n(y,"P",{});var Oe=r(As);sp=a(Oe,"A different approach that may have the best of both world is to insert "),Qo=n(Oe,"CODE",{class:!0});var Cy=r(Qo);op=a(Cy,"scheduleUpdate"),Cy.forEach(o),tp=a(Oe," in scenarios that you think that changes may most likely happen:"),Oe.forEach(o),ap=i(y),q=n(y,"UL",{});var cs=r(q);Wa=n(cs,"LI",{});var Ay=r(Wa);ep=a(Ay,"Event handlers"),Ay.forEach(o),np=i(cs),ts=n(cs,"LI",{});var jt=r(ts);rp=a(jt,"Timeout (eg: "),zo=n(jt,"CODE",{class:!0});var Dy=r(zo);lp=a(Dy,"setTimeout"),Dy.forEach(o),ip=a(jt,", "),Zo=n(jt,"CODE",{class:!0});var Hy=r(Zo);pp=a(Hy,"setInterval"),Hy.forEach(o),cp=a(jt,", ...)"),jt.forEach(o),hp=i(cs),Ma=n(cs,"LI",{});var Ly=r(Ma);kp=a(Ly,"API handling, promises handling"),Ly.forEach(o),yp=i(cs),Ra=n(cs,"LI",{});var Uy=r(Ra);vp=a(Uy,"..."),Uy.forEach(o),cs.forEach(o),dp=i(y),Ds=n(y,"P",{});var Ce=r(Ds);up=a(Ce,"So, instead of enforcing framework users to use "),Xo=n(Ce,"CODE",{class:!0});var Ny=r(Xo);fp=a(Ny,"setAppState()"),Ny.forEach(o),xp=a(Ce,`, framework users should use the
custom timeouts, api handlers, ...:`),Ce.forEach(o),wp=i(y),st=n(y,"DIV",{class:!0});var md=r(st);md.forEach(o),mp=i(y),ot=n(y,"P",{});var Ah=r(ot);gp=a(Ah,"Inspired by "),Hs=n(Ah,"A",{href:!0,rel:!0});var Wy=r(Hs);bp=a(Wy,"AngularJS\u2019s \\$timeout"),Wy.forEach(o),Ah.forEach(o),Ep=i(y),Ls=n(y,"P",{});var Ae=r(Ls);_p=a(Ae,"Your framework user can now be free to change the application state the way he wants, as long as the changes are done within your custom handlers. Because at the end of the handler, you will call "),tt=n(Ae,"CODE",{class:!0});var My=r(tt);Tp=a(My,"scheduleUpdate()"),My.forEach(o),Sp=a(Ae,"."),Ae.forEach(o),Pp=i(y),at=n(y,"P",{});var Dh=r(at);Ip=a(Dh,"Similarly, this may trip new developers into the framework too! Try search "),Us=n(Dh,"A",{href:!0,rel:!0});var Ry=r(Us);jp=a(Ry,'"AngularJS $timeout vs window.setTimeout"'),Ry.forEach(o),Dh.forEach(o),Op=i(y),U=n(y,"P",{});var G=r(U);Cp=a(G,"You may think, what if there are no state changes in the handler function, wouldn\u2019t calling an extra "),et=n(G,"CODE",{class:!0});var qy=r(et);Ap=a(qy,"scheduleUpdate()"),qy.forEach(o),Dp=a(G," be inefficient? Well so far, we haven\u2019t discussed what\u2019s happening in "),nt=n(G,"CODE",{class:!0});var Vy=r(nt);Hp=a(Vy,"scheduleUpdate()"),Vy.forEach(o),Lp=a(G,", we can check "),qa=n(G,"STRONG",{});var $y=r(qa);Up=a($y,"what has changed"),$y.forEach(o),Np=a(G," (which will be covered in the next section)"),Va=n(G,"STRONG",{});var By=r(Va);Wp=a(By,","),By.forEach(o),Mp=a(G," and if there\u2019s nothing change, we can skip the subsequent steps."),G.forEach(o),Rp=i(y),$a=n(y,"P",{});var Jy=r($a);qp=a(Jy,"If you look at the strategies that we have tried so far, you may have noticed a common struggle:"),Jy.forEach(o),Vp=i(y),Ns=n(y,"UL",{});var De=r(Ns);Ba=n(De,"LI",{});var Yy=r(Ba);$p=a(Yy,"allow framework user to change the application state in any way he wants"),Yy.forEach(o),Bp=i(De),Ja=n(De,"LI",{});var Gy=r(Ja);Jp=a(Gy,"achieve reactivity without much runtime complexity."),Gy.forEach(o),De.forEach(o),Yp=i(y),as=n(y,"P",{});var Ot=r(as);Gp=a(Ot,"At this point, you got to agree that enforcing framework developers to call "),rt=n(Ot,"CODE",{class:!0});var Ky=r(rt);Kp=a(Ky,"setAppState"),Ky.forEach(o),Fp=a(Ot," whenever they want to change the application state, requires "),Ya=n(Ot,"STRONG",{});var Fy=r(Ya);Qp=a(Fy,"less runtime complexity"),Fy.forEach(o),zp=a(Ot," from the framework, and it\u2019s unlikely to have any corner cases or caveats that need to handle."),Ot.forEach(o),Zp=i(y),Ga=n(y,"P",{});var Qy=r(Ga);Xp=a(Qy,"If the dilemma is between developer expressiveness versus runtime complexity, probably we could get the best of both worlds by shifting the complexity from runtime to build time?"),Qy.forEach(o),y.forEach(o),we=i(c),x=n(c,"SECTION",{});var T=r(x);Ka=n(T,"H3",{});var zy=r(Ka);Ws=n(zy,"A",{href:!0,id:!0});var Zy=r(Ws);sc=a(Zy,"Static analysis"),Zy.forEach(o),zy.forEach(o),oc=i(T),Fa=n(T,"P",{});var Xy=r(Fa);tc=a(Xy,"If we have a compiler that allow framework users to write:"),Xy.forEach(o),ac=i(T),lt=n(T,"DIV",{class:!0});var gd=r(lt);gd.forEach(o),ec=i(T),Qa=n(T,"P",{});var sv=r(Qa);nc=a(sv,"and compiles it to:"),sv.forEach(o),rc=i(T),it=n(T,"DIV",{class:!0});var bd=r(it);bd.forEach(o),lc=i(T),za=n(T,"P",{});var ov=r(za);ic=a(ov,"Then, we would really have best of both worlds! \u{1F60E}"),ov.forEach(o),pc=i(T),Ms=n(T,"P",{});var He=r(Ms);cc=a(He,"Let\u2019s look at different scenarios that the framework user would write, and see whether we know when to insert the "),pt=n(He,"CODE",{class:!0});var tv=r(pt);hc=a(tv,"scheduleUpdate()"),tv.forEach(o),kc=a(He,":"),He.forEach(o),yc=i(T),ct=n(T,"DIV",{class:!0});var Ed=r(ct);Ed.forEach(o),vc=i(T),Za=n(T,"P",{});var av=r(Za);dc=a(av,"Allow me to summarise some complexities faced in the example above:"),av.forEach(o),uc=i(T),Rs=n(T,"UL",{});var Le=r(Rs);$=n(Le,"LI",{});var Xs=r($);fc=a(Xs,"It is easy to track direct changes to the application state, but it is extremely difficult to track changes made indirectly, eg: "),ht=n(Xs,"CODE",{class:!0});var ev=r(ht);xc=a(ev,"foo.one"),ev.forEach(o),wc=a(Xs,", "),kt=n(Xs,"CODE",{class:!0});var nv=r(kt);mc=a(nv,"doSomethingMutable(this.appState)"),nv.forEach(o),gc=a(Xs," or "),yt=n(Xs,"CODE",{class:!0});var rv=r(yt);bc=a(rv,"this.appState.obj.increment()"),rv.forEach(o),Xs.forEach(o),Ec=i(Le),qs=n(Le,"LI",{});var Ue=r(qs);_c=a(Ue,"It is easy to track changes through assignment statements, but extremely difficult to track changes made through mutating methods, eg: "),vt=n(Ue,"CODE",{class:!0});var lv=r(vt);Tc=a(lv,"this.appState.list.push('1')"),lv.forEach(o),Sc=a(Ue,", I mean how do you know the method is mutating?"),Ue.forEach(o),Le.forEach(o),Pc=i(T),A=n(T,"P",{});var N=r(A);Ic=a(N,"So, for "),Vs=n(N,"A",{href:!0,rel:!0});var iv=r(Vs);jc=a(iv,"Svelte"),iv.forEach(o),Oc=a(N,", one of the frameworks that use static analysis to achieve reactivity, it only ensures reactivity through assignment operators (eg: "),dt=n(N,"CODE",{class:!0});var pv=r(dt);Cc=a(pv,"="),pv.forEach(o),Ac=a(N,", "),ut=n(N,"CODE",{class:!0});var cv=r(ut);Dc=a(cv,"+="),cv.forEach(o),Hc=a(N,", \u2026) and unary arithmetic operators (eg: "),ft=n(N,"CODE",{class:!0});var hv=r(ft);Lc=a(hv,"++"),hv.forEach(o),Uc=a(N," and "),xt=n(N,"CODE",{class:!0});var kv=r(xt);Nc=a(kv,"--"),kv.forEach(o),Wc=a(N,")."),N.forEach(o),Mc=i(T),$s=n(T,"P",{});var Ne=r($s);Rc=a(Ne,"I believe that there\u2019s room yet to be explored in this space, especially at the "),Bs=n(Ne,"A",{href:!0,rel:!0});var yv=r(Bs);qc=a(yv,"rise of TypeScript"),yv.forEach(o),Vc=a(Ne,", we may be able to understand our application state better through static types."),Ne.forEach(o),T.forEach(o),me=i(c),E=n(c,"SECTION",{});var P=r(E);Xa=n(P,"H2",{});var vv=r(Xa);Js=n(vv,"A",{href:!0,id:!0});var dv=r(Js);$c=a(dv,"Summary"),dv.forEach(o),vv.forEach(o),Bc=i(P),se=n(P,"P",{});var uv=r(se);Jc=a(uv,"We\u2019ve gone through different strategies of knowing when the application state has changed:"),uv.forEach(o),Yc=i(P),es=n(P,"UL",{});var Ct=r(es);oe=n(Ct,"LI",{});var fv=r(oe);Gc=a(fv,"mutation tracking"),fv.forEach(o),Kc=i(Ct),wt=n(Ct,"LI",{});var Hh=r(wt);Fc=a(Hh,"just call "),mt=n(Hh,"CODE",{class:!0});var xv=r(mt);Qc=a(xv,"scheduleUpdate"),xv.forEach(o),Hh.forEach(o),zc=i(Ct),te=n(Ct,"LI",{});var wv=r(te);Zc=a(wv,"static analysis"),wv.forEach(o),Ct.forEach(o),Xc=i(P),ae=n(P,"P",{});var mv=r(ae);sh=a(mv,"Different strategies manifests itself in terms of the API of the framework:"),mv.forEach(o),oh=i(P),Ys=n(P,"UL",{});var We=r(Ys);ee=n(We,"LI",{});var gv=r(ee);Gs=n(gv,"P",{});var Me=r(Gs);th=a(Me,"Is the framework user going to change the application state with simple object manipulation? or have to use API like "),gt=n(Me,"CODE",{class:!0});var bv=r(gt);ah=a(bv,"setAppState()"),bv.forEach(o),eh=a(Me,"?"),Me.forEach(o),gv.forEach(o),nh=i(We),ns=n(We,"LI",{});var At=r(ns);ne=n(At,"P",{});var Ev=r(ne);rh=a(Ev,"Is there caveats that the framework user needs to be aware of?"),Ev.forEach(o),lh=i(At),re=n(At,"P",{});var _v=r(re);ih=a(_v,"For example:"),_v.forEach(o),ph=i(At),Ks=n(At,"UL",{});var Re=r(Ks);le=n(Re,"LI",{});var Tv=r(le);ch=a(Tv,"Can only use assignment statement to achieve reactivity?"),Tv.forEach(o),hh=i(Re),ie=n(Re,"LI",{});var Sv=r(ie);kh=a(Sv,"Does framework user need to use a helper function for adding new reactive property to the application state?"),Sv.forEach(o),Re.forEach(o),At.forEach(o),We.forEach(o),yh=i(P),pe=n(P,"P",{});var Pv=r(pe);vh=a(Pv,"Knowing when an application state has changed, allow frameworks to know when to update our view. Yet, to optimise the updates, frameworks need to know what has changed in the application state."),Pv.forEach(o),dh=i(P),ce=n(P,"P",{});var Iv=r(ce);uh=a(Iv,"Are we going to remove and recreate every DOM element in the view? Do we know that which part of the view is going to change based on what has changed in the application state?"),Iv.forEach(o),fh=i(P),Fs=n(P,"P",{});var qe=r(Fs);xh=a(qe,"That is, if we know "),he=n(qe,"STRONG",{});var jv=r(he);wh=a(jv,"the WHAT"),jv.forEach(o),mh=a(qe,"."),qe.forEach(o),gh=i(P),bh=n(P,"HR",{}),Eh=i(P),Qs=n(P,"P",{});var Ve=r(Qs);_h=a(Ve,"I\u2019d like to thank "),zs=n(Ve,"A",{href:!0,rel:!0});var Ov=r(zs);Th=a(Ov,"Rich Harris"),Ov.forEach(o),Sh=a(Ve," for pointing out some inaccuracies in the previous version of this article and providing valuable feedbacks. All the remaining errors are mine.."),Ve.forEach(o),P.forEach(o),this.h()},h(){p(b,"href","#what-is-reactivity"),p(b,"id","what-is-reactivity"),p(to,"class","code-section"),p(ao,"class","code-section"),p(eo,"class","code-section"),p(no,"class","inline"),p(ro,"class","inline"),p(hs,"href","#the-when-and-the-what"),p(hs,"id","the-when-and-the-what"),p(ys,"href","#the-when"),p(ys,"id","the-when"),p(lo,"class","inline"),p(io,"class","inline"),p(po,"class","inline"),p(vs,"href","https://techterms.com/definition/screen_tearing"),p(vs,"rel","nofollow"),p(co,"class","code-section"),p(ko,"class","inline"),p(yo,"class","inline"),p(ds,"href","https://kentcdodds.com/blog/dont-sync-state-derive-it"),p(ds,"rel","nofollow"),p(us,"href","#mutation-tracking"),p(us,"id","mutation-tracking"),p(vo,"class","code-section"),p(uo,"class","code-section"),p(fo,"class","inline"),p(xo,"class","inline"),p(wo,"class","inline"),p(go,"class","inline"),p(bo,"class","inline"),p(fs,"href","#prior-proxy"),p(fs,"id","prior-proxy"),p(Eo,"class","code-section"),p(ws,"href","https://paper.dropbox.com/doc/Reactivity-in-Web-Frameworks--Aroey0wh9iZRE8dm9lC4Ulo0AQ-D6CkkTTpH1AqGvBlKcQ85"),p(ws,"rel","nofollow"),p(_o,"class","inline"),p(ms,"href","https://vuejs.org/v2/guide/reactivity.html#Change-Detection-Caveats"),p(ms,"rel","nofollow"),p(To,"class","inline"),p(So,"class","inline"),p(Po,"class","inline"),p(Io,"class","inline"),p(jo,"class","inline"),p(Oo,"class","inline"),p(Co,"class","inline"),p(Ao,"class","inline"),p(Do,"class","code-section"),p(bs,"href","https://github.com/vuejs/vue/blob/22790b250cd5239a8379b4ec8cc3a9b570dac4bc/src/core/observer/array.js"),p(bs,"rel","nofollow"),p(Es,"href","https://codesandbox.io/s/mutation-tracking-getterssetters-44ono"),p(Es,"rel","nofollow"),p(Ts,"href","https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy"),p(Ts,"rel","nofollow"),p(Ss,"href","#with-proxy"),p(Ss,"id","with-proxy"),p(Lo,"class","inline"),p(Uo,"class","inline"),p(No,"class","code-section"),p(Wo,"class","inline"),p(Mo,"class","code-section"),p(Ro,"class","code-section"),p(qo,"class","inline"),p(Vo,"class","inline"),p(js,"href","https://caniuse.com/#feat=proxy"),p(js,"rel","nofollow"),p($o,"class","inline"),p(ls,"href","#just-call-scheduleupdate"),p(ls,"id","just-call-scheduleupdate"),p(Bo,"class","inline"),p(Jo,"class","code-section"),p(Yo,"class","code-section"),p(Go,"class","inline"),p(is,"href","https://github.com/facebook/react/blob/0cf22a56a18790ef34c71bef14f64695c0498619/packages/react/src/ReactBaseClasses.js#L57"),p(is,"rel","nofollow"),p(Ko,"class","code-section"),p(Fo,"class","code-section"),p(Qo,"class","inline"),p(zo,"class","inline"),p(Zo,"class","inline"),p(Xo,"class","inline"),p(st,"class","code-section"),p(Hs,"href","https://github.com/angular/angular.js/blob/master/src/ng/timeout.js#L13"),p(Hs,"rel","nofollow"),p(tt,"class","inline"),p(Us,"href","https://www.google.com/search?q=angularjs%20$timeout%20vs%20window.setTimeout"),p(Us,"rel","nofollow"),p(et,"class","inline"),p(nt,"class","inline"),p(rt,"class","inline"),p(Ws,"href","#static-analysis"),p(Ws,"id","static-analysis"),p(lt,"class","code-section"),p(it,"class","code-section"),p(pt,"class","inline"),p(ct,"class","code-section"),p(ht,"class","inline"),p(kt,"class","inline"),p(yt,"class","inline"),p(vt,"class","inline"),p(Vs,"href","http://github.com/sveltejs/svelte"),p(Vs,"rel","nofollow"),p(dt,"class","inline"),p(ut,"class","inline"),p(ft,"class","inline"),p(xt,"class","inline"),p(Bs,"href","https://2019.stateofjs.com/javascript-flavors/typescript/"),p(Bs,"rel","nofollow"),p(Js,"href","#summary"),p(Js,"id","summary"),p(mt,"class","inline"),p(gt,"class","inline"),p(zs,"href","https://twitter.com/Rich_Harris"),p(zs,"rel","nofollow")},m(c,k){Uv(g,c,k),j(c,W,k),j(c,v,k),s(v,K),s(K,b),s(b,M),s(v,oo),s(v,Dt),s(Dt,$e),s(v,Be),s(v,Ht),s(Ht,Je),s(v,Ye),s(v,Lt),s(Lt,Ge),s(v,Ke),s(v,Ut),s(Ut,Fe),s(v,Qe),s(v,to),to.innerHTML=Rv,s(v,ze),s(v,Nt),s(Nt,Ze),s(v,Xe),s(v,ao),ao.innerHTML=qv,s(v,sn),s(v,Wt),s(Wt,on),s(v,tn),s(v,eo),eo.innerHTML=Vv,s(v,an),s(v,F),s(F,en),s(F,Mt),s(Mt,Rt),s(Rt,nn),s(F,rn),s(F,qt),s(qt,Vt),s(Vt,ln),s(F,pn),s(v,cn),s(v,Q),s(Q,hn),s(Q,no),s(no,kn),s(Q,yn),s(Q,ro),s(ro,vn),s(Q,dn),s(v,un),s(v,$t),s($t,fn),s(v,xn),s(v,Bt),s(Bt,wn),s(v,mn),s(v,Jt),s(Jt,Yt),s(Yt,gn),j(c,ye,k),j(c,D,k),s(D,Gt),s(Gt,hs),s(hs,bn),s(D,En),s(D,Kt),s(Kt,_n),s(D,Tn),s(D,ks),s(ks,Ft),s(Ft,Sn),s(ks,Pn),s(ks,Qt),s(Qt,In),s(D,jn),s(D,rs),s(rs,zt),s(zt,On),s(rs,Cn),s(rs,Zt),s(Zt,An),s(rs,Dn),s(D,Hn),s(D,H),s(H,Ln),s(H,Xt),s(Xt,Un),s(H,Nn),s(H,sa),s(sa,Wn),s(H,Mn),s(H,oa),s(oa,Rn),s(H,qn),s(H,ta),s(ta,Vn),s(H,$n),j(c,ve,k),j(c,S,k),s(S,aa),s(aa,ys),s(ys,Bn),s(S,Jn),s(S,ea),s(ea,Yn),s(S,Gn),s(S,L),s(L,Kn),s(L,lo),s(lo,Fn),s(L,Qn),s(L,io),s(io,zn),s(L,Zn),s(L,po),s(po,Xn),s(L,sr),s(L,vs),s(vs,or),s(L,tr),s(S,ar),s(S,na),s(na,er),s(S,nr),s(S,co),co.innerHTML=$v,s(S,rr),s(S,ho),s(ho,lr),s(ho,ra),s(ra,ir),s(S,pr),s(S,la),s(la,V),s(V,cr),s(V,ko),s(ko,hr),s(V,kr),s(V,yo),s(yo,yr),s(V,vr),s(V,ds),s(ds,dr),s(S,ur),s(S,ia),s(ia,fr),j(c,de,k),j(c,u,k),s(u,pa),s(pa,us),s(us,xr),s(u,wr),s(u,ca),s(ca,mr),s(u,gr),s(u,ha),s(ha,br),s(u,Er),s(u,ka),s(ka,_r),s(u,Tr),s(u,ya),s(ya,Sr),s(u,Pr),s(u,vo),vo.innerHTML=Bv,s(u,Ir),s(u,va),s(va,jr),s(u,Or),s(u,uo),uo.innerHTML=Jv,s(u,Cr),s(u,R),s(R,Ar),s(R,fo),s(fo,Dr),s(R,Hr),s(R,xo),s(xo,Lr),s(R,Ur),s(R,wo),s(wo,Nr),s(R,Wr),s(u,Mr),s(u,da),s(da,Rr),s(u,qr),s(u,ua),s(ua,Vr),s(u,$r),s(u,mo),s(mo,z),s(z,Br),s(z,go),s(go,Jr),s(z,Yr),s(z,bo),s(bo,Gr),s(z,Kr),s(mo,Fr),s(u,Qr),s(u,fa),s(fa,zr),j(c,ue,k),j(c,d,k),s(d,xa),s(xa,fs),s(fs,Zr),s(d,Xr),s(d,wa),s(wa,sl),s(d,ol),s(d,Eo),Eo.innerHTML=Yv,s(d,tl),s(d,xs),s(xs,al),s(xs,ws),s(ws,el),s(xs,nl),s(d,rl),s(d,ma),s(ma,ll),s(d,il),s(d,Z),s(Z,pl),s(Z,ms),s(ms,_o),s(_o,cl),s(Z,hl),s(Z,To),s(To,kl),s(Z,yl),s(d,vl),s(d,I),s(I,dl),s(I,So),s(So,ul),s(I,fl),s(I,Po),s(Po,xl),s(I,wl),s(I,Io),s(Io,ml),s(I,gl),s(I,jo),s(jo,bl),s(I,El),s(I,Oo),s(Oo,_l),s(I,Tl),s(I,Co),s(Co,Sl),s(I,Pl),s(I,Ao),s(Ao,Il),s(I,jl),s(d,Ol),s(d,ga),s(ga,Cl),s(d,Al),s(d,Do),Do.innerHTML=Gv,s(d,Dl),s(d,gs),s(gs,Hl),s(gs,bs),s(bs,Ll),s(gs,Ul),s(d,Nl),s(d,ba),s(ba,Ho),s(Ho,Wl),s(Ho,Es),s(Es,Ml),s(d,Rl),s(d,Ea),s(Ea,ql),s(d,Vl),s(d,_a),s(_a,$l),s(d,Bl),s(d,_s),s(_s,Jl),s(_s,Ts),s(Ts,Yl),s(_s,Gl),j(c,fe,k),j(c,f,k),s(f,Ta),s(Ta,Ss),s(Ss,Kl),s(f,Fl),s(f,X),s(X,Ql),s(X,Lo),s(Lo,zl),s(X,Zl),s(X,Uo),s(Uo,Xl),s(X,si),s(f,oi),s(f,No),No.innerHTML=Kv,s(f,ti),s(f,Sa),s(Sa,Pa),s(Pa,ai),s(f,ei),s(f,Ps),s(Ps,ni),s(Ps,Wo),s(Wo,ri),s(Ps,li),s(f,ii),s(f,Mo),Mo.innerHTML=Fv,s(f,pi),s(f,Ia),s(Ia,ci),s(f,hi),s(f,ss),s(ss,ja),s(ja,ki),s(ss,yi),s(ss,Oa),s(Oa,vi),s(ss,di),s(ss,Ca),s(Ca,ui),s(f,fi),s(f,Ro),Ro.innerHTML=Qv,s(f,xi),s(f,os),s(os,wi),s(os,qo),s(qo,mi),s(os,gi),s(os,Vo),s(Vo,bi),s(os,Ei),s(f,_i),s(f,Is),s(Is,Ti),s(Is,js),s(js,Si),s(Is,Pi),s(f,Ii),s(f,Aa),s(Aa,ji),j(c,xe,k),j(c,h,k),s(h,Da),s(Da,ls),s(ls,Oi),s(ls,$o),s($o,Ci),s(h,Ai),s(h,Ha),s(Ha,Di),s(h,Hi),s(h,Os),s(Os,Li),s(Os,Bo),s(Bo,Ui),s(Os,Ni),s(h,Wi),s(h,Jo),Jo.innerHTML=zv,s(h,Mi),s(h,La),s(La,Ri),s(h,qi),s(h,Yo),Yo.innerHTML=Zv,s(h,Vi),s(h,Cs),s(Cs,$i),s(Cs,is),s(is,Bi),s(is,Go),s(Go,Ji),s(Cs,Yi),s(h,Gi),s(h,Ua),s(Ua,Ki),s(h,Fi),s(h,Ko),Ko.innerHTML=Xv,s(h,Qi),s(h,Na),s(Na,zi),s(h,Zi),s(h,Fo),Fo.innerHTML=sd,s(h,Xi),s(h,As),s(As,sp),s(As,Qo),s(Qo,op),s(As,tp),s(h,ap),s(h,q),s(q,Wa),s(Wa,ep),s(q,np),s(q,ts),s(ts,rp),s(ts,zo),s(zo,lp),s(ts,ip),s(ts,Zo),s(Zo,pp),s(ts,cp),s(q,hp),s(q,Ma),s(Ma,kp),s(q,yp),s(q,Ra),s(Ra,vp),s(h,dp),s(h,Ds),s(Ds,up),s(Ds,Xo),s(Xo,fp),s(Ds,xp),s(h,wp),s(h,st),st.innerHTML=od,s(h,mp),s(h,ot),s(ot,gp),s(ot,Hs),s(Hs,bp),s(h,Ep),s(h,Ls),s(Ls,_p),s(Ls,tt),s(tt,Tp),s(Ls,Sp),s(h,Pp),s(h,at),s(at,Ip),s(at,Us),s(Us,jp),s(h,Op),s(h,U),s(U,Cp),s(U,et),s(et,Ap),s(U,Dp),s(U,nt),s(nt,Hp),s(U,Lp),s(U,qa),s(qa,Up),s(U,Np),s(U,Va),s(Va,Wp),s(U,Mp),s(h,Rp),s(h,$a),s($a,qp),s(h,Vp),s(h,Ns),s(Ns,Ba),s(Ba,$p),s(Ns,Bp),s(Ns,Ja),s(Ja,Jp),s(h,Yp),s(h,as),s(as,Gp),s(as,rt),s(rt,Kp),s(as,Fp),s(as,Ya),s(Ya,Qp),s(as,zp),s(h,Zp),s(h,Ga),s(Ga,Xp),j(c,we,k),j(c,x,k),s(x,Ka),s(Ka,Ws),s(Ws,sc),s(x,oc),s(x,Fa),s(Fa,tc),s(x,ac),s(x,lt),lt.innerHTML=td,s(x,ec),s(x,Qa),s(Qa,nc),s(x,rc),s(x,it),it.innerHTML=ad,s(x,lc),s(x,za),s(za,ic),s(x,pc),s(x,Ms),s(Ms,cc),s(Ms,pt),s(pt,hc),s(Ms,kc),s(x,yc),s(x,ct),ct.innerHTML=ed,s(x,vc),s(x,Za),s(Za,dc),s(x,uc),s(x,Rs),s(Rs,$),s($,fc),s($,ht),s(ht,xc),s($,wc),s($,kt),s(kt,mc),s($,gc),s($,yt),s(yt,bc),s(Rs,Ec),s(Rs,qs),s(qs,_c),s(qs,vt),s(vt,Tc),s(qs,Sc),s(x,Pc),s(x,A),s(A,Ic),s(A,Vs),s(Vs,jc),s(A,Oc),s(A,dt),s(dt,Cc),s(A,Ac),s(A,ut),s(ut,Dc),s(A,Hc),s(A,ft),s(ft,Lc),s(A,Uc),s(A,xt),s(xt,Nc),s(A,Wc),s(x,Mc),s(x,$s),s($s,Rc),s($s,Bs),s(Bs,qc),s($s,Vc),j(c,me,k),j(c,E,k),s(E,Xa),s(Xa,Js),s(Js,$c),s(E,Bc),s(E,se),s(se,Jc),s(E,Yc),s(E,es),s(es,oe),s(oe,Gc),s(es,Kc),s(es,wt),s(wt,Fc),s(wt,mt),s(mt,Qc),s(es,zc),s(es,te),s(te,Zc),s(E,Xc),s(E,ae),s(ae,sh),s(E,oh),s(E,Ys),s(Ys,ee),s(ee,Gs),s(Gs,th),s(Gs,gt),s(gt,ah),s(Gs,eh),s(Ys,nh),s(Ys,ns),s(ns,ne),s(ne,rh),s(ns,lh),s(ns,re),s(re,ih),s(ns,ph),s(ns,Ks),s(Ks,le),s(le,ch),s(Ks,hh),s(Ks,ie),s(ie,kh),s(E,yh),s(E,pe),s(pe,vh),s(E,dh),s(E,ce),s(ce,uh),s(E,fh),s(E,Fs),s(Fs,xh),s(Fs,he),s(he,wh),s(Fs,mh),s(E,gh),s(E,bh),s(E,Eh),s(E,Qs),s(Qs,_h),s(Qs,zs),s(zs,Th),s(Qs,Sh),ge=!0},p:jd,i(c){ge||(Nv(g.$$.fragment,c),ge=!0)},o(c){Wv(g.$$.fragment,c),ge=!1},d(c){Mv(g,c),c&&o(W),c&&o(v),c&&o(ye),c&&o(D),c&&o(ve),c&&o(S),c&&o(de),c&&o(u),c&&o(ue),c&&o(d),c&&o(fe),c&&o(f),c&&o(xe),c&&o(h),c&&o(we),c&&o(x),c&&o(me),c&&o(E)}}}function Hd(so){let g,W;const v=[so[0],Dv];let K={$$slots:{default:[Dd]},$$scope:{ctx:so}};for(let b=0;b<v.length;b+=1)K=Lh(K,v[b]);return g=new Od({props:K}),{c(){Hv(g.$$.fragment)},l(b){Lv(g.$$.fragment,b)},m(b,M){Uv(g,b,M),W=!0},p(b,[M]){const oo=M&1?Pd(v,[M&1&&Cv(b[0]),M&0&&Cv(Dv)]):{};M&2&&(oo.$$scope={dirty:M,ctx:b}),g.$set(oo)},i(b){W||(Nv(g.$$.fragment,b),W=!0)},o(b){Wv(g.$$.fragment,b),W=!1},d(b){Mv(g,b)}}}const Dv={title:"Reactivity in Web Frameworks (Part 1)",date:"2020-01-05T08:00:00Z",lastUpdated:"2020-01-08T08:00:00Z",description:"Reactivity is the ability of a web framework to update your view whenever the application state has changed. How do web frameworks achieve reactivity?",label:"blog"};function Ld(so,g,W){return Id("blog",{image:Ad}),so.$$set=v=>{W(0,g=Lh(Lh({},g),Av(v)))},g=Av(g),[g]}class $d extends _d{constructor(g){super();Td(this,g,Ld,Hd,Sd,{})}}export{$d as default,Dv as metadata};
